"use strict";function defer_expr(e,t){var n;e()?t():n=setInterval(function(){e()&&(clearInterval(n),t())},0)}String.prototype.replace_all=function(e,t){var n=this.valueOf();for(e=e||"",t=t||"";0<=n.indexOf(e);)n=n.replace(e,t);return n},window._id_counter=-1,Object.prototype.hasOwnProperty("_id")||Object.defineProperty(Object.prototype,"_id",{value:"",enumerable:!1,writable:!0}),Object.prototype.hasOwnProperty("set_id")||Object.defineProperty(Object.prototype,"set_id",{value:function(e){var t=this;return t._id=e||(window._id_counter++,"__"+window._id_counter+"__"),t._id},enumerable:!1,writable:!1}),Object.prototype.hasOwnProperty("forIn")||Object.defineProperty(Object.prototype,"forIn",{value:function(e){var t;if(e)for(t in this)e(t,this[t])},enumerable:!1,writable:!1});var Signals=function(e){if(e)return e;var g,t,n,i,u,p,f,h,o={},r={},m="production";function f(e,t){this._i=e,this._fn=t}function h(e,t,n){var i=!1,o=!1,r=null;return{ns:e,name:t,names:t.split("."),args:n,stopPropagation:function(){i=!0},isStop:function(){return i},freeze:function(){o=!0},unfreeze:function(){var e=r;o=!1,r=null,e&&e.keepOn()},isFreeze:function(){return o},registerFrezer:function(e){o&&e instanceof f&&(r=e)}}}function u(e,t,n){if(r[e][t]=r[e][t]||[],void 0===r[e][t].count&&(r[e][t].count=10),0<=r[e][t].indexOf(n)){if(r[e][t].count--,r[e][t].count<0)throw p(e,t),'Signals. !!!Collision!!! Trigger "'+t+'" go to recursion.'}else r[e][t].push(n)}function p(e,t){delete r[e][t]}function g(e){return o[e]=o[e]||{},r[e]=r[e]||{},o[e]}function t(e,t,n,i){var o;"function"==typeof n&&(void 0===i&&(i=0),n._priority=i,(o=g(e))[t]=o[t]||[],o[t].indexOf(n)<0&&o[t].push(n))}function n(e,t,n){var i,o;"function"==typeof n&&(i=g(e))[t]&&(0<=(o=i[t].indexOf(n))&&i[t].splice(o,1),0==i[t].length&&(delete i[t],delete r[t]))}function a(e,t){var n;(n=g(e))[t]&&(delete n[t],delete r[t])}function i(o,r){var a,e,t,n,i,s,d,l=(e=r,d=[],t=g(o),0<=(s=n=e).indexOf(".")&&(s=[],n.split(".").forEach(function(e){i?(i=i+"."+e,s.push(i)):(i=e,s.push(e))})),"string"==typeof(e=s)?(t[e]=t[e]||[],d=t[e]):Array.isArray(e)&&e.forEach(function(e){t[e]=t[e]||[],d.push.apply(d,t[e])}),d.sort(function(e,t){return e._priority-t._priority}),d),c=[];c.push.apply(c,arguments),c=c.splice(2),a=new h(o,r,c),function e(t){var n,i=0;for(void 0!==t&&(i=t+1);i<l.length;i++){if(a.isStop())return void p(o,r);n=l[i],u(o,r,n);try{n.apply(a,a.args)}catch(e){"development"==m&&(console.error("Error on Signals Calling",e),console.info("Dump idx : ",t),console.info("Dump fn : ",n),console.info("Dump trigger (t) : ",a),console.info("Dump arguments : ",a.args))}if(a.isFreeze())return void a.registerFrezer(new f(i,e));l.length-1==i&&p(o,r)}}()}return f.prototype={_i:0,_fn:null,keepOn:function(){this._fn(this._i)},isInstance:function(e){return e instanceof f}},e={setEnvironmentStage:function(e){m=e||m},create:function(e){var t=this,n=e||{}.set_id();return{parent:t,getNameSpace:function(){return n},on:function(){var e=[];return e.push.apply(e,arguments),e.unshift(n),t.on.apply(t,e),this},off:function(){var e=[];return e.push.apply(e,arguments),e.unshift(n),t.off.apply(t,e),this},clearAll:function(){var e=[];return e.push.apply(e,arguments),e.unshift(n),t.clearAll.apply(t,e),this},trigger:function(){var e=[];return e.push.apply(e,arguments),e.unshift(n),t.trigger.apply(t,e),this}}},on:function(){return t.apply(t,arguments),this},off:function(){return n.apply(n,arguments),this},clearAll:function(){return a.apply(a,arguments),this},trigger:function(){return i.apply(i,arguments),this},connect:function(){return this.on.apply(this,arguments),this},disconnect:function(){return this.off.apply(this,arguments),this},signal:function(){return this.trigger.apply(this,arguments),this}}}(Signals);function AbstractHelperClass(){}AbstractHelperClass.prototype={run:function(){},destroy:function(){},_isWidgetHasActiveHelperInDom:function(e,t){return e&&e._activeHelpers&&e._activeHelpers[t]&&e._dom==e._activeHelpers[t].parent()[0]},registerTemplate:function(e,t){angular.isString(t)?this._templates[e]={_content:t,render:function(){return this._content}}:this._templates[e]=t},unregisterTemplate:function(e){delete this._templates[e]},getTemplate:function(e){return this._templates[e]||this._templates.base},showByWidget:function(e){var t;return e&&(e._activeHelpers&&e._activeHelpers[this.type]?this._isWidgetHasActiveHelperInDom(e,this.type)||e._$dom.prepend(e._activeHelpers[this.type]):(t=this.getTemplate(e.name).render({widget:e,type:this.type}),e._activeHelpers=e._activeHelpers||{},e._activeHelpers[this.type]=$(t),e._$dom.prepend(e._activeHelpers[this.type]))),this},hideByWidget:function(e){return e&&e._activeHelpers&&e._activeHelpers[this.type]&&(e._activeHelpers[this.type].remove(),delete e._activeHelpers[this.type]),this},updateByWidget:function(e){return this.hideByWidget(e),this.showByWidget(e),this}};var HelperDD={convertPosition:function(e){var t,n=e.positionMethod,i=e.targetWidget,o=e.targetElement,r=e.droppedWidget||null,a=angular.isUndefined(e.positionIndexDelta)?0:e.positionIndexDelta,s={positionIndex:0,containerIndex:0,positionMethod:n,name:i.name,id:i.getWidgetId(),targetWidget:i,targetElement:o},d=-1;return t=i.getContainerPositionIndex(),i.isContainer()&&"prepend"===n&&(n="append",d=0),-1<["before","after"].indexOf(n)&&(i._parent?(d=i.getPositionIndexInContainer(),i=i._parent,r&&i===r._parent&&t===i.getContainerIndexByElement(r._$dom)&&r._$dom.index()<d&&d--,"after"==n&&d++,d+=a,n="append"):console.error("DD HELPER : targetWidget not have parent")),s.name=i.name,s.id=i.getWidgetId(),s.positionMethod=n,s.positionIndex=d,s.containerIndex=t,s.targetWidget=i,s}};function HelperDragHoverClass(){this._templates={base:{render:function(e){return'<div class="moto-editor-helper moto-editor-helper_drag-hover"><div class="moto-editor-outline"></div><div class="moto-editor-label moto-editor-helper-label_top"><span class="helper-label">'+MotoEditor.translate(e.widget.label)+"</span></div></div>"}}}}function HelperDragOverClass(){this._templates={base:{render:function(){return'<div class="moto-editor-helper moto-editor-helper_drag-over"><div class="moto-editor-outline"></div></div>'}}}}function HelperHighlightClass(){this._templates={base:{render:function(){return'<div class="moto-editor-helper moto-editor-helper_highlight"><div class="moto-editor-outline"></div></div>'}}}}function HelperHoverClass(){this._templates={base:{render:function(e){return'<div class="moto-editor-helper moto-editor-helper_hover moto-editor_no-draggable" draggable="true"><div class="moto-editor-outline"></div><div class="moto-editor-label moto-editor-helper-label_top"><span class="moto-editor_draggable" draggable="true"><span class="icon moto-editor-drag-icon"></span><span class="helper-label">'+MotoEditor.translate(e.widget.label)+"</span></span>"+(e.widget.isCopyable()?'<span class="moto-editor_duplicate-closest-widget moto-editor-label-button_widget-duplicate"></span>':"")+(e.widget.isRemovable()?'<span class="moto-editor_remove-closest-widget moto-editor-label-button_widget-remove"></span>':"")+"</div></div>"}}}}function HelperSelectedClass(){this._templates={base:{render:function(e){var t=MotoEditor.HelperSelected._getParentsInfo(e.widget);return'<div class="moto-editor-helper moto-editor-helper_selected moto-editor_no-draggable" draggable="true"><div class="moto-editor-outline"></div><div class="moto-editor-parent-widgets-button-group moto-editor-parent-widgets-button-group_'+t.position+' moto-editor-parent-widgets-list_hidden"><div class="moto-editor-label moto-editor-label_'+t.position+' moto-editor-parent-widgets-button moto-editor_toggle-parent-labels"><span class="moto-editor_draggable" draggable="true"><span class="icon moto-editor-drag-icon"></span><span class="helper-label">'+MotoEditor.translate(e.widget.label)+"</span></span>"+(e.widget.isCopyable()?'<span class="moto-editor_duplicate-closest-widget moto-editor-label-button_widget-duplicate"></span>':"")+(e.widget.isRemovable()?'<span class="moto-editor_remove-closest-widget moto-editor-label-button_widget-remove"></span>':"")+"</div>"+t.template+"</div></div>"}}},this.onToggleParentLabelsClick=function(e){$(e.currentTarget).closest(".moto-editor-parent-widgets-button-group").toggleClass("moto-editor-parent-widgets-list_hidden"),e.stopPropagation()}}function InsertLineClass(){}function MotoEditorEnvironmentClass(e){var i={};(e=e||{}).window=e.window||window,e.document=e.document||document,e.$=e.$||e.window.$,this.setGlobal=function(e,t,n){return!(!angular.isString(e)||0<e.indexOf("."))&&(n=n||{},e=e.trim(),!(i[e]&&!i[e].rewritable)&&(n.rewritable=n.rewritable||!0,i[e]={entity:t,rewritable:n.rewritable},n.rewritable&&(this["__"+e]=t),!0))},this.getGlobal=function(e){return!angular.isString(e)||0<e.indexOf(".")?null:i[e]&&i[e].entity||null},this.setGlobal("$",$),this.setGlobal("window",e.window),this.setGlobal("document",e.document),e.$&&(this.setGlobal("$window",$(e.window)),this.setGlobal("$document",$(e.document)))}function MotoEditorUtilsClass(e){this.$=e.getGlobal("$")}function MotoEditorWidgetsUtilsClass(e){this.MotoEditor=e.getEditor(),this._widgets=this._widgets,this._indexById=this._indexById,this._indexByName=this._indexByName,this._indexByWidthChanged=this._indexByWidthChanged}function MotoEditorEventsHandlerClass(e){var n,t,i=e;function o(e,t){n.Widgets.updateCache(t),n.getHelpers().hideHelpers()}function r(e,t){n.Widgets.massCall(n.Widgets.getNestedWidgetsByWidget(t),{method:"onWidthChanged"})}this.run=function(){n=i.getEditor(),(t=n.getScope()).$on("widget.preset.afterChange",o),t.$on("Widget.WidthChangedByWidget",r)}}HelperDragHoverClass.prototype=Object.create(AbstractHelperClass.prototype),angular.extend(HelperDragHoverClass.prototype,{constructor:HelperDragHoverClass,type:"drag-hover"}),HelperDragOverClass.prototype=Object.create(AbstractHelperClass.prototype),angular.extend(HelperDragOverClass.prototype,{constructor:HelperDragOverClass,type:"drag-over"}),HelperHighlightClass.prototype=Object.create(AbstractHelperClass.prototype),angular.extend(HelperHighlightClass.prototype,{constructor:HelperHighlightClass,type:"highlight"}),HelperHoverClass.prototype=Object.create(AbstractHelperClass.prototype),angular.extend(HelperHoverClass.prototype,{constructor:HelperHoverClass,type:"hover"}),HelperSelectedClass.prototype=Object.create(AbstractHelperClass.prototype),angular.extend(HelperSelectedClass.prototype,{constructor:HelperSelectedClass,type:"selected",_getParentsInfo:function(e){var t,n,i,o;for(o=[],t=MotoEditor.getElementCharacteristics(e._$dom);e._parent&&5!=o.length;)if((e=e._parent).isVisibleInNesting()){if(e.isUnselectable())break;i='<div class="moto-editor-parent-widget-item"><div class="moto-editor-label moto-editor_select-widget-by-id-attribute" data-id="'+e._id+'"><span class="icon icon-'+e.name.replace(/\./g,"-")+'"></span><span class="helper-label">'+MotoEditor.translate(e.label)+"</span></div></div>",o.push(i)}return"top"==(n=27*(o.length+1)<t.top?"top":"bottom")&&(o=o.reverse()),{position:n,template:'<div class="moto-editor-parent-widgets-list">'+o.join("")+"</div>"}},run:function(){MotoEditor._$body.find(".moto-section").on("click",".moto-editor_toggle-parent-labels",this.onToggleParentLabelsClick)},destroy:function(){MotoEditor._$body.find(".moto-section").off("click",".moto-editor_toggle-parent-labels",this.onToggleParentLabelsClick)}}),InsertLineClass.prototype={showByWidgetAndPosition:function(e,t){var n;("prepend"===t||"append"===t)&&e._$dom.children(".moto-editor-insert-line").length||"after"===t&&e._$dom.next().hasClass("moto-editor-insert-line")||"before"===t&&e._$dom.prev().hasClass("moto-editor-insert-line")||(this.hide(),this.$insertLineDom=$('<div class="moto-editor-insert-line"></div>'),e._$dom[t](this.$insertLineDom[0]),n="height 300ms",this.$insertLineDom.css({transition:n,"-webkit-transition":n}),setTimeout(function(){this.$insertLineDom.css("height","20px")}.bind(this),0))},hide:function(){this.$insertLineDom&&this.$insertLineDom.remove()}},MotoEditorEnvironmentClass.prototype={ENVIRONMENT_STAGE:"production",isDevelopmentStage:function(){return"development"==this.ENVIRONMENT_STAGE},setStage:function(e){return this.ENVIRONMENT_STAGE=e,this},getStage:function(){return this.ENVIRONMENT_STAGE},connectEditor:function(e){return this.setGlobal("Editor",e,{writable:!1})},setScope:function(e){return this.setGlobal("$scope",e,{writable:!1})},getScope:function(){return this.getGlobal("$scope")},getEditor:function(){return this.getGlobal("Editor")},setEventManager:function(e){return this.setGlobal("EventManager",e),this},getEventManager:function(){return this.getGlobal("EventManager")},setTranslator:function(e){return this.setGlobal("Translator",e),this},getTranslator:function(){return this.getGlobal("Translator")},setWidgetFactory:function(e){return this.setGlobal("WidgetFactory",e),this},getWidgetFactory:function(){return this.getGlobal("WidgetFactory")},setLivePreviewService:function(e){return this.setGlobal("LivePreviewService",e),this},getLivePreviewService:function(){return this.getGlobal("LivePreviewService")},sdsdsdsds:function(){}},MotoEditorUtilsClass.prototype={$:null,isEvent:function(e){return!!(e&&angular.isObject(e)&&e.target&&e.preventDefault&&e.stopPropagation)},isDomElementAWidget:function(e){return!!angular.isElement(e)&&!!$(e).data("widget")},getClosestElementBySelector:function(e,t){return e&&t?this.$(e).closest(t).get(0):null},getClosestWidgetElement:function(e){return this.getClosestElementBySelector(e,"[data-widget]")},getClosestWidgetElementForDrag:function(e){var t;return t=this.getClosestElementBySelector(e,'[draggable="true"]'),t=this.getClosestElementBySelector(t,"[data-widget]")},getClosestSectionElement:function(e){return this.getClosestElementBySelector(e,".moto-section")},getNestedWidgetElementsByDom:function(e){return this.$(e).find(".moto-widget[data-widget]")},getChildWidgetElementsByDom:function(e){return this.$(e).children(".moto-widget[data-widget]")},getClosestWidgetElementByEvent:function(e){return this.getClosestWidgetElement(e.target)},cleanUpWidgetDom:function(e){this.$(e).removeAttr("id").removeClass("moto-editor_this_widget_hovered moto-widget_selected moto-widget_hover moto-widget_empty").find("[draggable]").addBack().removeAttr("draggable").find("[contenteditable]").addBack().removeAttr("contenteditable").find("[data-draggable-disabled]").addBack().removeAttr("data-draggable-disabled").find("[data-widget-id]").addBack().removeAttr("data-widget-id")},getContainerEdgeHeight:function(e){var t=e._$dom.outerHeight();return t<=25?parseInt(t/3):10}},MotoEditorWidgetsUtilsClass.prototype={MotoEditor:null,_widgets:[],_indexById:{},_indexByName:{},_indexByWidthChanged:[],getAll:function(){return this._widgets},getById:function(e){return this._indexById[e]||null},getByDom:function(e){return e&&this.getById(e.id)},getWidgetsByName:function(e){if(angular.isArray(e)){var t,n=[],i=e.length;for(t=0;t<i;t++)n=n.concat(this.getWidgetsByName(e[t]));return n}return this._indexByName[e]||[]},getWidgetsWithWidthChanged:function(){return this._indexByWidthChanged},_massCallHelperApply:function(e,t,n){return e[t].apply(e,n)},_massCallHelperRun:function(e,t,n){return e[t](n)},massCall:function(e,t){t=t||{};var n,i,o=e.length,r=this._massCallHelperRun,a=t.postProcessor||angular.noop,s=t.errorProcessor||angular.noop;if(!angular.isString(t.method))return!1;if(!angular.isArray(e))return!1;for(angular.isArray(t.args)&&(r=this._massCallHelperApply),n=0;n<o;n++)try{i=e[n],angular.isFunction(i[t.method])&&a(r(i,t.method,t.args),i,t)}catch(e){s(e,i,t)}},__matchFunctionTrue:function(){return!0},__matchFunctionStringName:function(e,t){return t.name===e.name},__matchFunctionArrayName:function(e,t){return-1<t.name.indexOf(e.name)},_getSubWidgetsByDom:function(e,t,n){if(!this.MotoEditor.Utils[t])return!1;(n=n||{}).where=n.where||null;var i,o,r=this.MotoEditor.Utils[t](e),a=r.length,s=[],d=this.__matchFunctionTrue;for(n.where&&(angular.isString(n.where.name)&&n.where.name?d=this.__matchFunctionStringName:angular.isArray(n.where.name)?d=this.__matchFunctionArrayName:angular.isFunction(n.where)&&(d=n.where)),o=0;o<a;o++)(i=this.getByDom(r[o]))&&d(i,n.where)&&s.push(i);return s},getNestedWidgetsByDom:function(e,t){return this._getSubWidgetsByDom(e,"getNestedWidgetElementsByDom",t)},getNestedWidgetsByWidget:function(e,t){return e&&this.getNestedWidgetsByDom(e._dom,t)||[]},getChildrenWidgetsByDom:function(e,t){return this._getSubWidgetsByDom(e,"getChildWidgetElementsByDom",t)},getChildrenWidgetsByWidget:function(e,t){return e&&this.getChildrenWidgetsByDom(e.getDomElementsWhereWidgetsCanBePlaced(),t)||[]},updateCache:function(e){this._indexById[e.getId()]||(this._widgets.push(e),this._indexByName[e.name]=this._indexByName[e.name]||[],this._indexByName[e.name].push(e),this._indexById[e._id]=e,angular.isFunction(e.onWidthChanged)&&this._indexByWidthChanged.push(e))},cleanIndexNameByWidget:function(e){var t;e&&e.name&&this._indexByName[e.name]&&-1<(t=this._indexByName[e.name].indexOf(e))&&this._indexByName[e.name].splice(t,1)},cleanIndexWidthChangedByWidget:function(e){var t;e&&angular.isFunction(e.onWidthChanged)&&-1<(t=this._indexByWidthChanged.indexOf(e))&&this._indexByWidthChanged.splice(t,1)},removeCache:function(e){if(!e)return!1;this._indexById[e._id]&&(this._indexById[e._id]=null,delete this._indexById[e._id]);var t=this._widgets.indexOf(e);if(-1<t&&this._widgets.splice(t,1),this.cleanIndexNameByWidget(e),this.cleanIndexWidthChangedByWidget(e),e.isContainer()){var n,i=e.getChildrenWidgets(),o=i.length;for(n=0;n<o;n++)this.removeCache(i[n])}return!0},scrollTo:function(e,t){e&&e._$dom&&(t=t||angular.noop,this.MotoEditor._window.$("html, body").animate({scrollTop:e._$dom.offset().top-100},400).promise().then(t))},isNeedToScroll:function(e){var t,n=this.MotoEditor._$window.scrollTop(),i=this.MotoEditor._$window.height();return!(!e||!e._$dom)&&((t=e._$dom.offset().top)<n||.8*i+n<t)},checkAndScrollTo:function(e,t){t=t||angular.noop,angular.isString(e)&&(e=this.getById(e)),e&&this.isNeedToScroll(e)?this.scrollTo(e,t):t(!0)},existsById:function(e){return!!this.getById(e)}},function(e){var t,g,r,i,u,n={};function p(){return t.isDevelopmentStage()}function l(t,n,e){try{return angular.isArray(e)||(e=[e]),t[n].apply(t,e)}catch(e){t[n]&&(console.error("callSafely : error",e),console.error("callSafely : target",t),console.error("callSafely : method",n))}return!1}function o(){}function a(){}function s(){}function d(){}function f(e){var t;if(n[e])return n[e];switch(e){case"creating":t=a;break;case"initialize":t=s;break;case"pasting":t=d}return t?(n[e]=new t,n[e]):(p()&&console.error("Unknown scenario ",e),null)}function h(e){return g.getWidgetById(e.targetConfig.targetWidgetId)}function m(e){return e.targetConfig&&angular.isDefined(e.targetConfig.indexInContainer)?e.targetWidget:-1<["prepend","append","cell-left","cell-right"].indexOf(e.position)?e.targetWidget:e.targetWidget._parent}function v(t){var e,n;if(t.droppedWidgetOptions.isNew?g.getScope().$broadcast("NEW EVENT: Insert widget before"):g.getScope().$broadcast("NEW EVENT: Move widget before",t.droppedWidgetOptions.widget),t=angular.extend({needToSelect:!0,targetConfig:{}},t),(t=g._callInterceptor(g.INTERCEPTOR__INSERT_OR_MOVE_WIDGET_OPTIONS,t)).targetWidget=t.targetWidget||h(t),t.parentWidget=t.parentWidget||m(t),t.targetConfig&&angular.isDefined(t.targetConfig.indexInContainer)&&(t.targetConfig.containerIndex=t.targetConfig.containerIndex||0,e=$(t.targetWidget.getDomElementsWhereWidgetsCanBePlaced()[t.targetConfig.containerIndex]),0===t.targetConfig.indexInContainer?(t.position="prepend",t.targetWidget._targetDomElement=e):(t.position="after",t.targetWidget._targetDomElement=t.targetWidget.children[t.targetConfig.indexInContainer-1]._dom),t.targetWidget._$targetDomElement=$(t.targetWidget._targetDomElement)),"left"!==t.position&&"right"!==t.position){if("cell-left"===t.position||"cell-right"===t.position)return n=t.targetWidget.getLocationInEditor(),void v({targetWidget:t.targetWidget._parent,droppedWidgetOptions:{isNew:!0,widgetName:"row.column",options:{properties:[{size:6}]}},needToSelect:!1,callback:function(e){e._parent.normalizeColumnSizes(),g.getScope().$broadcast("Widget.WidthChangedByWidget",this._parent),v({targetWidget:e,droppedWidgetOptions:t.droppedWidgetOptions,callback:t.callback,targetConfig:{containerIndex:0,indexInContainer:0}})},targetConfig:{containerIndex:0,indexInContainer:"cell-left"===t.position?n.indexInContainer:n.indexInContainer+1}});var i,o,r,a,s,d,l,c;if(o="section"===(i=t).parentWidget.name&&!u.isContainers(i.droppedWidgetOptions.widgetName),o=g._callInterceptor(g.INTERCEPTOR__IS_NEED_TO_WRAP_WITH_ROW,o,i))v({targetWidget:t.targetWidget,droppedWidgetOptions:{isNew:!0,widgetName:"row",widget:null,options:{children:[{name:"row.column"}]}},position:t.position,needToSelect:!1,callback:function(e){v({droppedWidgetOptions:t.droppedWidgetOptions,callback:t.callback,widgetProcessorName:t.widgetProcessorName?t.widgetProcessorName:void 0,targetConfig:{containerIndex:0,indexInContainer:0,targetWidgetId:e.children[0].getWidgetId()}})}});else t.droppedWidgetOptions.isNew?function n(i){var o,e,t,r,a,s;if(!(o=i.droppedWidgetOptions.widget))return(o=u.createWidgetByName(i.droppedWidgetOptions.widgetName,i.droppedWidgetOptions.options,i.parentWidget))||p()&&console.error("WidgetFactory._insertWidget : createWidgetByName not created widget",i.droppedWidgetOptions.widgetName),u.reviveChildrenWidgets(o),void(i.droppedWidgetOptions.widget=o).renderAsString(function(e,t){e&&p()&&(console.groupEnd(),console.group("ERROR on WidgetFactory._insertWidget"),console.error("WidgetFactory._insertWidget : end with error"),console.log("ERROR:",e),console.log("WIDGET:",o),console.log("CONTENT:",t),console.groupEnd()),o._replaceNode(t),n(i)},{mode:"new",debug:!1});i.positionMethod?(a=(r=i.targetWidget).getDomElementsWhereWidgetsCanBePlaced(),(e=r.$(a[i.containerIndex||0])).append(o._dom),angular.isDefined(i.positionIndex)&&-1<i.positionIndex&&o.getPositionIndexInContainer()!==i.positionIndex&&(s=e.children(".moto-widget[data-widget]").eq(i.positionIndex))&&s.before(o._dom)):(e=i.targetWidget.getTargetElement(i))[i.position](o._dom),g.Widgets.updateCache(o),i.parentWidget&&i.parentWidget.scanLiveChildren(),delete i.targetWidget._targetDomElement,delete i.targetWidget._$targetDomElement,o._dom.setAttribute("draggable",o.isDraggable()),angular.isDefined(i.widgetProcessorName)&&(t=f(i.widgetProcessorName)),t||(t=f("creating")),t.execute(o),o._propertiesLoaded=!0,delete o._config,o._parent&&o._parent.triggerEvent("appendChild",o,e,"new"),i.needToSelect&&o.select(),g.getScope().$broadcast("NEW EVENT: Insert widget after",o),i.callback&&i.callback(o)}(t):(a=(r=t).droppedWidgetOptions.widget,r.positionMethod?(l=(d=r.targetWidget).getDomElementsWhereWidgetsCanBePlaced(),s=d.$(l[r.containerIndex||0]),a._parent.triggerEvent("removeChild",a),s.append(a._dom),a._parent=d,angular.isDefined(r.positionIndex)&&-1<r.positionIndex&&a.getPositionIndexInContainer()!==r.positionIndex&&(c=s.children().eq(r.positionIndex),(c=s.children(".moto-widget[data-widget]").eq(r.positionIndex))?(console.warn(d.name,": insertChildAction : move new widget from ",a._$dom.index(),a.getPositionIndexInContainer()," to ",r.positionIndex),c.before(a._dom)):console.warn(d.name,": insertChildAction : cant find exists widget by index",r.positionIndex)),a._parent.triggerEvent("appendChild",a,s,"move")):((s=r.targetWidget.getTargetElement(r))[r.position](a._dom),a._parent&&a._parent.triggerEvent("removeChild",a),a._parent=r.parentWidget,a._parent&&a._parent.triggerEvent("appendChild",a,s,"move")),delete r.targetWidget._targetDomElement,delete r.targetWidget._$targetDomElement,a.triggerEvent("moved"),r.needToSelect&&a.select(),a._Editor.getScope().$broadcast("NEW EVENT: Move widget after",a),r.callback&&r.callback(a))}else v({targetWidget:t.targetWidget,droppedWidgetOptions:{isNew:!0,widgetName:"row",options:{children:[{name:"row.column",properties:{size:6}},{name:"row.column",properties:{size:6}}]}},position:"before",needToSelect:!1,callback:function(e){v({targetWidget:e.children["left"===t.position?1:0],droppedWidgetOptions:{isNew:!1,widgetName:t.targetWidget.name,widget:t.targetWidget},needToSelect:!1,targetConfig:{indexInContainer:0},callback:function(){v({targetWidget:e.children["left"===t.position?0:1],droppedWidgetOptions:t.droppedWidgetOptions,callback:t.callback,targetConfig:{indexInContainer:0}})}})}})}function c(e){this._Environment=e,this.MotoEditor=e.getEditor(),this.ACL=new MotoEditorContentManagerACL(e),this.ContentHistoryManager={startTransaction:function(){return{complete:angular.noop}}},g=this.MotoEditor,t=e}o.prototype={_VERBOSE:!1,execute:function(e){},executeChildren:function(e){},callSafely:function(e,t,n){return this._VERBOSE&&(e.name&&e.getId?console.info(e.name,e.getId(),t):console.info("callSafely",t,"of",e)),l(e,t,n)}},((a.prototype=Object.create(o.prototype)).constructor=a).prototype.execute=function(e){e._initialized=!1,this.callSafely(e,"beforeCreate"),e.isContainer()&&e.children.length&&(this._VERBOSE&&console.group(e.name,e.getId()),this.executeChildren(e.children),this._VERBOSE&&console.groupEnd()),1===e._apiVersion?this.callSafely(e,"initialize",[{isNew:!0}]):this.callSafely(e,"create"),this.callSafely(e,"afterCreate"),e._initialized=!0},a.prototype.executeChildren=function(e){var t,n,i,o;for(angular.isArray(e)||(e=[e]),t=0,n=e.length;t<n;t++)o=e[t],this._VERBOSE&&console.group(o.name),o._initialized=!1,o._silentMode=!0,(i=o.$("#"+o.getId())).length||(i=o.$(".moto-widget[data-widget-id="+o.getId()+"]")),i.length&&(o.connectNode(i.get(0)),o._dom.setAttribute("draggable",o.isDraggable())),this.callSafely(o,"beforeCreate"),o.isContainer()&&this.executeChildren(o.children),1===o._apiVersion?this.callSafely(o,"initialize",[{isNew:!0}]):this.callSafely(o,"create"),o._propertiesLoaded=!0,g.Widgets.updateCache(o),o.updateEmptyClass(),this.callSafely(o,"afterCreate"),o._initialized=!0,o._silentMode=!1,this._VERBOSE&&console.groupEnd()},((s.prototype=Object.create(o.prototype)).constructor=s).prototype.connectChildren=function(e){var t,n,i,o,r;if(t=e.getDomElementsWhereWidgetsCanBePlaced())if(r=(n=g.Utils.getChildWidgetElementsByDom(t)).length){for(angular.isArray(e.children)?e.children.length=0:e.children=[],this._VERBOSE&&console.info(e.name,"connectChildren : found "+r+" widget dom"),o=0;o<r;o++)(i=g.getWidgetByDom(n[o]))?i.setParentWidget(e):(i=u.createWidgetByDom(n[o],e),g.Widgets.updateCache(i)),i?e.children.push(i):this._VERBOSE&&console.warn(e.name,"connectChildren : can not create widget from dom",n[o]);e._childrenInited=!0}else this._VERBOSE&&console.info(e.name,"connectChildren : not found children dom on $holders",t);else this._VERBOSE&&console.info(e.name,"connectChildren : not have widget holders => skip",t)},s.prototype.execute=function(e,t){var n,i;if(u.isWidget(e))i=e;else{if(!(n=$(e)).data("widget"))return this._VERBOSE&&console.warn("Target not have data-widget",e),null;if(!(i=u.createWidgetByDom(n,t)))return this._VERBOSE&&console.warn("Can not create widget by DOM",n),null}return g.Widgets.updateCache(i),i._dom.setAttribute("draggable",i.isDraggable()),i._silentMode=!0,i._initialized?this._VERBOSE&&console.warn("Widget already initialized",i.name,i.getId()):this.callSafely(i,"beforeInitialize"),this.connectChildren(i),i.isContainer()&&i.children.length&&(this._VERBOSE&&console.group(i.name,i.getId()),this.executeChildren(i.children),this._VERBOSE&&console.groupEnd()),i._initialized||(1===i._apiVersion?this.callSafely(i,"initialize",[{isNew:!1}]):this.callSafely(i,"initialize")),i._propertiesLoaded=!0,i.updateEmptyClass(),i._initialized||this.callSafely(i,"afterInitialize"),g.Widgets.updateCache(i),i._silentMode=!1,i._initialized=!0,i},s.prototype.executeChildren=function(e){var t,n,i,o;for(angular.isArray(e)||(e=[e]),t=0,n=e.length;t<n;t++)o=e[t],this._VERBOSE&&console.group(o.name),o._silentMode=!0,o._$dom||((i=o.$("#"+o.getId())).length||(i=o.$(".moto-widget[data-widget-id="+o.getId()+"]")),i.length&&o.connectNode(i.get(0))),o._dom.setAttribute("draggable",o.isDraggable()),o._initialized||this.callSafely(o,"beforeInitialize"),this.connectChildren(o),o.isContainer()&&this.executeChildren(o.children),o._initialized||(1===o._apiVersion?this.callSafely(o,"initialize",[{isNew:!1}]):this.callSafely(o,"initialize")),o._propertiesLoaded=!0,o.updateEmptyClass(),o._initialized||this.callSafely(o,"afterInitialize"),g.Widgets.updateCache(o),o._silentMode=!1,o._initialized=!0,this._VERBOSE&&console.groupEnd()},((d.prototype=Object.create(a.prototype)).constructor=d).prototype.execute=function(e){e._silentMode=!0,a.prototype.execute.apply(this,arguments),e._silentMode=!1},(e.MotoEditorContentManager=c).prototype={_Environment:null,MotoEditor:null,ContentHistoryManager:null,_WidgetFactory:null,_EventManager:null,ACL:null,setInjector:function(e){var t;(i=e).has("core.library.editor.ContentHistoryManager")&&(t=i.get("core.library.editor.ContentHistoryManager")).prototype.startTransaction&&(this.ContentHistoryManager=new t(this)),this.ACL.setWidgetService(i.get("core.library.editor.WidgetsService"))},getWidgetProcessor:f,getWidgetFactory:function(){return this._WidgetFactory||(this._WidgetFactory=this._Environment.getWidgetFactory())},setWidgetFactory:function(e){return this._WidgetFactory=e,this.ACL.setWidgetFactory(e),u=e,this},setEventManager:function(e){return r=e,this._EventManager=e,this},insertOrMoveWidgetByOptions:function(e){var t,n=e.callback||angular.noop;!e.droppedWidgetOptions.widgetName&&e.droppedWidgetOptions.widget&&(e.droppedWidgetOptions.widgetName=e.droppedWidgetOptions.widget.name),e.callback=function(e){t&&(e?g.HistoryManager.endActionsTransaction("InsertOrMoveWidget",{widgetId:e.getId()}):g.HistoryManager.rejectActionsTransaction("InsertOrMoveWidget")),n(e)},g.HistoryManager.getTransactionInProcess()||(t=g.HistoryManager.startActionsTransaction("InsertOrMoveWidget")),e.targetWidget=e.targetWidget||h(e),e.parentWidget=e.parentWidget||m(e),this.ACL.isAllowDropObject(e.droppedWidgetOptions,e.parentWidget,e.position)?(e.droppedWidgetOptions.isNew?r.trigger("Widget.Create.AccessGranted",e):r.trigger("Widget.Move.AccessGranted",e),v(e)):(e.droppedWidgetOptions.isNew?r.trigger("Widget.Create.AccessDenied",e):r.trigger("Widget.Move.AccessDenied",e),e.callback(null))},duplicateWidget:function(e,n){var i,t,o,r,a=this.getWidget(e);return angular.isFunction(n)||(n=angular.noop),a?(i=this.ContentHistoryManager.startTransaction("DUPLICATE_WIDGET",a),r=a.exportForCopy(),o=a.getPositionInContent(),t=a._parent?a._parent:a,o.widgetId=t.getId(),o.positionIndex++,this.pasteWidgetFromBuffer(r,o,function(e,t){i.complete(e,t),n(e,t)})):n({message:"Cant find widget by id",id:e})},pasteWidgetFromBuffer:function(e,t,n){var i,o;if(angular.isFunction(n)||(n=angular.noop),!angular.isObject(e)||!angular.isString(e.name)||!angular.isObject(e.properties))return n({message:'"Buffer" are not valid',value:e});if(!angular.isObject(t))return n({message:'"targetPosition" are not valid',value:t});if(angular.isUndefined(t.widgetId))return n({message:'"targetPosition" not have "widgetId"',value:t});if(!(o=this.getWidget(t.widgetId)))return n({message:'Widget with id "'+t.widgetId+'" not found',value:t.widgetId});if(!g.HistoryManager.startActionsTransaction("PasteWidget"))return n({message:'"PasteWidget" transaction was not started',value:t});e=angular.copy(e),t=angular.copy(t),i=this.ContentHistoryManager.startTransaction("PASTE_WIDGET",{buffer:e,target:t,targetWidget:o}),v({targetWidget:o,parentWidget:o,droppedWidgetOptions:{isNew:!0,widgetName:e.name,options:e},position:"append",positionMethod:"append",positionIndex:t.positionIndex||-1,containerIndex:t.containerIndex||0,widgetProcessorName:"pasting",needToSelect:!0,callback:function(e){r.trigger("NEW EVENTS: this widget will be paste",e),g.getScope().$broadcast("NEW EVENTS: the widget was pasted",e),o.emitEvent("contentUpdated",o),i.complete(null,e),g.HistoryManager.endActionsTransaction("PasteWidget"),n(null,e)}})},getWidget:function(e){return angular.isString(e)&&(e=this.MotoEditor.getWidgetById(e)),e&&e.__isPublicInstance&&(e=e.__internalInstance),u.isWidget(e)||(e=null),e},getPublicInstance:function(e){var t;return angular.isString(e)&&(e=this.MotoEditor.getWidgetById(e)),e&&(t=e.__isPublicInstance?e:e.__publicInstance?e.__publicInstance:this.revivePublicInstance(e)),t},getInternalInstance:function(e){return angular.isString(e)&&(e=this.MotoEditor.getWidgetById(e)),e&&e.__internalInstance&&(e=e.__internalInstance),u.isWidget(e)||(e=null),e},getContentHistoryManager:function(){return this.ContentHistoryManager},__latestScopedPublicInstance:null,revivePublicInstance:function(e,t){var n=null;return t&&this.__latestScopedPublicInstance&&(this.ContentHistoryManager.startTransaction("DESELECT_WIDGET"),this.__latestScopedPublicInstance.__$scope=null),e.__isPublicInstance&&(n=e),e.__publicInstance&&(n=e.__publicInstance),n?n.__syncProperties():n=new(i.get("coreLibraryWidgetPublicInstance"))(e),n.__setScope(t),t&&(this.ContentHistoryManager.startTransaction("SELECT_WIDGET",n),this.__latestScopedPublicInstance=n),n},setWidgetProperties:function(e,t,n){var i=this.getPublicInstance(e);return i?(angular.isFunction(n)&&i.__addPendingCallback(n),i.__$scope?(i.properties=angular.copy(t),i.__$scope.$$phase||i.__$scope.$apply()):this.setWidgetInternalProperties(e,t),!0):(angular.isFunction(n)&&n({message:"Widget not found",target:e}),!1)},setWidgetInternalProperties:function(e,t,n){var i,o,r,a=this.getInternalInstance(e),s=this.getPublicInstance(e);if(angular.isFunction(n)||(n=angular.noop),!s)return n({message:"Widget was not found",target:e}),!1;function d(e){e?l(a,"contentViewWasNotUpdated",[e,r]):l(a,"contentViewWasUpdated",[r]),g.getScope().$broadcast("NEW EVENT: Widget properties were changed",a,r),s.__releasePendingCallback(e),i.complete(e,a)}angular.isFunction(n)&&s.__addPendingCallback(n),t=angular.isObject(t)?angular.copy(t):{},r=angular.copy(a.properties),i=this.ContentHistoryManager.startTransaction("SET_PROPERTY_WIDGET",a,{newProperties:t}),l(a,"willReceiveNewProperties",[t]),o=l(a,"shouldUpdateContentView",[t]),a.properties=t,o?a.renderPreview(d):(angular.equals(t.align,r.align)||l(a,"updateAlignInDOM"),angular.equals(t.spacing,r.spacing)||l(a,"updateSpacingsInDOM"),t.visible_on!==r.visible_on&&l(a,"updateVisibleOnInDOM"),t.preset,t.preset,l(a,"manualUpdateContentView",[r]),d(null))},destroyWidget:function(e){var t,n,i=this.getWidget(e);return!!i&&((n=this.MotoEditor.HistoryManager.getTransactionInProcess())||this.MotoEditor.HistoryManager.startActionsTransaction("DestroyWidget",{widgetId:i.getId()}),t=this.ContentHistoryManager.startTransaction("DESTROY_WIDGET",i),r.trigger("NEW EVENTS: this widget will be destroy",i),this.MotoEditor.getScope().$broadcast("NEW EVENT: Widget will be removed",i),i._parent&&l(i._parent,"youChildrenWillUpdate",i),i._parent&&l(i._parent,"youChildWillDestroy",i),l(i,"beforeDestroyLog"),l(i,"beforeDestroy"),i.isContainer()&&function e(t){var n,i,o;for(angular.isArray(t)||(t=[t]),n=0,i=t.length;n<i;n++)l(o=t[n],"beforeDestroy"),o.isContainer()&&e(o.children),o._$dom&&o._$dom.remove(),l(o,"afterDestroy"),g.Widgets.removeCache(o),l(o,"afterDestroyLog")}(i.children),i._$dom&&i._$dom.remove(),i._parent&&i._parent.triggerEvent("removeChild",i),l(i,"afterDestroy"),this.MotoEditor.getScope().$broadcast("NEW EVENT: Widget was removed",i),this.MotoEditor.Widgets.removeCache(i),l(i,"afterDestroyLog"),i._parent&&l(i._parent,"youChildDidDestroy",i),i._parent&&l(i._parent,"youChildrenDidUpdate",i),t.complete(null,i),n||this.MotoEditor.HistoryManager.endActionsTransaction("DestroyWidget"),!0)}}}(window),function(e){var r;function u(e){return!0===e||!1===e}function t(e){this._Environment=e,this._AccessMap=angular.copy(this._AccessMap),r=e.getEditor()}(window.MotoEditorContentManagerACL=t).prototype={_Environment:null,_WidgetFactory:null,_WidgetService:null,setWidgetFactory:function(e){return this._WidgetFactory=e,this},setWidgetService:function(e){return this._WidgetService=e,this},_AccessMap:{"*":{rules:[":containers"]},section:{rules:!1},row:{rules:!0},container:{rules:":containers"},block:{rules:["section"]}},_isContainers:function(e){return this._WidgetFactory.isContainers(e)},setRule:function(e,t){return this._AccessMap[e]=t,this},isAllowDropObject:function(e,t,n){var i;return(i=this._isAllow(e.widgetName,t,n))?i=r._callInterceptor(r.INTERCEPTOR__IS_ALLOW_DROP_OBJECT,i,{dropObject:e,targetWidget:t,method:n}):i},_isAllow:function(e,t,n){return this.isAllowDropToWidget(e,angular.isObject(t)?t.name:t,n)&&this.isAllowHoldWidget(e,angular.isObject(t)?t.name:t,n)},isAllowToPasteFromBuffer:function(e,t,n,i){var o;return o=this._isAllowToPasteFromBuffer(e,t.name,n,i),o=r._callInterceptor(r.INTERCEPTOR__BUFFER_IS_ALLOW_TO_PASTE,o,{buffer:e,targetWidget:t,page:n,sectionName:i})},_isAllowToPasteFromBuffer:function(e,t,n,i){return this._isAllow(e.name,t)&&this._WidgetService.isWidgetAllowedToUse(e.name,n,i)},removeUnpastableWidgetsFromBuffer:function(e,t,n,i){var o=angular.copy(e);return(o=r._callInterceptor(r.INTERCEPTOR__PASTE_BUFFER_CLEANING,o,{targetWidget:t,page:n,sectionName:i}))?(o=this._removeUnpastableWidgetsFromBuffer(o,t,n,i),o=r._callInterceptor(r.INTERCEPTOR__PASTE_BUFFER_CLEANED,o,{targetWidget:t,page:n,sectionName:i})):o},_removeUnpastableWidgetsFromBuffer:function(e,t,n,i){var o,r=angular.copy(e);if("children"in r&&(r.children=[]),e.children&&e.children.length)for(o=0;o<e.children.length;o++)this._isAllowToPasteFromBuffer(e.children[o],e.name,n,i)&&r.children.push(this._removeUnpastableWidgetsFromBuffer(e.children[o],e.name,n,i));return r},isAllowHoldWidget:function(e,t,n){var i={};return angular.isObject(e)&&!t&&(e=(i=e).source||null,t=i.target||null,n=n||null),!0},isAllowDropToWidget:function(e,t,n){var i={};if(angular.isObject(e)&&!t&&(e=(i=e).source||null,t=i.target||null),!e||!t)return!1;var o,r,a=this._AccessMap,s=a["*"].rules,d=!1,l=i.debug||!1;if(a[e]&&a[e].rules&&(s=a[e].rules),l&&console.log(" @",i,s),u(s))return l&&console.log(" @ return",s),s;angular.isString(s)&&(s=[s]),l&&console.log(" @ rules",s);for(var c=0,g=s.length;c<g;c++){if(r=s[c],l&&console.log(" @ rule",r,"source",e,"target",t),u[r]){d=r,l&&console.log(" @ isBoolean",r);break}if(angular.isFunction(r)){if(u(o=r({source:e,target:t,method:n,isAllow:d}))){d=o,l&&console.log(" @ function",r);break}}else if(angular.isString(r)){if("!"===r[0]){if(t!==r.substr(1))continue;d=!1,l&&console.log(" @ !",t,r.substr(1));break}if(":containers"===r){d=this._isContainers(t),l&&console.log(" @ :containers",t);break}d=r===t}else l&&console.log(" @ skip not string",r)}return l&&console.log(" @ return",d,c),d}}}(),function(){var s,r,o,d,l,n,c,a,g,u,i,p,f,h,m,v,_,w,E,t,b=null,y={isNew:null,widgetName:null,widget:null,options:null},W={topId:"top_scroll_page",bottomId:"bottom_scroll_page",delay:0},C=!1,S="production",I=0,O=!1,D=!1;function T(){return y&&y.widgetName}function H(){y={isNew:null,widgetName:null,widget:null,options:null}}function N(){return"development"===S}function B(e){var t;if(angular.isObject(e)&&e._$dom){1<I&&console.info("Editor.js : activateSectionOnWidgetRemove()",e.name);try{(t=s.Utils.getClosestSectionElement(e._$dom))?(u=t,i=null,g.off("NEW EVENTS: this widget will be destroy",B),g.trigger("section.edit",u.id)):1<I&&console.error("Editor.js : activateSectionOnWidgetRemove() : not found section",t)}catch(e){1<I&&console.error("Editor.js : activateSectionOnWidgetRemove() : SOME ERROR",e)}}else 1<I&&console.error("Editor.js : activateSectionOnWidgetRemove() : Bad Widget",e)}function x(e){var t;if(angular.isObject(e)&&e._$dom){1<I&&console.info("Editor.js : activateSectionOnWidgetPaste()",e.name);try{(t=s.Utils.getClosestSectionElement(e._$dom))?(u=t,i=e,g.off("NEW EVENTS: this widget will be paste",x),g.trigger("section.edit",u.id)):1<I&&console.error("Editor.js : activateSectionOnWidgetPaste() : not found section",t)}catch(e){1<I&&console.error("Editor.js : activateSectionOnWidgetPaste() : SOME ERROR",e)}}else 1<I&&console.error("Editor.js : activateSectionOnWidgetPaste() : Bad Widget",e)}function k(e){var t;if(k._inProgress)1<I&&console.warn("Editor.js : activateSectionOnDragStart() : DOUBLE RUN");else{k._inProgress=!0;try{(t=s.Utils.getClosestSectionElement(e.target))?(u=t,i=!1,g.trigger("section.edit",u.id)):1<I&&console.error("Editor.js : activateSectionOnDragStart() : not found section",t)}catch(e){1<I&&console.error("Editor.js : activateSectionOnDragStart() : SOME ERROR",e)}}}function P(e){function t(){c.widget.dragOver(e),E.dragOverTimeoutLastTime=(new Date).getTime()}E&&(E.dragOverTimeoutLastTime?E.dragOverTimeoutLastTime+50<(new Date).getTime()&&t():t())}function M(){Helpers.hover()}function A(){0<I&&console.info("Editor.js : unbindSection()"),$(".moto-section").off("click",c.section.editClick),$(document).off("dragstart",k),g.off("NEW EVENTS: this widget will be destroy",B),g.off("NEW EVENTS: this widget will be paste",x)}function R(){C&&($(".helper-insert").off("dragover",c.widget.elementDragOver),s._$window.off("dragover",c.widget.elementDragOver),C=!1,g.trigger("NEW EVENT: Editor helpers hides insert cursor",b),s.HelperDragHover.hideByWidget(d),d=null,s.InsertLine.hide(),s.getHelpers().hideInsertHelper(),s.HelperDragOver.hideByWidget(l),l=null,E&&(E.targetWidget=null,E.targetPosition=null))}function j(e){return(e=e||u)?(2<I&&console.info("Editor.js : unbindWidgets"),3<I&&console.info("Editor.js : unbindWidgets : DOM",e),3<I&&console.info("Editor.js : unbindWidgets : Remove draggable for .moto-widget"),(e=$(e)).find(".moto-widget").removeClass("moto-widget_active").removeAttr("draggable"),g.trigger("NEW EVENT: Editor start unbind widgets for section",e),3<I&&console.info("Editor.js : unbindWidgets : UnBind dom events [click, drag*, mouse*, blur]"),e.off("dragstart",".moto-editor_no-draggable",c.widget.dragPrevent).off("dragstart",".moto-editor_draggable",c.widget.dragStart).off("click",".moto-editor_select-widget-by-id-attribute",c.widget.selectWidgetByIdAttribute).off("click",".moto-editor_remove-closest-widget",c.widget.remove).off("click",".moto-editor_select-closest-widget",c.widget.click).off("click",".moto-editor_duplicate-closest-widget",c.widget.duplicate).off("click",c.widget.click).off("mousedown",c.widget.mouseDown).off("dragstart",".moto-widget",c.widget.dragStart).off("mouseenter",".moto-widget",c.widget.mouseEnter).off("mouseleave",".moto-widget",c.widget.mouseLeave),!0):(2<I&&console.info("Editor.js : unbindWidgets : Bad DOM"),!1)}function F(e){return e?(1<I&&console.info("Editor.js : turnOffSection()"),e=$(e),2<I&&console.info('Editor.js : turnOffSection : Section ID "'+e.attr("id")+'"'),e.addClass("moto-section_inactive").removeAttr("draggable"),function(e){var t,n,i,o;if(!e)return 2<I&&console.info("Editor.js : turnOffWidgetsByDOM() : Bad DOM"),!1;if(2<I&&console.info('Editor.js : turnOffWidgetsByDOM : Section ID "'+e.attr("id")+'"'),j(e),0<(i=(t=e.find(".moto-widget")).length))for(n=0;n<i;n++)if(o=s.getWidgetByDom(t[n]),angular.isObject(o))try{o.fallAsleep()}catch(e){3<I&&console.error("Editor.js : on widget.fallAsleep"),4<I&&console.error("DUMP.ERROR: ",e),4<I&&console.error("DUMP.Widget: ",o)}return!0}(e)):(1<I&&console.info("Editor.js : turnOffSection() : Bad DOM"),!1)}function L(){return $("#top_scroll_page, #bottom_scroll_page")}function U(){var e,t,n,i,o,r=$("html,body");return r.is(":animated")||(e=s._$window.scrollTop(),n=-1===(t=$(this).attr("id")===W.topId?-1:1)?v:_,i=-1===t?e:$(document).height()-(e+s._$window.height()),w&&w!==t&&(L().show(),w=t),angular.isDefined(n)&&n===i&&0<i?(o=e+40*t,r.animate({scrollTop:o},W.delay,"linear")):0===i&&(w=1===t?(m.hide(),1):(h.hide(),-1)),-1===t?v=i:_=i),!0}function V(){(h=$("#"+W.topId)).length||(h=$('<div id="top_scroll_page">&nbsp;</div>').appendTo("body")),(m=$("#"+W.bottomId)).length||(m=$('<div id="bottom_scroll_page">&nbsp;</div>').appendTo("body")),L().addClass("autoscroll-help-panel"),h.css({top:0}),m.css({bottom:0}),L().on("dragover",U),s._$body.addClass("moto-drag-state"),y.widgetName&&s._$body.addClass("moto-drag-state_widget-"+y.widgetName.replace(/\./g,"-"))}function G(e){s.getCurrentSection()||function(e){var t;if(angular.isObject(e)&&e._$dom){1<I&&console.info("Editor.js : activateSectionOnNewDragEnd()",e.name);try{(t=s.Utils.getClosestSectionElement(e._$dom))?(u=t,i=e,g.trigger("section.edit",u.id)):1<I&&console.error("Editor.js : activateSectionOnNewDragEnd() : not found section",t)}catch(e){1<I&&console.error("Editor.js : activateSectionOnNewDragEnd() : SOME ERROR",e)}}else 1<I&&console.error("Editor.js : activateSectionOnNewDragEnd() : Bad Widget",e)}(e),s.getScope().$broadcast("NEW EVENT: Widget was created",e),g.trigger("Editor.Widget.Created",e),e.triggerEvent("newDragEnd")}function z(){var e,t=s.getHelpers();E=null,H(),(e=L())&&(e.hide(),e.off("dragover",U),h&&h.remove(),m&&m.remove()),s._$body.removeClass(function(e,t){return(t.match(/(^|\s)moto-drag-state[^\s]*/g)||[]).join(" ")}),s.HelperDragHover.hideByWidget(d),d=null,s.HelperDragOver.hideByWidget(l),l=null,s.InsertLine.hide(),t.hideInsertHelper(),s.HelperHover.hideByWidget(s.getHelpers().getWidgetWithHoverHelper())}function q(e,t){var n,i;T()&&H(),n=e,i=t,y={isNew:null,widgetName:"",options:angular.copy(i)||{},widget:null},angular.isString(n)?(y.widgetName=n,y.isNew=!0):angular.isObject(n)&&(y.widgetName=n.name,y.widget=n,y.isNew=!1),E={},setTimeout(V,0)}function X(){var n,e;try{if(!(E&&E.targetPosition&&E.targetWidget&&T()&&C))return void z();if(n=!y.widget,e=r.get(y.widgetName),n&&e&&!e.prototype.isDuplicatableInSection()&&$('.moto-widget[data-widget="'+y.widgetName+'"]',u).length)return g.trigger("Widget.Create.AccessDenied.Duplicate"),void z();if(!(n||y.widget&&function(e,t){var n;for(n=e;n;){if(n.getId()===t.getId())return!1;n=n._parent}return!0}(E.targetWidget,y.widget)&&E.targetWidget.getId()!==y.widget.getId()))return void z();s.ContentManager.insertOrMoveWidgetByOptions({targetWidget:E.targetWidget,droppedWidgetOptions:y,position:E.targetPosition,callback:function(e){var t;e&&(n?G(e):((t=e).onWidthChanged&&t.onWidthChanged(),s.Widgets.massCall(s.Widgets.getNestedWidgetsByWidget(t),{method:"onWidthChanged"}),t.triggerEvent("dragEnd"),s.selectWidget(t),s.HelperSelected.updateByWidget(s.getCurrentWidget()),s.getScope().$broadcast("NEW EVENT: Widget was moved by editor",t)),s.Widgets.checkAndScrollTo(e))}}),z()}catch(e){N()&&console.error("Error in process of dropping widget",e)}}function Y(e){e.preventDefault(),X()}function e(e){e.connectEditor(this),this._Environment=e,this._window=window,this._document=document,this._$body=$("body"),this._$window=$(this._window),this.ContentManager=new MotoEditorContentManager(e),this.Widgets=new MotoEditorWidgetsUtilsClass(e),this.Utils=new MotoEditorUtilsClass(e),this.HelperHover=new HelperHoverClass(e),this.HelperSelected=new HelperSelectedClass(e),this.InsertLine=new InsertLineClass(e),this.HelperHighlight=new HelperHighlightClass(e),this.HelperDragHover=new HelperDragHoverClass(e),this.HelperDragOver=new HelperDragOverClass(e),this.EventsHandler=new MotoEditorEventsHandlerClass(e)}H(),e.prototype={_window:null,_document:null,ContentManager:null,ElementsPanel:null,Widgets:null,Utils:null,HelperHover:null,HelperSelected:null,InsertLine:null,HelperHighlight:null,HelperDragHover:null,HelperDragOver:null,_Environment:null,_device:{name:"desktop",_isDesktop:!(k._inProgress=!1),_isTablet:!1,_isMobile:!1},_silentMode:!1,_interceptorInstance:null,INTERCEPTOR__PASTE_FROM_BUFFER:"paste_from_buffer.target_widget",INTERCEPTOR__DRAG_OVER_TARGET_WIDGET:"drag_over.target_widget",INTERCEPTOR__INSERT_OR_MOVE_WIDGET_OPTIONS:"insert_or_move_widget.options",INTERCEPTOR__DRAG_OVER_POSITION:"drag_over.position",INTERCEPTOR__PASTE_BUFFER_CLEANING:"paste_from_buffer:cleaning",INTERCEPTOR__PASTE_BUFFER_CLEANED:"paste_from_buffer:cleaned",INTERCEPTOR__BUFFER_IS_ALLOW_TO_PASTE:"paste_from_buffer:is_allow",INTERCEPTOR__IS_ALLOW_DROP_OBJECT:"drop_object:is_allow",INTERCEPTOR__IS_NEED_TO_WRAP_WITH_ROW:"drop_widget:is_need_to_wrap_with_row",INTERCEPTOR__UNDO_REDO_ACTION_BEFORE:"undo_redo_action:before_action",isInterceptorConnected:function(){return!!this._interceptorInstance},_initInterceptor:function(){this.isInterceptorConnected()||(this._interceptorInstance=o.get("coreLibraryInterceptors").createInterceptor())},getInterceptorInstance:function(){return this._interceptorInstance},addInterceptor:function(e,t){return this.isInterceptorConnected()?this.getInterceptorInstance().addInterceptor(t,e):(N()&&console.warn("Editor.addInterceptor : to early try add interceptor",e),!1)},_callInterceptor:function(e,t,n){return this.isInterceptorConnected()?this.getInterceptorInstance().execute(e,t,n):(N()&&console.warn("Editor.callInterceptor : to early try call interceptor",e),t)},getEnvironment:function(){return this._Environment},setScope:function(e){return this._Environment.setScope(e),this},getScope:function(){return this._Environment.getScope()},getContextWindow:function(){return this._Environment._window},isSectionActivated:function(){return D},activateSectionById:function(e){return!(this.isSectionActivated()||!this.isSectionExists(e))&&(u=$("#"+e+".moto-section").get(0),g.trigger("section.edit",e),!0)},isSectionExists:function(e){return 1===$("#"+e+".moto-section").length},getClosestWidgetByDom:function(e){return s.getWidgetByDom(s.Utils.getClosestWidgetElement(e))},getWidgetSectionById:function(e){var t=$("#"+e);return 0<t.length?s.getWidgetByDom(t.get(0)):null},getWidgetSectionByWidget:function(e){var t=s.Utils.getClosestSectionElement(e._$dom);return t?s.getWidgetByDom(t):null},getWidgetSections:function(){var n,i=[];return $(".moto-section").each(function(e,t){(n=s.getWidgetByDom(t))&&i.push(n)}),i},getCurrentWidget:function(){return p},selectWidget:function(e,t){var n;if(angular.isString(e)&&(e=this.getWidgetById(e)),r.isWidget(e)&&this.Widgets.existsById(e.getId())){if(t||(e=e.getWidgetForHelper("selected")),e.isUnselectable())return!1;(!(n=this.getCurrentWidget())||n&&e.getId()!==n.getId())&&(n&&(n._$dom.removeClass("moto-widget_selected"),n.triggerEvent("unselected"),n.emitEvent("childUnSelected",n,e)),(p=e)._$dom.addClass("moto-widget_selected"),e.triggerEvent("selected"),this.getScope().$broadcast("NEW EVENT: Widget was selected",e),e.emitEvent("childSelected",e)),s.HelperSelected.hideByWidget(n),s.HelperSelected.showByWidget(e)}},unselectCurrentWidget:function(){return!!p&&(p._$dom.removeClass("moto-widget_selected"),p.triggerEvent("unselected"),p.emitEvent("childUnSelected",p,p),Helpers.hideHelpers(),s.HelperSelected.hideByWidget(p),this.getScope().$broadcast("NEW EVENT: Widget was unselected",p),!(p=null))},getCurrentSection:function(){return f},getHelpers:function(){return Helpers},setElementsPanel:function(e){(this.ElementsPanel=e).connectEditor(s)},setContentEntity:function(e){return t?(console.warn("Editor : ContentEntity already defined"),!1):(t=e,!0)},getContentEntity:function(){return t},setHistoryManager:function(e){this.HistoryManager=e},userWantsToRemoveWidget:function(e){var t,n=o.get("$q"),i=n.defer();return!1===(t=!e._lockedBy&&e.canBeRemoved())&&i.reject(t),n.when(t).then(function(){!1!==t&&s.destroyWidget(e)?i.resolve(e):i.reject(e)}.bind(this),function(){i.reject(e)}),i.promise},userWantsToDuplicateWidget:function(e){return!!r.isWidget(e)&&(!e._lockedBy&&(!!e.isCopyable()&&(s.isUnduplicatableWidgetInside(e)?(o.get("coreLibraryMessenger").warning("WIDGET.COMMON.UNDUPLICATABLE_WIDGET_ERROR_MESSAGE"),!1):s.ContentManager.duplicateWidget(e,function(e,t){e?console.warn("Error while duplicate widget:",e):s.Widgets.checkAndScrollTo(t)}))))},destroyWidget:function(e){return angular.isString(e)&&(e=this.getWidgetById(e)),!!s.ContentManager.destroyWidget(e)&&((e===p||p&&p.isInside(e))&&(p=null,Helpers.hideHelpers()),p&&s.HelperSelected.updateByWidget(p),s.Widgets.removeCache(e),!0)},hideEmptySectionsPlaceholders:function(n){return this.getWidgetSections().forIn(function(e,t){t.hideEmptySectionPlaceholder(n)}),this},lockAllSection:function(n){return this.getWidgetSections().forIn(function(e,t){t.pleaseLockContent(n)}),this},unlockAllSection:function(n){return this.getWidgetSections().forIn(function(e,t){t.pleaseUnLockContent(n)}),this},lockSectionById:function(e,t){var n,i;if(angular.isArray(e)){for(n=0;n<e.length;n++)this.lockSectionById(e[n],t);return this}return(i=this.getWidgetSectionById(e))?i.pleaseLockContent(t):this},lockSectionByName:function(e,t){var n;if(angular.isArray(e)){for(n=0;n<e.length;n++)this.lockSectionByName(e[n],t);return this}return this.lockSectionById("section-"+e,t)},unlockSectionById:function(e,t){var n,i;if(angular.isArray(e)){for(n=0;n<e.length;n++)this.unlockSectionById(e[n],t);return this}return(i=this.getWidgetSectionById(e))&&i.pleaseUnLockContent(t),this},unlockSectionByName:function(e,t){var n;if(angular.isArray(e)){for(n=0;n<e.length;n++)this.unlockSectionByName(e[n],t);return this}return this.unlockSectionById("section-"+e,t)},getContextDocument:function(){return this._document},setEventManager:function(e){this._Environment.setEventManager(e),this.ContentManager.setEventManager(e),g=e,window&&(window.Helpers=window.Helpers||{},window.Helpers.hideHelpers=function(){s.InsertLine.hide(),Helpers.hover(),s.HelperDragHover.hideByWidget(d),d=null,s.HelperDragOver.hideByWidget(l),l=null},window.Helpers.em=g)},getEventManager:function(){return this._Environment.getEventManager()},_translator:null,setTranslator:function(e){return this._translator=e,this._Environment.setTranslator(e),this},getTranslator:function(){return this._Environment.getTranslator()},translate:function(e){return this._translator?this._translator.instant(e):e},getWidgets:function(){return this.Widgets.getAll()},setDeviceName:function(e){return e&&(this._device.name=e,this._device._isDesktop="desktop"==e,this._device._isTablet="tablet"==e,this._device._isMobile="mobile-v"==e||"mobile-h"==e,window.device=e),this},isSilentMode:function(e){return e&&e._silentMode||this._silentMode},getDeviceName:function(){return this._device.name},isDeviceADesktop:function(){return this._device._isDesktop},isDeviceATablet:function(){return this._device._isTablet},isDeviceAMobile:function(){return this._device._isMobile},updateWidgetsWidth:function(){return setTimeout(function(){s.Widgets.massCall(s.Widgets.getWidgetsWithWidthChanged(),{method:"onWidthChanged"})},700),this},getUnremovableWidgetInside:function(e){var n;if(e)return function e(t){return t.isRemovable()?(t.children&&t.children.length&&(n=n.concat(t.children)),n.shift(),!!n.length&&e(n[0])):t}((n=[e])[0]);N()&&console.error("editor.js : getUnremovableWidgetInside > invalid argument [widget]:",e)},isUnduplicatableWidgetInside:function(e){var n;if(e)return function e(t){return!t.isCopyable()||(t.children&&t.children.length&&(n=n.concat(t.children)),n.shift(),!!n.length&&e(n[0]))}((n=[e])[0]);N()&&console.error("editor.js : isUnduplicatableWidgetInside > invalid argument [widget]:",e)},setInjector:function(e){o=e,this.ContentManager.setInjector(o),this._initInterceptor()},setWidgetFactory:function(e){r=e,this._Environment.setWidgetFactory(e),this.ContentManager.setWidgetFactory(e);try{r.setWidgetsCacheOptions(widgetCacheOptions||{}),r.Environment.setEditor(this)}catch(e){}},getWidgetFactory:function(){return r},getCacheOptionsByWidgetId:function(e){var t=window.widgetCacheOptions;if(t)return t[e]},setLivePreviewService:function(e){return this._Environment.setLivePreviewService(e),this},run:function(){var e,t,n,i;for(0<I&&console.info("\nEditor.js : MotoEditor.run()"),this.HelperHover.run(),this.HelperSelected.run(),this.EventsHandler.run(),this.getScope().$broadcast("NEW EVENT: Editor start running",b),this.getScope().$on("MotoEvent:LivePreview.DeviceWasChanged",this.updateWidgetsWidth),g.off("NEW EVENTS: this widget will be destroy",B).on("NEW EVENTS: this widget will be destroy",B).off("NEW EVENTS: this widget will be paste",x).on("NEW EVENTS: this widget will be paste",x),0<I&&console.info("Editor.js : bindSection()"),$(".moto-section").on("click",c.section.editClick),$(document).on("dragend drop",Y),parent.$("body").on("dragenter",c.widget.parentBodyDragEnter),$(document).on("dragstart",k),s._$body.on("drop",c.preventDefault).on("dragenter",".moto-widget",c.widget.dragOver).on("dragover",".moto-widget,.moto-section:not(.moto-section_locked)",P).on("dragenter",".moto-section_locked",c.widget.lockedSectionDragEnter).on("mouseleave",M).on("mouseenter",".moto-section_inactive",M).on("dragleave",".moto-section_locked",c.widget.lockedSectionDragLeave),1<I&&console.info("Editor.js : MotoEditor.run : bind eventManager.on => signals.*"),g.on("section.edit",a.section.edit).on("widget.new.dragStart",q).on("widget.new.dragEnd",X),1<I&&console.info("Editor.js : MotoEditor.run : create interval helpers"),n=(e=$(".moto-section")).length,1<I&&console.info('Editor.js : MotoEditor.run : light connecting to sections, count is "'+n+'" => bindWidgets(), motoEditor.initializeContainerWidgetByDom()'),t=0;t<n;t++)u=e[t],2<I&&console.info("\nEditor.js : MotoEditor.run : light connecting to section",u.id),(i=(i=u)||u)?(2<I&&console.info("Editor.js : bindWidgets"),3<I&&console.info("Editor.js : bindWidgets : DOM",i),3<I&&console.info("Editor.js : bindWidgets : Set draggable = true for .moto-widget"),i=$(i),g.trigger("NEW EVENT: Editor start bind widgets for section",i),3<I&&console.info("Editor.js : bindWidgets : Bind dom events [click, drag*, mouse*, blur]"),i.on("dragstart",".moto-editor_no-draggable",c.widget.dragPrevent).on("dragstart",".moto-editor_draggable",c.widget.dragStart).on("click",".moto-editor_select-widget-by-id-attribute",c.widget.selectWidgetByIdAttribute).on("click",".moto-editor_remove-closest-widget",c.widget.remove).on("click",".moto-editor_select-closest-widget",c.widget.click).on("click",".moto-editor_duplicate-closest-widget",c.widget.duplicate).on("click",c.widget.click).on("mousedown",c.widget.mouseDown).on("dragstart",c.widget.dragStart).on("mouseenter",".moto-widget",c.widget.mouseEnter).on("mouseleave",".moto-widget",c.widget.mouseLeave)):2<I&&console.info("Editor.js : bindWidgets : Bad DOM"),s.initializeWidgetByDom(u);u=null,2<I&&console.info("\n"),1<I&&console.info("Editor.js : MotoEditor.run : add dblclick for .moto-widget"),$(document).on("dblclick",c.widget.doubleClick),this._$body.addClass("moto-preview-mode_content"),this.getScope().$broadcast("NEW EVENT: Editor finish running",b)},destroy:function(){this.getScope().$broadcast("NEW EVENT: Editor start self destroying",b),s.HelperHover.destroy(),s.HelperSelected.destroy(),j(),$(document).off("dblclick",c.widget.doubleClick),0<I&&console.info("Editor.js : unbindSelectSection()"),u&&($(".moto-section").removeClass("moto-section_inactive"),$(u).removeClass("moto-section_active").removeAttr("draggable"),$(document).off("keyup",c.section.del),$(document).off("keydown",c.section.keydown),$(u).off("mouseenter",c.widget.mouseEnter).off("mouseleave",c.widget.mouseLeave)),parent.$("body").off("keyup",c.section.del),$(document).off("dragend drop",Y),parent.$("body").off("dragenter",c.widget.parentBodyDragEnter),s._$body.off("drop",c.preventDefault).off("dragenter",".moto-widget",c.widget.dragOver).off("dragover",".moto-widget,.moto-section:not(.moto-section_locked)",P).off("dragenter",".moto-section_locked",c.widget.lockedSectionDragEnter).off("mouseleave",M).off("mouseenter",".moto-section_inactive",M).off("dragleave",".moto-section_locked",c.widget.lockedSectionDragLeave),R(),A(),s.Widgets.massCall(s.getWidgets(),{method:"destroy"}),0<I&&console.info("Editor.js : MotoEditor.destroy()"),1<I&&console.info("Editor.js : MotoEditor.destroy : unbind eventManager.off => signals.*"),g.off("section.edit",a.section.edit).off("widget.new.dragStart",q).off("widget.new.dragEnd",X).off("NEW EVENTS: this widget will be destroy",B).off("NEW EVENTS: this widget will be paste",x),this.getScope().$broadcast("NEW EVENT: Editor self destroyed",b),this.ElementsPanel&&this.ElementsPanel.disconnectEditor(this),this.ElementsPanel=null,this.getScope().$destroy()},edit:function(e){1<I&&console.info("Editor.js : MotoEditor.edit() ",e),c.section.editClick(e)},transform:function(){1<I&&console.info("Editor.js : MotoEditor.transform()")},onBeforeSaveSection:function(e){var t,n;Helpers.hideHelpers(),$(".moto-editor-helper").remove(),s.hideEmptySectionsPlaceholders(!0),1<I&&console.info("Editor.js : Editor.onBeforeSaveSection() : start : Prepare content for saving"),angular.isObject(e)||(e={}),angular.isUndefined(e.useTransform)&&(e.useTransform=!0),p=null,$("body").addClass("moto-preview-overlay moto-preview-overlay_fill-dark"),$(".moto-editor-helper").remove(),n=".moto-widget."+(t=["moto-editor_this_widget_hovered","moto-widget_selected","moto-widget_hover","moto-widget_empty"]).join(", .moto-widget."),2<I&&console.info("Editor.js : Editor.onBeforeSaveSection() : Clean css class : ",t),3<I&&console.info("Editor.js : Editor.onBeforeSaveSection() : Selector : ",n),3<I&&console.info("Editor.js : Editor.onBeforeSaveSection() : Found items for clean : ",$(n).length),$(n).removeClass(t.join(" ")),e.useTransform&&f.exportForSaveAsHtml(),1<I&&console.info("Editor.js : Editor.onBeforeSaveSection() : end")},getHtmlById:function(e){var t;return 1<I&&console.info("Editor.js : MotoEditor.getHtmlById()"),(t=$("#"+e).html())&&(t=t.replace(/\<\!----\@/g,"").replace(/\@----\>/g,"")),4<I&&console.info("Editor.js : MotoEditor.getHtmlById => \n",t,"\n"),t},getElementCharacteristics:function(e,t){var n;return t=!!t,(n=e.offset()).top-=$("body").offset().top,e.hasClass("moto-cell")?n.width=e.width():n.width=e.outerWidth(),n.height=e.outerHeight(t),t&&(n.top-=parseInt(e.css("margin-top").replace("px",""))),n},__getPositionsByEventAndWidget:function(e,t){var n=$(e.originalEvent.target).offset().top,i=$(e.originalEvent.target).offset().left,o=e.originalEvent.offsetY||e.originalEvent.clientY-n+window.pageYOffset,r=e.originalEvent.offsetX||e.originalEvent.clientX-i+window.pageXOffset;return{clientY:e.originalEvent.clientY,clientX:e.originalEvent.clientX,targetWidgetOffsetY:o+(n-t._$dom.offset().top),targetWidgetOffsetX:r+(i-t._$dom.offset().left)}},setEnvironmentStage:function(e){S=e||S,this._Environment.setStage(S)},initializeWidgetByDom:function(e,t){return this.ContentManager.getWidgetProcessor("initialize").execute(e,t)},initializeWidgets:function(e,t){var n,i;if(2<I&&console.info("Editor.js : initializeWidgets : Bind dom events [click, drag*, mouse*, blur]"),3<I&&console.info("Editor.js : initializeWidgets : DOM",e),3<I&&console.info("Editor.js : initializeWidgets : parent",t),(e=$(e))&&e.data("widget"))for(n=s.initializeWidgetByDom(e,t),i=0;e.children[i];i++)s.initializeWidgets(e.children[i],n)},getWidgetByDom:function(e){return this.Widgets.getByDom(e)},getWidgetById:function(e){return this.Widgets.getById(e)},getWidgetsByName:function(e){return this.Widgets.getWidgetsByName(e)},getDroppedWidgetOptions:function(){return y},userWantsToPasteWidget:function(e,t){var n,i,o=r.getCurrentPage();e&&(t=(n=(t=t||this.getCurrentWidget()).getTargetDataForPaste(e)).targetWidget,i=n.widgetPosition,t=this._callInterceptor(this.INTERCEPTOR__PASTE_FROM_BUFFER,t,{buffer:e,position:i}),i.widgetId=t.getId(),this.ContentManager.ACL.isAllowToPasteFromBuffer(e,t,o,this.getCurrentSection().getSectionName())&&(e=this.ContentManager.ACL.removeUnpastableWidgetsFromBuffer(e,t,o,this.getCurrentSection().getSectionName()),angular.isObject(e)&&angular.isString(e.name)&&angular.isObject(e.properties)&&this.ContentManager.pasteWidgetFromBuffer(e,i,function(e,t){e||s.Widgets.checkAndScrollTo(t)})))}},a={section:{edit:function(){var e;return 1<I&&console.info("Editor.js : signals.section.edit : start"),O?(0<I&&console.error("Section Activation is already in progress"),!1):D?(0<I&&console.error("Section is already activated"),!1):(f=s.getWidgetByDom(u),b.setGlobal("__ActivatedSectionWidget__",f),b.setGlobal("__CurrentSectionWidget__",f),s.getScope().$broadcast("NEW EVENT: Editor start activating section",b),O=!0,A(),0<I&&console.info("Editor.js : bindSelectSection()"),u&&($(".moto-section").each(function(e,t){t!==u&&F(t)}),$(u).addClass("moto-section_active").attr("draggable",!0),$(document).on("keyup",c.section.del),$(document).on("keydown",c.section.keydown),$(u).on("mouseenter",c.widget.mouseEnter).on("mouseleave",c.widget.mouseLeave)),parent.$("body").on("keyup",c.section.del),!1!==i&&(e=i||f,s.HelperHover.hideByWidget(e),s.selectWidget(e)),i=null,s.getScope().$broadcast("NEW EVENT: Editor finished activating section",b),D=!(O=!1),s.ElementsPanel.updateContent(),void(1<I&&console.info("Editor.js : signals.section.edit : end")))}}},c={section:{del:function(e){var t,n,i;if(4<I&&console.info("Editor.js : events.section.del"),5<I&&console.info("Editor.js : events.section.del : event",e),(46==e.keyCode||8==e.keyCode)&&p){if(0<parent.$(".modal").length)return;if(1===(n=$(":focus")).length?t=n:1===(i=parent.$(":focus")).length&&(t=i),t&&("INPUT"===t.prop("tagName")||"TEXTAREA"===t.prop("tagName")||"true"===t.prop("contenteditable")))return;s.userWantsToRemoveWidget(p)}},keydown:function(e){var t;if(8===e.keyCode){if((t=$(":focus"))&&("INPUT"===t.prop("tagName")||"TEXTAREA"===t.prop("tagName")||"true"===t.prop("contenteditable")))return;e.preventDefault()}},editClick:function(e){var t,n;1<I&&console.info("Editor.js : events.section.editClick"),2<I&&console.info("Editor.js : events.section.editClick : event",e),"string"==typeof e?(t=$("#"+e).get(0))&&(n=(u=t).id):(u=e.currentTarget,t=s.Utils.getClosestWidgetElementForDrag(e.target),2<I&&console.info('Editor.js : events.section.editClick : "el" ',t),t&&(i=s.getWidgetByDom(t),2<I&&console.info("Editor.js : events.section.editClick : init edit ",e)),n=u.id),n?(1<I&&console.info('Editor.js : events.section.editClick : trigger "section.edit"',n),g.trigger("section.edit",n)):1<I&&console.info("Editor.js : events.section.editClick : NO SECTION ID")},click:function(e){g.trigger("section.click",u,e),e.preventDefault()}},widget:{mouseEnter:function(e){var t=s.getClosestWidgetByDom(e.target);if(t){if(t=t.getWidgetForHelper("hover"),e.preventDefault(),t.isUnselectable())return!1;p!==t?Helpers.hover(t):Helpers.hover(),t.emitEvent("childHovered",t)}},mouseLeave:function(e){var t=s.getClosestWidgetByDom(e.target);t&&(t=t.getWidgetForHelper("hover")).emitEvent("childUnHovered",t),e.preventDefault(),$(document).one("mousemove",".moto-widget,.moto-section:not(.moto-section_inactive)",c.widget.mouseEnter)},mouseDown:function(e){n=s.getClosestWidgetByDom(e.target)},click:function(e){var t;e.preventDefault(),(t=s.getClosestWidgetByDom(e.target))&&n&&t===n&&(s.HelperHover.hideByWidget(s.getHelpers().getWidgetWithHoverHelper()),t.triggerEvent("click",e),g.trigger("widget.click",t,e),s.selectWidget(t)),n=null},duplicate:function(e){var t;if(e.preventDefault(),e.stopPropagation(),!(t=s.getClosestWidgetByDom(e.target)))return!1;s.userWantsToDuplicateWidget(t)},remove:function(e){var t;if(e.preventDefault(),e.stopPropagation(),!(t=s.getClosestWidgetByDom(e.target)))return!1;s.userWantsToRemoveWidget(t)},selectWidgetByIdAttribute:function(e){var t;t=$(e.currentTarget).data("id"),s.selectWidget(t),e.stopPropagation()},doubleClick:function(e){var t=s.getClosestWidgetByDom(e.target);t?(t.triggerEvent("doubleClick",e),e.preventDefault()):(2<I&&console.warn("Editor.js : events.widget.doubleClick : widget not found by event.target"),3<I&&console.warn("Editor.js : events.widget.doubleClick : event",e))},dragPrevent:function(e){return!!y.widgetName||(e.preventDefault(),!1)},dragStart:function(e){var t,n,i;if((n=s.Utils.getClosestWidgetElementForDrag(e.target))&&(t=s.getWidgetByDom(n))&&t.isDraggable(e)&&!t._lockedBy){e.originalEvent.dataTransfer.effectAllowed="move",e.originalEvent.dataTransfer.dropEffect="move";try{e.originalEvent.dataTransfer.setData("text",t.name)}catch(e){}i=t.getDragImage(),e.originalEvent.dataTransfer.setDragImage&&i&&e.originalEvent.dataTransfer.setDragImage(i,0,0),q(t)}},dragOver:function(e){var t,n,i,o,r,a;if(e.preventDefault(),T()){if((o=$(e.target))&&((i=o.closest(".moto-widget",u)).length||(i=o.hasClass("moto-section_inactive")?$(".moto-section_active"):o),n=s.getWidgetByDom(i[0]),i&&i.data("widget")&&n)){if((s.getCurrentSection()||s.getWidgetSectionByWidget(n)).isContentLocked())return void R();r=n}if(!r)return;if(C||($(".helper-insert").on("dragover",c.widget.elementDragOver),s._$window.on("dragover",c.widget.elementDragOver),C=!0),r._targetDomElement=o.data("container")&&!o.data("widget")?o[0]:r._dom,r._$targetDomElement=$(r._targetDomElement),t={event:e,droppedWidgetOptions:y,device:device,eventPositions:s.__getPositionsByEventAndWidget(e,r)},r=s._callInterceptor(s.INTERCEPTOR__DRAG_OVER_TARGET_WIDGET,r,t),t.eventPositions=s.__getPositionsByEventAndWidget(e,r),a=r.getHelperInsertPosition(t),a=s._callInterceptor(s.INTERCEPTOR__DRAG_OVER_POSITION,a,t),r&&a&&r===E.targetWidget&&a===E.targetPosition)return;E.targetWidget=r,E.targetPosition=a,!1,(-1<["prepend","append","cell-left","cell-right"].indexOf(E.targetPosition)?s.ContentManager.ACL.isAllowDropObject(y,E.targetWidget,E.targetPosition):s.ContentManager.ACL.isAllowDropObject(y,E.targetWidget._parent||E.targetWidget,E.targetPosition))&&(s.getHelpers().hideInsertHelper(),-1<["after","before"].indexOf(E.targetPosition)&&"section"===E.targetWidget._parent.name||-1<["append","prepend"].indexOf(E.targetPosition)&&"section"===E.targetWidget.name?s.InsertLine.showByWidgetAndPosition(E.targetWidget,E.targetPosition):(s.InsertLine.hide(),s.getHelpers().showInsertHelper(E.targetWidget,E.targetPosition)),s.HelperDragOver.hideByWidget(l),l=null,E.targetWidget.isContainer()||(l=E.targetWidget,s.HelperDragOver.showByWidget(l)),s.HelperDragHover.hideByWidget(d),d=(d=-1<["prepend","append","cell-left","cell-right"].indexOf(E.targetPosition)?E.targetWidget:E.targetWidget._parent||E.targetWidget).getWidgetForHelper("draghover"),s.HelperDragHover.showByWidget(d))}},parentBodyDragEnter:function(){parent&&0<parent.$(".modal").length||R()},lockedSectionDragEnter:function(e){var t,n;R(),(n=$(e.target))&&(t=n.closest("[data-widget]")).length&&s.getWidgetByDom(t[0])._$dom.addClass("moto-section_locked-drag-over")},lockedSectionDragLeave:function(e){var t,n;(n=$(e.target))&&(t=n.closest("[data-widget]")).length&&s.getWidgetByDom(t[0])._$dom.removeClass("moto-section_locked-drag-over")},elementDragOver:function(e){e.preventDefault()}},preventDefault:function(e){2<I&&console.warn("events.preventDefault"),e.preventDefault()}},window.Helpers=window.Helpers||{},window.device="desktop",(b=new MotoEditorEnvironmentClass).setGlobal("Helpers",Helpers),s=new e(b),window.MotoEditorClass=e,$(function(){window.MotoEditor=s})}(),function(){var t;window.Helpers=window.Helpers||{},window.Helpers.hover=function(e){(t||e)&&t!=e&&(t&&(t._$dom.removeClass("moto-widget_hover"),t.isAutoHideHelpers("hover")&&MotoEditor.HelperHover.hideByWidget(t)),e&&(e._$dom.addClass("moto-widget_hover"),e.isAutoShowHelpers("hover")&&MotoEditor.HelperHover.showByWidget(e)),t=e)},window.Helpers.getWidgetWithHoverHelper=function(){return t}}(),function(){var o,r,d,l;function e(e,t){var n,i;return i=d.getElementCharacteristics(e._$dom),n="left"===t?i.left:i.left+i.width-l.SMALL_INSERT_HELPER_SIZE,{width:l.SMALL_INSERT_HELPER_SIZE,height:i.height,top:i.top,left:n}}function t(e,t){var n,i,o,r,a=0,s=0;return("row.column"===e.name||"block"===e.name)&&-1<["prepend","append"].indexOf(t)?(n=e._$targetDomElement,s=parseInt(n.css("padding-left").replace("px",""))):n=e._$dom,"accordion.item"===e.name&&(n=e.getTargetElement({position:t})),i="container"===e.name,o=d.getElementCharacteristics(n,i),r=d.getElementCharacteristics(n),"prepend"===t?e.isContainer()&&!e.isTargetElementEmpty({position:t})&&(a=0):"append"===t?e.isContainer()&&!e.isTargetElementEmpty({position:t})&&(a=r.height-l.SMALL_INSERT_HELPER_SIZE):"after"===t&&(a=r.height,a-=l.SMALL_INSERT_HELPER_SIZE),a=r.top+a,s=o.left+s,{width:o.width,height:l.SMALL_INSERT_HELPER_SIZE,top:a,left:s}}function n(e,t){var n,i;e&&t&&o&&o[t]&&(n=o[t].getRenderOptions(e,t))&&(i=d._$body.height(),n.top<0?n.top=0:n.top+n.height>i&&(n.top=i-n.height),r.css({width:n.width+"px",height:n.height+"px",top:Math.round(n.top)+"px",left:Math.round(n.left)+"px"}).show())}function i(){try{r&&r.hide()}catch(e){}}function a(e){var t,n=e.name;for(delete e.name,angular.isString(n)&&(n=[n]),o=o||{},t=0;t<n.length;t++)o[n[t]]=e}$(function(){r=$('<div class="helper-insert"></div>'),d=window.MotoEditor,l=d.getHelpers(),d._$body.append(r),l.hideInsertHelper=i,l.showInsertHelper=n,l.addInsertPositions=a,l.SMALL_INSERT_HELPER_SIZE=4,l.MEDIUM_INSERT_HELPER_SIZE=6,l.addInsertPositions({name:["prepend","append","after","before"],getRenderOptions:t}),l.addInsertPositions({name:["left","right"],getRenderOptions:e})})}(),$(function(){var e;(e=$("body")).on("click","a",function(e){e.preventDefault()}),e.removeClass("moto-preview-overlay")}),$(window).one("load",function(){window.parent&&parent.livePreviewLoaded&&parent.livePreviewLoaded()}),function($e,Ae,e){var t,Re={beforeShow:n,move:n,change:n,show:n,hide:n,cancel:n,apply:n,color:!1,flat:!1,showInput:!1,inputUpdateOriginal:!0,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!1,showInitial:!1,showPalette:!1,showPaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",clearText:"Clear Color Selection",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,showHex:!0,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,initialOffset:!1,showRGBA:!1},je=[],Fe=!!/msie/i.exec($e.navigator.userAgent),Le=function(){function e(e,t){return!!~(""+e).indexOf(t)}var t=document.createElement("div").style;return t.cssText="background-color:rgba(0,0,0,.5)",e(t.backgroundColor,"rgba")||e(t.backgroundColor,"hsla")}(),Ue="color"===(t=Ae("<input type='color' value='#ffffff' />")[0]).type&&"#ffffff"!==t.value,Ve=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),Ge=function(){var e="";if(Fe)for(var t=1;t<=6;t++)e+="<div class='sp-"+t+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",e,"</div>","</div>","<div class='sp-alpha'><label class='opacity-label'>Opacity</label><div class='sp-alpha-inner alpha-inner-slider'><div class='sp-alpha-handle'></div></div>","<div class='sp-input-container sp-input-container-mini sp-cf'>","<input class='sp-input-opacity' type='text' spellcheck='false'  />","<span class='percent'>%</span>","</div>","</div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-labels sp-cf'>","<span class='sp-labels-current'></span>","<span class='sp-labels-new'></span>","</div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}();function ze(e,t,n,i){for(var o=[],r=0;r<e.length;r++){var a=e[r];if(a){var s=tinycolor(a),d=s.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";d+=tinycolor.equals(t,a)?" sp-thumb-active":"";var l=s.toString(i||"rgb"),c=Le?"background-color:"+s.toRgbString():"filter:"+s.toFilter();o.push('<span title="'+l+'" data-color="'+s.toRgbString()+'" class="'+d+'"><span class="sp-thumb-inner" style="'+c+';" /></span>')}else{o.push('<span title="No Color Selected" data-color="" style="background-color:transparent;" class="sp-clear-display"></span>')}}return"<div class='sp-cf moto-ui-transparent "+n+"'>"+o.join("")+"</div>"}function r(e,t){var n,o,r,a,s,d,l,g=(s=t,d=e,(l=Ae.extend({},Re,s)).callbacks={move:Xe(l.move,d),change:Xe(l.change,d),show:Xe(l.show,d),hide:Xe(l.hide,d),beforeShow:Xe(l.beforeShow,d),cancel:Xe(l.cancel,d),apply:Xe(l.apply,d)},l),u=g.flat,c=g.showSelectionPalette,p=g.localStorageKey,f=g.theme,h=g.callbacks,m=(n=ke,o=10,function(){var e=this,t=arguments;r&&clearTimeout(a),!r&&a||(a=setTimeout(function(){a=null,n.apply(e,t)},o))}),v=!1,_=0,w=0,E=0,b=0,y=0,W=0,C=0,S=0,I=0,O=0,D=1,T=[],H=[],N={},B=g.selectionPalette.slice(0),x=g.maxSelectionSize,k="sp-dragging",P=null,M=e.ownerDocument,$=(M.body,Ae(e)),A=!1,R=Ae(Ge,M).addClass(f),j=R.find(".sp-color"),F=R.find(".sp-dragger"),L=R.find(".sp-hue"),U=R.find(".sp-slider"),V=R.find(".sp-top-inner"),G=R.find(".sp-alpha-inner"),z=(R.find(".sp-alpha"),R.find(".sp-alpha-handle")),q=R.find(".sp-input"),X=R.find(".sp-input-opacity"),Y=R.find(".sp-palette"),Z=R.find(".sp-initial"),K=R.find(".sp-cancel"),J=R.find(".sp-clear"),Q=R.find(".sp-choose"),ee=R.find(".sp-labels-new"),te=R.find(".sp-labels-current"),ne=$.is("input"),ie=ne&&Ue&&"color"===$.attr("type"),oe=ne&&!u,re=oe?Ae(Ve).addClass(f).addClass(g.className).addClass(g.replacerClassName):Ae([]),ae=oe?re:$,se=re.find(".sp-preview-inner"),de=g.color||ne&&$.val(),le=!1,ce=g.preferredFormat,ge=ce,ue=!g.showButtons||g.clickoutFiresChange,pe=!de,fe=g.allowEmpty&&!ie;function he(){if(g.showPaletteOnly&&(g.showPalette=!0),g.palette){T=g.palette.slice(0),H=Ae.isArray(T[0])?T:[T],N={};for(var e=0;e<H.length;e++)for(var t=0;t<H[e].length;t++){var n=tinycolor(H[e][t]).toRgbString();N[n]=!0}}R.toggleClass("sp-flat",u),R.toggleClass("sp-input-disabled",!g.showInput),R.toggleClass("sp-alpha-enabled",g.showAlpha),R.toggleClass("sp-clear-enabled",fe),R.toggleClass("sp-buttons-disabled",!g.showButtons),R.toggleClass("sp-palette-disabled",!g.showPalette),R.toggleClass("sp-palette-only",g.showPaletteOnly),R.toggleClass("sp-initial-disabled",!g.showInitial),R.addClass(g.className).addClass(g.containerClassName),g.showAlpha&&V.addClass("opacity-color-area"),ke()}function me(){if(p&&$e.localStorage){try{var e=$e.localStorage[p].split(",#");1<e.length&&(delete $e.localStorage[p],Ae.each(e,function(e,t){ve(t)}))}catch(e){}try{B=$e.localStorage[p].split(";")}catch(e){}}}function ve(e){if(c){var t=tinycolor(e).toRgbString();if(!N[t]&&-1===Ae.inArray(t,B))for(B.push(t);B.length>x;)B.shift();if(p&&$e.localStorage)try{$e.localStorage[p]=B.join(";")}catch(e){}}}function _e(){var n=Te(),e=Ae.map(H,function(e,t){return ze(e,n,"sp-palette-row sp-palette-row-"+t,g.preferredFormat)});me(),B&&e.push(ze(function(){var e=[];if(g.showPalette)for(i=0;i<B.length;i++){var t=tinycolor(B[i]).toRgbString();N[t]||e.push(B[i])}return e.reverse().slice(0,g.maxSelectionSize)}(),n,"sp-palette-row sp-palette-row-selection",g.preferredFormat)),Y.html(e.join(""))}function we(){if(g.showInitial){var e=le,t=Te();Z.html(ze([e,t],t,"sp-palette-row-initial",g.preferredFormat))}}function Ee(){(w<=0||_<=0||b<=0)&&ke(),R.addClass(k),P=null,$.trigger("dragstart.spectrum",[Te()])}function be(){R.removeClass(k),$.trigger("dragstop.spectrum",[Te()])}function ye(){var e=q.val();if(null!==e&&""!==e||!fe){var t=tinycolor(e);t.ok?(De(t),g.inputUpdateOriginal?xe(!0):(h.move(Te()),$.trigger("move.spectrum",[Te()]))):q.addClass("sp-validation-error")}else De(null),g.inputUpdateOriginal?xe(!0):(h.move(Te()),$.trigger("move.spectrum",[Te()]))}function We(){var e=X.val();e=parseInt(e,10),!isNaN(e)&&0<=e&&e<=100?(D=e/100,He()):X.addClass("sp-validation-error")}function Ce(){v?Ie():Se()}function Se(){var e=Ae.Event("beforeShow.spectrum");v?ke():($.trigger(e,[Te()]),!1===h.beforeShow(Te())||e.isDefaultPrevented()||(!function(){for(var e=0;e<je.length;e++)je[e]&&je[e].hide()}(),v=!0,Ae(M).bind("click.spectrum",Ie),Ae($e).bind("resize.spectrum",m),re.addClass("sp-active"),R.removeClass("sp-hidden"),ke(),Ne(),le=Te(),we(),h.show(le),$.trigger("show.spectrum",[le])))}function Ie(e){e&&"click"==e.type&&2==e.button||(v=!1,Ae(M).unbind("click.spectrum",Ie),Ae($e).unbind("resize.spectrum",m),re.removeClass("sp-active"),R.addClass("sp-hidden"),!tinycolor.equals(Te(),le)?ue&&"cancel"!==e?xe(!0):Oe():"cancel"===e&&""===g.color&&Oe(),h.hide(Te()),$.trigger("hide.spectrum",[Te()]))}function Oe(){De(le,!0),h.cancel(Te())}function De(e,t){var n,i;tinycolor.equals(e,Te())?Ne():(!e&&fe?pe=!0:(pe=!1,i=(n=tinycolor(e)).toHsv(),S=i.h%360/360,I=i.s,O=i.v,D=i.a),Ne(),n&&n.ok&&!t&&(ge=ce||n.format))}function Te(e){return e=e||{},fe&&pe?null:tinycolor.fromRatio({h:S,s:I,v:O,a:Math.round(100*D)/100},{format:e.format||ge})}function He(){Ne(),h.move(Te()),$.trigger("move.spectrum",[Te()])}function Ne(){q.removeClass("sp-validation-error"),X.removeClass("sp-validation-error"),Be();var e=tinycolor.fromRatio({h:S,s:1,v:1});j.css("background-color",e.toHexString());var t=ge;D<1&&(0!==D||"name"!==t)&&("hex"!==t&&"hex3"!==t&&"hex6"!==t&&"name"!==t||(t="rgb"));var n=Te({format:t}),i="";if(se.removeClass("sp-clear-display"),se.css("background-color","transparent"),!n&&fe)se.addClass("sp-clear-display");else{var o=n.toHexString(),r=n.toRgbString();if(Le||1===n.alpha?se.css("background-color",r):(se.css("background-color","transparent"),se.css("filter",n.toFilter())),g.showAlpha){var a=n.toRgb();a.a=0;tinycolor(a).toRgbString()}i=g.showRGBA?n.toString(t):n.toString("hex")}g.showInput&&(q.val(i),X.val(Math.round(100*n.alpha))),g.showPalette&&_e(),we()}function Be(){var e=I,t=O;if(fe&&pe)z.hide(),U.hide(),F.hide();else{z.show(),U.show(),F.show();var n=e*_,i=w-t*w;n=Math.max(-E,Math.min(_-E,n-E)),i=Math.max(-E,Math.min(w-E,i-E)),F.css({top:i+"px",left:n+"px"});var o=D*y;z.css({left:o-W/2+"px"});var r=S*b;U.css({top:r-C+6+"px"})}}function xe(e){var t=Te(),n="",i=!tinycolor.equals(t,le);t&&(n=t.toString(ge),ve(t)),ne&&$.val(n),le=t,e&&i&&(h.change(t),$.trigger("change",[t]))}function ke(){var e,t,n,i,o,r,a,s,d,l,c;_=j.width(),w=j.height(),E=F.height(),L.width(),b=L.height(),C=U.height(),y=218,W=z.width(),u||(R.css("position","absolute"),n=ae,i=(t=R).outerWidth(),o=t.outerHeight(),r=n.outerHeight(),a=t[0].ownerDocument,s=a.documentElement,d=s.clientWidth+Ae(a).scrollLeft(),l=s.clientHeight+Ae(a).scrollTop(),(c=n.offset()).left-=Math.min(c.left,c.left+i>d&&i<d?Math.abs(c.left+i-d):0),c.top-=Math.min(c.top,c.top+o>l&&o<l?Math.abs(o+r-0):0),e=c,angular.isObject(g.initialOffset)&&(e=angular.extend(e,g.initialOffset)),R.offset(e)),Be(),g.showPalette&&_e(),$.trigger("reflow.spectrum")}function Pe(){Ie(),A=!0,$.attr("disabled",!0),ae.addClass("sp-disabled")}!function(){if(Fe&&R.find("*:not(input)").attr("unselectable","on"),he(),oe&&$.after(re).hide(),fe||J.hide(),u)$.after(R).hide();else{var e="parent"===g.appendTo?$.parent():Ae(g.appendTo);1!==e.length&&(e=Ae("body")),e.append(R)}function t(e){return e.data&&e.data.ignore?(De(Ae(this).data("color")),He()):(De(Ae(this).data("color")),He(),xe(!0),Ie()),!1}me(),ae.bind("click.spectrum touchstart.spectrum",function(e){A||Ce(),e.stopPropagation(),Ae(e.target).is("input")||e.preventDefault()}),($.is(":disabled")||!0===g.disabled)&&Pe(),R.click(qe),q.change(ye),q.bind("paste",function(){setTimeout(ye,1)}),q.keydown(function(e){13==e.keyCode&&ye()}),R.on("mousedown",function(){R.find("input:focus").each(function(e){Ae(this).blur()})}),R.find(".opacity-label").text(g.opacityLabel),X.change(We),X.bind("paste",function(){setTimeout(We,1)}),X.keydown(function(e){13==e.keyCode&&We()}),K.text(g.cancelText),K.attr("title",g.cancelText),K.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),Ie("cancel")}),J.attr("title",g.clearText),J.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),pe=!0,He(),u&&xe(!0)}),Q.text(g.chooseText),Q.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),q.hasClass("sp-validation-error")||X.hasClass("sp-validation-error")||(xe(!0),h.apply(Te()),Ie())}),ee.text(g.newText),te.text(g.currentText),Ye(G,function(e,t,n){D=e/y,pe=!1,n.shiftKey&&(D=Math.round(10*D)/10),He()},Ee,be),Ye(L,function(e,t){S=parseFloat(t/b),pe=!1,g.showAlpha||(D=1),He()},Ee,be),Ye(j,function(e,t,n){if(n.shiftKey){if(!P){var i=I*_,o=w-O*w,r=Math.abs(e-i)>Math.abs(t-o);P=r?"x":"y"}}else P=null;var a=!P||"y"===P;(!P||"x"===P)&&(I=parseFloat(e/_)),a&&(O=parseFloat((w-t)/w)),pe=!1,g.showAlpha||(D=1),He()},Ee,be),de?(De(de),Ne(),ge=ce||tinycolor(de).format,ve(de)):Ne(),u&&Se();var n=Fe?"mousedown.spectrum":"click.spectrum touchstart.spectrum";Y.delegate(".sp-thumb-el",n,t),Z.delegate(".sp-thumb-el:nth-child(1)",n,{ignore:!0},t)}();var Me={show:Se,hide:Ie,toggle:Ce,reflow:ke,option:function(e,t){return void 0===e?Ae.extend({},g):void 0===t?g[e]:(g[e]=t,void he())},enable:function(){A=!1,$.attr("disabled",!1),ae.removeClass("sp-disabled")},disable:Pe,set:function(e){De(e),xe()},get:Te,destroy:function(){$.show(),ae.unbind("click.spectrum touchstart.spectrum"),R.remove(),re.remove(),je[Me.id]=null},container:R};return Me.id=je.push(Me)-1,Me}function n(){}function qe(e){e.stopPropagation()}function Xe(e,t){var n=Array.prototype.slice,i=n.call(arguments,2);return function(){return e.apply(t,i.concat(n.call(arguments)))}}function Ye(a,s,n,e){s=s||function(){},n=n||function(){},e=e||function(){};var i=a.ownerDocument||document,d=!1,l={},c=0,g=0,u="ontouchstart"in $e,o={};function p(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function r(e){if(d){if(Fe&&document.documentMode<9&&!e.button)return f();var t=e.originalEvent.touches,n=t?t[0].pageX:e.pageX,i=t?t[0].pageY:e.pageY,o=Math.max(0,Math.min(n-l.left,g)),r=Math.max(0,Math.min(i-l.top,c));u&&p(e),s.apply(a,[o,r,e])}}function f(){d&&(Ae(i).unbind(o),Ae(i.body).removeClass("sp-dragging"),e.apply(a,arguments)),d=!1}o.selectstart=p,o.dragstart=p,o["touchmove mousemove"]=r,o["touchend mouseup"]=f,Ae(a).bind("touchstart mousedown",function(e){var t=e.which?3==e.which:2==e.button;e.originalEvent.touches,t||d||!1!==n.apply(a,arguments)&&(d=!0,c=Ae(a).height(),g=Ae(a).width(),l=Ae(a).offset(),Ae(i).bind(o),Ae(i.body).addClass("sp-dragging"),u||r(e),p(e))})}var a="spectrum.id";Ae.fn.spectrum=function(n,e){if("string"!=typeof n)return this.spectrum("destroy").each(function(){var e=r(this,Ae.extend({},n,Ae(this).data()));Ae(this).data(a,e.id)});var i=this,o=Array.prototype.slice.call(arguments,1);return this.each(function(){var e=je[Ae(this).data(a)];if(e){var t=e[n];if(!t)throw new Error("Spectrum: no such method: '"+n+"'");"get"==n?i=e.get():"container"==n?i=e.container:"option"==n?i=e.option.apply(e,o):"destroy"==n?(e.destroy(),Ae(this).removeData(a)):t.apply(e,o)}}),i},Ae.fn.spectrum.load=!0,Ae.fn.spectrum.loadOpts={},Ae.fn.spectrum.draggable=Ye,Ae.fn.spectrum.defaults=Re,Ae.spectrum={},Ae.spectrum.localization={},Ae.spectrum.palettes={},Ae.fn.spectrum.processNativeColorInputs=function(){Ue||Ae("input[type=color]").spectrum({preferredFormat:"hex6"})},function(){var c=/^[\s,#]+/,g=/\s+$/,i=0,u=Math,p=u.round,f=u.min,h=u.max,e=u.random;function m(e,o){if(o=o||{},"object"==typeof(e=e||"")&&e.hasOwnProperty("_tc_id"))return e;var t=function(e){var t={r:0,g:0,b:0},n=1,i=!1,o=!1;"string"==typeof e&&(e=function(e){e=e.replace(c,"").replace(g,"").toLowerCase();var t,n=!1;if(b[e])e=b[e],n=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};if(t=O.rgb.exec(e))return{r:t[1],g:t[2],b:t[3]};if(t=O.rgba.exec(e))return{r:t[1],g:t[2],b:t[3],a:t[4]};if(t=O.hsl.exec(e))return{h:t[1],s:t[2],l:t[3]};if(t=O.hsla.exec(e))return{h:t[1],s:t[2],l:t[3],a:t[4]};if(t=O.hsv.exec(e))return{h:t[1],s:t[2],v:t[3]};if(t=O.hex8.exec(e))return{a:(i=t[1],S(i)/255),r:S(t[2]),g:S(t[3]),b:S(t[4]),format:n?"name":"hex8"};var i;if(t=O.hex6.exec(e))return{r:S(t[1]),g:S(t[2]),b:S(t[3]),format:n?"name":"hex"};if(t=O.hex3.exec(e))return{r:S(t[1]+""+t[1]),g:S(t[2]+""+t[2]),b:S(t[3]+""+t[3]),format:n?"name":"hex"};return!1}(e));"object"==typeof e&&(e.hasOwnProperty("r")&&e.hasOwnProperty("g")&&e.hasOwnProperty("b")?(r=e.r,a=e.g,s=e.b,t={r:255*C(r,255),g:255*C(a,255),b:255*C(s,255)},i=!0,o="%"===String(e.r).substr(-1)?"prgb":"rgb"):e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("v")?(e.s=I(e.s),e.v=I(e.v),t=function(e,t,n){e=6*C(e,360),t=C(t,100),n=C(n,100);var i=u.floor(e),o=e-i,r=n*(1-t),a=n*(1-o*t),s=n*(1-(1-o)*t),d=i%6;return{r:255*[n,a,r,r,s,n][d],g:255*[s,n,n,a,r,r][d],b:255*[r,r,s,n,n,a][d]}}(e.h,e.s,e.v),i=!0,o="hsv"):e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("l")&&(e.s=I(e.s),e.l=I(e.l),t=function(e,t,n){var i,o,r;function a(e,t,n){return n<0&&(n+=1),1<n&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(e=C(e,360),t=C(t,100),n=C(n,100),0===t)i=o=r=n;else{var s=n<.5?n*(1+t):n+t-n*t,d=2*n-s;i=a(d,s,e+1/3),o=a(d,s,e),r=a(d,s,e-1/3)}return{r:255*i,g:255*o,b:255*r}}(e.h,e.s,e.l),i=!0,o="hsl"),e.hasOwnProperty("a")&&(n=e.a));var r,a,s;return n=W(n),{ok:i,format:e.format||o,r:f(255,h(t.r,0)),g:f(255,h(t.g,0)),b:f(255,h(t.b,0)),a:n}}(e),r=t.r,a=t.g,s=t.b,d=t.a,l=p(100*d)/100,n=o.format||t.format;return r<1&&(r=p(r)),a<1&&(a=p(a)),s<1&&(s=p(s)),{ok:t.ok,format:n,_tc_id:i++,alpha:d,getAlpha:function(){return d},setAlpha:function(e){d=W(e),l=p(100*d)/100},toHsv:function(){var e=_(r,a,s);return{h:360*e.h,s:e.s,v:e.v,a:d}},toHsvString:function(){var e=_(r,a,s),t=p(360*e.h),n=p(100*e.s),i=p(100*e.v);return 1==d?"hsv("+t+", "+n+"%, "+i+"%)":"hsva("+t+", "+n+"%, "+i+"%, "+l+")"},toHsl:function(){var e=v(r,a,s);return{h:360*e.h,s:e.s,l:e.l,a:d}},toHslString:function(){var e=v(r,a,s),t=p(360*e.h),n=p(100*e.s),i=p(100*e.l);return 1==d?"hsl("+t+", "+n+"%, "+i+"%)":"hsla("+t+", "+n+"%, "+i+"%, "+l+")"},toHex:function(e){return w(r,a,s,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(){return E(r,a,s,d)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:p(r),g:p(a),b:p(s),a:d}},toRgbString:function(){return 1==d?"rgb("+p(r)+", "+p(a)+", "+p(s)+")":"rgba("+p(r)+", "+p(a)+", "+p(s)+", "+l+")"},toPercentageRgb:function(){return{r:p(100*C(r,255))+"%",g:p(100*C(a,255))+"%",b:p(100*C(s,255))+"%",a:d}},toPercentageRgbString:function(){return 1==d?"rgb("+p(100*C(r,255))+"%, "+p(100*C(a,255))+"%, "+p(100*C(s,255))+"%)":"rgba("+p(100*C(r,255))+"%, "+p(100*C(a,255))+"%, "+p(100*C(s,255))+"%, "+l+")"},toName:function(){return 0===d?"transparent":y[w(r,a,s,!0)]||!1},toFilter:function(e){var t="#"+E(r,a,s,d),n=t,i=o&&o.gradientType?"GradientType = 1, ":"";e&&(n=m(e).toHex8String());return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+t+",endColorstr="+n+")"},toString:function(e){var t=!!e;e=e||this.format;var n=!1,i=!t&&d<1&&0<=d&&("hex"===e||"hex6"===e||"hex3"===e||"name"===e);return"rgb"===e&&(n=this.toRgbString()),"prgb"===e&&(n=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(n=this.toHexString()),"hex3"===e&&(n=this.toHexString(!0)),"hex8"===e&&(n=this.toHex8String()),"name"===e&&(n=this.toName()),"hsl"===e&&(n=this.toHslString()),"hsv"===e&&(n=this.toHsvString()),i?this.toRgbString():n||this.toHexString()}}}function v(e,t,n){e=C(e,255),t=C(t,255),n=C(n,255);var i,o,r=h(e,t,n),a=f(e,t,n),s=(r+a)/2;if(r==a)i=o=0;else{var d=r-a;switch(o=.5<s?d/(2-r-a):d/(r+a),r){case e:i=(t-n)/d+(t<n?6:0);break;case t:i=(n-e)/d+2;break;case n:i=(e-t)/d+4}i/=6}return{h:i,s:o,l:s}}function _(e,t,n){e=C(e,255),t=C(t,255),n=C(n,255);var i,o,r=h(e,t,n),a=f(e,t,n),s=r,d=r-a;if(o=0===r?0:d/r,r==a)i=0;else{switch(r){case e:i=(t-n)/d+(t<n?6:0);break;case t:i=(n-e)/d+2;break;case n:i=(e-t)/d+4}i/=6}return{h:i,s:o,v:s}}function w(e,t,n,i){var o=[r(p(e).toString(16)),r(p(t).toString(16)),r(p(n).toString(16))];return i&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0):o.join("")}function E(e,t,n,i){var o;return[r((o=i,Math.round(255*parseFloat(o)).toString(16))),r(p(e).toString(16)),r(p(t).toString(16)),r(p(n).toString(16))].join("")}m.fromRatio=function(e,t){if("object"==typeof e){var n={};for(var i in e)e.hasOwnProperty(i)&&(n[i]="a"===i?e[i]:I(e[i]));e=n}return m(e,t)},m.equals=function(e,t){return!(!e||!t)&&m(e).toRgbString()==m(t).toRgbString()},m.random=function(){return m.fromRatio({r:e(),g:e(),b:e()})},m.desaturate=function(e,t){t=0===t?0:t||10;var n=m(e).toHsl();return n.s-=t/100,n.s=o(n.s),m(n)},m.saturate=function(e,t){t=0===t?0:t||10;var n=m(e).toHsl();return n.s+=t/100,n.s=o(n.s),m(n)},m.greyscale=function(e){return m.desaturate(e,100)},m.lighten=function(e,t){t=0===t?0:t||10;var n=m(e).toHsl();return n.l+=t/100,n.l=o(n.l),m(n)},m.darken=function(e,t){t=0===t?0:t||10;var n=m(e).toHsl();return n.l-=t/100,n.l=o(n.l),m(n)},m.complement=function(e){var t=m(e).toHsl();return t.h=(t.h+180)%360,m(t)},m.triad=function(e){var t=m(e).toHsl(),n=t.h;return[m(e),m({h:(n+120)%360,s:t.s,l:t.l}),m({h:(n+240)%360,s:t.s,l:t.l})]},m.tetrad=function(e){var t=m(e).toHsl(),n=t.h;return[m(e),m({h:(n+90)%360,s:t.s,l:t.l}),m({h:(n+180)%360,s:t.s,l:t.l}),m({h:(n+270)%360,s:t.s,l:t.l})]},m.splitcomplement=function(e){var t=m(e).toHsl(),n=t.h;return[m(e),m({h:(n+72)%360,s:t.s,l:t.l}),m({h:(n+216)%360,s:t.s,l:t.l})]},m.analogous=function(e,t,n){t=t||6,n=n||30;var i=m(e).toHsl(),o=360/n,r=[m(e)];for(i.h=(i.h-(o*t>>1)+720)%360;--t;)i.h=(i.h+o)%360,r.push(m(i));return r},m.monochromatic=function(e,t){t=t||6;for(var n=m(e).toHsv(),i=n.h,o=n.s,r=n.v,a=[],s=1/t;t--;)a.push(m({h:i,s:o,v:r})),r=(r+s)%1;return a},m.readability=function(e,t){var n=m(e).toRgb(),i=m(t).toRgb(),o=(299*n.r+587*n.g+114*n.b)/1e3,r=(299*i.r+587*i.g+114*i.b)/1e3,a=Math.max(n.r,i.r)-Math.min(n.r,i.r)+Math.max(n.g,i.g)-Math.min(n.g,i.g)+Math.max(n.b,i.b)-Math.min(n.b,i.b);return{brightness:Math.abs(o-r),color:a}},m.readable=function(e,t){var n=m.readability(e,t);return 125<n.brightness&&500<n.color},m.mostReadable=function(e,t){for(var n=null,i=0,o=!1,r=0;r<t.length;r++){var a=m.readability(e,t[r]),s=125<a.brightness&&500<a.color,d=a.brightness/125*3+a.color/500;(s&&!o||s&&o&&i<d||!s&&!o&&i<d)&&(o=s,i=d,n=m(t[r]))}return n};var b=m.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},y=m.hexNames=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}(b);function W(e){return e=parseFloat(e),(isNaN(e)||e<0||1<e)&&(e=1),e}function C(e,t){var n;"string"==typeof(n=e)&&-1!=n.indexOf(".")&&1===parseFloat(n)&&(e="100%");var i,o="string"==typeof(i=e)&&-1!=i.indexOf("%");return e=f(t,h(0,parseFloat(e))),o&&(e=parseInt(e*t,10)/100),u.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function o(e){return f(1,h(0,e))}function S(e){return parseInt(e,16)}function r(e){return 1==e.length?"0"+e:""+e}function I(e){return e<=1&&(e=100*e+"%"),e}var t,n,a,O=(n="[\\s|\\(]+("+(t="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?",a="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?",{rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+a),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+a),hsv:new RegExp("hsv"+n),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});$e.tinycolor=m}(),Ae(function(){Ae.fn.spectrum.load&&Ae.fn.spectrum.processNativeColorInputs()})}(window,jQuery);