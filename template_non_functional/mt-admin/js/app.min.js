"use strict";angular.module("core.library.deviceDetection",[]).run(["deviceDetectionService","$document",function(e,t){e.isMobileDevice()?angular.element(t[0].body).addClass("moto-mobile-device"):angular.element(t[0].body).addClass("moto-desktop-device")}]),angular.module("core.library.dragDrop",[]),angular.module("core.library.editor.history",[]).run(["EditorHistoryManager",function(e){e.registerAction({name:"createWidget",inverseName:"removeWidget",run:function(e,t,o){e._silentMode=!0,e.ContentManager.insertOrMoveWidgetByOptions({droppedWidgetOptions:{isNew:!0,options:{properties:t.properties,children:angular.copy(t.children),widgetId:t.id},widgetName:t.name},targetConfig:{targetWidgetId:t.parent,indexInContainer:t.position},needToSelect:!1,callback:function(){e._silentMode=!1,o()}})},transformDataFromInverseAction:function(e,t){return e.getWidgetById(t.id).exportForHistory()}}),e.registerAction({name:"removeWidget",inverseName:"createWidget",run:function(e,t,o){e.destroyWidget(t.id),o()},transformDataFromInverseAction:function(e,t){return delete t.properties,delete t.children,t}}),e.registerAction({name:"setProperties",run:function(e,t,o){var i=e.getWidgetById(t.id);i?i.setProperties(t.properties).then(o):o()},transformDataFromInverseAction:function(e,t){var o,i=e.getWidgetById(t.id);if(!i)return t;for(o in t.properties)t.properties.hasOwnProperty(o)&&(t.properties[o]=angular.copy(i.properties[o]));return t}}),e.registerAction({name:"moveWidget",run:function(e,t,o){var i=e.getWidgetById(t.id),r=i.getLocationInEditor(),n=t.indexInContainer;r.parentWidgetId===t.targetWidgetId&&t.indexInContainer>r.indexInContainer&&n++,e.ContentManager.insertOrMoveWidgetByOptions({droppedWidgetOptions:{widget:i,widgetName:i.name},targetConfig:{targetWidgetId:t.targetWidgetId,indexInContainer:n},needToSelect:!1,callback:o})},transformDataFromInverseAction:function(e,t){var o=e.getWidgetById(t.id).getLocationInEditor();return t.targetWidgetId=o.parentWidgetId,t.indexInContainer=o.indexInContainer,t}})}]),angular.module("core.library.editor",["core.library.jsonrpc","core.library.config","core.library.interceptors","core.library.Features","motoUI.Menu","core.library.editor.history"]).value("MotoEditorValues",{copiedWidget:null}),angular.module("core.library",[]),angular.module("core.library.interceptors",[]),angular.module("core.library.messenger",["ngSanitize"]),angular.module("core.library.utils",["core.library.modal","core.library.config"]),angular.module("core.library.validate",["pascalprecht.translate"]),angular.module("core.library.viewportInitialScale",[]),angular.module("core.library.widget.editor",["core.library.config","core.library.utils","core.library.editor","core.library.PathResolver"]),angular.module("core.library.Widget",["core.library.Features","pascalprecht.translate","core.library.config","core.library.utils","core.library.editor","core.library.PathResolver","core.library.widget.editor","core.library.jsonrpc","application.design","application.templates"]),angular.module("core.library.Accounts",["core.library.utils","core.library.storage","core.library.languages","angular-jwt"]).provider("coreLibraryAccounts",["coreLibraryUtilsProvider","coreLibraryLanguagesProvider","coreLibraryConfigProvider","$translateProvider",function(r,o,n,a){var i,s,l={debug:!1,expOffset:21600,appId:"",authUrl:"",productInfoUrl:""};function e(e){l.debug&&(console.warn("Accounts send",e),console.warn("message.data",e.data),console.warn("message.origin",e.origin),console.warn("message.lastEventId",e.lastEventId),console.warn("message.source",e.source),console.warn("message.ports",e.ports),window.$lastPostMessage=e),s?s._processMessage(e):l.debug&&console.warn("serviceInstance not found")}function c(e,t,o,i){this._$rootScope=e,this._$location=t,this._jwtHelper=o,this._MotoLocalStorage=i,this._initRawAccessToken()}this.setOptions=function(e){var t;if(!angular.isObject(e))return!1;for(t in e)e.hasOwnProperty(t)&&this.setOption(t,e[t]);return!0},this.setOption=function(e,t){return!!angular.isString(e)&&(!angular.isUndefined(l[e])&&(r.getTypeOff(l[e])===r.getTypeOff(t)&&(l[e]=t,!0)))},window.addEventListener?window.addEventListener("message",e,!1):window.attachEvent("onmessage",e),c.prototype._accessToken="",c.prototype._$rootScope=null,c.prototype._jwtHelper=null,c.prototype._MotoLocalStorage=null,c.prototype._initRawAccessToken=function(){this._accessToken=this._MotoLocalStorage.getValue("module-accounts-access_token"),this.isExpiredToken()&&this.dropAccessToken()},c.prototype._processMessage=function(e){var t,o;return l.debug&&console.info("_processMessage (event)",e),e instanceof MessageEvent?"https://accounts.motocms.com"!==e.origin?(l.debug&&console.info('_processMessage : ignore by "origin"'),!1):(t=e.data,angular.isString(t)&&(t=angular.fromJson(t)),angular.isObject(t)?"accounts"!==t.module?(l.debug&&console.info('_processMessage : ignore by "message.module"'),!1):angular.isObject(t.body)?angular.isString(t.action)&&t.action.length?("setToken"===t.action&&(o=t.body.access_token,this.setAccessToken(o)),void("setProductInfo"===t.action&&this._$rootScope.$broadcast("$motoAccounts.ProductInfoWasReceived",t.body.productInfo))):(l.debug&&console.info('_processMessage : ignore by "message.action"'),!1):(l.debug&&console.info('_processMessage : ignore by "message.body"'),!1):(l.debug&&console.info("_processMessage : message not object",t),!1)):(l.debug&&console.info('_processMessage : ignore by "instanceof"'),!1)},c.prototype.dropAccessToken=function(){this._accessToken="",this._MotoLocalStorage.setValue("module-accounts-access_token","")},c.prototype._decodeToken=function(e){try{return angular.isUndefined(e)&&(e=this._accessToken),angular.isString(e)?this._jwtHelper.decodeToken(e):null}catch(e){}return null},c.prototype.setAccessToken=function(e){var t=this._decodeToken(e);return l.debug&&(console.info("setAccessToken : token",e),console.info("setAccessToken : token",t)),!!t&&(this._accessToken=e,this._$rootScope.$broadcast("$motoAccounts.AccessTokenWasChanged",e),this._MotoLocalStorage.setValue("module-accounts-access_token",e),!0)},c.prototype.getAccessToken=function(){return this._accessToken},c.prototype.isTokenExists=function(){return!!this._decodeToken()},c.prototype.isExpiredToken=function(){return!this.isTokenExists()||this._jwtHelper.isTokenExpired(this._accessToken,l.expOffset)},c.prototype.getTokenExpirationDate=function(){var e=null;return this.isTokenExists()&&(e=this._jwtHelper.getTokenExpirationDate(this._accessToken)),e instanceof Date&&e.setTime(e.getTime()-1e3*l.expOffset),e},c.prototype.getTokenData=function(e){var t=this._decodeToken();return t?angular.isDefined(e)?angular.isString(e)?t[e]:null:t:null},c.prototype.setDefaultProductInformation=function(e){i=e},c.prototype.encodeRequest=function(e){var t;return angular.isObject(e)?(t=angular.toJson(e),t=r.base64Encode(t)):null},c.prototype.getAuthUrl=function(e){var t=l.authUrl;return l.debug&&console.info('getAuthUrl : "productInformation"',e),l.debug&&console.info('getAuthUrl : "_options.authUrl"',l.authUrl),angular.isUndefined(e)&&(e=i),angular.isObject(e)?(t+="?app_id="+l.appId,t+="&lang="+o.getProfileCode(),t+="&language_locale="+o.getProfileLocale(),t+="&request="+encodeURIComponent(this.encodeRequest(e)),l.debug&&console.info("getAuthUrl : return",t),t):null},c.prototype.getProductInfoUrl=function(){var e=l.productInfoUrl,t=n.get("currentTheme"),o=t?t.template_id:"",i=n.get("environment",{});return i.location=this._$location.absUrl(),i.currentTheme=t,e+="?app_id="+l.appId,e+="&language_locale="+a.use(),e+="&template_id="+o,e+="&environment="+encodeURIComponent(r.base64Encode(angular.toJson(i)))},this.$get=["$rootScope","$location","jwtHelper","MotoLocalStorage",function(e,t,o,i){return s||(s=new c(e,t,o,i)),s}]}]),angular.module("core.library.brand",["pascalprecht.translate","core.library.Features","kr.ngNamespaceUrl"]),angular.module("core.library.brand").provider("motoBrand",["$translateProvider","motoFeaturesProvider","$namespaceUrlProvider",function(t,o,i){var r=this,n=!1,a={},e={};r.getMediaUrl=e.getMediaUrl=function(e){var t=function e(t,o,i){if(angular.isUndefined(i)&&(i=null),!angular.isObject(t))return i;if(!angular.isUndefined(t[o]))return t[o];var r=angular.isArray(o)?o:o.split("."),n=r.shift();return angular.isUndefined(t[n])?i:e(t[n],r,i)}(a.media,e),o="@adminImages/"+e;return t&&(o=t.path),i.url(o)},r.addTranslations=function(e){angular.isObject(e)&&(angular.isUndefined(e.BRAND)&&(e={BRAND:e}),t.translations("en_US",e),t.translations("en",e),t.translations(e))},r.addFeatures=function(e){angular.isObject(e)&&o.addList(e)},r.getName=function(){return a.name},e.getName=r.getName,r.bootstrap=function(e){n||(a=e,angular.isObject(a.features)&&r.addFeatures(a.features),angular.isObject(a.translations)&&r.addTranslations(a.translations),n=!0)},this.$get=[function(){return e}]}]);try{angular.module("application.config.value")}catch(e){angular.module("application.config.value",["ng"]).constant("application.config.value",null)}angular.module("core.library.config",["application.config.value"]).provider("coreLibraryConfig",["application.config.value",function(e){var t,o,i,r,n=this,a={},s="production",l=(new Date).getTime(),c=!1;function p(e,t){var o,i,r=[],n=null;for(e&&angular.isString(e)&&(n=a,r=e.split("."),i=t?r.length-1:r.length),o=0;o<i;o++){if(!r[o]||!n.hasOwnProperty(r[o])){n=null;break}n=n[r[o]]}return t&&n&&n.hasOwnProperty(r[o])&&(n=n[r[o]]=angular.copy(t)),n}function d(e,t,o){var i,r,n,a;if(angular.isNumber(t)){if(isNaN(t))return o;t+=""}if(!angular.isString(t)||t.length<1)return o;if(angular.isDefined(e[t]))return e[t];a=t.split(".");try{for(r=e,i=0,n=a.length;i<n;i++)angular.isDefined(r)&&(r=r[a[i]]);if(angular.isDefined(r))return r}catch(e){}return o}function u(e,t,o){var i,r,n,a;if(angular.isNumber(t)){if(isNaN(t))return!1;t+=""}if(!angular.isString(t)||t.length<1)return!1;if(angular.isDefined(e[t]))return e[t]=o,!0;n=t.split(".");try{for(i=0,r=n.length;i<r&&(a=n[i],i!==r-1);i++){if(angular.isUndefined(e[a]))e[a]={};else if(!angular.isObject(e[a])||angular.isArray(e[a]))return!1;e=e[a]}e[a]=o}catch(e){console.error(e)}return!0}function g(e,t,o){var i,r,n,a;if(angular.isNumber(t)){if(isNaN(t))return!1;t+=""}if(!angular.isString(t)||t.length<1)return!1;if(angular.isDefined(e[t]))return angular.extend(e[t],o),!0;n=t.split(".");try{for(i=0,r=n.length;i<r&&(a=n[i],i!==r-1);i++){if(angular.isUndefined(e[a]))e[a]={};else if(!angular.isObject(e[a])||angular.isArray(e[a]))return!1;e=e[a]}angular.extend(e[a],o)}catch(e){console.error(e)}return!0}a=angular.isObject(e)?e:app.config||a,angular.isDefined(a.env)&&-1!==["development","testing"].indexOf(a.env)&&(s=a.env),t="development"===s,o="testing"===s,i="production"===s,angular.isDefined(a.isDemoMode)&&(c=a.isDemoMode),r=d(a,"settings.website.features"),angular.isString(r)&&(r=angular.fromJson(r),angular.isObject(r)&&(a.settings.website.features=r)),r=d(a,"__features__"),angular.isString(r)&&(r=angular.fromJson(r),angular.isObject(r)&&(a.__features__=r)),this.isDevelopment=function(){return t},this.isTesting=function(){return o},this.isProduction=function(){return i},this.isDemoMode=function(){return c},this.getStage=function(){return s},this.get=function(e,t){var o;return(o=d(a,e,t))&&(o=angular.copy(o)),o},this.exists=function(e){return function(e,t){var o,i,r;if(angular.isNumber(t)){if(isNaN(t))return!1;t+=""}if(!angular.isString(t)||t.length<1)return!1;if(angular.isDefined(e[t]))return!0;for(o=0,i=(r=t.split(".")).length;o<i;o++){if(angular.isUndefined(e[r[o]]))return!1;e=e[r[o]]}return!0}(a,e)},this.update=function(e,t){try{t=angular.copy(t)}catch(e){return!1}return app&&app.config&&u(app.config,e,t),u(a,e,t)},this.extend=function(e,t){try{t=angular.copy(t)}catch(e){return!1}return app&&app.config&&g(app.config,e,t),g(a,e,t)},this.getBuild=function(){return parseInt(d(a,"settings.system.build",l))},this.getVersion=function(){return d(a,"settings.system.version","3.1.6")},this.key=function(e){return a.hasOwnProperty(e)?a[e]:null},this.keyPath=function(e,t){return p(e)||(angular.isDefined(t)?t:null)},this.setValueByPath=function(e,t){return!(!angular.isDefined(t)||!p(e,t))},this.$get=[function(){return{isDevelopment:n.isDevelopment,isTesting:n.isTesting,isProduction:n.isProduction,isDemoMode:n.isDemoMode,getStage:n.getStage,get:n.get,exists:n.exists,update:n.update,extend:n.extend,getBuild:n.getBuild,getVersion:n.getVersion,key:n.key,keyPath:n.keyPath,setValueByPath:n.setValueByPath}}]}]),angular.module("core.library").service("coreLibraryContentSection",["jsonrpc",function(e){var t=e.newService("ContentSection");this.getSettings=t.createMethod("getSettings"),this.setSettings=t.createMethod("setSettings")}]),angular.module("core.library.CssGenerator",["application.design","core.library.editor","core.library.Widget"]).provider("coreLibraryCssGenerator",function(){var c,p,d,t,u,g,m,f,h,y,n=!1,a={colors:{},spacings:{},themeGrid:{},headings:{}},o={};function s(t,o){return t.isLoaded?t.deferred.resolve():t.isLoading||(t.deferred=m.defer(),t.isLoading=!0,g({method:"GET",cache:c,url:t.path,headers:{Accept:"text/plain"},transformResponse:function(e){return e}}).then(function(e){e&&e.data&&("nunjucks"===o?t.compiler=y.getTemplateCompiler("nunjucks")(e.data):"less"===o&&(t.getLess=e.data),t.isLoading=!1,t.isLoaded=!0,t.deferred.resolve())})),t.deferred.promise}function l(e){return o[e]}function b(e,t){var o;return(o=l(e))?"nunjucks"===o.engine?o.compiler.render(t):o.getLess:""}function _(e){var t,o,i=0,r=m.defer();function n(){++i==e.length&&r.resolve()}for(t=0;t<e.length;t++)!(o=l(e[t]))||o.isLoaded?n():s(o,o.engine).then(n);return r.promise}function i(e){o[e.name]||(o[e.name]={path:e.path,engine:e.engine,isLoaded:!1,isLoading:!1})}function v(e){return"widget_"+e}function E(e){var t,o;(o=p.getWidget(e))&&(t=o.template,i({name:v(e),path:t.path,engine:t.engine}))}function w(){i({name:"constants",path:"@systemWebsiteStyleLessDir/constants.less",engine:"less"}),i({name:"grid",path:"@systemWebsiteStyleLessDir/grid.less",engine:"less"}),i({name:"base",path:"@systemWebsiteStyleLessDir/base.less",engine:"less"}),i({name:"spacings",path:"@systemWebsiteStyleLessDir/spacings.less",engine:"less"}),i({name:"website",path:"@userLessDir/variables/website.less",engine:"less"}),i({name:"colorizer",path:"@userLessDir/variables/colorizer.less",engine:"less"}),i({name:"item",path:"@lessTemplates/styler/item.less.twig",engine:"nunjucks"}),i({name:"theme",path:"@currentTheme/less/styles.less",engine:"less"})}w.prototype={setSpacing:function(e){var i,r;e&&e.forIn(function(o,e){e.forIn(function(e,t){i="@spacing_"+o+"_"+e,r=t?(t+"").replace("px","")+"px":"''",a.spacings[i]=r})})},setGrid:function(e){e&&(a.themeGrid["@grid-gutter-width"]=e["gutter-width"],a.themeGrid["@grid-fixed-row-width"]=e["fixed-row-width"])},setHeadingSpacings:function(e){e&&(a.headings["@spacing_heading1"]=e.heading1,a.headings["@spacing_heading2"]=e.heading2,a.headings["@spacing_heading3"]=e.heading3,a.headings["@spacing_heading4"]=e.heading4)},setColorsTheme:function(e){e&&(n=!0,e.getVariables().forIn(function(e,t){a.colors[e]=t}))},_compileLess:function(e,i){t.parse(e,function(e,t){var o;if(e)return console.error(e),!1;(o=t.toCSS())&&i&&i(o)})},css:function(t){var o,i,r,e=this;t=t||{},r=["constants","website","spacings","base","grid","theme","item"],h.objects().forEach(function(e){E(e.widget_name),r.push(v(e.widget_name))}),_(r).then(function(){o=b("constants"),o+=b("website"),n||e.setColorsTheme(f.objects().first()),a.colors.forIn(function(e,t){o+=e+": "+t+";\n"}),a.spacings.forIn(function(e,t){o+=e+": "+t+";\n"}),o+=b("spacings"),o+=b("base"),a.themeGrid.forIn(function(e,t){o+=e+": "+t+";\n"}),o+=b("grid"),o+=b("theme"),a.headings.forIn(function(e,t){o+=e+": "+t+";\n"}),u.objects().forEach(function(e){i=t.stylesRecord&&t.stylesRecord.id==e.id?t.stylesRecord:e,o+=b("item",{item:i,link:i.link||null})}),h.objects().forEach(function(e){i=t.widgetPreset&&t.widgetPreset.id==e.id?t.widgetPreset:e,o+=b(v(i.widget_name),{item:i})}),e._compileLess(o,t.callback)})},renderPresetStyles:function(o){var i;E(o.widgetPreset.widget_name),_(["colorizer","constants","website",v(o.widgetPreset.widget_name)]).then(function(){i=b("colorizer"),i+=b("constants"),i+=b("website"),n&&a.colors.forIn(function(e,t){i+=e+": "+t+";\n"}),i+=b(v(o.widgetPreset.widget_name),{item:o.widgetPreset}),t.parse(i,function(e,t){o.callback(t.toCSS().trim(),!0)})})},renderSpacingsStyles:function(o){var i;this.setSpacing(o.spacings),_(["constants","website","spacings","grid"]).then(function(){i=b("constants"),i+=b("website"),i+=b("spacings"),i+=b("grid"),a.spacings.forIn(function(e,t){i+=e+": "+t+";\n"}),a.headings.forIn(function(e,t){i+=e+": "+t+";\n"}),a.themeGrid.forIn(function(e,t){i+=e+": "+t+";\n"}),t.parse(i,function(e,t){o.callback(t.toCSS(),!0)})})},renderGridStyles:function(o){var i;this.setGrid(o.themeGrid),_(["constants","website","grid"]).then(function(){i=b("constants"),i+=b("website"),a.themeGrid.forIn(function(e,t){i+=e+": "+t+";\n"}),i+=b("grid"),t.parse(i,function(e,t){o.callback(t.toCSS(),!0)})})},renderHeadingSpacingsStyles:function(o){var i;this.setHeadingSpacings(o.spacings),_(["constants","website","spacings","grid"]).then(function(){i=b("constants"),i+=b("website"),i+=b("spacings"),i+=b("grid"),a.headings.forIn(function(e,t){i+=e+": "+t+";\n"}),a.themeGrid.forIn(function(e,t){i+=e+": "+t+";\n"}),t.parse(i,function(e,t){o.callback(t.toCSS(),!0)})})},renderStylesRecord:function(o){var i;_(["colorizer","constants","website","item"]).then(function(){i=b("colorizer"),i+=b("constants"),i+=b("website"),n&&a.colors.forIn(function(e,t){i+=e+": "+t+";\n"}),i+=b("item",{item:o.stylesRecord,link:o.stylesRecord.link||null}),t.parse(i,function(e,t){o.callback(t.toCSS(),!0)})})}},t=new less.Parser,this.$get=["core.library.styles.StylesModel","application.design.colorizer.DesignColorizerModel","core.library.editor.PresetsModel","$http","$q","$templateCache","core.library.editor.PresetsService","motoFeatures","coreLibraryWidget",function(e,t,o,i,r,n,a,s,l){return u=e,f=t,h=o,g=i,m=r,c=n,p=a,y=l,d||(d=new w),d}]}),angular.module("core.library.CurrentValue",[]).service("CurrentValue",[function(){var i={};return{get:function(e,t,o){return i.hasOwnProperty(e)&&i[e].hasOwnProperty(t)?i[e][t]:o},set:function(e,t,o){return i.hasOwnProperty(e)||(i[e]={}),i[e][t]=o,this},clear:function(e,t){i.hasOwnProperty(e)&&delete i[e][t]}}}]),angular.module("core.library.deviceDetection").service("deviceDetectionService",["viewportInitialScaleService",function(e){var t={isMobileDevice:function(){return t.isTouchDevice()&&!e.isDesktop()},isDesktopDevice:function(){return!t.isMobileDevice()},isTouchDevice:function(){return Boolean("ontouchstart"in window||navigator.maxTouchPoints)}};return t}]),angular.module("core.library.dragDrop").provider("dragDropBoxService",function(){this.$get=[function(){var o,t,i,r,f,n,a,s=[];return i=function(e,t,o,i,r,n,a,s,l,c,p,d,u,g){e.font=r+"px Calibri";var m=e.measureText(t).width;p&&(e.fillStyle=u),d&&(e.strokeStyle=g),e.strokeStyle="#1f34f6",f(e,o-l,i-r+r/5-c-s,m+2*l,r+2*s,a,p,d),e.fillStyle=n,e.fillText(t,o,i)},f=function(e,t,o,i,r,n,a,s){angular.isUndefined(s)&&(s=!0),angular.isUndefined(n)&&(n=5),e.beginPath(),e.moveTo(t+n,o),e.lineTo(t+i-n,o),e.quadraticCurveTo(t+i,o,t+i,o+n),e.lineTo(t+i,o+r-n),e.quadraticCurveTo(t+i,o+r,t+i-n,o+r),e.lineTo(t+n,o+r),e.quadraticCurveTo(t,o+r,t,o+r-n),e.lineTo(t,o+n),e.quadraticCurveTo(t,o,t+n,o),e.closePath(),s&&e.stroke(),a&&e.fill()},r=function(e,t){(n=document.createElement("canvas")).width=80,n.height=50,(a=n.getContext("2d")).drawImage(o,0,0),i(a,e,30,45,15,"#FFF",3,2,7,0,!0,!1,"#ffab26","#fff111"),s[t]=document.createElement("img"),s[t].src=n.toDataURL()},{drawItemsInCanvas:function(e,t){r(e,t)},init:function(){(o=new Image).crossOrigin="anonymous",o.src=app.config.getUrl("@adminImages/drag-files-image.png"),o.onload=function(){r(1,0)},(t=new Image).src=app.config.getUrl("@adminImages/drag-folder-img.png")},itemsBox:function(){var e,t;return(e=function(e){t=e}).setDragImage=function(e){e.originalEvent.dataTransfer.setDragImage&&(t?e.originalEvent.dataTransfer.setDragImage(s[0],-2,25):e.originalEvent.dataTransfer.setDragImage(s[1],-2,25))},e},foldersBox:function(){var e;return(e=function(){}).setDragImage=function(e){e.originalEvent.dataTransfer.setDragImage&&e.originalEvent.dataTransfer.setDragImage(t,-8,15)},e}}}]}),angular.module("core.library.dragDrop").directive("ngDragDropConfig",[function(){return{restrict:"A",link:function(t,i,e){var o,r,n,a,s,l,c,p,d,u=!1;l=i[0],c=function(){return l.hasOwnProperty("$$ngDragDropItem")?l.$$ngDragDropItem:null},s=function(e){var t,o=c();if("dragstart"==e.type&&(p&&d.apply(p,[o,e,i]),e.originalEvent.dataTransfer.effectAllowed="move",e.originalEvent.dataTransfer.dropEffect="move",l.attachEvent||navigator.userAgent.match(/Trident.*rv\:11\./)?e.originalEvent.dataTransfer.setData("Text",i.html()):e.originalEvent.dataTransfer.setData("text/html",i.html()),p.hasOwnProperty("box")?p.box instanceof Function?p.box.setDragImage(e):"object"==typeof p.box?e.originalEvent.dataTransfer.setDragImage&&e.originalEvent.dataTransfer.setDragImage(p.box,-12,8):e.originalEvent.dataTransfer.setDragImage&&e.originalEvent.dataTransfer.setDragImage(i.context,-12,8):e.originalEvent.dataTransfer.setDragImage&&e.originalEvent.dataTransfer.setDragImage(i.context,-12,8)),p&&(p.cssClass&&("dragenter"!=e.type&&"dragover"!=e.type||("string"==typeof p.cssClass?i.addClass(p.cssClass):p.cssClass instanceof Function&&(t=p.cssClass).apply(p,[e.type,i,e])),"dragleave"!=e.type&&"drop"!=e.type||("string"==typeof p.cssClass?i.removeClass(p.cssClass):p.cssClass instanceof Function&&(t=p.cssClass).apply(p,[e.type,i,e]))),p.hasOwnProperty(e.type)&&(t=p[e.type])instanceof Function))return t.apply(p,[o,e])},n=function(){u||(i.on("drag",s),i.on("dragstart",s),i.on("dragenter",s),i.on("dragleave",s),i.on("dragover",s),i.on("dragend",s),i.on("drop",s),u=!0)},a=function(){u&&(i.off("drag",s),i.off("dragstart",s),i.off("dragenter",s),i.off("dragleave",s),i.off("dragover",s),i.off("dragend",s),i.off("drop",s),u=!1)},o=function(e){return e?"object"!=typeof(p=t.$eval(e))?r():(i.attr("draggable",!0),d=p.beforeStart||angular.noop,n(),!0):r()},r=function(){return a(),i.removeAttr("draggable"),!1},e.$observe("ngDragDropConfig",o),t.$on("$destroy",r)}}}]).directive("ngDragDrop",[function(){return{restrict:"A",require:"^?ngDragDropConfig",link:function(t,e,o){var i,r,n;n=e[0],i=function(e){return r(),n.$$ngDragDropItem=e?t.$eval(e):null,!0},r=function(){return n.hasOwnProperty("$$ngDragDropItem")&&delete n.$$ngDragDropItem,!1},o.$observe("ngDragDrop",i),t.$on("$destroy",r)}}}]),angular.module("core.library.dragDrop").directive("motoDragWidget",[function(){return{restrict:"A",link:function(t,o,e){var i,r,n=!1;function a(e){var t=r&&r.item||null;if(e&&t&&i){if("dragstart"==e.type){i.beforeStart(e,t,o),e.originalEvent.dataTransfer.effectAllowed="move",e.originalEvent.dataTransfer.dropEffect="move",o.get(0);try{e.originalEvent.dataTransfer.setData("text",o.html())}catch(e){}i.hasOwnProperty("box")?i.box instanceof Function?i.box.setDragImage(e):"object"==typeof i.box?e.originalEvent.dataTransfer.setDragImage&&e.originalEvent.dataTransfer.setDragImage(i.box,-12,8):e.originalEvent.dataTransfer.setDragImage&&e.originalEvent.dataTransfer.setDragImage(o.context,-12,8):e.originalEvent.dataTransfer.setDragImage&&e.originalEvent.dataTransfer.setDragImage(o.context,-12,8)}return i.cssClass&&("dragenter"!=e.type&&"dragover"!=e.type||("string"==typeof i.cssClass?o.addClass(i.cssClass):i.cssClass instanceof Function&&i.cssClass.apply(i,[e.type,o,e])),"dragleave"!=e.type&&"drop"!=e.type||("string"==typeof i.cssClass?o.removeClass(i.cssClass):i.cssClass instanceof Function&&i.cssClass.apply(i,[e.type,o,e]))),angular.isFunction(i[e.type])?i[e.type](e,t,o):void 0}}function s(){return n&&(o.off("drag",a),o.off("dragstart",a),o.off("dragenter",a),o.off("dragleave",a),o.off("dragover",a),o.off("dragend",a),o.off("drop",a),n=!1),o.removeAttr("draggable"),!1}e.$observe("motoDragWidget",function(e){return e?(r=t.$eval(e),angular.isObject(r)&&angular.isObject(r.item)&&angular.isObject(r.callbacks)?(i=r.callbacks,o.attr("draggable",!0),i.beforeStart=angular.isFunction(i.beforeStart)?i.beforeStart:function(){},n||(o.on("drag",a),o.on("dragstart",a),o.on("dragenter",a),o.on("dragleave",a),o.on("dragover",a),o.on("dragend",a),o.on("drop",a),n=!0),!0):s()):s()}),t.$on("$destroy",s)}}}]),angular.module("core.library.editor").provider("core.library.editor.BlocksService",["coreLibraryUtilsProvider",function(i){var r,n,a,s,l,o,c=this,e=[{name:"headers",label:"WIDGET.BLOCK.CATEGORY.HEADERS",order:5,blocks:[]},{name:"galleries",label:"WIDGET.BLOCK.CATEGORY.GALLERIES",order:10,blocks:[]},{name:"call_to_action",label:"WIDGET.BLOCK.CATEGORY.CALL_TO_ACTION",order:15,blocks:[]},{name:"general",label:"WIDGET.BLOCK.CATEGORY.GENERAL",order:20,blocks:[]},{name:"price_tables",label:"WIDGET.BLOCK.CATEGORY.PRICE_TABLES",order:25,blocks:[]},{name:"counters",label:"WIDGET.BLOCK.CATEGORY.COUNTERS",order:30,blocks:[]},{name:"teams",label:"WIDGET.BLOCK.CATEGORY.TEAMS",order:35,blocks:[]},{name:"partners_and_clients",label:"WIDGET.BLOCK.CATEGORY.PARTNERS_AND_CLIENTS",order:40,blocks:[]},{name:"testimonials",label:"WIDGET.BLOCK.CATEGORY.TESTIMONIALS",order:45,blocks:[]},{name:"contacts",label:"WIDGET.BLOCK.CATEGORY.CONTACTS",order:50,blocks:[]},{name:"footers",label:"WIDGET.BLOCK.CATEGORY.FOOTERS",order:55,blocks:[]},{name:"more",label:"WIDGET.BLOCK.CATEGORY.MORE",order:60,blocks:[]},{name:"user_blocks",label:"WIDGET.BLOCK.CATEGORY.USER_BLOCKS",order:100,blocks:[]}];function p(e,t){if(this._collection=t,e=angular.extend({},s,e||{}),angular.extend(this,e),this._category=t.getCategoryByName(this.category),angular.isArray(this.allowed))for(var o=0,i=this.allowed.length;o<i;o++)angular.isString(this.allowed[o].pageType)&&(this.allowed[o].pageType=[this.allowed[o].pageType]),angular.isString(this.allowed[o].sectionName)&&(this.allowed[o].sectionName=[this.allowed[o].sectionName]);if(this._meta={},this.previewUrl){this.previewUrl=app.config.getUrl(this.previewUrl);var r=this.previewUrl.split("/");this._meta.previewFileName=r.pop(),this._meta.previewFilePath=r.join("/")}}function d(){this.isLoaded=!1,this.items=[],this.categories=angular.copy(e),this.addCategory=function(e){var t;return!(!e||this.isCategoryExists(e.name))&&(t=$.extend(!0,{},l,e),this.categories.push(t),r.$broadcast("MotoEvent:BlocksService.CategoryAdded",t),t)},this.isCategoryExists=function(t){return this.categories.some(function(e){return e.name===t})},this.getCategoryByName=function(t){var o;return this.isCategoryExists(t)?this.categories.some(function(e){e.name===t&&(o=e)}):o=this.addCategory($.extend(!0,{},l,{name:t})),o},this.getCategories=function(){return this.categories},this.addBlock=function(e){var t,o;return t=this.getCategoryByName(e.category),o=new p(e,this),this.items.push(o),t.blocks.push(o),i.sortArrayByProperty(t.blocks,"created_at"),r.$broadcast("MotoEvent:BlocksService.BlockAdded",o),o},this.deleteBlock=function(o){var i;return(i=this.getCategoryByName(o.category)).blocks.every(function(e,t){return e.id!==o.id||(i.blocks.splice(t,1),!1)}),!0},this.getBlocksByCategory=function(e){return this.getCategoryByName(e).blocks},this.getBlocks=function(e){var t=a.defer();e=e||!1;return o&&o.isLoaded&&!e?t.resolve(o):n.newService("BlocksService").createMethod("getList",{ignoreLoadingBar:!0})().then(function(e){e.items&&e.items.length&&e.items.forEach(function(e){o.addBlock(e)}),o.isLoaded=!0,r.$broadcast("MotoEvent:BlocksService.FilledFromServer"),t.resolve(o)}),t.promise},this.syncWithServer=function(){return this.clearCollectionData(),this.getBlocks(!0)},this.clearCollectionData=function(){return this.items=[],this.categories=angular.copy(e),this}}s={id:"",previewUrl:"",category:"more",order:50,options:{templateUrl:""}},l={name:"",label:"",order:80,blocks:[]},p.prototype={_collection:null,_category:null,_meta:{},id:"",previewUrl:"",category:"more",allowed:!0,order:50,options:{templateUrl:""},getPreviewFileName:function(){return this._meta.previewFileName},getPreviewFilePath:function(){return this._meta.previewFilePath},getCategoryName:function(){return this.category},getCategory:function(){return this._category},isAllowToUse:function(e,t){if(t=t||null,!angular.isArray(this.allowed))return this.allowed;var o,i,r,n=!1,a=this.allowed;for(i=0,r=a.length;i<r&&(o=a[i],e&&o.pageType?(n=-1<o.pageType.indexOf(e),t&&o.sectionName&&(n&=-1<o.sectionName.indexOf(t))):t&&o.sectionName&&(n=-1<o.sectionName.indexOf(t)),!n);i++);return n},getAllowedSections:function(e){var o=[];if(!angular.isArray(this.allowed))return o;var t,i,r,n=this.allowed;for(i=0,r=n.length;i<r;i++)if(t=n[i],!e||angular.isUndefined(t.pageType)||-1!=t.pageType.indexOf(e)){if(!t.sectionName){o=[];break}o=o.concat(t.sectionName)}return 0<o.length&&(o=o.filter(function(e,t){return o.indexOf(e)==t})),o}},o=new d,c.getBlocks=function(){return o.getBlocks()},c.syncWithServer=function(){return o.syncWithServer()},c.addCategory=function(e){return o.addCategory(e)},c.addBlock=function(e){return o.addBlock(e)},c.deleteBlock=function(e){return o.deleteBlock(e)},c.saveToTheme=function(e){var t=!e.id;return o.saveToTheme(e).then(function(e){return t&&(e=o.addBlock(e)),e})},c.deleteFromTheme=function(e){return o.deleteFromTheme(e).then(function(){c.deleteBlock(e)})},c.$get=["$rootScope","jsonrpc","$q",function(e,t,o){return r=e,a=o,d.prototype._Service=(n=t).newService("BlocksService"),d.prototype.saveToTheme=d.prototype._Service.createMethod("saveToTheme"),d.prototype.deleteFromTheme=d.prototype._Service.createMethod("deleteFromTheme"),c}]}]),angular.module("core.library.editor").factory("core.library.editor.BlocksTabClass",["$q","motoFeatures","core.library.editor.BlocksService","core.library.editor.ElementsTabClass",function(e,t,o,i){function r(){i.apply(this,arguments)}return(r.prototype=Object.create(i.prototype)).name="blocks",r.prototype.template="blocks",r.prototype.label="WIDGET.BLOCK.BLOCKS_TEXT",r.prototype.enabled=t.isEnabled("theme_widget_block"),r.prototype.loadContent=function(){var t=e.defer();return o.getBlocks().then(function(e){this._content=e.categories,this._content=angular.copy(this._content),this.updateContent(),t.resolve()}.bind(this),function(){t.reject()}),t.promise},r.prototype.updateContent=function(){var t,o=this;o.content.length=0,angular.forEach(this._content,function(e){e.blocks.length<1||(t={label:e.label,name:e.name,order:e.order},o.isAllowed("Category",t,!0)&&(t.items=[],angular.forEach(e.blocks,function(e){e.isAllowToUse(o._panel._cache.ContentEntityType,o._panel._cache.ContentSectionName)&&!1!==o.isAllowed("Block",e,!0)&&t.items.push(e)}),t.items.length&&o.content.push(t)))})},r}]),angular.module("core.library.editor").factory("core.library.editor.ElementsPanelClass",["$q","$timeout","motoFeatures","core.library.editor.BlocksService","core.library.editor.WidgetsService","core.library.editor.ElementsTabClass","core.library.editor.BlocksTabClass","core.library.editor.WidgetsTabClass",function(t,e,o,i,r,n,a,s){function l(){this._availableTabs=angular.copy(this._availableTabs),this._registeredTabs=angular.copy(this._registeredTabs),this._currentTab=null,this._cache={},this.addTab("blocks",new a),this.addTab("widgets",new s)}return(l.prototype={_loading:!1,_availableTabs:{},_availableTabsCount:0,_registeredTabs:{},_cache:{},_Editor:null,_currentTab:null}).getTab=function(e){return angular.isString(e)&&this._registeredTabs[e]||null},l.prototype.addTab=function(e,t){if(!angular.isString(e))return!1;if(this._registeredTabs[e])return!1;if(!(t instanceof n))throw new Error("Tab must be instanceof ElementsTabClass");return t.attachPanel(this),this._registeredTabs[e]=t,!0},l.prototype.loadContent=function(){var e=t.defer();return this._loading=!0,t.all([this._registeredTabs.blocks.loadContent(),this._registeredTabs.widgets.loadContent()]).then(function(){this.updateAvailableTabs(),this._loading=!1,e.resolve()}.bind(this),function(){this._loading=!1,e.reject()}.bind(this)),e.promise},l.prototype.updateContent=function(){var e=t.defer();return this._updateCache(),t.all([this._registeredTabs.blocks.updateContent(),this._registeredTabs.widgets.updateContent()]).then(function(){this.updateAvailableTabs(),e.resolve()}.bind(this),function(){e.reject()}.bind(this)),e.promise},l.prototype.getAvailableTabs=function(){return this._availableTabs},l.prototype.updateAvailableTabs=function(){this._availableTabs={},this._availableTabsCount=0,angular.forEach(this._registeredTabs,function(e){if(!e.enabled||!e.visible)return this._currentTab===e&&(this._currentTab=null),void(this._availableTabs[e.name]&&delete this._availableTabs[e.name]);this._availableTabs[e.name]=e,this._availableTabsCount++,this._currentTab||this.setCurrentTab(e)}.bind(this))},l.prototype.showAllTabs=function(){angular.forEach(this._registeredTabs,function(e){e.show()}),this.updateAvailableTabs()},l.prototype.showOnlyTabs=function(t){if(angular.isString(t)){if("*"===t)return this.showAllTabs();t=[t]}if(!angular.isArray(t))return!1;angular.forEach(this._registeredTabs,function(e){-1<t.indexOf(e.name)?e.show():e.hide()}),this.updateAvailableTabs()},l.prototype.unsetCurrentTab=function(){this._currentTab=null,this.updateAvailableTabs()},l.prototype.setCurrentTab=function(e){return angular.isString(e)&&(e=this._registeredTabs[e]),!!angular.isObject(e)&&(!(this._availableTabs[e.name]<0)&&(this._currentTab=e,!0))},l.prototype.getCurrentTab=function(){return this._currentTab},l.prototype.getCurrentTabName=function(e){return this._currentTab&&this._currentTab.name||e},l.prototype.connectEditor=function(e){return!this._Editor&&(this._Editor=e,this.updateContent(),!0)},l.prototype.disconnectEditor=function(e){return this._Editor===e&&(this._Editor=null,this._cache={},!0)},l.prototype._updateCache=function(){var e={};this._Editor&&(e.ContentEntity=this._Editor.getContentEntity(),e.ContentSection=this._Editor.getCurrentSection(),e.ContentEntity&&(e.ContentEntityType=e.ContentEntity.type,e.ContentEntityRecord=e.ContentEntity.record),e.ContentSection&&(e.ContentSectionName=e.ContentSection.getSectionName())),this._cache=e},l}]),angular.module("core.library.editor").factory("core.library.editor.ElementsTabClass",[function(){function e(){this._panel=null,this._content=[],this.content=[],this.visible=!!this.enabled,this._filters=[],this._visibilityItems={}}return(e.prototype={name:null,template:null,label:"",enabled:!1,visible:!0,_panel:null,_filters:[],_visibilityItems:{},_defaultVisibility:!0,_content:[],content:[]}).show=function(){this.visible=!!this.enabled},e.prototype.hide=function(){this.visible=!1},e.prototype.loadContent=function(){console.warn('Method "loadContent" no implemented on',this)},e.prototype.updateContent=function(){console.warn('Method "updateContent" no implemented on',this)},e.prototype.isAllowed=function(e,t,o){var i;if(!0!==o&&!1!==o)throw new Error("Defaults must be a boolean value");return i=this._applyFilter("isAllow:"+e,t),angular.isUndefined(i)&&(i=o),i},e.prototype.addFilter=function(e){return angular.isFunction(e)?(this._filters.push(e),!0):(console.warn("Bad argument : filter must be a function"),!1)},e.prototype._applyFilter=function(e,t){var o,i,r={name:e};return angular.forEach(this._filters,function(e){try{o=e.apply(null,[r,t]),angular.isUndefined(o)||(i=o)}catch(e){console.warn("ElementsTab._applyFilter : error on filter"),console.error(e)}}),i},e.prototype.attachPanel=function(e){return!this._panel&&(this._panel=e,!0)},e}]),angular.module("core.library.editor").factory("core.library.editor.WidgetsTabClass",["$q","$timeout","core.library.editor.ElementsTabClass","core.library.editor.WidgetsService",function(i,e,t,r){function n(e,t){this._tab=t,angular.isObject(e)&&angular.extend(this,e)}function o(){t.apply(this,arguments),this._updateTimer=null}return(n.prototype={_tab:null,name:"",label:"",hidden:!1,order:0,widgets:[]}).showAllItems=function(){var t=[];return angular.forEach(this.widgets,function(e){t.push(e.name)}),this._tab.showItems(t)},(o.prototype=Object.create(t.prototype)).name="widgets",o.prototype.template="widgets",o.prototype.label="MODULE.PAGES.WIDGETS",o.prototype.enabled=!0,o.prototype.loadContent=function(){var e,t,o=i.defer();for(this._content=r.getCategories(),this._content=angular.copy(this._content),e=0,t=this._content.length;e<t;e++)this._content[e]=new n(this._content[e],this);return this.updateContent(),o.resolve(),o.promise},o.prototype._isAllowedOnThisContent=function(e){return!this._panel||!(angular.isDefined(this._visibilityItems[e.name])&&!this._visibilityItems[e.name])&&(!!e.enabled&&r.isWidgetAllowedToUse(e.name,this._panel._cache.ContentEntityRecord,this._panel._cache.ContentSectionName))},o.prototype._updateContent=function(){this._updateTimer&&e.cancel(this._updateTimer),this._updateTimer=e(function(){this.updateContent()}.bind(this),50)},o.prototype.updateContent=function(){var t,o=this;this._updateTimer&&e.cancel(this._updateTimer),o.content.length=0,angular.forEach(o._content,function(e){e.widgets.length<1||e.hidden||(t={label:e.label,name:e.name,order:e.order},o.isAllowed("Category",t,!0)&&(t.items=[],angular.forEach(e.widgets,function(e){o._isAllowedOnThisContent(e)&&!1!==o.isAllowed("Widget",e,!0)&&t.items.push(e)}),t.items.length&&o.content.push(t)))})},o.prototype.showAllItems=function(){this._visibilityItems={},this._defaultVisibility=!0,this._updateContent()},o.prototype.showOnlyItems=function(t){var o=this;if(angular.isString(t)){if("*"===t)return this.showAllItems();t=[t]}if(!angular.isArray(t))return!1;this._visibilityItems={},this._defaultVisibility=!1,angular.forEach(this._content,function(e){angular.forEach(e.widgets,function(e){o._visibilityItems[e.name]=-1<t.indexOf(e.name)})}),this._updateContent()},o.prototype.hideItems=function(e){var t;if(angular.isString(e)&&(e=[e]),!angular.isArray(e))return!1;for(t=0;t<e.length;t++)this._visibilityItems[e[t]]=!1;this._updateContent()},o.prototype.showItems=function(e){var t;if(angular.isString(e)){if("*"===e)return this.showAllItems();e=[e]}if(!angular.isArray(e))return!1;for(t=0;t<e.length;t++)this._visibilityItems[e[t]]=!0;this._updateContent()},o.prototype.getCategory=function(e){var t,o;if(!angular.isString(e))return null;for(t=0,o=this._content.length;t<o;t++)if(this._content[t].name===e)return this._content[t];return null},o.prototype.showCategories=function(t,o){angular.isString(t)&&(t=[t]),angular.forEach(this._content,function(e){-1<t.indexOf(e.name)&&(e.hidden=!1,o&&e.showAllItems())}),this._updateContent()},o.prototype.hideCategories=function(t){angular.isString(t)&&(t=[t]),angular.forEach(this._content,function(e){-1<t.indexOf(e.name)&&(e.hidden=!0)}),this._updateContent()},o}]),angular.module("core.library.editor.history").service("EditorHistoryManager",["coreLibraryUtils","$timeout","$q",function(f,h,y){var b,_={};function t(n){var o,i,p,a,s,d=this,l={},u=[],g=[],r=!1,c=!1;function m(){p.options.widgetId&&(a=p.options.widgetId),n.Widgets.checkAndScrollTo(a),d.isUndoInProcess()?g.push(p):u.push(p),h(function(){n.selectWidget(a),c=r=!1,b.resolve(p),p=s=a=b=null})}this.getTransactionInProcess=function(){return p||null},this.isUndoOrRedoInProcess=function(){return this.isUndoInProcess()||this.isRedoInProcess()},this.isUndoInProcess=function(){return r},this.isRedoInProcess=function(){return c},this.clearUndoTransactions=function(){u.length=0},this.clearRedoTransactions=function(){g.length=0},this.startActionsTransaction=function(e,t){return p||this.isUndoOrRedoInProcess()?(p&&!this.isUndoOrRedoInProcess()&&console.warn('Transaction "'+e+'" was not started: "'+p.name+'" already in process.'),!1):(p={name:e,actions:[],options:t||{}},!0)},this.rejectActionsTransaction=function(e){p&&!this.isUndoOrRedoInProcess()&&p.name===e&&(p=null)},this.endActionsTransaction=function(e,t){if(!p||this.isUndoOrRedoInProcess()||p.name!==e)return!1;if(p.actions.length){for(p.options=p.options||{},p.options=angular.extend(p.options,t),u.push(p);50<u.length;)u.shift();this.clearRedoTransactions(),o.$$phase||o.$apply()}return!(p=null)},this.runAction=function(e,t,o,i){e._callInterceptor(e.INTERCEPTOR__UNDO_REDO_ACTION_BEFORE,t,o),_[t].run(e,o,i)},this._executeTransactionActions=function(e){var t,o,i="undo"===e,r={};try{t=i?s.pop():s.shift(),a=t.data.id,r.name=t.name,r.data=t.data,_[(o=t).name].inverseName&&(o.name=_[o.name].inverseName),_[o.name].transformDataFromInverseAction&&(o.data=_[o.name].transformDataFromInverseAction(n,angular.copy(o.data))),d.runAction(n,r.name,r.data,function(){s.length?h(function(){d._executeTransactionActions(e)}):m()})}catch(e){console.error(e),m()}},this._executeTransaction=function(e){var t,o;if(b=y.defer(),this.isUndoOrRedoInProcess())return b.reject(),b.promise;if("undo"===e){if(!u.length)return;r=!0,t=(p=u.pop()).actions.length-1}else if("redo"===e){if(!g.length)return;c=!0,p=g.pop(),t=0}for(s=p.actions,p.actions=[],o=0;o<s.length;o++)p.actions.push(s[o]);return n.Widgets.checkAndScrollTo(p.actions[t].data.id,function(){d._executeTransactionActions(e)}),b.promise},this.addAction=function(e,t){!p||this.isUndoOrRedoInProcess()||_[e].locked||p.actions.push({name:e,data:t})},this.lockAction=function(e){_[e].locked=!0},this.unlockAction=function(e){delete _[e].locked},this.undo=function(){return this._executeTransaction("undo")},this.redo=function(){return this._executeTransaction("redo")},this.getUndoTransactions=function(){return u},this.getRedoTransactions=function(){return g},(o=n.getScope()).$on("NEW EVENT: Insert widget after",function(e,t){d.addAction("removeWidget",{id:t.getId()})}),o.$on("NEW EVENT: Widget will be removed",function(e,t){i=t.exportForHistory()}),o.$on("NEW EVENT: Widget was removed",function(e,t){i&&i.id===t.getId()&&(d.addAction("createWidget",i),i=null)}),o.$on("NEW EVENT: Widget properties were changed",function(e,t,o){var i,r,n,a,s,l,c;if(!d.isUndoOrRedoInProcess()&&t&&t.properties&&o){for(l in s=f.objectDiffQuick(t.properties,o,1),(i=u[u.length-1])&&(a=i.actions[i.actions.length-1]),n=(r=a&&"SetProperties"===i.name&&a.data.id===t.getId()&&!g.length&&!a.redoData)?a.data.properties:{},s)s.hasOwnProperty(l)&&!n.hasOwnProperty(l)&&(n[l]=angular.copy(o[l]));Object.getOwnPropertyNames(n).length&&(r?a.data.properties=n:(p||(c=d.startActionsTransaction("SetProperties")),d.addAction("setProperties",{id:t.getId(),properties:n}),c&&d.endActionsTransaction("SetProperties")))}}),o.$on("NEW EVENT: Move widget before",function(e,t){var o=t.getLocationInEditor();l[t.getId()]={targetWidgetId:o.parentWidgetId,indexInContainer:o.indexInContainer}}),o.$on("NEW EVENT: Move widget after",function(e,t){var o=t.getLocationInEditor(),i=t.getId(),r=l[i];!r||o.parentWidgetId===r.targetWidgetId&&o.indexInContainer===r.indexInContainer||(r.id=i,d.addAction("moveWidget",r)),delete l[i]}),o.$on("NEW EVENT: Editor self destroyed",function(){d.clearUndoTransactions(),d.clearRedoTransactions()})}return this.registerAction=function(e){angular.isObject(e)&&angular.isString(e.name)&&angular.isFunction(e.run)&&(angular.isDefined(_[e.name])||(_[e.name]=e))},this.create=function(e){return new t(e)},this}]),angular.module("core.library.editor").provider("core.library.editor.PresetsService",["motoUI.MenuServiceProvider","motoFeaturesProvider","coreLibraryConfigProvider","coreLibraryUtilsProvider",function(o,i,r,t){var n=[],a=this;function s(e){var t;this.name=e.name,this.order=e.order||100,angular.isDefined(e.enabled)?this.enabled=e.enabled:(t="theme_presets_"+this.name.replace(/\./g,"-"),this.enabled=!i.isExist(t)||i.isExist(t)&&i.isEnabled(t)),this.icons=e.icons||{},this.category=e.category||"more",this.stateParam=e.stateParam||this.name,this.base=e.base||null,this.label=e.label||"EDITOR.WIDGETS."+this.name.toUpperCase()+".LABEL",this.template=e.template||{path:"@websiteWidgets/"+this.name+"/templates/default.twig.css",engine:"nunjucks"},this.presetPropertiesView=e.presetPropertiesView||null,this.checkPresetControls=!angular.isDefined(e.checkPresetControls)||e.checkPresetControls,this.enabled&&!this.base&&o.getMenu("design_widgets_menu").addItem({label:this.label,state:"app.design.widgets.presets({widget: '"+this.stateParam+"'})",indicate:!1,priority:this.order,itemId:this.name,hidden:!!angular.isDefined(e.hidden)&&e.hidden,icon:this.icons.medium})}return this.addWidget=function(e){return!i.isDisabled("theme_presets")&&(n.push(new s(e)),t.sortArrayByProperty(n,"order"),!0)},a.getWidgets=function(){return n.filter(function(e){return e.enabled})},a.getWidget=function(e){var t;for(t=0;t<n.length;t++)if(n[t].name===e)return n[t];return null},this.getWidgetByStateParam=function(e){var t;for(t=0;t<n.length;t++)if(n[t].stateParam===e)return n[t];return null},a.getPresetsWidget=function(e){var t;if(!e)return null;for(t=0;t<n.length;t++)if(n[t].name===e)return n[t].base||n[t].name;return null},a.getPresetControls=function(e,t){var o;return e?(o=r.get("settings.website.theme_presets",{}),angular.isString(o)&&(o=angular.fromJson(o||{})),o&&o[e]?void 0===t?o[e]:o[e][t]||null:null):null},{addWidget:a.addWidget,getWidget:a.getWidget,getWidgets:a.getWidgets,$get:["jsonrpc",function(e){var t=e.newService("PresetsService");return a.getList=t.createMethod("getList"),a.save=t.createMethod("save"),a}]}}]).provider("core.library.editor.PresetsModel",[function(){var t;t=function(e,t){var o=this;t=t||{},o.id=t.id||"",o.name=t.name||"",o.widget_name=t.widget_name||"",o.class_name=t.class_name,o.is_system=parseInt(t.is_system),o.is_responsive=t.is_responsive||0,o.template=t.template||"",o.properties=angular.fromJson(t.properties),o.created=t.created||null,o.modified=t.modified||null},this.$get=["core.library.editor.PresetsService",function(e){return Model.register("Presets",{proxy:this.proxy={service:e},record:t}),Model("Presets").load(!1)}]}]),angular.module("core.library.editor").service("core.library.editor.WidgetHighlighterService",[function(){function e(){}return e.prototype.enable=function(e){e._Editor._$body.addClass("moto-editor_widget-editing-mode"),e._$dom.addClass("moto-widget_highlighted")},e.prototype.disable=function(e){e._Editor._$body.removeClass("moto-editor_widget-editing-mode"),e._$dom.removeClass("moto-widget_highlighted")},new e}]),angular.module("core.library.editor").service("core.library.editor.WidgetLockerService",[function(){function e(){}function o(e,t){e._selectingLocked=!0,e._lockedBy=t}function t(e){e._selectingLocked=!1,e._lockedBy=null}return e.prototype.lock=function(e,t){this.unlockChildren(e),o(e,t)},e.prototype.unlock=function(e){this.lockChildren(e,e._selectingLocked),t(e)},e.prototype.lockChildren=function(e,t){e._Editor.Widgets.getNestedWidgetsByWidget(e).forEach(function(e){o(e,t)})},e.prototype.unlockChildren=function(e){e._Editor.Widgets.getNestedWidgetsByWidget(e).forEach(function(e){t(e)})},new e}]),angular.module("core.library.editor").provider("core.library.editor.WidgetsService",["motoFeaturesProvider","coreLibraryInterceptorsProvider","coreLibraryUtilsProvider",function(o,e,r){var n=this,a=[{name:"structure",label:"WIDGET.COMMON.CATEGORY.STRUCTURE",order:5,widgets:[]},{name:"basic",label:"WIDGET.COMMON.CATEGORY.BASIC",order:10,widgets:[]},{name:"galleries",label:"WIDGET.COMMON.CATEGORY.GALLERIES",order:15,widgets:[]},{name:"social",label:"WIDGET.COMMON.CATEGORY.SOCIAL",order:20,widgets:[]},{name:"media",label:"WIDGET.COMMON.CATEGORY.MEDIA",order:23,widgets:[]},{name:"blog",label:"WIDGET.COMMON.CATEGORY.BLOG",order:25,widgets:[]},{name:"more",label:"WIDGET.COMMON.CATEGORY.MORE",order:30,widgets:[]}],i=e.createSimpleInterceptor();function s(e){var t;e=e||{},this.name=e.name||null,this.label=e.label||"EDITOR.WIDGETS."+this.name.toUpperCase()+".LABEL",this.category=e.category||"more",this.order=e.order||100,angular.isDefined(e.enabled)?this.enabled=e.enabled:(t="theme_widget_"+e.name.replace(/\./g,"-"),this.enabled=!o.isExist(t)||o.isExist(t)&&o.isEnabled(t)),this.icons={},this.icons=angular.isObject(e.icons)?function(e){var t,o={small:"",medium:"",large:""};for(t in o)e.hasOwnProperty(t)&&e[t]&&(o[t]=e[t].trim());return o}(e.icons):{},this.options=e.options||{},e.allowed&&(this.allowed=e.allowed)}function l(t){var o=null;return angular.forEach(a,function(e){t==e.name&&(o=e)}),o}return n.addCategory=function(e,t,o,i){return i=i||!1,"string"==typeof e&&(l(e)||(a.push({name:e,label:"string"!=typeof t?e.toUpperCase():t,order:o||100,hidden:i,widgets:[]}),r.sortArrayByProperty(a,"order")),!0)},n.addWidget=function(e){var t;return i.execute("widget.adding",e),!(void 0===e||!e.name)&&(!!(t=l(e.category))&&(t.widgets.push(new s(e)),r.sortArrayByProperty(t.widgets,"order"),i.execute("widget.added",e),!0))},n.getWidgetsByOptions=function(e,o,i){var t,r=[];return"string"!=typeof e?null:(t=l(e))&&o&&o.type?(t.widgets.forIn(function(e,t){n.isWidgetAllowedToUse(t.name,o,i)&&r.push(t)}),r):null},n.getCategories=function(){return a},n.getWidget=function(e){var t,o;for(t=0;t<a.length;t++)for(o=0;o<a[t].widgets.length;o++)if(e===a[t].widgets[o].name)return a[t].widgets[o];return!1},n.isWidgetAllowedToUse=function(e,t,o){var i=n.getWidget(e),r=!1;return angular.isObject(t)||(t={type:"NONE"}),"popup"===t.type?!!i.hasOwnProperty("allowed")&&(!!angular.isFunction(i.allowed)&&i.allowed(t,o)):(i.hasOwnProperty("allowed")?angular.isString(i.allowed)?r=i.allowed===t.type:angular.isArray(i.allowed)?r=0<=i.allowed.indexOf(t.type):angular.isFunction(i.allowed)&&(r=i.allowed(t,o)):r=!0,r)},{addInterceptor:function(e,t){return i.addInterceptor(t,e)},addCategory:n.addCategory,addWidget:n.addWidget,isWidgetAllowedToUse:n.isWidgetAllowedToUse,getWidget:n.getWidget,$get:[function(){return n}]}}]),angular.module("core.library.Features",["core.library.interceptors"]).provider("motoFeatures",["coreLibraryInterceptorsProvider",function(e){var t={},i={engine_code_injection:!0,engine_dashboard:!0,engine_ml_disk_info:!1,theme_widget_social_links_extended:!0,theme_widget_tabs:!0,theme_widget_paypal_button:!0,theme_widget_actions_open_popup:!0,theme_widget_tile_gallery:!0,theme_widget_instagram_post:!0,theme_widget_integrations_acuity_scheduling:!0,theme_widget_integrations_opentable:!0,theme_widget_integrations_airbnb:!0},r=e.createSimpleInterceptor();function n(e){return"allow_code_injection"===e?"engine_code_injection":e}function o(e,t){var o;return!!e&&(e=n(e),o=i[e],t&&(o=r.execute("isEnabled: "+e,o,t)),Boolean(o))}function a(e){return!o(e)}function s(e){return e=n(e),i.hasOwnProperty(e)}function l(e,t){return e=n(e),!i[e]&&t?t:i[e]}function c(e,t){var o;if(e=n(e),t=t||!0,angular.isString(e))i[e]=t;else if(angular.isArray(e))for(o=0;o<e.length;o++)c(e[o],t);else if(angular.isObject(e))for(o in e)e.hasOwnProperty(o)&&c(o,e[o])}function p(e){var t;if(e=n(e),angular.isString(e))i[e]&&delete i[e];else if(angular.isArray(e))for(t=0;t<e.length;t++)p(e[t]);else if(angular.isObject(e))for(t in e)e.hasOwnProperty(t)&&p(t)}function d(){return i}this.isEnabled=o,this.isDisabled=a,this.isExist=s,this.getValue=l,this.enable=c,this.disable=p,this.getList=d,this.setList=function(e){i=e},this.addList=function(e){angular.extend(i,e)},this.addInterceptor=function(e,t){return r.addInterceptor(t,e)},t.isEnabled=o,t.isDisabled=a,t.isExist=s,t.getValue=l,t.getList=d,t.enable=c,t.disable=p,this.$get=[function(){return t}]}]),angular.module("core.library.history",[]).service("simpleHistory",[function(){var e=this,t=null,o=null;e.init=function(e){t=e,o=angular.copy(e)},e.isChanged=function(){return!angular.equals(JSON.stringify(t),JSON.stringify(o))},e.reset=function(e){angular.extend(e,angular.copy(o)),t=e},e.clear=function(){o=t=null},e.createNew=function(){return new function(){var t,o;this.save=function(e){t=null,e&&(t=angular.copy(e),o=e)},this.revert=function(e){t&&e&&(angular.extend(e,t),e.properties=angular.copy(t.properties))},this.clear=function(){t=null},this.isChanged=function(){return!(!t||!o)&&!angular.equals(t,o)},this.getPrev=function(){return o},this.getUndo=function(){return t}}}}]),angular.module("core.library.HttpRequestQueue",["ng"]).provider("coreLibraryHttpRequestQueue",["$httpProvider",function(e){var t,n=!1,a=!1,o=this,i={locked:!1,items:[]},s=[],r="__RequestQueue__",l={concurrentConnections:0,debug:!1};function c(e,t){var o=this;this.request=e,this.queue=t,e[r+"CompleteQueuedRequest"]=function(){return o.requestCompleted()}}function p(){this.items=[],this.stats=this.stats}function d(t){try{t&&t.config&&angular.isFunction(t.config[r+"CompleteQueuedRequest"])&&t.config[r+"CompleteQueuedRequest"]()}catch(e){l.debug&&(console.warn("ERROR on taskCompletedByResponse"),console.warn("error",e),console.warn("response",t))}}o.isConnected=function(){return n},o.enable=function(){a=!0,n||(e.interceptors.push(t),n=!0)},o.disable=function(){a=!1},o.getStatistics=function(){return angular.copy(i.stats)},o.setConcurrentConnections=function(e){0<(e=parseInt(e))||(e=0),l.concurrentConnections=e},o.addRequestValidator=function(e){return!!angular.isFunction(e)&&(s.push(e),!0)},c.prototype.inProgress=!1,c.prototype.isCompleted=!1,c.prototype.request=null,c.prototype.deferred=null,c.prototype.queue=null,c.prototype.destroy=function(){delete this.request,delete this.deferred,delete this.queue},c.prototype.setDeferred=function(e){this.deferred=e},c.prototype.requestCompleted=function(){return!this.isCompleted&&(this.isCompleted=!0,this.inProgress=!1,this.queue.taskCompleted(this),!0)},p.prototype.locked=!(c.prototype.resolveRequest=function(){if(this.inProgress||this.isCompleted)return!1;this.inProgress=!0;try{this.deferred.resolve(this.request)}catch(e){l.debug&&console.error("Error on resolve request",e)}return!0}),p.prototype.items=[],p.prototype.stats={work:0,done:0,total:0},p.prototype.addRequest=function(e,t){var o,i=t.defer();return(o=new c(e,this)).setDeferred(i),this.items.push(o)<=l.concurrentConnections&&this.dispatchFreeTasks(),i.promise},p.prototype.taskCompleted=function(e){this.stats.work--,this.stats.done++,this.dispatchFreeTasks()},p.prototype.dispatchFreeTasks=function(){if(this.locked)return!1;this.locked=!0;var e,t,o=l.concurrentConnections,i=[],r=0;for(e=0,t=this.items.length;e<t&&!(o<=r||o<=i.length);e++)this.items[e].isCompleted?(this.items[e].destroy(),this.items.splice(e,1),e--,t--):this.items[e].inProgress?r++:(r++,this.items[e].resolveRequest(),this.stats.work++);this.locked=!1,this.stats.total=this.items.length},i=new p,t=["$q",function(t){return{request:function(e){return function(e){var t,o,i,r=!1;if(!e||l.concurrentConnections<1||!s.length||!a||!n||e.ignoreHttpQueued)return!1;for(o=0,i=s.length;o<i;o++)if(t=s[o],angular.isFunction(t))try{if(!0===t(e)){r=!0;break}}catch(e){}return r}(e)?i.addRequest(e,t):e},response:function(e){return d(e),e},responseError:function(e){return d(e),t.reject(e)}}}],this.$get=[function(){return{getStatistics:o.getStatistics}}]}]),angular.module("core.library.integration",[]).provider("coreLibraryIntegration",[function(){var r={},e={},n=!1;function o(e,t){return"type"===e&&(t=t.toLowerCase().trim()),t}function i(e){this._data={},this.setFromData(e)}function a(){this._items=[],i.apply(this,arguments)}function t(e){e=o("type",e);var t=null;return r[e]?t=r[e]:(t=new a({type:e}),r[t.getType()]=t),t}i.prototype._data={},i.prototype._nameToMethod=function(e){var t=e.trim();return t=(t=(t=t.replace(/([_])/g," ")).replace(/^([a-z])|\s+([a-z])/g,function(e){return e.toUpperCase()})).replace(/(\s)/g,"")},i.prototype.set=function(e,t){var o="set"+this._nameToMethod(e);return angular.isFunction(this[o])?this[o](t):(this._data[e]=t,this)},i.prototype.get=function(e,t){if(angular.isUndefined(e))return this._data;var o="get"+this._nameToMethod(e);return angular.isFunction(this[o])?this[o](t):angular.isUndefined(this._data[e])?t:this._data[e]},i.prototype.setFromData=function(e){for(var t in n&&console.log("IntegrationItem.setFromData",e),e)e.hasOwnProperty(t)&&this.set(t,e[t]);return this},((a.prototype=new i).constructor=a).prototype.setType=function(e){return this._data.type=o("type",e),this},a.prototype.getType=function(){return this._data.type},a.prototype.setItems=function(e){var t,o;for(o in e)e.hasOwnProperty(o)&&(t=new i(e[o]),this._items.push(t));return this},a.prototype.first=function(){var e;return 0<this._items.length?e=this._items[0]:(e=new i,this._items.push(e)),e},e.addCollections=this.addCollections=function(e){var t,o,i;for(n&&console.log("setList",e.length,e),o=0,i=e.length;o<i;o++)n&&console.log("new IntegrationCollection",e[o]),t=new a(e[o]),n&&console.log("IntegrationCollection = ",t),r[t.getType()]=t},e.get=this.get=t,e.first=this.first=function(e){return t(e).first()},window.$service=e,this.$get=[function(){return e}]}]),angular.module("core.library.interceptors").provider("coreLibraryInterceptors",[function(){var o,i={defaultConstructor:"SimpleInterceptor",showError:!1};function e(t){this.createInterceptor=function(e){return t.createInterceptor(e)},this.createSimpleInterceptor=function(){return t.createSimpleInterceptor()},this.createWildCartInterceptor=function(){return t.createWildCartInterceptor()}}function t(){}function r(){this._handlers={},this._options={}}function n(){r.apply(this,arguments)}function a(){r.apply(this,arguments)}return o=new t,t.prototype._interceptorConstructors={},t.prototype.setOption=function(e,t){return!(!angular.isString(e)||e.trim().length<1)&&(i[e]=t,!0)},t.prototype.getOption=function(e,t){return angular.isDefined(i[e])?i[e]:t},t.prototype.setEnvironmentStage=function(e){"development"===e&&this.setOption("showError",!0)},t.prototype.addConstructor=function(e,t){return!angular.isString(e)||e.trim().length<1?(this.isShowError()&&console.error("InterceptorProvider.addConstructor : bad interceptor name. Must be a string and not empty : ",e),!1):angular.isFunction(t)?void(this._interceptorConstructors[e]=t):(this.isShowError()&&console.error("InterceptorProvider.addConstructor : bad interceptor constructor. Must be a function : ",t),!1)},t.prototype.getConstructor=function(e){return this.hasConstructor(e)?this._interceptorConstructors[e]:null},t.prototype.hasConstructor=function(e){return!!this._interceptorConstructors[e]},t.prototype.createInterceptor=function(e){var t;return angular.isUndefined(e)&&(e=this.getOption("defaultConstructor")),t=this.getConstructor(e),angular.isFunction(t)?new t:null},t.prototype.createSimpleInterceptor=function(){return this.createInterceptor("SimpleInterceptor")},t.prototype.createWildCartInterceptor=function(){return this.createInterceptor("WildCartInterceptor")},t.prototype.$get=function(){return new e(this)},r.prototype._handlers={},r.prototype._options={},r.prototype.setOption=function(e,t){return!(!angular.isString(e)||e.trim().length<1)&&(this._options[e]=t,!0)},r.prototype.getOption=function(e,t){return angular.isDefined(this._options[e])?this._options[e]:o.getOption(e,t)},r.prototype.isShowError=function(){return this.getOption("showError",!1)},r.prototype.addInterceptor=function(e,t){return angular.isFunction(e)?!angular.isString(t)||t.trim().length<1?(this.isShowError()&&console.error("SimpleInterceptor.addInterceptor : bad interceptor name. Must be a string and not empty : ",t),!1):(t=t.trim(),this._handlers[t]=this._handlers[t]||[],this._handlers[t].push(e),!0):(this.isShowError()&&console.error("SimpleInterceptor.addInterceptor : bad interceptor handler. Must be a function : ",e),!1)},r.prototype.getHandlers=function(e){return this._handlers[e]||[]},r.prototype.execute=function(t,e,o){var i,r,n,a,s,l={name:t};if(i=this.getHandlers(t),!angular.isArray(i)||0<!i.length)return e;for(a=0,s=i.length;a<s;a++)try{r=i[a],angular.isFunction(r)&&(n=r(l,e,o),angular.isDefined(n)&&null!==n&&(e=n))}catch(e){this.isShowError()&&(console.error("SimpleInterceptor.execute : Error catched"),console.error("\tInterceptor name :",t),console.error("\tInterceptor handler :",r),console.error("\tInterceptor error :",e))}return e},(n.prototype=Object.create(r.prototype)).constructor=n,((a.prototype=Object.create(r.prototype)).constructor=a).prototype.addInterceptor=function(e,t){return angular.isUndefined(t)&&(t="*"),r.prototype.addInterceptor.call(this,e,t)},a.prototype.getHandlers=function(e){var t;return t=r.prototype.getHandlers.call(this,e),angular.isArray(this._handlers["*"])&&(t=t.concat(this._handlers["*"])),t},a.prototype.addHandler=function(e,t){return console.log(e),console.log(t),function(){}},o.addConstructor("SimpleInterceptor",r),o.addConstructor("WildCartInterceptor",a),o}]),angular.module("core.library.jsonrpc",["ngFileUpload","core.library.config"]).provider("jsonrpc",["coreLibraryConfigProvider",function(e){var t=this,f=[],h=this.defaults={},o=0;function p(){return e.isDevelopment()}function y(){return o+++""}t.addInterceptor=function(e,t){return o=e,i=t,r={injected:!1},!!(angular.isString(o)||angular.isFunction(o)||angular.isArray(o))&&(angular.isObject(i)||(i={}),r.interceptor=o,r.priority=angular.isNumber(i.priority)?i.priority:100,r.methods=angular.isDefined(i.methods)?i.methods:"*.*",angular.isString(r.methods)&&(r.methods=[r.methods]),f.push(r),!0);var o,i,r},h.basePath="/rpc",this.$get=["$http","$q","$injector","Upload",function(u,g,d,m){var o;function l(e,t,o){var i,r;if("request"===o)for(i=t.length-1;0<=i;i--)(t[i].request||t[i].requestError)&&(e=e.then(t[i].request,t[i].requestError));if("response"===o)for(i=0,r=t.length;i<r;i++)(t[i].response||t[i].responseError)&&(e=e.then(t[i].response,t[i].responseError));return e}function c(o,e,i){var t,r,n,a=y(),s={jsonrpc:"2.0",method:o.method,id:a},l=g.defer(),c=l.promise;h.BeforeRequest&&h.BeforeRequest(s,o,e),angular.isDefined(o.data)&&(s.params=o.data);var p=[];angular.forEach(u.defaults.transformResponse,function(e){p.push(e)}),p.push(function(e){return e&&e.id===a?e:null});var d=(e=e||{}).transformResponse;return angular.isArray(d)?[].push.apply(p,d):angular.isFunction(d)&&p.push(d),e.transformResponse=p,n=o.path||h.basePath,(t=e).headers=t.headers||{},t.headers["X-Requested-With"]=t.headers["X-Requested-With"]||"XMLHttpRequest",t.method="POST",t.url=n,t.data=s,i&&(t.file=i),g.when(t).then(function(e){var t=g.defer();return(i?(o.progress&&(r=o.progress,delete o.progress),m.upload(e).progress(function(e){r instanceof Function&&r.call(r,e)})):u(e)).then(t.resolve,t.reject),t.promise}).then(function(e){var t=e.data;return e.status,e.headers,e.config,null===t?(h.ErrorRequest&&h.ErrorRequest(c,null),l.reject(null)):t&&t.hasOwnProperty("error")?(h.ErrorRequest&&h.ErrorRequest(c,t.error),l.reject(t.error)):t&&t.hasOwnProperty("result")?(h.SuccessRequest&&h.SuccessRequest(c,t.result),l.resolve(t.result)):(h.ErrorRequest&&h.ErrorRequest(c,t),l.reject(t)),e},function(e){return h.ErrorRequest&&h.ErrorRequest(c,e.data),l.reject({code:e.status,message:"COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR",type:"NETWORK",httpError:e}),e}),l.promise}function i(e,t){this.serviceName=e,this.path=t}return o="priority",f=f.sort(function(e,t){return e[o]<t[o]?-1:e[o]>t[o]?1:0}),c.request=function(e,t,o,i){return arguments.length<4&&(i=o,o=t,t=e,e=null),c({path:e,method:t,data:o},i)},c.setBasePath=function(e){return t.setBasePath(e)},c.getBasePath=function(){return t.getBasePath()},c.getRequestId=function(){return y()},c.setBeforeRequest=function(e){return t.setBeforeRequest(e)},c.setEndSuccessRequest=function(e){return t.setEndSuccessRequest(e)},c.setEndErrorRequest=function(e){return t.setEndErrorRequest(e)},i.prototype.createMethod=function(e,n){var a=this.path,s=this.serviceName+"."+e,t=function(e){var o,i=function(e){var t,o,i,r,n,a=e.split("."),s=a.pop(),l=a.join("."),c=[],p=f.length;for(n=0;n<p;n++)o=!1,t=f[n].methods,angular.isFunction(t)?o=t({service:l,method:s}):(o|=-1<t.indexOf("*"),o|=-1<t.indexOf("*.*"),o|=-1<t.indexOf(l+".*"),o|=-1<t.indexOf("*."+s),o|=-1<t.indexOf(l+"."+s)),o&&(r=f[n].injected,i=f[n].interceptor,r||(i=angular.isString(i)?d.get(i):d.invoke(i),f[n].injected=!0,f[n].interceptor=i),c.push(i));return c}(s),t={path:a,method:s,params:e,config:angular.copy(n)},r=!!i.length;return o=g.when(t),r&&(o=l(o,i,"request")),(o=o.then(function(t){var e=g.defer();return o=c.request(t.path,t.method,t.params,t.config),r&&(o=(o=l(o=o.then(function(e){return g.resolve({data:e,request:t})},function(e){return g.reject({error:e,request:t})}),i,"response")).then(function(e){return g.resolve(e.data?e.data:e)},function(e){return g.reject(e.error?e.error:e)})),o.then(e.resolve,e.reject),e.promise},function(e){return g.reject(e)})).success=function(e){return p()&&console.warn('Some code call deprecated method "success" on ',s),o.then(e),this},o.error=function(e){return p()&&console.warn('Some code call deprecated method "error" on ',s),o.then(null,e),this},o.stopPropagation=function(){p()&&console.warn('Some code call deprecated method "stopPropagation" on ',s)},o};return t.__jsonRpcMethod=s,t},i.prototype.createUploadMethod=function(e,r){var n=this.path,a=this.serviceName+"."+e;return function(e,t,o){var i;if(!e)throw"Property file not found";return(i=c({path:n,method:a,data:t,progress:o},r,e)).success=function(e){return p()&&console.warn('Some code call deprecated method "success" on ',a),i.then(e),this},i.error=function(e){return p()&&console.warn('Some code call deprecated method "error" on ',a),i.then(null,e),this},i}},c.newService=function(e,t){return new i(e,t)},c.createBatch=function(e,t){function o(){}return o.prototype={_requests:[],_callbacks:{},add:function(e,t){var o={jsonrpc:"2.0",id:y()},i=g.defer(),r=!1,n=i.promise,a={success:function(){},error:function(){}};return angular.isFunction(e)&&(e=e.__jsonRpcMethod),!!e&&(o.method=e,angular.isDefined(t)&&(o.params=t),n.success=function(e){return a.success=e,this},n.error=function(e){return a.error=e,this},n.then(function(){r||a.success.apply(null,arguments)},function(){r||a.error.apply(null,arguments)}),n.stopPropagation=function(){r=!0},this._requests.push(o),this._callbacks[o.id]=i,n)},isEmpty:function(){return!this._requests.length},doRequest:function(){var o=this,a=g.defer(),e=a.promise,t=!1,i={success:function(){},error:function(){}},r={method:"POST",url:h.basePath,headers:{"X-Requested-With":"XMLHttpRequest"},data:this._requests};if(e.success=function(e){return i.success=e,this},e.error=function(e){return i.error=e,this},e.then(function(){t||i.success.apply(null,arguments)},function(){t||i.error.apply(null,arguments)}),e.stopPropagation=function(){t=!0},this.isEmpty())return a.resolve(),e;function s(e){var t=o._callbacks[e.id];return!!t&&(null===e?t.reject(null):e&&e.hasOwnProperty("error")?t.reject(e.error):e&&e.hasOwnProperty("result")?t.resolve(e.result):t.reject(e),!0)}return u(r).success(function(e,t,o,i){for(var r=0,n=e.length;r<n;r++)s(e[r]);a.resolve(e)}).error(function(e){for(var t=0,o=e.length;t<o;t++)s(e[t]);a.reject(e)}).finally(function(){o._requests=[],o._callbacks={}}),e}},new o},c}],t.setBasePath=function(e){return this.defaults.basePath=e,this},t.getBasePath=function(){return this.defaults.basePath},t.setBeforeRequest=function(e){return this.defaults.BeforeRequest=e,this},t.setEndSuccessRequest=function(e){return this.defaults.SuccessRequest=e,this},t.setEndErrorRequest=function(e){return this.defaults.ErrorRequest=e,this}}]),angular.module("core.library.languages",["core.library.utils","core.library.config"]).provider("coreLibraryLanguages",["coreLibraryUtilsProvider","coreLibraryConfigProvider",function(e,t){this.getProfileCode=function(){return this.getProfileLocale().substring(0,2)}.bind(this),this.getWebsiteCode=function(){return this.getWebsiteLocale().substring(0,2)}.bind(this),this.getProfileLocale=function(){return e.getObjectValueByPath(window,"app.user.language_locale","en_US")},this.getWebsiteLocale=function(){return t.get("settings.website.language_locale","en_US")},this.$get=[function(){return this}.bind(this)]}]),angular.module("core.library.LivePreview",["core.library.CssGenerator","core.library.utils","core.library.messenger","core.library.scriptsInjector"]).provider("coreLibraryLivePreview",[function(){this.$get=["$rootScope","coreLibraryCssGenerator","coreLibraryUtils","$q","MotoDevicesConstants","coreLibraryWidget","ScriptsInjector",function(i,o,r,e,t,a,s){var n={desktop:function(){return t.SIZE.DESKTOP},tablet:function(){return t.SIZE.TABLET},"mobile-h":function(){return t.SIZE["MOBILE-H"]},"mobile-v":function(){return t.SIZE["MOBILE-V"]}},l="live_preview_css",c="temp_css";function p(){return document.getElementById("id_live_preview")||null}function d(){var n=this;this._em=null,this._url=null,this._device="desktop",this.isLoad=!1,n._load=function(){n._inject()},n.processCallbacks=function(){a.afterLivePreviewReady.forIn(function(e,t){t(n.window)}),n.window.$(n.window).on("widthChanged",function(){a.afterWidthChanged.forIn(function(e,t){t(n.window)})}),n.window.$("body").delegate("a","click",function(e){e.preventDefault()}),n.updateFrame(),n.window.$(n.window).trigger("resize")},(n._domFrame=p())&&(window.livePreviewLoaded=n._load,n.setDevice(n.getOption("defaultDevice","desktop")),n.$(function(){n.window.$&&n.processCallbacks(),n.ScriptsInjector=s.create(n.window)})),this.insertCssInStyleTag=function(e,t){var o,i,r;if(!n.document)return null;r=t?c:l,(o=n.document.getElementById(r))||((o=n.document.createElement("style")).setAttribute("id",r),t&&(i=n.$("#"+l)).length?i.after(o):n.document.body.appendChild(o)),o.innerHTML=e}}return d.prototype={_em:null,_url:null,_domFrame:null,_load:null,_device:null,isLoad:!1,_options:{defaultStyleId:"moto-website-style",deviceCssClassPrefix:"moto-preview-device_",defaultDevice:"desktop",scrollBarWidth:null,backgroundClassMask:/^moto-background(_[0-9]+)*/},window:null,document:null,_queue:{ready:[]},setOption:function(e,t){return this._options[e]=t,this},getOption:function(e,t){return this._options[e]||t||null},$:function(e,t){return angular.isFunction(e)&&this._queue.ready.push(e),this.document?e?(t=t||this.document,$(e,t)):$(this.document):null},_inject:function(){var e;if(this._domFrame||this.isLoad){if(this.window=this._domFrame.contentWindow,this.document=this.window.document,this.isLoad=!0,this._queue.ready.length)for(e=0;e<this._queue.ready.length;e++)$(this._queue.ready[e],this.document);this._em&&this._em.trigger("LivePreview.load")}},appendStyleSheet:function(e,t){var o={tag:"link",url:e,target:"body",attributes:{id:null,href:e,rel:"stylesheet"}};return angular.isObject(t)&&(o=r.deepExtend(o,t)),this.appendAssets(o)},appendJavaScript:function(e,t){var o={tag:"script",url:e,target:"head",attributes:{id:null,src:e}};return angular.isObject(t)&&(o=r.deepExtend(o,t)),this.appendAssets(o)},appendAssets:function(e){var t,o,i=this.document;return i?(e.attributes.id||(e.attributes.id=e.url),(o=i.getElementById(e.attributes.id))||(t=e.target||"head",t=i.getElementsByTagName(t)[0],o=i.createElement(e.tag),angular.extend(o,e.attributes),t.appendChild(o)),this):null},disableDefaultCss:function(){var e,t=this.document;return t?((e=t.getElementById(this.getOption("defaultStyleId")))&&(e.disabled="disabled"),this):null},enableDefaultCss:function(){var e,t=this.document;return t?((e=t.getElementById(this.getOption("defaultStyleId")))&&(e.disabled=""),this):null},reloadDefaultCss:function(){var e,t=this.document;if(!t)return null;(e=t.getElementById(this.getOption("defaultStyleId")))&&($(e).data("url")||$(e).data("url",e.href),e.href=$(e).data("url")+"?_t="+Date.now(),this.enableDefaultCss())},destroy:function(){this._domFrame=null,this._em=null,this._queue.ready=[],this.window=null,this.document=null,this.ScriptsInjector&&this.ScriptsInjector.reset()},setUrl:function(e){var t,o;(this._url=e)&&this._domFrame&&((o=this.$("body"))&&o.addClass("moto-preview-overlay"),this.isLoad=!1,this.window=null,this.document=null,this.ScriptsInjector&&this.ScriptsInjector.reset(),(t=p())&&t.contentWindow?t.contentWindow.location.replace(this._url):this._domFrame.src=this._url)},reload:function(){var e=p();e&&e.contentWindow?e.contentWindow.location.replace(this._url):$("#id_live_preview").attr("src",function(e,t){return t})},setSize:function(e){var t=this;return e&&t._domFrame&&(e.width===n.desktop()?(t._domFrame.style.width="100%",t._domFrame.style["min-width"]=n.desktop()+t.getScrollBarWidth()+"px"):(t._domFrame.style.width=e.width+t.getScrollBarWidth()+"px",t._domFrame.style["min-width"]="0")),t},getScrollBarWidth:function(){if(null==this._options.scrollBarWidth){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),document.body.appendChild(t);var o=e.offsetWidth;t.style.overflow="scroll";var i=e.offsetWidth;o==i&&(i=t.clientWidth),document.body.removeChild(t),this._options.scrollBarWidth=o-i}return this._options.scrollBarWidth},setDevice:function(e){var t,o=this;return 750,e&&n.hasOwnProperty(e)&&(o.setSize({width:n[e]()}),t=$(o._domFrame).find("body"),o._device&&t.removeClass(o.getOption("deviceCssClassPrefix")+o._device),t.addClass(o.getOption("deviceCssClassPrefix")+e),o._device=e,o.updateFrame(),setTimeout(function(){o._domFrame&&o._domFrame.contentWindow&&$(o._domFrame.contentWindow.window).trigger("resize")},750),i.$broadcast("MotoEvent:LivePreview.DeviceWasChanged",o)),o},updateFrame:function(){var e;this.isLoad&&((e=this.$("body")).data("device")&&e.removeClass(this.getOption("deviceCssClassPrefix")+e.data("device")),e.addClass(this.getOption("deviceCssClassPrefix")+this._device).data("device",this._device))},useStyle:function(e){var t=this;if(!this.document)return null;(e=e||{}).callback=function(e){t.disableDefaultCss(),t.insertCssInStyleTag(e),t.removeTempStyleTag()},o.css(e)},renderPresetStyles:function(e){o.renderPresetStyles({widgetPreset:e,callback:this.insertCssInStyleTag})},renderSpacingsStyles:function(e){o.renderSpacingsStyles({spacings:e,callback:this.insertCssInStyleTag})},renderGridStyles:function(e){o.renderGridStyles({themeGrid:e,callback:this.insertCssInStyleTag})},renderHeadingSpacingsStyles:function(e){o.renderHeadingSpacingsStyles({spacings:e,callback:this.insertCssInStyleTag})},renderStylesRecord:function(e){o.renderStylesRecord({stylesRecord:e,callback:this.insertCssInStyleTag})},removeTempStyleTag:function(){var e=this.$("#"+c);e&&e.remove()},setEventManager:function(e){this._em=e},getDevice:function(){return this._device},getSize:function(){},getUrl:function(){return this._url},setVariable:function(e,t){return o.setVariable(e,t),this},unsetVariable:function(e){return o.unsetVariable(e),this},setSpacing:function(e){return o.setSpacing(e),this},unsetSpacing:function(){return o.unsetSpacing(),this},setColorsTheme:function(e){return o.setColorsTheme(e),this},setBodyBackground:function(e){var t=this,o=t.$("body");o&&t.isLoad&&e.match(t._options.backgroundClassMask)&&(o[0].className.split(/\s+/).filter(function(e){e.match(t._options.backgroundClassMask)&&o.removeClass(e)}),o.addClass(e))}},function(){return new d}}]}]),angular.module("core.library.messenger").provider("motoNotify",[function(){var c,p='<div class="moto-ui-messenger moto-ui-messenger_type-{{::$type}}" ng-click="$close()"><p class="moto-ui-messenger_message-text"><span ng-bind-html="::$message"></span></p><i class="fa fa-times-circle moto-ui-messenger_close-button"></i></div>',d=1e3,u="Ok",g="success",m=500,f=!1;this.config=function(e){e=e||{},d=angular.isDefined(e.messageDuration)?e.messageDuration:d,u=angular.isDefined(e.defaultMessageText)?e.defaultMessageText:u,g=angular.isDefined(e.messageType)?e.messageType:g,m=angular.isDefined(e.animationDuration)?e.animationDuration:m,p=angular.isDefined(e.template)?e.template:p},this.$get=["$interval","$window","$compile","$rootScope","$translate",function(o,i,r,e,n){var a,s=e.$new(!0);function l(){f&&(o.cancel(a),c.animate({top:-c.height(),opacity:0},m,"swing",function(){c.remove(),f=!1}))}return{show:function(e){var t;f&&(c.stop().remove(),o.cancel(a)),t=(e=e||{}).duration||d,s.$type=e.type||g,s.$message=n.instant(e.message||u,e.translateArgs||{}),f=!0,c=r(p)(s),i.$("body").append(c),null===s.$parent.$$phase&&s.$apply(),c.css({top:-c.height()}),c.animate({top:0},m,"swing",function(){a=o(l,t,1)})},close:s.$close=l}}]}]),angular.module("core.library.messenger").config(["motoNotifyProvider",function(e){e.config({messageDuration:5e3,defaultMessageText:"COMMON.MESSAGES.UPDATE_SUCCESS",messageType:"success",animationDuration:350})}]).service("coreLibraryMessenger",["motoNotify",function(r){this.message=function(e,t,o,i){r.show({message:t,duration:i,type:e,translateArgs:o})},this.info=function(e,t,o){this.message("info",e,t,o)},this.warning=function(e,t,o){this.message("warning",e,t,o)},this.success=function(e,t,o){this.message("success",e,t,o)},this.error=function(e,t,o){this.message("error",e,t,o)}}]),angular.module("core.library.modal",["ui.bootstrap","core.library.validate","pascalprecht.translate"]).provider("coreLibraryModal",[function(){var l,i,c,r,o=[];function n(e){var t;e=e.currentScope||e,-1<(t=o.indexOf(e))&&o.splice(t,1)}function a(e){var t;try{t=e.currentScope,r(function(){!e.defaultPrevented&&t&&t.cancel&&t.cancel()},150)}catch(e){}}function p(e){var t;(t=e,-1<o.indexOf(t))||(e.$on("$destroy",n),e.$on("motoPopupCanceled",a),o.push(e))}window.$popupStack=o,angular.element(document).keydown(function(e){var t;if(27===e.keyCode){if(!(t=o[o.length-1])||t.escKeyDisabled)return;t.$broadcast("motoPopupCanceled")}}),(i=function(e,i,r,t,o,n){var a,s;return r&&(a=r.clientY,s=r.clientX,t+=" mini-modal "),n=n||!1,l.open({templateUrl:e,scope:c.$new(),controller:["$scope","$uibModalInstance","$timeout",function(e,t,o){e.escKeyDisabled=n,p(e),e.ok=function(){t.close(e)},e.cancel=function(){t.dismiss(e)},e.$on("$stateChangeStart",function(){t.dismiss(e)}),angular.isFunction(i)&&i.apply(this,arguments),r&&o(function(){angular.element(".mini-modal .modal-dialog").css({left:s,top:a})},1)}],backdrop:!r&&"static",keyboard:!1,windowClass:t||"",resolve:o||{}})}).iframe=function(e,i){var t,r="moto-iframe-window";return(i=i||{}).windowClass?i.windowClass=r+" "+i.windowClass:i.windowClass=r,t={template:'<div class="modal-header modal-header_iframe" ng-show="showIframeWindow"><button type="button" class="close" ng-click="close()">&times;</button></div><div class="modal-body modal-body_iframe" ng-show="showIframeWindow"><iframe ng-src="'+e+'" scrolling="no" style="overflow:hidden;padding:0;margin:0;border:0;" allowtransparency="true" width="100%" height="100%" border="0" hspace="0" marginheight="0" marginwidth="0" vspace="0" frameBorder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe></div>',scope:c.$new(),controller:["$scope","$uibModalInstance","$timeout",function(o,e,t){i.enableLoader?(o.showIframeWindow=!1,t(function(){var e,t;(e=angular.element("."+r+" .modal-dialog")).after('<div class="spinner-icon"></div>'),(t=e.find("iframe")).on("load",function(){e.next(".spinner-icon").remove(),o.showIframeWindow=!0,o.$$phase||o.$apply(),i.autoFocus&&t.focus()})})):o.showIframeWindow=!0,o.close=function(){e.dismiss(o)},p(o),o.cancel=o.close,o.$on("$stateChangeStart",o.close)}],backdrop:i.backdrop||"static",keyboard:i.keyboard||!1,size:i.size||"",windowClass:i.windowClass,resolve:i.resolve||{}},l.open(t)},this.$get=["$rootScope","$uibModal","$timeout",function(e,t,o){return c=e,l=t,r=o,i}]}]),angular.module("core.library.PathResolver",["ng"]).provider("coreLibraryPathResolver",[function(){var e=this;e.getPath=function(e){return app.config.getPath(e)},e.getUrl=function(e,t,o){return app.config.getUrl(e,t,o)},e.getAbsoluteUrl=function(e){return app.config.getAbsoluteUrl(e)},e.getUploadAbsoluteUrl=function(e){return app.config.getUploadAbsoluteUrl(e)},e.getUploadUrl=function(e,t,o){return app.config.getUploadUrl(e,t,o)},e.getRelativeUrl=function(e,t){return app.config.getRelativeUrl(e,t)},this.$get=[function(){return{getPath:e.getPath,getUrl:e.getUrl,getAbsoluteUrl:e.getAbsoluteUrl,getUploadAbsoluteUrl:e.getUploadAbsoluteUrl,getUploadUrl:e.getUploadUrl,getRelativeUrl:e.getRelativeUrl}}]}]),angular.module("core.library.scriptsInjector",[]).service("ScriptsInjector",["$q",function(r){var n={};function t(i){this.reset=function(){this.deferredScriptsQueue=null,this.injectedScripts=null},this.inject=function(t){var e,o;return this.deferredScriptsQueue=this.deferredScriptsQueue||{},this.deferredScriptsQueue[t]?this.deferredScriptsQueue[t].promise:(o=r.defer(),this.deferredScriptsQueue[t]=o,n[t]?((e=n[t](i)).one("load",function(){this.injectedScripts=this.injectedScripts||{},this.injectedScripts[t]=!0,o.resolve()}.bind(this)),e.one("error",function(e){o.reject({error:"Can not load script",name:t,event:e})}),i.document.getElementsByTagName("head")[0].appendChild(e[0])):o.reject({error:"Unknown script",name:t}),o.promise)}}return this.addScript=function(e,t){n[e]=t},this.create=function(e){return new t(e)},this}]),angular.module("core.library.storage",["ngStorage","core.library.utils"]).service("MotoLocalStorage",["$localStorage","coreLibraryUtils",function(i,r){var e=this;e.addFlag=function(e,t){i[e]=i[e]||{},i[e][app.user.id]=i[e][app.user.id]||[],$.isArray(i[e][app.user.id])&&$.inArray(t,i[e][app.user.id])<0&&i[e][app.user.id].push(t)},e.removeFlag=function(e,t){var o;i[e]&&i[e][app.user.id]&&-1!=(o=$.inArray(t,i[e][app.user.id]))&&i[e][app.user.id].splice(o,1)},e.flagExists=function(e,t){return!(t&&(!i[e]||i[e]&&(!i[e][app.user.id]||i[e][app.user.id]&&$.inArray(t,i[e][app.user.id])<0)))},e.setValue=function(e,t){var o=r.getObjectValueByPath(window,"app.user.id","1");i[e]=i[e]||{},i[e][o]=t},e.getValue=function(e){var t=r.getObjectValueByPath(window,"app.user.id","1");if(i[e]&&i[e][t])return i[e][t]}}]),app.library=app.library||{},app.library.styles||(app.library.styles=angular.module("core.library.styles",["moto.constants"])),app.library.styles.provider("core.library.styles.ClassesStylesModel",["MotoDevicesConstants",function(e){var t,i,r,n=e.LIST;function a(e){var o=this;e&&(i.apply(this,arguments),n.forEach(function(e){var t=o[e];t.base["background-size"]||(t.base["background-size"]="auto"),t.base["background-position"]||(t.base["background-position"]="left top"),t.base["background-repeat"]||(t.base["background-repeat"]="no-repeat"),t.base["background-attachment"]||(t.base["background-attachment"]="scroll")}))}(i=function(e){var t,o,i=this;e&&(t=e||{},t=angular.fromJson(t),t=r.deepExtend((o={},n.forEach(function(e){o[e]={base:{}}}),o),t),r.deepExtend(i,t),n.forEach(function(e){Array.isArray(i[e].base)&&(i[e].base={})}))}).prototype={},(a.prototype=new i).constructor=a,(t=function(e,t){var o;o=t||{},this.id=o.id||"",this.name=o.name||"",this.class_name=o.class_name,this.is_system=parseInt(o.is_system),this.is_responsive=parseInt(o.is_responsive||0),this.type=o.type,"background"===this.type?this.properties=new a(o.properties||{}):this.properties=new i(o.properties||{}),"text"===this.type&&(this.link=new i(o.link||{})),this.created=o.created||null,this.modified=o.modified||null}).prototype={id:null,name:null,class_name:null,type:null,is_system:null,is_responsive:null,properties:null,link:null,created:null,modified:null},this.$get=["coreLibraryUtils",function(e){return r=e,{ClassStyles:function(){return t},ClassStyleProperties:function(){return i}}}]}]).provider("core.library.styles.StylesModel",[function(){this.$get=["core.library.styles.StylesService","core.library.styles.ClassesStylesModel",function(e,t){return Model.register("Styles",{proxy:{service:e},index:["id","class_name"],record:t.ClassStyles()}),Model("Styles").load(!1)}]}]),app.library=app.library||{},app.library.styles||(app.library.styles=angular.module("core.library.styles",[])),app.library.styles.service("core.library.styles.StylesService",["jsonrpc",function(e){var t=e.newService("StylesService");this.getList=t.createMethod("getList"),this.save=t.createMethod("save"),this.delete=t.createMethod("delete"),this.duplicate=t.createMethod("duplicate"),this.getColorTheme=t.createMethod("getColorTheme"),this.setColorTheme=t.createMethod("setColorTheme")}]);var app=app||{},Model;angular.module("core.library.tutorial",["core.library.Features","core.library.languages","core.library.viewportInitialScale"]).run(["$rootScope","coreLibraryTutorial",function(e,t){t.setScope(e),t.checkOnlineStatus()}]).provider("coreLibraryTutorial",["motoFeaturesProvider","coreLibraryLanguagesProvider",function(s,l){var n,a,c,p,d,u=this,g={},m=!1,o=!1,i={url:""};function f(e,t,o){if(angular.isUndefined(o)&&(o=null),!angular.isObject(e))return o;if(!angular.isUndefined(e[t]))return e[t];var i=angular.isArray(t)?t:t.split("."),r=i.shift();return angular.isUndefined(e[r])?o:f(e[r],i,o)}this.init=function(e){return!!angular.isObject(e)&&(i=angular.extend({},i,e),this)},this.set=function(e,t){i[e]=t},g.set=this.set,this.get=function(e,t){return f(i,e,t)},g.get=this.get,this.isEnabled=function(){return o},g.isEnabled=this.isEnabled,g.checkState=function(){var e,t;if(s.isEnabled("cp_tutorial_center")){if(o=o&&m,!m)return d.$broadcast("tutorialStatusChanged",!1);t=(t=f(n.current,"motoParams.tutorialUrl","")).trim(),e=o,g.set("section",t),e!==(o=""!=t)&&d&&d.$broadcast("tutorialStatusChanged",o)}},g.setScope=function(e){(d=e).$on("$stateChangeSuccess",g.checkState)},g.checkOnlineStatus=function(){if(s.isEnabled("cp_tutorial_center")){var e=g.get("url").trim();if(""==e)return!1;var t=new Date;a.jsonp(e+"status/?callback=JSON_CALLBACK&stm="+t.getFullYear()+t.getMonth()+t.getDate()+t.getHours(),{ignoreLoadingBar:!0,timeout:3e3}).success(function(e){m=e.status||!1}).error(function(e){m=!1}).then(g.checkState)}},this.open=function(e){if(s.isEnabled("cp_tutorial_center")){if(!m)return d.$broadcast("tutorialStatusChanged",!1),!1;e=e||u.get("section");var t=g.get("url").trim();if(""==t)return!1;var o,i,r={locale:(o="en_US",i=l.getProfileLocale(),angular.isUndefined(i)||-1===["en_US","ru_RU","de_DE"].indexOf(i)?o||"en_US":i),build:f(app,"config.settings.system.build",27),version:f(app,"config.settings.system.version","3.0.5"),section:e,now:(new Date).getTime()},n=[];for(var a in r)n.push(a+"="+r[a]);t+="?"+n.join("&"),c.iframe(t,{windowClass:"moto-iframe-window_tutorial",autoFocus:!0,enableLoader:!0}),p.addFlag("tutorial_visited",e)}},g.open=this.open,this.$get=["$state","$http","coreLibraryModal","MotoLocalStorage","viewportInitialScaleService",function(e,t,o,i,r){return n=e,a=t,c=o,p=i,r,g}]}]),angular.module("core.library.uploader",["core.library.utils"]).value("maxAsyncFiles",2).provider("coreLibraryUploader",function(){var o,r,n,a,d,u,s=[],i=[],l=[],g=!1;(o=function(e){var t,r=this;return this.allFiles=[],this.currentUpload=[],this.allCountFiles=0,this.countUploaded=0,this.allSize=0,this.uploadSize=0,this.options={validate:!0,upload_max_size:1024,allowed_ext_list:["jpg","png","gif"],denied_ext_list:["exe","php","sh","bat","cmd","py","js"],validType:["size","allow"]},this.idx=e,this.env="coreLibraryUploader_"+e,this.interceptors=[],(t=function(){}).prototype={on:function(e,t){e&&t instanceof Function&&Signals.connect(r.env,e,t)},off:function(e,t){e&&t instanceof Function&&Signals.disconnect(r.env,e,t)},cancel:function(){0!=r.allFiles.length&&(r.allFiles=[],g=!0)},setOptions:function(e){(e=e||{}).forIn(function(e,t){r.setOption(e,t)})},getOption:function(e,t){return r.getOption(e,t)},addInterceptor:function(e){e.priority=angular.isDefined(e.priority)?e.priority:100,e.itemType=angular.isDefined(e.itemType)?e.itemType:null,r.interceptors.push(e),a.sortArrayByProperty(r.interceptors,"priority")},info:function(){return{allSize:r.allSize,uploadSize:r.uploadSize,formatAllSize:a.fileSize(r.allSize),formatUploadSize:a.fileSize(r.uploadSize),all:r.allCountFiles,uploaded:r.countUploaded,success:r.countSuccess,error:r.countError,isUpload:0<r.allCountFiles,usedSpace:0<r.allCountFiles?~~parseInt(r.uploadSize/r.allSize*100):0}},poolMessages:function(){var i=[];return l.forEach(function(e,t,o){e.env==r.env&&(i.push({type:e.type,args:e.args}),o.splice(t,1))}),i},upload:function(t){var o=[],i=r.getOption("validate",!0);return(t=t||{}).files&&0<t.files.length&&(r.setSignal("before",[t]),t.files.forEach(function(e){i?r.validFile(e)&&(r.allSize=r.allSize+e.size,o.push({file:e,params:t.params||null})):(r.allSize=r.allSize+e.size,o.push({file:e,params:t.params||null}))}),r.allCountFiles=r.allCountFiles+o.length,r.allFiles.push.apply(r.allFiles,o),0==o.length&&r.setSignal("after"),r.upload()),this}},new t}).prototype={idx:null,env:null,allFiles:null,currentUpload:null,allSize:0,uploadSize:0,allCountFiles:0,countUploaded:0,countSuccess:0,countError:0,options:{},setOption:function(e,t){this.options[e]=t},getOption:function(e,t){return t=t||null,this.options.hasOwnProperty(e)?this.options[e]:t},setSignal:function(e,t){var o=[];o.push.apply(o,t),o.unshift(e),o.unshift(this.env),l.unshift({env:this.env,type:e,args:o||null}),Signals.trigger.apply(Signals,o)},getInterceptorsByItemType:function(e){var t,o=[];for(t in this.interceptors)null!==this.interceptors[t].itemType&&this.interceptors[t].itemType!=e||o.push(this.interceptors[t]);return o},validFile:function(e){var t,o=this,i=[],r=o.getOption("upload_max_size"),n=o.getOption("allowed_ext_list"),a=o.getOption("denied_ext_list"),s=o.getOption("validType");return!!e&&(0<=s.indexOf("size")&&(e.size<=r?i.push(!0):(i.push(!1),o.setSignal("validate",["MODULE.MEDIA_LIBRARY.FILE_TOO_LARGE_ERROR_MESSAGE",e]))),0<=e.name.lastIndexOf(".")?(t=e.name.substr(e.name.lastIndexOf(".")+1).toLowerCase(),0<=s.indexOf("deny")&&(t&&a.indexOf(t)<0?i.push(!0):(i.push(!1),o.setSignal("validate",["MODULE.MEDIA_LIBRARY.INCORRECT_EXTENSION_ERROR_MESSAGE",e]))),0<=s.indexOf("allow")&&(t&&0<=n.indexOf(t)?i.push(!0):(i.push(!1),o.setSignal("validate",["MODULE.MEDIA_LIBRARY.INCORRECT_EXTENSION_ERROR_MESSAGE",e])))):(i.push(!1),o.setSignal("validate",["MODULE.MEDIA_LIBRARY.INCORRECT_EXTENSION_ERROR_MESSAGE",e])),i.indexOf(!1)<0)},upload:function(){var e,l=this,t=[],c=Model("MediaLibItems"),i=s[l.idx];function p(){l.setSignal("after"),g=!1,l.allCountFiles=l.countUploaded=0,l.countError=l.countSuccess=0,l.allSize=l.uploadSize=0,l.xhrs={}}for(e=l.currentUpload.length-1;0<=e;e--)l.currentUpload[e].isUpload&&l.currentUpload.splice(e,1);0==l.currentUpload.length&&g&&p(),l.currentUpload.length<n&&0<(t=l.allFiles.splice(0,n-l.currentUpload.length)).length&&(t.forEach(function(e){l.currentUpload.push({file:e.file,params:e.params,isUpload:!1,inProgress:!1,thumbnails:null})}),t=null,l.currentUpload.forEach(function(a){var t=0,o=!1;function s(e){l.countUploaded++,l.countError++,a.isUpload=!0,e&&l.setSignal("error",[e,a.file]),l.countUploaded>=l.allCountFiles&&p(),l.upload()}a.inProgress||(a.inProgress=!0,i(a.file,a.params,function(e){l.uploadSize=l.uploadSize+(e.loaded-t),l.setSignal("progress"),(t=e.loaded)-e.loaded!=0||o||(o=!0,l.uploadSize=l.uploadSize+(a.file.size-e.total))}).then(function(e){var t,o,i;function r(){i.is_ready=1,c.save(i),u.$broadcast("MotoEvent:uploadedItemReady",{item:i})}function n(e){r(),s(e)}t=0,i=function(e){var t,o,i;for((t=c.newRecord(e)).is_ready=0,c.insert(t),i=c.objects(),o=0;o<i.length;o++)if(i[o].id==t.id)return t}(e),o=l.getInterceptorsByItemType(i.type),function e(){t<o.length?(t++,d.when(o[t-1].onSuccess(i)).then(e,n)):(l.countUploaded++,l.countSuccess++,a.isUpload=!0,r(),l.countUploaded>=l.allCountFiles&&p(),l.upload())}()},s))}))}},r=function(e){var t=s.indexOf(e);return t<0&&(t=s.push(e)-1,i[t]=new o(t)),i[t]},this.$get=["maxAsyncFiles","coreLibraryUtils","$q","$rootScope",function(e,t,o,i){return n=e,a=t,d=o,u=i,function(e){return r(e)}}]}),angular.module("core.library.urlGenerator",[]).provider("coreLibraryUrlGenerator",function(){var UrlGenerator;UrlGenerator=function(){this._value="",this.isMake=!1,this._parent=null},UrlGenerator.prototype={isMake:!1,_value:null,_parent:null,set value(e){this.isMake=""!=e,this.prepareValue(e)},get value(){var e;return e=this._value,this._parent&&(e=this._parent+"/"+e),e},setParent:function(e){return this._parent=e,this},prepareValue:function(e){this._value=e.toString(),this.replSpace().replUpper().replTranslit().replUndefined()},setValue:function(e){return this.isMake||this.prepareValue(e),this},replSpace:function(){return this._value=this._value.replace_all(" ","-"),this},replUpper:function(){return this._value=this._value.toLowerCase(),this},replUndefined:function(){var e,t,o=this._value.split("");for(e=o.length-1;0<=e;e--)45==(t=o[e].charCodeAt())||95==t||48<=t&&t<=57||97<=t&&t<=122||o.splice(e,1);return this._value=o.join(""),this},replTranslit:function(){var self=this,tr='a b v g d e ["zh","j"] z i y k l m n o p r s t u f h c ch sh ["shh","shch"] ~ y ~ e yu ya ~ ["jo","e"]'.split(" "),val=self._value.split(""),i,cc,ch,v;for(i=val.length-1;0<=i;i--)v=val[i].charCodeAt(),0<=v&&v<=64||91<=v&&v<=127||(cc=v,ch=1072<=cc?tr[cc-1072]:val[i],ch?ch.length<3?val[i]=ch:val[i]=eval(ch)[0]:val[i]="");return self._value=val.join(""),self}},this.$get=[function(){return function(){return new UrlGenerator}}]}),angular.module("core.library.utils").provider("coreLibrarySpacingHelper",[function(){var a,s=this,l="moto-spacing",c=["top","right","bottom","left"],p=["auto","zero","small","medium","large"],d={a:"auto",z:"zero",s:"small",m:"medium",l:"large"};function o(){a=new RegExp("^"+l+"-("+c.join("|")+")-("+p.join("|")+")$")}function r(e){var t;if(!angular.isString(e))return null;for(t in d)if(d.hasOwnProperty(t)&&d[t]===e)return t;return" "}s.addValue=function(e,t){return!!angular.isString(e)&&(!(angular.isString(t)&&1<t.length)&&(!(-1<p.indexOf(e))&&(p.push(e),t&&(d[t]=e),o(),!0)))},s.parseShort=function(e,t){var o,i,r,n;if(!angular.isString(e))return null;for(angular.isObject(t)&&!angular.isArray(t)||(t={}),i=Math.min(c.length,e.length),o=0;o<i;o++)r=c[o],n=e[o],(n=d[n])&&(t[r]=n);return t},s.generateShort=function(e){var t,o,i="";if(!angular.isObject(e)||angular.isArray(e))return null;for(t=0,o=c.length;t<o;t++)i+=r(e[c[t]]);return i},s.parseClasses=function(e,t){var o,i,r,n;if(angular.isString(e)&&(e=e.split(" ")),!angular.isArray(e))return null;for(angular.isObject(t)&&!angular.isArray(t)||(t={}),o=0,i=e.length;o<i;o++)r=e[o],angular.isString(r)&&(r=r.trim()).length&&(n=a.exec(r))&&(!t[n[1]]||p.indexOf(n[2])>p.indexOf(t[n[1]]))&&(t[n[1]]=n[2]);return t},s.generateSpacings=function(e){var t,o,i,r,n=[];if(!angular.isObject(e)||angular.isArray(e))return null;for(t=0,o=c.length;t<o;t++)i=e[r=c[t]],-1<p.indexOf(i)&&n.push(l+"-"+r+"-"+i);return n.join(" ")},s.removeSpacingInElement=function(e,t){var o,i,r,n;if(!angular.isElement(e))return!1;if(o=e.attr("class"),!angular.isString(o))return!0;for("*"===t?t=c:angular.isArray(t)||(t=[t]),i=0,r=(o=o.split(" ")).length;i<r;i++)(n=a.exec(o[i]))&&-1!==t.indexOf(n[1])&&(o[i]="");return o=(o=o.join(" ")).replace(/\s+/g," ").trim(),e.attr("class",o),!0},s.parseElement=function(e,t){return angular.isElement(e)?s.parseClasses(e.attr("class"),t):null},s.setSpacingInElement=function(e,t,o){return!!angular.isElement(e)&&(-1!==c.indexOf(t)&&(null===o?(s.removeSpacingInElement(e,t),!0):-1!==p.indexOf(o)&&(s.removeSpacingInElement(e,t),e.addClass(l+"-"+t+"-"+o),!0)))},s.updateSpacingInElement=function(e,t){var o,i,r,n=[];if(!angular.isElement(e))return!1;if(!angular.isObject(t)||angular.isArray(t))return!1;for(o=0,i=c.length;o<i;o++)(null===(r=t[c[o]])||-1<p.indexOf(r))&&n.push(c[o]);if(!n.length)return!1;for(s.removeSpacingInElement(e,n),o=0,i=n.length;o<i;o++)(r=t[n[o]])&&e.addClass(l+"-"+n[o]+"-"+r);return!0},o(),this.$get=[function(){return{parseShort:s.parseShort,generateShort:s.generateShort,parseFromClasses:s.parseClasses,generateSpacings:s.generateSpacings,parseElement:s.parseElement,setSpacingInElement:s.setSpacingInElement,removeSpacingInElement:s.removeSpacingInElement,updateSpacingInElement:s.updateSpacingInElement}}]}]),angular.module("core.library.utils").provider("coreLibraryUtils",["coreLibraryConfigProvider",function(n){var t,a,o=Object.prototype.toString,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="";function e(){return{convertToTwoDigitHexCodeFromDecimal:function(e){var t=Math.round(e).toString(16);return 1<t.length||(t="0"+t),t},hue2rgb:function(e,t,o){return o<0&&(o+=1),1<o&&(o-=1),o<1/6?e+6*(t-e)*o:o<.5?t:o<2/3?e+(t-e)*(2/3-o)*6:e},hslToRgb:function(e,t,o){var i,r,n;if(0==t)i=r=n=o;else{var a=o<.5?o*(1+t):o+t-o*t,s=2*o-a;i=this.hue2rgb(s,a,e+1/3),r=this.hue2rgb(s,a,e),n=this.hue2rgb(s,a,e-1/3)}return[255*i,255*r,255*n]},rgbToHsl:function(e,t,o){e/=255,t/=255,o/=255;var i,r,n=Math.max(e,t,o),a=Math.min(e,t,o),s=(n+a)/2;if(n==a)i=r=0;else{var l=n-a;switch(r=.5<s?l/(2-n-a):l/(n+a),n){case e:i=(t-o)/l+(t<o?6:0);break;case t:i=(o-e)/l+2;break;case o:i=(e-t)/l+4}i/=6}return[i,r,s]},hex:function(e){return 10==e?"a":11==e?"b":12==e?"c":13==e?"d":14==e?"e":15==e?"f":e.toString()},hexToRGB:function(e){return e=e.toLowerCase(),{r:parseInt(e.substring(0,2),16)||0,g:parseInt(e.substring(2,4),16)||0,b:parseInt(e.substring(4,6),16)||0}},rgbToHex:function(e){var t,o=this;return t=o.hex(Math.floor(e.r/16)),t+=o.hex(e.r%16),t+=o.hex(Math.floor(e.g/16)),t+=o.hex(e.g%16),t+=o.hex(Math.floor(e.b/16)),t+=o.hex(e.b%16)}}}function i(t,o){var i;return angular.isObject(t)&&(o=t.height,t=t.width),t=parseInt(t),o=parseInt(o),i=t/o,{setWidth:function(e){return{width:e,height:Math.round(e/i),scale:e/t}},setHeight:function(e){return{width:Math.round(e*i),height:e,scale:e/o}},setScale:function(e){return{width:Math.round(t*e),height:Math.round(o*e),scale:e}}}}function r(e){var t,o=["Bytes","KB","MB","GB","TB"],i=parseInt(e);return 0===i?"0 Bytes":2<=(t=parseInt(Math.floor(Math.log(i)/Math.log(1024))))?(i/Math.pow(1024,t)).toFixed(2)+" "+o[t]:Math.round(i/Math.pow(1024,t))+" "+o[t]}function s(e,t,o){(t=t||{}).permalinks==o&&(t.permalinks=n.get("settings.website.permalinks")),t.suffix==o&&(t.suffix=n.get("settings.website.suffix"));var i=[],r={prefix:"",suffix:"",site:n.get("settings.website.address")};if(parseInt(n.get("settings.website.main_page"))==parseInt(e.id))return r.site;for(t.permalinks?t.suffix?r.suffix=".html":r.suffix="/":r.prefix="?url=";null!=e;)i.push(e.url),e=e.parent;return i.reverse(),r.site+r.prefix+i.join("/")+r.suffix}function l(e,t){return jQuery.extend(!0,e,t)}function c(o){o.yesHandler=o.yesHandler||angular.noop,o.noHandler=o.noHandler||angular.noop,t("views/components/ui/modal/confirm.tpl.html",function(e,t){e.question=o.question||"COMMON.TEXT.UNSAVED_CHANGES_CONFIRMATION",e.translate_params=o.translate_params,e.ok=function(){t.close(e),angular.isFunction(o.yesHandler)&&o.yesHandler()},e.cancel=function(){t.close(e),angular.isFunction(o.noHandler)&&o.noHandler()}})}function p(e,t){var o,i,r,n;return n=e+"_script",(r=$("#"+n)).length?r.is("[loading]")?o=r.data("deferred"):(o=a.defer()).resolve():((i=document.createElement("script")).setAttribute("loading",""),i.setAttribute("id",n),i.src=t,o=a.defer(),(r=$(i)).data("deferred",o),r.one("load",function(){i.removeAttribute("loading"),(o=r.data("deferred")).resolve(),r.removeData("deferred")}),document.getElementsByTagName("head")[0].appendChild(i)),o.promise}function g(e,t){var o,i;for(!t&&(t="-"),t=t.split(""),i=0;i<t.length;i++)o=new RegExp("\\"+t[i]+".","g"),e=e.replace(o,function(e){return e[1].toUpperCase()});return e}function m(e,t){return!t&&(t="-"),e.replace(/[A-Z]/g,function(e){return t+e.toLowerCase()})}function f(e){return $.map(e[0].attributes,function(e){return e.name})}function h(e){e.attr("class",e.attr("class").trim().replace(/\s\s+/g," "))}function y(e){return!0===e||"1"===e||1===e||"true"===e||0<parseInt(e)}function b(e){return parseInt(e)||0}function _(e){return angular.isUndefined(e)||null===e?"":""+e}function v(e){if(angular.isDate(e))return e;var t="";return angular.isObject(e)&&!angular.isUndefined(e.sec)?e=parseInt(e.sec):angular.isString(e)&&(-1==(e=e.trim()).indexOf(" ")?e=parseInt(e):t=new Date(e)),angular.isNumber(e)&&(t=new Date(1e3*e)),t}function E(e,t){return angular.isUndefined(t)?e:"integer"==t||"int"==t?b(e):"boolean"===t||"bool"===t?y(e):"string"==t?_(e):"object"!=t&&"array"!=t||!angular.isString(e)?"datetime"==t||"date"==t?v(e):e:angular.fromJson(e)}function w(e){return(e=_(e)).charAt(0).toUpperCase()+e.substr(1)}function S(e,t){if(!angular.isString(e)&&!angular.isNumber(e))return t||u;if(!(e+="").length)return"";var o,i,r,n="";for(i=0,r=e.length;i<r;i++)(o=e.charCodeAt(i))<128?n+=String.fromCharCode(o):(127<o&&o<2048?n+=String.fromCharCode(o>>6|192):(n+=String.fromCharCode(o>>12|224),n+=String.fromCharCode(o>>6&63|128)),n+=String.fromCharCode(63&o|128));return n}function M(e,t){if(!angular.isString(e)&&!angular.isNumber(e))return t||u;if(!(e+="").length)return"";var o,i,r,n,a,s,l,c="",p=0;for(e=S(e);p<e.length;)n=(o=e.charCodeAt(p++))>>2,a=(3&o)<<4|(i=e.charCodeAt(p++))>>4,s=(15&i)<<2|(r=e.charCodeAt(p++))>>6,l=63&r,isNaN(i)?s=l=64:isNaN(r)&&(l=64),c=c+d.charAt(n)+d.charAt(a)+d.charAt(s)+d.charAt(l);return c}function C(e,t){if(!angular.isString(e)&&!angular.isNumber(e))return t||u;if(!(e+="").length)return"";for(var o="",i=0,r=0,n=0,a=0;a<e.length;)(i=e.charCodeAt(a))<128?(o+=String.fromCharCode(i),a++):191<i&&i<224?(r=e.charCodeAt(a+1),o+=String.fromCharCode((31&i)<<6|63&r),a+=2):(r=e.charCodeAt(a+1),n=e.charCodeAt(a+2),o+=String.fromCharCode((15&i)<<12|(63&r)<<6|63&n),a+=3);return o}function I(e,t){if(!angular.isString(e)&&!angular.isNumber(e))return t||u;if(!(e+="").length)return"";var o,i,r,n,a,s,l="",c=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)o=d.indexOf(e.charAt(c++))<<2|(n=d.indexOf(e.charAt(c++)))>>4,i=(15&n)<<4|(a=d.indexOf(e.charAt(c++)))>>2,r=(3&a)<<6|(s=d.indexOf(e.charAt(c++))),l+=String.fromCharCode(o),64!=a&&(l+=String.fromCharCode(i)),64!=s&&(l+=String.fromCharCode(r));return l=C(l)}function T(e){return e&&e.window===e}function O(e){return e&&e.$evalAsync&&e.$watch}function k(e){return e&&angular.isFunction(e.then)}function A(e){return e&&angular.isFunction(e.resolve)&&angular.isFunction(e.reject)}function P(e,t){var o;if(!angular.isObject(t))return e;for(o in t)t.hasOwnProperty(o)&&(e[o]=angular.copy(t[o]));return e}function L(e){return o.call(e)}function D(e){return"[object Object]"===L(e)}function R(e,t,o){var i,r,n,a;if(!D(e)||!D(t))return!1;for(n in angular.isNumber(o)||(o=0),i={},t)if(t.hasOwnProperty(n))if(e.hasOwnProperty(n)){if(e[n]!==t[n])if(L(e[n])===L(t[n])){if(o&&angular.isObject(t[n])){if(!angular.isObject(e[n])){i[n]=t[n],r=!0;continue}if(0<o&&(a=R(e[n],t[n],o-1))){i[n]=a,r=!0;continue}}angular.equals(e[n],t[n])||(i[n]=t[n],r=!0)}else i[n]=t[n],r=!0}else i[n]=t[n],r=!0;return r?i:null}function W(e,t,o){var i,r,n,a,s=[];if(!angular.isObject(e))return s;for(i in angular.isNumber(t)&&(o=t),angular.isString(t)||(t="."),angular.isNumber(o)||(o=3),e)if(e.hasOwnProperty(i))if(o&&angular.isObject(e[i])&&!angular.isArray(e[i])&&!angular.isElement(e[i])){if((r=W(e[i],t,o-1)).length)for(n=0,a=r.length;n<a;n++)s.push(i+t+r[n])}else s.push(i);return s}function N(e,t,o){var i,r,n;try{for(r=t.split("."),n=e,i=0;i<r.length;i++)angular.isDefined(n)&&(n=n[r[i]]);if(angular.isDefined(n))return n}catch(e){}return o}function U(e){var t;if((t=angular.isString(e)?$("<div>"+e+"</div>"):e).find("*").addBack().contents().filter(function(){return 8===this.nodeType}).remove(),angular.isString(e))return t.html()}function x(e,o){return e.sort(function(e,t){return e[o]<t[o]?-1:e[o]>t[o]?1:0})}function F(e,t){var o,i,r="1";for(angular.isString(e)||(e="uid_"),t=parseInt(t),t=isNaN(t)?6:(t=Math.max(t,3),Math.min(t,12)),o=0;o<t;o++)r+="0";return r=parseInt(r),i=("000000000000"+Math.floor(Math.random()*r)).substr(-t),e+parseInt((new Date).getTime()/1e3,10)+"_"+i}function G(e,t){var o,i,r;if(angular.isArray(e))o=[];else{if(!angular.isObject(e))return null;o={}}for(angular.isArray(t)||(t=[t]),i=0,r=t.length;i<r;i++)angular.isDefined(e[t[i]])&&(o[t[i]]=e[t[i]]);return o}return app.coreUtilsService=new function(){this.rgb=e,this.fileSize=r,this.deepExtend=l,this.generateFullPageUrl=s,this.openConfirmationBox=c,this.loadScript=p,this.toCamelCase=g,this.fromCamelCase=m,this.getAttributes=f,this.prettifyClassAttribute=h,this.convertValue=E,this.convertToBoolean=y,this.convertToInteger=b,this.convertToString=_,this.convertToDate=v,this.ucfirst=w,this.utf8Encode=S,this.base64Encode=M,this.utf8Decode=C,this.base64Decode=I,this.isWindowLikeObject=T,this.isScopeLikeObject=O,this.isPromiseLikeObject=k,this.isDeferredLikeObject=A,this.getTypeOff=L,this.assignWithCopy=P,this.objectDiffQuick=R,this.objectKeysDeepPlain=W,this.getObjectValueByPath=N,this.removeComments=U,this.sortArrayByProperty=x,this.proportionalResize=i,this.generateUID=F,this.getOnlyValues=G,this.configure=function(e){t=e.coreLibraryModal,a=e.$q}},app.coreUtilsService,{rgb:e,fileSize:r,deepExtend:l,generateFullPageUrl:s,openConfirmationBox:c,loadScript:p,toCamelCase:g,fromCamelCase:m,getAttributes:f,prettifyClassAttribute:h,convertValue:E,convertToBoolean:y,convertToInteger:b,convertToString:_,convertToDate:v,ucfirst:w,utf8Encode:S,base64Encode:M,utf8Decode:C,base64Decode:I,isWindowLikeObject:T,isScopeLikeObject:O,isPromiseLikeObject:k,isDeferredLikeObject:A,getTypeOff:L,assignWithCopy:P,objectDiffQuick:R,objectKeysDeepPlain:W,getObjectValueByPath:N,removeComments:U,sortArrayByProperty:x,proportionalResize:i,generateUID:F,getOnlyValues:G,$get:["coreLibraryModal","$q",function(e,t){return app.coreUtilsService.configure({coreLibraryModal:e,$q:t}),app.coreUtilsService}]}}]),angular.module("core.library.validate").directive("form",[function(){return{restrict:"E",link:function(t,o,i){var r,n=!1;function a(){r.forIn(function(e){r[e]&&r[e].clearBalloon&&r[e].clearBalloon()})}function s(){return r.forIn(function(e){r[e]&&r[e].validate&&r[e].validate()}),r.$valid}function l(e){e.data&&e.data.errors&&!Array.isArray(e.data.errors)&&function o(e,t){var i;angular.isArray(e)?(i={isValid:!1,data:{}},e.forEach(function(e){i.data[e]={key:e,isValid:!1}}),r[t]&&r[t].setValidity&&r[t].setValidity(i)):angular.isObject(e)&&e.forIn(function(e,t){o(t,e)})}(e.data.errors)}function c(e){return e.stopPropagation(),e.preventDefault(),!1}function e(){return n&&(o.off("submit",c),n=!1),!1}t.$on("$destroy",function(){e()}),i.$observe("name",function(){var e=!1;return i.name&&t[i.name]&&(r=t[i.name],n||(o.on("submit",c),n=!0),r.setValidity=l,r.validate=s,r.clearErrors=a,e=!0),e})}}}]),angular.module("core.library.validate").directive("validate",["$translate","coreLibraryValidation",function(h,y){return{restrict:"A",require:"ngModel",link:function(o,i,r,n){var a,t,s,l,c,p,d=!1,u="group-not-valid";function g(){s&&s.remove(),t.removeClass(u)}function m(e){n.$error.forIn(function(e){n.$setValidity(e,!0)}),g(),e.isValid?t.removeClass(u):(t.addClass(u),e.data.forIn(function(e,t){var o,i=t.args;switch(t.key){case"stringLengthTooShort":o="COMMON.VALIDATION_ERROR.STRING_LENGTH_TOO_SHORT",i=c.minLen?{minimum_character_count:c.minLen}:{};break;case"stringLengthTooLong":o="COMMON.VALIDATION_ERROR.STRING_LENGTH_TOO_LONG",i=c.maxLen?{maximum_character_count:c.maxLen}:{};break;case"isEmpty":o="COMMON.VALIDATION_ERROR.REQUIRED_VALUE";break;case"incorrectURL":o="COMMON.VALIDATION_ERROR.INCORRECT_URL";break;case"hostnameUnknownTld":o="COMMON.VALIDATION_ERROR.UNKNOWN_TLD_FOR_HOSTNAME";break;case"hostnameLocalNameNotAllowed":o="COMMON.VALIDATION_ERROR.LOCAL_NAME_NOT_ALLOWED_FOR_HOSTNAME";break;case"hostnameInvalidHostname":case"hostnameInvalidHostnameSchema":o="COMMON.VALIDATION_ERROR.INCORRECT_HOSTNAME";break;case"hostnameInvalidUri":o="COMMON.VALIDATION_ERROR.INCORRECT_HOSTNAME_URI";break;case"emailAddressInvalidFormat":case"emailAddressInvalidHostname":o="COMMON.VALIDATION_ERROR.INCORRECT_EMAIL";break;case"valueNotConfirm":case"notSame":o="COMMON.VALIDATION_ERROR.NOT_CONFIRMED_VALUE";break;case"valueInvalid":o="COMMON.VALIDATION_ERROR.INCORRECT_VALUE";break;case"recordFound":case"notUnique":o="COMMON.VALIDATION_ERROR.VALUE_ALREADY_EXISTS";break;default:o=t.key}n.$setValidity(t.key,t.isValid),t.message=h.instant(o,i)}),s=i.balloon({position:l,data:e}),(p=o.$eval(r.balloonStyle))&&s.css(p))}function f(){var e;r.confirm&&a.setValidateOption("confirm",(r.confirm&&(e=o.$eval(r.confirm)),e)),m(a.validate(n.$viewValue))}function e(){return d&&(i.off("blur",f),d=!1),!1}t=i.closest(".form-group"),o.$on("$destroy",function(){e()}),r.$observe("validate",function(){var e,t=!1;return r.validate&&(e=o.$eval(r.validate))&&(c=e,d||(i.on("blur",f),d=!0),a=y.getValidatorByOptions(e),l=r.validatePosition||"right",n.setValidity=m,n.validate=f,n.clearBalloon=g,t=!0),t})}}}]),angular.module("core.library.validate").provider("coreLibraryValidation",[function(){var n={},i={TOO_SHORT:"stringLengthTooShort",TOO_LONG:"stringLengthTooLong",IS_EMPTY:"isEmpty",EMAIL_INVALID:"emailAddressInvalidHostname",URL_INVALID:"incorrectURL",NOT_CONFIRM:"valueNotConfirm",NUMBER_BIGGER:"numberIsBigger",NUMBER_SMALLER:"numberIsSmaller",VALUE_INVALID:"valueInvalid"},t=function(e){var o=this;o&&(e=e||{},o._options={},e.forIn(function(e,t){n.hasOwnProperty(e)&&(o._options[e]=t)}))};function e(e,t){var o={isValid:!1,key:i.TOO_LONG,args:{MaxLen:t}};return null==e?(o.isValid=!0,o.key=""):t>=(e=e.toString().trim()).length&&(o.isValid=!0,o.key=""),o}function o(e,t){var o={isValid:!1,key:i.TOO_SHORT,args:{MinLen:t}};return null==e?(o.isValid=!0,o.key=""):t<=(e=e.toString().trim()).length&&(o.isValid=!0,o.key=""),o}function r(e,t){var o={isValid:!1,key:i.VALUE_INVALID,args:{}};return t=new RegExp(t),null==e?(o.isValid=!0,o.key=""):t.test(e)&&(o.isValid=!0,o.key=""),o}t.prototype={_options:null,setValidateOption:function(e,t){n[e]&&(this._options[e]=t)},validate:function(i){var r={isValid:!0,data:{}};return this._options.forIn(function(e,t){var o;o=(0,n[e])(i,t),r.data[e]=o,r.isValid&&!1===o.isValid&&(r.isValid=!1)}),r}},n={req:function(e){var t={isValid:!1,key:i.IS_EMPTY,args:{}};return(e=(e=null==e?"":e.toString()).trim())&&0<e.length&&(t.isValid=!0,t.key=""),t},email:function(e){var t={isValid:!1,key:i.EMAIL_INVALID,args:{}};return e&&!/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e)||(t.isValid=!0,t.key=""),t},url:function(e){var t={isValid:!1,key:i.URL_INVALID,args:{}};return null==e?(t.isValid=!0,t.key=""):(!e||0===e.length||function(e){var t,o,i,r;for(t=e.indexOf("//"),t=(i=e.substr(t+2)).indexOf("/"),o=i.substr(0,t).split("."),r=0;r<o.length;r++)if(64<=o[r].length)return!1;return!0}(e)&&/^((?:(?:https?|ftp):\/\/)|(?:\/\/))(?:\S+(?::\S*)?@)?(?:(?!(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:[a-z\u00a1-\uffff]+))(?::\d{2,5})?(?:\/\S*)?$/i.test(e))&&(t.isValid=!0,t.key=""),t},max:function(e,t){var o={isValid:!1,key:i.NUMBER_BIGGER,args:{Max:t}};return null==e?(o.isValid=!0,o.key=""):(e=0<=e.indexOf(".")?parseFloat(e):parseInt(e))<=t&&(o.isValid=!0,o.key=""),o},min:function(e,t){var o={isValid:!1,key:i.NUMBER_SMALLER,args:{Min:t}};return null==e?(o.isValid=!0,o.key=""):t<=(e=0<=e.indexOf(".")?parseFloat(e):parseInt(e))&&(o.isValid=!0,o.key=""),o},maxLen:e,minLen:o,confirm:function(e,t){var o={isValid:!1,key:i.NOT_CONFIRM,args:{}};return e===t&&(o.isValid=!0,o.key=""),o},regExp:r,reg_exp:r,min_len:o,max_len:e},this.setValidator=function(e,t){n[e]=t},this.getValidator=function(e,t){return n[e]||t},this.getValidatorByOptions=function(e){return new t(e)},this.getAllValidators=function(){return n},this.getErrorMessages=function(){return i},this.getErrorMessage=function(e,t){return i[e]||t},this.setErrorMessage=function(e,t){i[e]=t},this.$get=[function(){return this}]}]),angular.module("core.library.viewportInitialScale").directive("viewportInitialScale",["$window","viewportInitialScaleService",function(s,l){return{restrict:"A",link:function(e,t,o){var i,r,n,a;e.setInitialScale=function(){i="width=device-width, initial-scale=1",r=l.checkMediaQuery("(max-device-width: 567px)"),n=l.checkMediaQuery("(min-device-width: 568px) and (max-device-width: 749px)"),a=l.checkMediaQuery("(min-device-width: 750px) and (max-device-width: 1024px)"),r?i="width=device-width, initial-scale=0.27":n?i="width=device-width, initial-scale=0.5":a&&(i="width=device-width, initial-scale=0.65"),o.$set("content",i)},e.setInitialScale(),angular.element(s).bind("resize",function(){l.isDesktop()||e.setInitialScale()})}}}]),angular.module("core.library.viewportInitialScale").provider("viewportInitialScaleService",[function(){var o={phone:"(max-device-width: 767px)",tablet:"(min-device-width: 768px) and (max-device-width: 1024px)",desktop:"(min-device-width: 1025px)",portrait:"(orientation: portrait)",landscape:"(orientation: landscape)",retina:"(-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)"};this.setRule=function(e,t){return o[e]=t,this},this.setRules=function(e){var t;for(t in e)e.hasOwnProperty(t)&&this.setRule(t,e[t]);return this},this.$get=["$window",function(t){var e={checkMediaQuery:function(e){if(e)return t.matchMedia(e).matches},isPhone:function(){return t.matchMedia(o.phone).matches},isTablet:function(){return t.matchMedia(o.tablet).matches},isDesktop:function(){return t.matchMedia(o.desktop).matches},isPortrait:function(){return t.matchMedia(o.portrait).matches},isLandscape:function(){return t.matchMedia(o.landscape).matches},isRetina:function(){return t.matchMedia(o.retina).matches}};return e}]}]),angular.module("application.widget.abstract_container",["application.widget.abstract"]).run(["coreLibraryWidget","$q","$translate","coreLibraryMessenger","coreLibraryUtils",function(i,l,o,r,n){var a=i.get("AbstractWidgetClass");function e(e){this.children=[],e.children&&e.children.length&&(this.children=e.children),a.call(this,e)}((e.prototype=Object.create(a.prototype)).constructor=e).prototype.isContainer=function(){return!0},e.prototype.shouldUpdateContentView=function(e){return!1},e.prototype.isTargetElementEmpty=function(e){return!this.getTargetElement(e).find(".moto-widget").length},e.prototype._allowedDragMethods=[{rule:"default",result:"append"},{rule:"top:edge",result:"before"},{rule:"bottom:edge",result:"after"}],e.prototype.getHelperInsertPosition=function(e){var t=this._$dom.outerHeight(),o=this._Editor.Utils.getContainerEdgeHeight(this);return"block"===e.droppedWidgetOptions.widgetName?e.eventPositions.targetWidgetOffsetY<=t/2?"before":"after":e.eventPositions.targetWidgetOffsetY<=o?"before":e.eventPositions.targetWidgetOffsetY>=t-o?"after":e.eventPositions.targetWidgetOffsetY>o&&e.eventPositions.targetWidgetOffsetY<t-o&&this._$targetDomElement.is("[data-container]")?"append":e.eventPositions.targetWidgetOffsetY<=t/2?"before":"after"},e.prototype.getDomElementsWhereWidgetsCanBePlaced=function(){return this._$dom},e.prototype.getNestedWidgets=function(e){var t=i.Environment.getGlobal("MotoEditor");return t&&t.Widgets.getNestedWidgetsByWidget(this,e)},e.prototype.getChildrenWidgets=function(e){var t=i.Environment.getGlobal("MotoEditor");return t&&t.Widgets.getChildrenWidgetsByWidget(this,e)},e.prototype.getChildrenCount=function(){return this.children.length},e.prototype.getTargetDataForPaste=function(e){var t,o=this.getPositionInContent();return i.isContainers(e.name)?(t=this._parent,o.positionIndex++):(t=this,o.positionIndex=t.children.length),{targetWidget:t,widgetPosition:o}},e.prototype.canBeRemoved=function(){var e,t;return!!this.isRemovable()&&(!!this.isEmpty()||1!=this._$dom.find(".cke_focus").length&&((t=this._Editor.getUnremovableWidgetInside(this))?(r.error("WIDGET.COMMON.UNREMOVABLE_WIDGET_ERROR_MESSAGE",{widget_name:o.instant(t.label)}),!1):(e=l.defer(),n.openConfirmationBox({yesHandler:e.resolve,noHandler:e.reject,question:"WIDGET.COMMON.REMOVE_WIDGET_CONFIRMATION"}),e.promise)))},e.prototype.exportWidgetsToObject=function(i){var r=[],n=0,a=i.length,s=l.defer();return function e(t){var o;t&&r.push(t),n<a&&(o=i[n],n++),o?o.exportToObject().then(e,s.reject):s.resolve(r)}(),s.promise},e.prototype.exportChildrenToObject=function(){return this.exportWidgetsToObject(this.children||this.getChildrenWidgets())},e.prototype.__toObject=function(){var t=a.prototype.__toObject.call(this),o=l.defer();return t.children=t.children||[],l.when(this.exportChildrenToObject()).then(function(e){t.children=e,o.resolve(t)}),o.promise},e.prototype.children=[],e.prototype._childrenIniting=!1,e.prototype._childrenInited=!1,e.prototype.insertChildAction=function(e,t){var o,i=this.getDomElementsWhereWidgetsCanBePlaced(),r=this.$(i[t.containerIndex||0]);return r?(e.setParentWidget(this),(window.$container=r).append(e._dom),angular.isDefined(t.positionIndex)&&-1<t.positionIndex&&e.getPositionIndexInContainer()!==t.positionIndex&&((o=r.children(".moto-widget[data-widget]").eq(t.positionIndex))?(console.warn(this.name,": insertChildAction : move new widget from ",e._$dom.index(),e.getPositionIndexInContainer()," to ",t.positionIndex),o.before(e._dom)):console.warn(this.name,": insertChildAction : cant find exists widget by index",t.positionIndex)),!0):(console.error(this.name,": insertChildAction : cant find container for insert widget",t),!1)},e.prototype.onAppendChildEvent=function(e,t){this.updateEmptyClass(),this.emitEvent("contentUpdated",this)},e.prototype.onRemoveChildEvent=function(e,t){this.updateEmptyClass(),this.emitEvent("contentUpdated",this)},e.prototype.getPositionChildIndexInContainer=function(e,t){return this.children.indexOf(e)},e.prototype.getContainerPositionIndexByChild=function(e){return this.getContainerIndexByElement(e._$dom)},e.prototype.getContainerIndexByElement=function(e){return this.getDomElementsWhereWidgetsCanBePlaced().index(e.parent())},e.prototype.scanLiveChildren=function(){var e,t,o,i;for(i=(e=this._Editor.Widgets.getChildrenWidgetsByWidget(this)).length,o=this.children.length=0;o<i;o++)(t=e[o])?(t._parent!==this&&t.setParentWidget(this),this.children.push(t)):console.error("scanLiveChildren : empty widget")},e.prototype.initChildrenByDom=function(e){var t,o,i,r;if(e||!this._childrenInited&&!this._childrenIniting){for(r=(t=this._Editor.Utils.getChildWidgetElementsByDom(this.getDomElementsWhereWidgetsCanBePlaced())).length,this.children=[],this._childrenIniting=!0,i=0;i<r;i++)if(o=this._Editor.initializeWidgetByDom(t[i],this)){if(this.children.push(o),o.initChildrenByDom)try{o.initChildrenByDom(e)}catch(e){console.error("Error on initChildrenByDom"),console.error("Error",e),console.error("Parent",this),console.error("Widget",o)}}else console.error("initChildrenByDom : can not init widget from dom",t[i]);this._childrenInited=!0,this._childrenIniting=!1}},e.prototype.__exportWidget=function(e){var t,o,i=a.prototype.__exportWidget.call(this,e);if(i.children=[],this.children&&this.children.length)for(t=0,o=this.children.length;t<o;t++)i.children.push(this.children[t].__exportWidget(e));return i},e.prototype.exportForSave=function(){var e,t,o=a.prototype.exportForSave.call(this);if(o.children=[],this.children&&this.children.length)for(e=0,t=this.children.length;e<t;e++)o.children.push(this.children[e].exportForSave());return o},e.prototype.exportForCopy=function(){var e,t,o=a.prototype.exportForCopy.call(this);if(o.children=[],this.children&&this.children.length)for(e=0,t=this.children.length;e<t;e++)this.children[e].isCopyable()&&o.children.push(this.children[e].exportForCopy());return o},e.prototype.exportForFuture=function(){var e,t,o=a.prototype.exportForFuture.call(this);if(o.children=[],this.children&&this.children.length)for(e=0;e<this.children.length;e++)t=this.children[e].exportForFuture(),angular.isObject(t)&&o.children.push(t);return o},e.prototype.postRenderPreview=function(){a.prototype.postRenderPreview.apply(this,arguments),this.updateEmptyClass(),this.reConnectChildren()},e.prototype.reConnectChildren=function(){var e,t,o,i=this.children.length;for(e=0;e<i;e++)if(t=this.children[e],(o=this.$("#"+t.getId(),this._$dom)).length||(o=this.$(".moto-widget[data-widget-id="+t.getId()+"]",this._$dom)),o.length){t.connectNode(o.get(0)),t._$dom.attr("draggable",t.isDraggable()),t.updateSpacingsInDOM();try{t.update()}catch(e){console.error("reConnectChildren widget.update()"),console.log("ERROR : ",e),console.log("WIDGET : ",t)}try{t.postRenderPreview()}catch(e){console.error("Error on reConnectChildren => postRenderPreview"),console.warn("ERROR",e),console.warn("WIDGET",t)}this._Editor.getScope().$broadcast("widget.preset.afterChange",t)}else console.error("reConnectChildren : Children node not found by #id or [data-widget-id]")},e.prototype.devQuickConvertWidget=function(e){var t={id:this.getWidgetId(),dom:this._dom,name:this.name,properties:angular.copy(this.properties)};if(this.children&&this.children.length){e&&console.group(t.name,t.id,this.children.length),t.children=[];for(var o=0,i=this.children.length;o<i;o++)t.children.push(this.children[o].devQuickConvertWidget(e));e&&console.groupEnd()}else e&&console.log(t.name,t.id);return t},e.prototype.clearUnnecessaryAnchors=function(){this.$(">a.moto-anchor",this._dom).slice(1).remove()},e.prototype.getAnchorDomElement=function(){return this.$(">a.moto-anchor",this._dom).first()},e.prototype.updateAnchorDomElement=function(){var e=this.getAnchorDomElement();this.properties.anchor.length?(e.length||(this._$dom.prepend('<a class="moto-anchor"></a>'),e=this.getAnchorDomElement()),e.attr("name",this.properties.anchor)):e.length&&e.remove()},i.set("AbstractContainerWidgetClass",e)}]),angular.module("application.widget.abstract_form-element",["application.widget.abstract"]).run(["coreLibraryWidget",function(e){var o=e.get("AbstractWidgetClass");function t(e){o.call(this,e)}((t.prototype=Object.create(o.prototype)).constructor=t).prototype._transformToMacros=!0,t.prototype._apiVersion=2,t.prototype.isCopyable=function(){return!0},t.prototype.getMainForm=function(){return this.__mainForm||(this.__mainForm=function(e){for(;!e.__formBuilder;)e=e._parent;return e}(this)),this.__mainForm},t.prototype.getCurrentPreset=function(){var e,t=o.prototype.getCurrentPreset.call(this);return t||(t=(e=this.getMainForm())?e.getCurrentPreset():"default"),t},e.set("AbstractFormElementWidgetClass",t)}]),angular.module("application.widget.abstract_form-field",["application.widget.abstract"]).run(["coreLibraryWidget",function(e){var o=e.get("AbstractFormElementWidgetClass"),t=[{name:"StripTags"},"trim"];function i(e){o.call(this,e)}((i.prototype=Object.create(o.prototype)).constructor=i).prototype.getFieldName=function(){return this.properties.name},i.prototype.getFieldType=function(){return this.properties.type||"text"},i.prototype.exportForCopy=function(){var e=o.prototype.exportForCopy.apply(this,arguments),t=this.getMainForm();return t&&t._selectingLocked&&delete e.properties.name,e},i.prototype.getFieldFilters=function(){return angular.copy(t)},i.prototype.getFieldValidators=function(){var e,t=[];return this.properties.validation.required&&t.push("required"),"number"!==this.properties.type&&angular.isObject(this.properties.validation.stringLength)&&(e="length:",this.properties.validation.stringLength.allowMin?e+=this.properties.validation.stringLength.minValue:e+="0",this.properties.validation.stringLength.allowMax&&(e+=","+this.properties.validation.stringLength.maxValue),t.push(e)),"number"===this.properties.type&&angular.isObject(this.properties.validation.numberValue)&&(e="between:",this.properties.validation.numberValue.allowMin&&angular.isDefined(this.properties.validation.numberValue.minValue)&&null!==this.properties.validation.numberValue.minValue?e+=this.properties.validation.numberValue.minValue:e+="-2147483647",this.properties.validation.numberValue.allowMax&&angular.isDefined(this.properties.validation.numberValue.maxValue)&&null!==this.properties.validation.numberValue.maxValue&&(e+=","+this.properties.validation.numberValue.maxValue),t.push(e)),angular.isObject(this.properties.validation.fileSize)&&(e="fileSize:",this.properties.validation.fileSize.allowMin?e+=this.properties.validation.fileSize.minValue:e+="0",this.properties.validation.fileSize.allowMax&&(e+=","+this.properties.validation.fileSize.maxValue),t.push(e)),angular.isObject(this.properties.validation.fileExtension)&&this.properties.validation.fileExtension.allowed&&t.push("fileExtension:"+this.properties.validation.fileExtension.value),t},e.set("AbstractFormFieldWidgetClass",i)}]),angular.module("application.widget.abstract",["core.library.utils","core.library.config","core.library.PathResolver","core.library.Widget"]).run(["coreLibraryWidget","$templateCache","coreLibraryUtils","$http","$q","coreLibrarySpacingHelper","coreLibraryConfig","coreLibraryPathResolver",function(s,o,a,l,c,t,e,i){var p={};function d(){return e.isDevelopment()}function r(e,t){var o,i="";for(r._tik++,e=e||24,(!angular.isString(t)||t.length<2)&&(t="0123456789abcdefghijklmnopqrstuvwxyz"),o=0;o<e;o++)i+=t.charAt(Math.floor(Math.random()*t.length));return r._last===i&&r._tik<5?r(e,t):(r._last=i,r._tik=0,i)}function n(){return"wid_"+parseInt((new Date).getTime()/1e3,10)+"_"+r(9)}function u(e){angular.isObject(e)?(this._config=e,this._Environment=e.Environment,this._Editor=e.Editor||this._Environment.getEditor(),this._EditorContentManager=this._Editor&&this._Editor.ContentManager||this._Environment.getContentManager(),this._WidgetFactory=e.WidgetFactory,this._EventManager=e.EventManager||this._Environment.getEventManager(),this._id=e.widgetId||e.id||n(),this._dragImagePath&&(this._dragImage=new Image,this._dragImage.src=i.getUrl(this._dragImagePath)),this._propertiesLoaded=angular.isObject(e.properties),this.properties=$.extend(!0,this.properties||{},e.properties||{}),this._windowContext=e.window||this._Environment.getGlobal("window"),this._parent=e.parent||null,this._helpers=e.Helpers||this._Environment.getGlobal("EditorHelpers"),this.$=e.$||this._Environment.getGlobal("$"),this._dom=null,e.dom&&this._replaceNode(e.dom),this.name=this.name||null,this.label=this.label||null,this._templateViewURL=this._templateViewURL||null,this.controller=this.controller||angular.noop,this.template=this.template||null,this.events=this.events||{},this.properties&&angular.isString(this.properties.align)&&(this.properties.align={desktop:this.properties.align,tablet:"","mobile-h":"","mobile-v":""})):d()&&console.error(new Error("Widget can not be just create, please use WidgetFactory"))}r._tik=0,u.prototype={_id:null,_permanentId:!1,_widgetId:null,_config:null,_windowContext:null,_Editor:null,_EditorContentManager:null,_dom:null,_parent:null,_helpers:null,_Environment:null,_transformToMacros:!1,_apiVersion:1,_propertiesLoaded:!1,_initialized:!1,_dragImagePath:null,_dragImage:null,_silentMode:!1,_lockedBy:null,_selectingLocked:!1,__renderingState:!1,__isPublicInstance:!1,__publicInstance:null,__internalInstance:null,__getPublicInstance:function(){return this.__publicInstance},__getInternalInstance:function(){return this},$:null,name:null,label:null,controller:null,_templateViewURL:null,template_url:null,_template:null,properties:null,events:null,getName:function(){return this.name},getCurrentPreset:function(){return this.properties.preset},isDraggable:function(){return!0},isUnselectable:function(){return this._selectingLocked},isDuplicatableInSection:function(){return!0},isAutoShowHelpers:function(e){return!0},isAutoHideHelpers:function(e){return!0},getLazyLoadingCssClass:function(){return""},isSelected:function(){return this._Editor.getCurrentWidget()===this},triggerEvent:function(e,t){var o,i=e.trim();return i="on"+(i=(i=a.toCamelCase(i,"-.:")).charAt(0).toUpperCase()+i.slice(1))+"Event",angular.isFunction(this[i])?(t=[o={name:e,method:i,preventDefault:function(){o.defaultPrevented=!0},defaultPrevented:!1}].concat([].slice.call(arguments,1)),this[i].apply(this,t)):this.events&&this.events[e]?(t=[].slice.call(arguments,1),this.events[e].apply(this,t)):void 0},emitEvent:function(){this.triggerEvent.apply(this,arguments),this._parent&&this._parent.emitEvent.apply(this._parent,arguments)},broadcastEvent:function(){var e,t,o;if(this.triggerEvent.apply(this,arguments),this.isContainer())for(t=0,o=(e=this.getChildrenWidgets()).length;t<o;t++)e[t].broadcastEvent.apply(e[t],arguments)},broadcastEventExceptMe:function(){var e,t,o;if(this.isContainer())for(t=0,o=(e=this.getChildrenWidgets()).length;t<o;t++)e[t].broadcastEvent.apply(e[t],arguments)},broadcastEventOnlyChildren:function(){var e,t,o;if(this.isContainer())for(t=0,o=(e=this.getChildrenWidgets()).length;t<o;t++)e[t].triggerEvent.apply(e[t],arguments)},getWidgetId:function(){return this.getId()},getId:function(){return this._id||(this._id=n())},getIconClassName:function(e){return"icon-"+this.name.replace(/\./g,"-")+("medium"===e?"-medium":"")},template:function(i){var e,r,n,t,a=this;if(n=s.getRenderTemplateItemClass(),this._template&&this._template.content)return this._template.renderItem||(this._template.renderItem=new n({engine:this._getTemplateEngine("swig"),content:this._template.content})),void i(this._template.renderItem);r=a._getTemplateUrl(),t=r,(e=angular.isUndefined(p[t])?null:p[t])?i(e):l({url:r,method:"GET",cache:o,ignoreLoadingBar:!0,transformResponse:function(e){return e}}).then(function(e){var t,o=new n({engine:a._getTemplateEngine("swig"),path:r,content:e.data});t=o,angular.isObject(t)&&(p[t.path]=t),i(o)})},_getTemplateUrl:function(){var e=null;return e=angular.isFunction(this.templateUrl)?this.templateUrl():this.templateUrl,angular.isObject(this._template)&&this._template.path&&(e=this._template.path),e},_getTemplateEngine:function(e){return angular.isObject(this._template)&&this._template.engine||e},templateUrl:function(){var e=this,t=e.properties?e.properties.preset:null;return"@websiteWidgets/"+(t?e.name+"/presets/"+t+"/template.html.twig":e.name+"/"+a.ucfirst(e.name)+".html.twig")},getRenderVariables:function(){return{currentWidget:this}},initialize:function(){this.properties=this.properties||{},this._propertiesLoaded||this._$dom.data("spacing")&&(this.properties.spacing=t.parseShort(this._$dom.data("spacing"),this.properties.spacing||{}),this.updateSpacingsInDOM()),this.properties.preset&&!angular.isString(this.properties.preset)&&(this.properties.preset=this.properties.preset.toString()),this._propertiesLoaded=!0},create:function(){this._propertiesLoaded=!0},destroy:function(){},fallAsleep:function(){},transform:function(){this._transformToMacros||(this._$dom.removeAttr("data-widget-id"),this._permanentId||this._$dom.removeAttr("id"),a.prettifyClassAttribute(this._$dom))},remove:function(e){console.warn("@deprecated calling widget.remove()",this.name,this.getId()),angular.isFunction(e)&&(e={callback:e}),angular.isObject(e)||(e={}),e.widget=this,e.callback=e.callback||angular.noop,this._Editor.destroyWidget(this)&&e.callback()},beforeDestroy:function(){},afterDestroy:function(){},beforeCreate:function(){},afterCreate:function(){},getTargetElement:function(e){return this._$targetDomElement||this._$dom},update:function(){},isEmpty:function(){return!(e=this,$(e._$dom).find(".moto-widget")).length;var e},updateEmptyClass:function(){this.isEmpty()?this._$dom.addClass("moto-widget_empty"):this._$dom.removeClass("moto-widget_empty")},isRemovable:function(){return!this._$dom.parent().closest(".moto-widget_content-locked").length},canBeRemoved:function(){return this.isRemovable()},isCopyable:function(){return!1},getDragImage:function(){return this._dragImage},getTemplateViewUrl:function(){return this._templateViewURL||this.template_view_url||"@websiteWidgets/"+this.name+"/views/properties.tpl.html"},select:function(){this._Editor.selectWidget(this)},toObject:function(){return function e(t,o){var i,r;for(i in o=o||{},t)"_"!==i[0]&&!angular.isFunction(t[i])&&t.hasOwnProperty(i)&&(r=t[i],angular.isArray(r)?r=e(r,[]):angular.isObject(r)&&(r=angular.isFunction(r.toObject)?r.toObject():e(r)),o[i]=r);return o}(this)},toJSON:function(){return angular.toJson(this.toObject())},updateAlignInDOM:function(){this.properties&&this.properties.align&&(this._$dom.attr("class",this._$dom.attr("class").replace(/(^|\s)moto-align-\S+/g,"")),this._$dom.addClass(this.getAlignClass()))},updateSpacingsInDOM:function(){this.properties&&this.properties.spacing&&(t.updateSpacingInElement(this._$dom,this.properties.spacing),this._transformToMacros||this._$dom.attr("data-spacing",t.generateShort(this.properties.spacing)))},updateVisibleOnInDOM:function(){this.properties&&this.properties.visible_on&&(this._$dom.attr("class",this._$dom.attr("class").replace(/(^|\s)moto-visible-on_\S+/g,"")),this._$dom.addClass(this.getVisibleOn("classes")))},setAnimationClass:function(){var e=this;e.$(e._dom).hasClass("wow")?e.$(e._dom).removeClass(e.$(e._dom).attr("data-animation")).addClass(e.properties.animation):e.$(e._dom).addClass("wow "+e.properties.animation),e.$(e._dom).attr("data-animation",e.properties.animation)},unsetAnimationClass:function(){var e=this;e.$(e._dom).attr("data-animation")&&(e.$(e._dom).removeClass("wow").removeClass(e.$(e._dom).attr("data-animation")),e.$(e._dom).removeAttr("data-animation"))},shouldUpdateContentView:function(e){return!0},shouldBeRendered:function(){return!0},manualUpdateContentView:function(e){angular.isFunction(this.update)&&this.update()},isVisibleInNesting:function(){return!0},getWidgetForHelper:function(e){return this},__syncProperties:function(){this.__publicInstance&&this.__publicInstance.__syncProperties()},updateContentView:function(o,i){var r=this,n=new Date;return r.__renderingState=!0,angular.isFunction(o)&&(i=o),angular.isObject(o)||(o={}),angular.isFunction(i)||(i=angular.noop),o.debug=o.debug||!1,o.debug&&(console.group("updateContentView widget "+r.name),console.log("Params : ",o),r.__renderingState&&console.warn(r.name,"already rendering")),r.renderAsString(function(e,t){if(t=t.trim(),e)return o.debug&&(console.log("updateContentView : end with error"),console.log("Time : ",new Date-n),console.groupEnd(),console.group("ERROR on updateContentView"),console.error("updateContentView on renderAsString"),console.log("ERROR:",e),console.log("WIDGET:",r),console.groupEnd()),r.__renderingState=!1,i(e,t);r.updateContentViewByString(t,{mode:"update",debug:o.debug},function(e,t){if(e)return o.debug&&(console.group("ERROR on updateContentView"),console.error("updateContentView on updateContentViewByString"),console.log("ERROR:",e),console.log("WIDGET:",r),console.groupEnd()),r.__renderingState=!1,i(e);o.debug&&(console.log("updateContentView : end"),console.log("Time : ",new Date-n),console.groupEnd()),r.__renderingState=!1,i(e,t)})},{mode:"update",debug:o.debug})},connectNode:function(e){return angular.isElement(e)?((e=(this.$||$)(e).get(0)).id||(e.id=this.getId()),this._dom=e,this.$&&(this._$dom=this.$(this._dom),this._$dom.data("widget-id")||this._$dom.attr("data-widget-id",this.getId())),!0):(d()&&console.error("Widget DOM Node can be connected by",{node:e,widget:this}),!1)},disconnectNode:function(){return this._dom=null,!(this._$dom=null)},_replaceNode:function(e){var t;return e=(this.$||$)(e).get(0),this._dom&&(t=this._dom),this.connectNode(e)?(t&&t.parentNode&&t.parentNode.replaceChild(this._dom,t),!0):(d()&&console.error("Widget DOM Node can be replaced by",{node:e,widget:this}),!1)},updateContentViewByString:function(t,o,i){var r,n=this,a=new Date;if(angular.isFunction(o)&&(i=o),angular.isObject(o)||(o={}),angular.isFunction(i)||(i=angular.noop),o.debug=o.debug||!1,o.debug&&(console.group("updateContentViewByString widget "+this.name),console.log("Params : ",o)),!(r=(r=this.$(t))[0]||null))return o.debug&&(console.log("updateContentViewByString : end"),console.log("Time : ",new Date-a),console.error("CANT_CREATE_DOM_NODE_FROM_CONTENT"),console.log("CONTENT:",t),console.groupEnd()),i({message:"CANT_CREATE_DOM_NODE_FROM_CONTENT",content:t});try{try{this._replaceNode(r)}catch(e){return o.debug&&(console.log("updateContentViewByString : end"),console.log("Time : ",new Date-a),console.error("CANT_REPLACE_DOM_NODE",e),console.log("NODE:",r),console.log("WIDGET:",this),console.groupEnd()),i({message:"CANT_REPLACE_DOM_NODE",error:e,node:r,widget:this})}n._$dom.closest(".moto-widget_content-locked").length||n._$dom.attr("draggable",n.isDraggable()),n.updateSpacingsInDOM();try{n.update()}catch(e){o.debug&&(console.error("updateContentViewByString widget.update()"),console.log("ERROR : ",e),console.log("WIDGET : ",n))}try{n.postRenderPreview()}catch(e){d()&&(console.error("Error on updateContentViewByString => postRenderPreview"),console.warn("ERROR",e),console.warn("WIDGET",n))}n.isSelected()&&(n._$dom.addClass("moto-widget_selected"),n._Editor.HelperSelected.showByWidget(n)),o.debug&&(console.log("updateContentViewByString : end"),console.log("Time : ",new Date-a),console.groupEnd()),this._Editor.getScope().$broadcast("widget.preset.afterChange",this),i(null,!0)}catch(e){return o.debug&&(console.log("updateContentViewByString : end"),console.log("Time : ",new Date-a),console.error("CANT_UPDATE_WIDGET",e),console.log("CONTENT:",t),console.log("WIDGET:",this),console.groupEnd()),i({message:"CANT_UPDATE_WIDGET",error:e,widget:this})}},postRenderAsString:function(e,t){return t&&t.debug&&console.log("postRenderAsString"),e},renderAsString:function(i,e){var r=this,n=new Date;angular.isObject(e)||(e={}),angular.isFunction(i)||(i=angular.noop),e.mode=e.mode||null,e.type="string",e.content="",e.debug=e.debug||!1,e.debug&&(console.group("renderAsString widget "+this.name),console.log("Params : ",e)),r._renderAsString(function(e,t,o){if(o.debug&&console.log("_renderAsString : end"),e)return o.debug&&(console.log("renderAsString : end with error"),console.log("Time : ",new Date-n),console.groupEnd(),console.group("ERROR on renderAsString"),console.error("renderAsString on _renderAsString",e),console.log("ERROR:",e),console.log("WIDGET:",r),console.log("CONTENT:",t),console.log("PARAMS:",o),console.groupEnd()),i(e,null);t=r.postRenderAsString(t,o),o.debug&&(console.log("renderAsString : end"),console.log("Time : ",new Date-n),console.groupEnd()),i(e,t)},e)},_renderAsString:function(i,r){var n=this;r.debug&&console.log("_renderAsString : start"),n.template(function(t){function o(e,t){e&&d()&&console.error("_renderAsString",e),i(e,t,r)}r.debug&&console.log("_renderAsString : template"),c.when(n.getRenderVariables()).then(function(e){angular.isObject(e)||(d()&&(console.warn("_renderAsString => Widget ",n.name,"return wrong renderVariables",e),console.warn("  renderVariables will using default structure")),e={widget:n.properties,currentWidget:n}),angular.isFunction(t)?(d()&&console.warn("_renderAsString => Widget ",n.name,"using old template as function"),o(null,t(e))):t.renderTemplate(e,o)},function(e){i(e,null,r)})})},postRenderPreview:function(){},renderPreview:function(e){return this.updateContentView({debug:!1},e)},isContainer:function(){return!1},isInside:function(e){for(var t=this;t._parent;)if((t=t._parent)._id===e._id)return!0;return!1},getTargetDataForPaste:function(e){var t=this.getPositionInContent();return t.positionIndex++,{targetWidget:this._parent,widgetPosition:t}},_allowedDragMethods:["left","right",{rule:"top:half",result:"before"},{rule:"bottom:half",result:"after"}],_allowedDropMethods:[],getHelperInsertPositionV2:function(e){var t,o,i,r,n,a,s,l=this.getHelperInsertPosition(e),c=this._Editor.isDeviceATablet()||this._Editor.isDeviceADesktop(),p=this._$dom.outerHeight(),d=this._$dom.outerWidth(),u=this._Editor.Utils.getContainerEdgeHeight(this),g=this._allowedDragMethods,m=g.length;for(r=0;r<m;r++){switch(i=g[r],angular.isString(i)&&(i={rule:i,result:i}),i.rule){case"default":t=i.result;break;case"left":e.eventPositions.targetWidgetOffsetX<=20&&60<d&&c&&(o=i.result||"left");break;case"right":e.eventPositions.targetWidgetOffsetX>=d-20&&60<d&&c&&(o=i.result||"right");break;case"top:half":e.eventPositions.targetWidgetOffsetY<=p/2&&(o=i.result||"before");break;case"top:edge":e.eventPositions.targetWidgetOffsetY<=u&&(o=i.result||"before");break;case"middle":e.eventPositions.targetWidgetOffsetY>u&&e.eventPositions.targetWidgetOffsetY<p-u&&this._$targetDomElement.is("[data-container]")&&(o=i.result||"append");break;case"bottom:half":e.eventPositions.targetWidgetOffsetY>p/2&&(o=i.result||"after");break;case"bottom:edge":e.eventPositions.targetWidgetOffsetY>=p-u&&(o=i.result||"after");break;case"cell-*":case"cell-left":case"cell-right":e.eventPositions.targetWidgetOffsetY>u&&e.eventPositions.targetWidgetOffsetY<p-u&&this._$targetDomElement.is("[data-container]")&&this._$targetDomElement.hasClass("moto-cell")&&this._parent.children.length<6&&c&&(n=this._Editor.getElementCharacteristics(this._$targetDomElement),s=10<(a=parseInt(this._$targetDomElement.css("padding-left").slice(0,-2)))?a:10,e.eventPositions.clientX<n.left+s&&(o="cell-left"),e.eventPositions.clientX>n.left+2*a+n.width-s&&(o="cell-right"))}if(o)break}return o=o||t,l},getHelperInsertPosition:function(e){var t=/(desktop|tablet)/.test(e.device),o=this._$dom.outerHeight(),i=this._$dom.outerWidth();return e.eventPositions.targetWidgetOffsetX<=20&&60<i&&t?"left":e.eventPositions.targetWidgetOffsetX>=i-20&&60<i&&t?"right":e.eventPositions.targetWidgetOffsetY<=o/2?"before":"after"},getAlignClass:function(e,t){var o,i,r,n="";if(t=t||"align",o=a.getObjectValueByPath(this.properties,t),e=e||"moto-align-",angular.isString(o))return e+o;for(r in o)o.hasOwnProperty(r)&&(i=o[r],angular.isString(i)&&((i=i.trim()).length<1||(n+=" "+e+i,"desktop"!==r&&(n+="_"+r))));return n=n.trim()},getSpacing:function(e){return null===(e=e||null)?this.properties.spacing:angular.isObject(this.properties.spacing)?"classes"===e?t.generateSpacings(this.properties.spacing):"short"===e?t.generateShort(this.properties.spacing):"":""},getVisibleOn:function(e){return"classes"===e?this.properties.visible_on&&"mobile-v"!==this.properties.visible_on?"moto-visible-on_"+this.properties.visible_on:"":this.properties.visible_on},getAnimationClasses:function(){return this.properties.animation?"wow "+this.properties.animation:""},getDomElementsWhereWidgetsCanBePlaced:function(){return null},setParentWidget:function(e){this._parent=e},__toObject:function(){return{id:this.getWidgetId(),name:this.name,properties:angular.copy(this.properties)}},exportToObject:function(t){var e=c.defer(),o=this.__toObject();return(o=c.when(o)).then(e.resolve,e.reject),angular.isFunction(t)&&e.promise.then(function(e){return t(null,e),e},function(e){t(e,null)}),e.promise},exportForCopy:function(){return this.isCopyable()?this.__exportWidget():null},exportForFuture:function(){return this.isCopyable()?this.__exportWidget():null},exportForSave:function(){return this.__exportWidget(["id"])},exportForSaveAsHtml:function(){var e,t,o,i,r=this;if(r._transformToMacros){if(t=r._windowContext.document,!r._dom.parentNode)return;try{r.transform()}catch(e){d()&&(console.error('Error on Abstract.exportForSaveAsHtml widget "'+r.name+'"',e),console.log("Widget Dump",r))}e=t.createComment("--@{{ widget( "+angular.toJson(r.exportForSave())+" ) }}@--"),r._dom.parentNode.replaceChild(e,r._dom)}else if(r._dom&&r._$dom.removeAttr("draggable"),s.dispatchTransform(r),r.children&&r.children.length)for(o=0,i=r.children.length;o<i;o++)r.children[o].exportForSaveAsHtml()},exportForHistory:function(){var e=this.__exportWidget(["id"]);return e.parent=this._parent.getId(),e.position=this.getPositionIndexInContainer(),e},__exportWidget:function(e){var t={name:this.name,properties:angular.copy(this.properties)};return angular.isArray(e)&&(-1<e.indexOf("id")&&(t.id=this.getId()),-1<e.indexOf("parent")&&(t.parent=this._parent?this._parent.getId():null),-1<e.indexOf("position")&&(t.position=this._parent&&this._parent.children?this._parent.children.indexOf(this):0)),t},getContainerPositionIndex:function(){return this._parent?this._parent.getContainerPositionIndexByChild(this):0},getPositionIndexInContainer:function(e){return this._parent?this._parent.getPositionChildIndexInContainer(this,e):this._$dom.prevAll(".moto-widget[data-widget]").length},isFirstInParent:function(e){return 0===this._parent.getPositionChildIndexInContainer(this,e)},isLastInParent:function(e){return this._parent.getPositionChildIndexInContainer(this,e)===this._parent.children.length-1},getPositionInContent:function(e){return{parentId:this._parent?this._parent.getId():null,containerIndex:this.getContainerPositionIndex(e),positionIndex:this.getPositionIndexInContainer(e),parentName:this._parent?this._parent.name:null}},getLocationInEditor:function(){var e=this._parent.getDomElementsWhereWidgetsCanBePlaced(),t=this._$dom.parent()[0];return{parentWidgetId:this._parent.getWidgetId(),containerIndex:e.index(t),indexInContainer:this._$dom.prevAll("[data-widget]").length}},setProperties:function(e){var t,o,i=c.defer();return o=(t=this._Editor.ContentManager).getPublicInstance(this),a.assignWithCopy(o.properties,e),t.setWidgetInternalProperties(o,o.properties,function(e){e?i.reject(e):i.resolve(this)}),i.promise},getParent:function(){return this._parent},devQuickConvertWidget:function(){return{id:this.getWidgetId(),dom:this._dom,name:this.name,properties:angular.copy(this.properties)}}},s.set("abstract",u),s.set("AbstractWidgetClass",u)}]),angular.module("core.library.Widget").run(["coreLibraryWidget",function(e){var n=e.Environment.getGlobal("Nunjucks");n.addExtension("autoescape",new function(){this.tags=["autoescape"],this.parse=function(e,t){var o,i=e.nextToken(),r=e.parseSignature(null,!0);return e.advanceAfterBlockEnd(i.value),o=e.parseUntilBlocks("endautoescape"),e.advanceAfterBlockEnd(),new t.CallExtension(this,"run",r,[o])},this.run=function(e,t,o){var i,r=n.opts.autoescape;return o||(o=t,t=!0),n.opts.autoescape=!!t,i=new nunjucks.runtime.SafeString(o()),n.opts.autoescape=r,i}})}]),angular.module("core.library.Widget").service("coreLibraryBackendWidgetService",["jsonrpc",function(e){var t=e.newService("WidgetsService");this.saveStorageFile=t.createMethod("saveStorageFile"),this.deleteStorageFile=t.createMethod("deleteStorageFile")}]),angular.module("core.library.widget.editor").run(["EditorHistoryManager","$rootScope",function(e,i){e.registerAction({name:"widgetEditorActivated",inverseName:"widgetEditorDeactivated",run:function(e,t,o){i.$broadcast("TopController.finishEditWidgetContent",e.getWidgetById(t.id),o)},transformDataFromInverseAction:function(e,t){return t}}),e.registerAction({name:"widgetEditorDeactivated",inverseName:"widgetEditorActivated",run:function(e,t,o){i.$broadcast("TopController.startEditWidgetContent",e.getWidgetById(t.id),o)},transformDataFromInverseAction:function(e,t){return t}})}]),angular.module("core.library.widget.editor").factory("WidgetContentEditorClass",["$rootScope","$q","$timeout","core.library.editor.WidgetHighlighterService","core.library.editor.WidgetLockerService","WidgetContentEditorUndoRedoService",function(e,t,o,i,r,n){function a(e){if(!angular.isObject(e))throw new Error("Cant create Content Editor because is not widget");if(!(e=e.__getInternalInstance())._allowToUseContentEditor)throw new Error("Widget [ "+e.name+" ] not allow to use Content Editor");((e.__ContentEditor=this)._mainWidget=e).onContentEditor("connected",this)}return(a.prototype={_mainWidget:null,_CurrentState:"FREE"}).getMainWidget=function(){return this._mainWidget},a.prototype.isWidgetsCopyingAllowed=function(){return!1},a.prototype.isActive=function(){return"ACTIVATED"===this._CurrentState},a.prototype._isAllowToActivate=function(){return"FREE"===this._CurrentState},a.prototype._isAllowToDeactivate=function(){return"ACTIVATED"===this._CurrentState},a.prototype.activate=function(){var e=t.defer();return this._isAllowToActivate()?(this._CurrentState="ACTIVATING",n.activation(this._mainWidget),this._mainWidget._Editor.unselectCurrentWidget(),this._mainWidget._Editor.Widgets.checkAndScrollTo(this._mainWidget),t.all([r.lock(this._mainWidget,this),i.enable(this._mainWidget),this._mainWidget.onContentEditor("activating",this)]).then(function(){this._CurrentState="ACTIVATED",this._mainWidget.onContentEditor("activated",this),n.activated(this._mainWidget),e.resolve()}.bind(this))):(console.warn("WidgetEditor : cant be activated",this._CurrentState),e.reject()),e.promise},a.prototype.deactivate=function(){var e=t.defer();return this._isAllowToDeactivate()?(this._CurrentState="DEACTIVATING",n.deactivation(this._mainWidget),this._mainWidget._Editor.unselectCurrentWidget(),o(function(){t.all([this._mainWidget.onContentEditor("deactivating",this),r.unlock(this._mainWidget),i.disable(this._mainWidget)]).then(function(){this._CurrentState="FREE",this._mainWidget.onContentEditor("deactivated",this),n.deactivated(this._mainWidget),this._mainWidget._Editor.selectWidget(this._mainWidget),e.resolve()}.bind(this))}.bind(this),50)):(console.warn("WidgetEditor : cant be deactivated",this._CurrentState),e.reject()),e.promise},a.prototype.destroy=function(){this._mainWidget.onContentEditor("destroyed",this),(this._mainWidget.__ContentEditor=this)._mainWidget=null},a}]),angular.module("core.library.widget.editor").service("WidgetContentEditorUndoRedoService",[function(){this.activation=function(e){e._Editor.HistoryManager.startActionsTransaction("widgetEditorActivating")},this.activated=function(e){e._Editor.HistoryManager.addAction("widgetEditorActivated",{id:e.getId()}),e._Editor.HistoryManager.endActionsTransaction("widgetEditorActivating")},this.deactivation=function(e){e._Editor.HistoryManager.startActionsTransaction("widgetEditorDeactivating")},this.deactivated=function(e){e._Editor.HistoryManager.addAction("widgetEditorDeactivated",{id:e.getId()}),e._Editor.HistoryManager.endActionsTransaction("widgetEditorDeactivating")}}]),angular.module("core.library.RenderWidget.NunjucksExtensions",["core.library.Widget","core.library.config","core.library.PathResolver","core.library.RenderWidget.Util"]).provider("coreLibraryRenderWidget.NunjucksExtensions",["coreLibraryWidgetProvider","coreLibraryRenderWidgetUtilProvider","coreLibraryConfigProvider","coreLibraryPathResolverProvider",function(p,d,i,r){var e,t,o={},n=p.Environment.getGlobal("Nunjucks");function a(){this.tags=["widget"],this.parse=function(e,t,o){var i=e.nextToken(),r=e.parseSignature(null,!0);e.advanceAfterBlockEnd(i.value);var n=e.parseUntilBlocks("endWidget");return e.advanceAfterBlockEnd(),new t.CallExtensionAsync(this,"runAsync",r,[n])},this.runAsync=function(e,i,t,r){return t(function(e,t){if(angular.isObject(i)&&!p.isWidget(i)&&angular.isString(i.name)&&angular.isObject(i.properties)&&(i=p.createWidgetByName(i.name,{properties:i.properties})),angular.isObject(i))i.renderAsString(function(e,t){e&&console.error("Render Widget Template Error",e),r(null,t)},{mode:"update",debug:!1});else{if(angular.isString(t)&&("{"!=(t=t.trim())[0]&&(t=atob(t)),"{"==t[0]&&(t=angular.fromJson(t)||{})),!p.isExistsConstructor(i))return console.error('Constructor for widget "'+i+'" not found'),r(null,"{{ widget('"+i+"', '"+angular.toJson(t)+"') }}"),null;var o=p.createWidgetByName(i,angular.copy(t));o._widgetId=o._widgetId||o._id,angular.isObject(t)&&p.CacheOptions.set(o._id,{name:o.name,widgetId:o._id,properties:t.properties}),o.renderAsString(function(e,t){e&&console.error("Render Widget Template Error",e),r(null,t)},{mode:"new",debug:!1})}})}}return n.addGlobal("template_from_string",function(e){return nunjucks.compile(e,n)}),n.addFilter("page_html_content",function(e,t,o){return e}),this.getDefaultWidgetExtension=function(){return t||(t=new a),t},o.getDefaultWidgetExtension=this.getDefaultWidgetExtension,n.addExtension("widget",this.getDefaultWidgetExtension()),n.addFilter("date",function(e,t){var o=t;if(e&&t)return o=(o=(o=o.replace("d","DD")).replace("m","MM")).replace("Y","YYYY"),moment(e).format(o)}),n.addGlobal("widget",function(e,t){angular.isString(t)&&("{"!=t[0]&&(t=atob(t)),"{"==t[0]&&(t=angular.fromJson(t)));var o=p.get(e);if(!o)return null;var i,r=d.generateWidgetId(),n=r+"_temp",a={widgetId:r},s=p.Environment.getGlobal("MotoEditor"),l=!1;function c(){if(!1===l)return setTimeout(c,25);var e=s.getContextWindow(),t=e.$("#"+n);if(0<t.length){var o=e.$(l);t.get(0).parentNode.replaceChild(o.get(0),t.get(0))}else console.error("Achtung on WidgetService render widget _updateHtml")}return angular.isObject(t)&&(a.properties=t,p.CacheOptions.set(r,{name:e,widgetId:r,properties:t})),i=new o(a),c=d.makeObservedCallback(c,s.getContextDocument()),i.renderAsString(function(e,t){l=t,c()},{mode:"new",debug:!1}),'<div id="'+n+'">Rendering....</div>'}),n.addGlobal("arrayToAttributes",function(e){var t,o="";for(t in e)!e.hasOwnProperty(t)||angular.isObject(e[t])||angular.isArray(e[t])||(o+=t+'="'+e[t]+'" ');return o}),e={_constants:{const_media_desktop_max_width:"100%",const_media_tablet_max_width:"1039px","const_media_mobile-h_max_width":"767px","const_media_mobile-v_max_width":"479px"},getConstant:function(e,t){return this._constants[e]||t||""},generateLessFromArray:function e(t,o){var i,r,n="";if(!t)return n;if(angular.isString(t))return angular.isString(o)&&(n+=o+" { \n"),n+=t,angular.isString(o)&&(n+="\n}\n"),n;for(i in t)t.hasOwnProperty(i)&&(r=t[i],"base"!==i?"before"!==i&&"after"!==i&&"hover"!==i?r&&(angular.isObject(r)?angular.isString(r.unicode)&&(n+=i+':"\\'+r.unicode+'";\n'):angular.isArray(r)||(n+=i+":"+r+";\n")):(n+="&:"+i+" {\n",n+=e(r),n+="}\n"):n+=e(r));return angular.isString(o)&&n&&0<n.length&&(n=o+" { \n"+n+"\n}\n"),n},generateWidgetInlineStyles:function(e){var t,o,i="";if(!angular.isObject(e))return e;for(t in e)e.hasOwnProperty(t)&&(o=e[t],angular.isString(o)&&o.length<1||("background-image"===t&&(o="url("+r.getUploadAbsoluteUrl(o)+")"),"background-color"===t&&"@"===o[0]||"color"===t&&"@"===o[0]||!angular.isString(o)||o.length<1||(i+=t+":"+o+";")));return i},generatePresetSelector:function(e,t){var o="";return angular.isString(e)?(o=e,t&&(angular.isObject(t)&&(t=t.class_name?t.class_name:""),t.length&&(o+="."+t)),o):(i.isDevelopment()&&console.error('StyleHelper.generatePresetSelector: argument "widgetClassName" should be a string: ',{widgetClassName:e,presetClassName:t}),o)}},n.addGlobal("StyleHelper",e),n.addGlobal("generateLessFromArray",e.generateLessFromArray),n.addGlobal("generatePresetSelector",e.generatePresetSelector),this.$get=[function(){return o}],this}]),angular.module("core.library.RenderWidget.Util",["ng"]).provider("coreLibraryRenderWidgetUtil",[function(){var e=this,t={};function r(){var i=[];this.whenDone=function(e,t,o){return i.push({callback:e,args:t||[],context:o||null}),this},this.dispatch=function e(t){t&&console.info("dispatch tick get error",angular.isFunction(t)?t():t);var o=i.shift();if(o){if(o instanceof r)return o.whenDone(e),void o.dispatch();angular.isFunction(o.callback)?(o.args.unshift(e),o.callback.apply(o.context,o.args)):e()}}}e.createQueue=function(){return new r},t.createQueue=e.createQueue,e.generateWidgetId=function(e){return angular.isString(e)||(e="wf_"),e+parseInt((new Date).getTime()/1e3,10)+"_"+Math.floor(1e4*Math.random())},t.generateWidgetId=e.generateWidgetId;var o,n=window.MutationObserver||window.WebKitMutationObserver||null;return o=n?function(e,t){t=t||document;var o=1,i=new n(e),r=t.createTextNode("");return i.observe(r,{characterData:!0}),function(){o=-o,r.data=o}}:function(i){return function(){var e=setTimeout(o,0),t=setInterval(o,50);function o(){clearTimeout(e),clearInterval(t),i()}}},e.makeObservedCallback=o,t.makeObservedCallback=o,this.$get=[function(){return t}],e}]),angular.module("core.library.Widget").provider("coreLibraryWidgetTraits",[function(){var e=this,i={},a={debug:!1};function r(e){return!!i[e]}function s(e){return i[e]||null}function n(e,t,o){var i,r,n=s(e);if(angular.isObject(o)||(o={strict:!0,rewritable:!1}),!n)throw a.debug&&console.warn("useTrait : Not found trait [",e,"]"),new Error("Trait [ "+e+" ] not exists");if(!angular.isFunction(t))throw a.debug&&console.warn("useTrait : targetClass not function"),new Error("TargetClass not a function");for(i in r=n.traitPrototype.prototype||n.traitPrototype)if(r.hasOwnProperty(i))if("constructor"!==i&&"__proto__"!==i){if(angular.isDefined(t.prototype[i])&&(a.debug&&console.info("useTrait : Attach ",i),o.strict))throw new Error("TargetClass already have property [ "+i+" ]");if(a.debug&&console.info("useTrait : Attach ",i),angular.isFunction(r[i]))t.prototype[i]=r[i];else try{t.prototype[i]=angular.copy(r[i])}catch(e){a.debug&&(console.warn("useTrait : Cant attach [",i,"] because angular.copy throw error"),console.error(e))}}else a.debug&&console.warn("useTrait : Ignore property [",i,"] because name on black list");else a.debug&&console.warn("useTrait : Ignore property [",i,'] because it not "hasOwnProperty"');return!0}function t(e,t,o){var i;for(i=0;i<e.length;i++)n(e[i],t,o)}function o(e,t){var o={};if(r(e))return a.debug&&console.warn("Widget Trait [ ",e," ] already exists"),!1;if(!angular.isFunction(t)&&!angular.isObject(t))throw new Error('This "traitPrototype" not allowing to use');return a.debug&&console.info("Widget Trait [ ",e," ] added"),o.name=e,o.traitPrototype=t,i[e]=o,!0}return e.isExists=r,e.getTrait=s,e.useTrait=n,e.useTraits=t,e.addTrait=o,this.$get=[function(){function e(){}return e.prototype.isTraitExists=r,e.prototype.addTrait=o,e.prototype.useTrait=n,e.prototype.useTraits=t,new e}],e}]),angular.module("core.library.Widget").factory("coreLibraryWidgetPublicInstance",["coreLibraryUtils","coreLibraryConfig",function(e,r){function o(e,t){return function(){return e[t].apply(e,arguments)}}function i(t,o,i){Object.defineProperty(t,i,{get:function(){return t[o][i]},set:function(e){t[o][i]=e}})}function t(e){var t;for(t in(this.__internalInstance=e).__publicInstance=this,e)0!==t.indexOf("__")&&(angular.isFunction(e[t])?(this[t]=o(e,t),angular.isDefined(e[t].$inject)&&(this[t].$inject=e[t].$inject)):-1<["_dom","_$dom","products","store_category_tree","categories"].indexOf(t)?i(this,"__internalInstance",t):this[t]=e[t]);this.properties=angular.copy(e.properties)}return t.prototype={__internalInstance:null,__pendingCallbacks:null,__isPublicInstance:!0,__$scope:null,properties:{},__getPublicInstance:function(){return this},__getInternalInstance:function(){return this.__internalInstance},__setScope:function(e){this.__$scope=e},__syncProperties:function(){var e,t=this.__internalInstance.properties;for(e in t)t.hasOwnProperty(e)&&(this.properties[e]=angular.copy(t[e]))},__getInternalDiff:function(){return e?e.objectDiffQuick(this.properties,this.__internalInstance.properties):null},__addPendingCallback:function(e){this.__pendingCallbacks=this.__pendingCallbacks||[],this.__pendingCallbacks.push(e)},__releasePendingCallback:function(e){var t,o,i=this.__pendingCallbacks;if(this.__pendingCallbacks=null,i)for(t=0,o=i.length;t<o;t++)try{i[t](e,this)}catch(e){r.isDevelopment()&&(console.error("Error when widget public instance release callback"),console.debug(" instance",this),console.debug(" callback",i[t]),console.debug(" error",e))}}},t}]),angular.module("core.library.Widget").provider("coreLibraryWidget",["coreLibraryConfigProvider","coreLibraryPathResolverProvider",function(e,t){var o,i,l=this,r={},n=["section","row","container"],a={locals:{}},s=null,c=new nunjucks.Environment({autoescape:!1});function p(){return e.isDevelopment()}function d(e){return e=(e=e.replace_all("~","+")).replace_all("_self.",""),o.compile(e,a)}function u(e){return e=e.replace_all("_self.",""),nunjucks.compile(e,c)}function g(e){var i=this,r=null;e=e||{},this.engine=e.engine||"html",this.path=e.path||null,this.content=e.content||null,this.content&&("swig"==this.engine&&(p()&&console.warn("Some code uses deprecated swig template engine"),r=d(this.content)),"nunjucks"==this.engine&&(r=u(this.content)),"html"==this.engine&&(r=function(){return i.content})),this.getCompiledTemplate=function(){return r},this.renderTemplate=function(e,t,o){return e=e||{},angular.isUndefined(e.currentWidget)&&!angular.isUndefined(e.widget)&&(e.currentWidget=e.widget),"nunjucks"==i.engine?r.render(e,t,o):(o=o||t,angular.isFunction(o)?o(null,r(e)):r(e))}}c.opts.autoescape=!1,l.set=function(e,t){if(t.prototype.isContainer()&&-1==n.indexOf(e)&&n.push(e),r[e]=t,p()&&2!==t.prototype._apiVersion&&!/^[Aa]bstract/.test(e)&&console.warn("Detected oldVersion widget",e),angular.isString(t.prototype.template)){var o=new g({engine:"html",content:t.prototype.template});t.prototype.template=function(e){return e(o)}}},l.get=function(e){return r[e]||null},l.isExistsConstructor=function(e){return!!r[e]},l.getRenderTemplateItemClass=function(){return g},l.setEventManager=function(e){i=e,this.Environment.setEventManager(i)},l.getEventManager=function(){return i},l.isContainers=function(e){return e.isContainer?e.isContainer():0<=n.indexOf(e)},l.isWidget=function(e){return e instanceof l.get("AbstractWidgetClass")},l.compileSwigTemplate=d,l.getTemplateCompiler=function(e){return"swig"===e?d:u},l.setCurrentPage=function(e){try{s=e,a.locals.currentPage=s,c.addGlobal("currentPage",e),this.Environment.setCurrentPage(e)}catch(e){}return l},l.getCurrentPage=function(){return s},l.CacheOptions=new function(){var o={};this.setData=function(e){o=e},this.get=function(e,t){return o[e]?o[e]:t},this.getProperties=function(e,t){return o[e]&&o[e].properties?o[e].properties:t},this.set=function(e,t){o[e]=t},this.clearAll=function(){o={}},this.clearAll()},l.setWidgetsCacheOptions=function(e){this.CacheOptions.setData(e)},l.createWidgetByName=function(e,t,o){var i=this.get(e);return i?(t instanceof l.get("AbstractWidgetClass")&&(o=t,t=null),angular.isObject(t)||(t={}),o&&(t.parent=o,t.$=o.$,t.Editor=o._Editor),t.Environment=this.getEnvironmentForWidget(t.Environment),t.WidgetFactory=this,new i(t)):null},l.createWidgetById=function(e,t,o){var i=this.CacheOptions.get(e);return i&&i.name?(t instanceof l.get("AbstractWidgetClass")&&(o=t,t=null),angular.isObject(t)||(t={}),t.properties=angular.copy(i.properties),t.widgetId=i.widgetId||e,i.extraOptions&&(t.extraOptions=angular.copy(i.extraOptions)),this.createWidgetByName(i.name,t,o)):null},l.reviveChildrenWidgets=function(e){e.isContainer()&&e.children.length&&this.reviveWidgetsPack(e.children,e)},l.reviveWidgetsPack=function(e,t,o){var i,r,n,a=angular.noop,s=l.get("AbstractWidgetClass");for(o instanceof s&&(t=o,o={}),angular.isObject(o)||(o={}),angular.isFunction(o.processor)&&(a=o.processor),i=0,r=e.length;i<r;i++)(n=e[i])instanceof s||angular.isObject(n)&&!angular.isUndefined(n.name)&&(a(n=this.createWidgetByName(n.name,n,t),o),n.isContainer()&&n.children&&n.children.length&&this.reviveWidgetsPack(n.children,n,o),e[i]=n);return e},l.createWidgetByDom=function(e,t,o){t instanceof l.get("AbstractWidgetClass")&&(o=t,t=null),angular.isObject(t)||(t={});var i,r,n=(e=$(e)).data("widget");if((i=e.attr("id"))?t.persistentId=i:i=e.data("widget-id"),t.dom=t.dom||e.get(0),i){if(r=this.createWidgetById(i,t,o))return r;t.widgetId=t.widgetId||i}return this.createWidgetByName(n,t,o)},l.getEnvironmentForWidget=function(e){return this.Environment},l.dispatchTransform=function(t){if(t instanceof l.get("AbstractWidgetClass")){try{t.transform()}catch(e){p()&&(console.error('Error on WidgetService.dispatchTransform widget "'+t.name+'"',e),console.log("Widget Dump",t))}try{if(!t._transformToMacros)return;var e,o,i=t._windowContext.document;if(!t._dom.parentNode)return;o='--@{{ widget("'+t.name+'", '+angular.toJson(t.properties)+") }}@--",e=i.createComment(o),t._dom.parentNode.replaceChild(e,t._dom)}catch(e){p()&&(console.error('Error on WidgetService.dispatchTransform widget "'+t.name+'"',e),console.log("Widget Dump",t))}}else p()&&(console.error('Error on WidgetService.dispatchTransform not instance of "classWidget"'),console.log("Widget Dump",t))},l.Environment=new function(){var i={};this.setGlobal=function(e,t,o){return!(!angular.isString(e)||0<e.indexOf("."))&&(o=o||{},e=e.trim(),!(i[e]&&!i[e].rewritable)&&(i[e]={entity:t,rewritable:o.rewritable||!0},!0))},this.getGlobal=function(e){return!angular.isString(e)||0<e.indexOf(".")?null:i[e]&&i[e].entity||null},this.getFunction=function(e,t){if(t=t||!1,!angular.isString(e))return t?null:angular.noop;var o,i=t?null:angular.noop,r=e.split("."),n=this.getGlobal(r.shift()),a=r.pop();return angular.isObject(n)&&(o=1<r.length?function e(t,o,i){if(angular.isUndefined(i)&&(i=null),angular.isUndefined(o)||null===o||""===o)return t;if(!angular.isObject(t))return i;if(!angular.isUndefined(t[o]))return t[o];var r=angular.isArray(o)?o:o.split("."),n=r.shift();return angular.isUndefined(t[n])?i:e(t[n],r,i)}(n,r.join(".")):n,angular.isObject(o)&&angular.isFunction(o[a])&&(i=o[a])),i},this.clearAll=function(){for(var e in i)i.hasOwnProperty(e)&&i[e].rewritable&&(i[e]=null,delete i[e])},this.deleteGlobal=function(e){angular.isArray(e)||(e=[e]);for(var t=0,o=e.length;t<o;t++)i.hasOwnProperty(e[t])&&(i[e[t]]=null,delete i[e[t]]);return this},this.setEditor=function(e){this.deleteGlobal(["MotoEditor","$","window","document","$window","$document"]);var t=e.getEnvironment();return this.setGlobal("MotoEditor",e),this.setLivePreviewService(t.getLivePreviewService()),this.setGlobal("window",t.getGlobal("window")),this.setGlobal("document",t.getGlobal("document")),this.setGlobal("$",t.getGlobal("$")),this.setGlobal("$window",t.getGlobal("$window")),this.setGlobal("$document",t.getGlobal("$document")),this.setGlobal("EditorHelpers",e.getHelpers()),this.setGlobal("ContentManager",e.ContentManager),this},this.getEditor=function(){return this.getGlobal("MotoEditor")},this.isDevelopmentStage=function(){return p()},this.getContentManager=function(){return this.getGlobal("ContentManager")},this.setEventManager=function(e){return this.setGlobal("EventManager",e),this},this.getEventManager=function(){return this.getGlobal("EventManager")},this.setTranslator=function(e){return this.setGlobal("Translator",e),this},this.getTranslator=function(){return this.getGlobal("Translator")},this.setWidgetFactory=function(e){return this.setGlobal("WidgetFactory",e,{writable:!1}),this},this.getWidgetFactory=function(){return this.getGlobal("WidgetFactory")},this.setLivePreviewService=function(e){return this.setGlobal("LivePreviewService",e),this},this.getLivePreviewService=function(){return this.getGlobal("LivePreviewService")},this.setCurrentPage=function(e){return this.setGlobal("currentPage",e),this},this.getCurrentPage=function(){return this.getGlobal("currentPage")}},l.Environment.setWidgetFactory(l),l.Environment.setGlobal("Nunjucks",c,{writable:!1}),l.afterLivePreviewReady=[],l.afterWidthChanged=[],l.doWhenLivePreviewReady=function(e){l.afterLivePreviewReady[l.afterLivePreviewReady.length]=e},l.doWhenWidthChanged=function(e){l.afterWidthChanged[l.afterWidthChanged.length]=e},(o=new swig.Swig).setFilter("length",function(e){return e&&e.length||0}),a.locals.Linker={isCurrent:function(e,t){return"page"==e&&s.id==t.id},href:function(){return"#"},img:function(e){return t.getUploadAbsoluteUrl(e)},lazyImageSrcAttribute:function(e){return this.lazySrcAttribute(this.img(e))},lazySrcAttribute:function(e){return'src="'+e+'"'},file:function(e){return t.getUploadAbsoluteUrl(e)},homePage:function(e){return e||t.getUrl("@website")},pageLink:function(e,t){return t||"#"},popupLink:function(){return"#"},taxonomyLink:function(){return"#"},getLinkAttributes:function(){return""}},a.locals.isPreview=!0,a.locals.currentPage=s,c.addGlobal("Linker",a.locals.Linker),c.addGlobal("isPreview",!0),c.addGlobal("isServer",!1),c.addGlobal("isClient",!0),c.addGlobal("currentPage",s),c.addFilter("json_encode",function(e){return angular.toJson(e)}),c.addFilter("json_decode",function(e){return angular.fromJson(e)}),c.addFilter("raw",function(e){return e}),l.$get=["$translate","motoFeatures",function(o,e){return c.addGlobal("FEATURES",e.getList()),c.addFilter("translate",function(e,t){return o.instant(e,t)}),c.addGlobal("translate",function(e,t){return o.instant(e,t)}),l}]}]),angular.module("core.library.Widget").run(["coreLibraryWidgetTraits","application.design.colorizer.DesignColorizerModel","coreLibraryConfig",function(e,t,o){var i;try{i=t.newRecord(o.get("settings.website.colors"))}catch(e){}function r(){}t.success(function(){i=t.objects().first()}).load(),r.prototype.isReadyColorized=function(){return!!i},r.prototype.getColorizerModel=function(){return i},e.addTrait("WidgetColorizerModel",r)}]),angular.module("core.library.Widget").run(["coreLibraryWidgetTraits","coreLibraryWidget","coreLibraryUtils","coreLibraryPathResolver",function(e,t,a,s){function o(){}function r(e,t){var o;return o=new RegExp(t+":[^;]+;*s*"),e.replace(o,"").trim()}function i(e,t){var o=e.attr("style")||"";o=r(o,t),e.attr("style",o)}function n(e,t,o){var i=e.attr("style")||"";i=r(i,t),i+=t+":"+o+";",e.attr("style",i)}function l(e,t){var o,i=e.attr("style")||"";return o=new RegExp(".*"+t+":([^;]*).*"),i.replace(o,"$1").trim()}e.useTrait("WidgetColorizerModel",o),o.prototype.__backgroundTraitVideoAllowed=!1,o.prototype.isBackgroundVideoSet=function(){var e=this.properties.bgVideo;return!!angular.isObject(e)&&!!(e&&e.track&&(e.track.webm&&e.track.webm.path||e.track.mp4&&e.track.mp4.path))},o.prototype.__backgroundTraitMigrateStrucure=function(){this.properties.bgPosition=this.properties.styles["background-position"]||this.properties.bgPosition},o.prototype._updateBackgroundColorInDom=function(){var e;this._$dom.attr("class",function(e,t){return t.replace(/(^|\s)moto-bg-color\S+/g,"")}),i(this._$dom,"background-color"),this.properties.styles["background-color"]&&((e=this.getColorizerModel().getClassNameByColorName(this.properties.styles["background-color"],"moto-bg-color"))?this._$dom.addClass(e):n(this._$dom,"background-color",this.properties.styles["background-color"]))},o.prototype._updateBackgroundImageInDom=function(){this.__backgroundTraitVideoAllowed&&(this._$dom.attr("data-bg-position",this.properties.bgPosition),this.properties.styles["background-position"]=this.properties.bgPosition),this.properties.styles["background-image"]?(n(this._$dom,"background-image","url("+t.Environment.getGlobal("Nunjucks").getGlobal("Linker").img(this.properties.styles["background-image"])+")"),n(this._$dom,"background-position",this.properties.styles["background-position"]),n(this._$dom,"background-repeat",this.properties.styles["background-repeat"]),n(this._$dom,"background-size",this.properties.styles["background-size"]),this._$dom.attr("data-bg-image",this.properties.styles["background-image"])):(i(this._$dom,"background-image"),i(this._$dom,"background-position"),i(this._$dom,"background-repeat"),i(this._$dom,"background-size"),this._$dom.removeAttr("data-bg-image"))},o.prototype._updateBackgroundParallaxedInDom=function(){this._$dom.removeClass("moto-parallax").removeAttr("data-stellar-background-ratio"),this.isBackgroundVideoSet()||this.properties.bgParallaxed&&this._$dom.addClass("moto-parallax").attr("data-stellar-background-ratio","0.5")},o.prototype._updateBackgroundFixedInDom=function(){this._$dom.removeClass("moto-background-fixed"),this.isBackgroundVideoSet()||this.properties.bgFixed&&this._$dom.addClass("moto-background-fixed")},o.prototype.getBackgroundClassName=function(){var t=null;return this._$dom.attr("class").split(" ").forEach(function(e){-1!==e.indexOf("moto-bg-color")&&(t=e)}),t},o.prototype._loadBackgroundColorFromDom=function(){var e=this.getBackgroundClassName();e?this.properties.styles["background-color"]=this.getColorizerModel().getNameByClassName(e):/background-color:/.test(this._$dom.attr("style"))&&(this.properties.styles["background-color"]=l(this._$dom,"background-color"))},o.prototype._loadBackgroundImageFromDom=function(){var e=this._$dom.attr("data-bg-image");e&&(this.properties.styles["background-image"]=e,this.properties.styles["background-position"]=l(this._$dom,"background-position"),this.properties.styles["background-repeat"]=l(this._$dom,"background-repeat"),this.properties.styles["background-size"]=l(this._$dom,"background-size"),this.properties.bgPosition=this.properties.styles["background-position"]),this.__backgroundTraitVideoAllowed&&(this.properties.bgPosition=this._$dom.attr("data-bg-position")||this.properties.bgPosition)},o.prototype._loadBackgroundParallaxedFromDom=function(){this.properties.bgParallaxed=!!this._$dom.attr("data-stellar-background-ratio")},o.prototype._loadBackgroundFixedFromDom=function(){this.properties.bgFixed=!!this._$dom.hasClass("moto-background-fixed")},o.prototype._transformBackgroundImage=function(){var e,t,o;this.properties.styles["background-image"]&&(t=this._$dom.attr("style"),o=this.properties,e=(t=t||"").replace(/url\(([^)]*)\)/,"url({{Linker.img('"+o.styles["background-image"]+"')}})"),this._$dom.attr("style",e),this._$dom.attr("style").indexOf("{{Linker")<0&&(n(this._$dom,"background-image","url('{{Linker.img(\""+this.properties.styles["background-image"]+"\")}}')"),0<=angular.copy(this._$dom).empty()[0].outerHTML.indexOf("{{Linker.img(&quot;")&&this._$dom.attr("style",e)))},o.prototype._loadBackgroundVideoFromDom=function(){var e;if(this.__backgroundTraitVideoAllowed&&(e=this.$(">.moto-background-video-container",this._$dom)).length){this.properties.bgVideo=e.attr("data-moto-background-video");try{angular.isString(this.properties.bgVideo)&&(this.properties.bgVideo=angular.fromJson(this.properties.bgVideo))}catch(e){}}},o.prototype._getBackgroundVideoCssClass=function(){if(this.__backgroundTraitVideoAllowed&&this.isBackgroundVideoSet())return"moto-background-video moto-absolute-position"+(angular.isString(this.properties.bgPosition)?" moto-absolute-position_"+this.properties.bgPosition.replace(" ","-"):"")},o.prototype._updateBackgroundVideoInDom=function(e,t){var o,i,r,n;this.__backgroundTraitVideoAllowed&&(this.isBackgroundVideoSet()?(this.properties.bgFixed=!1,this.properties.bgParallaxed=!1,angular.isUndefined(e)&&(e=this.properties.bgVideo),(e=e||{}).position=this.properties.bgPosition,(o=this.$(">.moto-background-video-container",this._$dom)).length||(o=this.$('<div class="moto-background-video-container moto-absolute-position__container"></div>'),this._$dom.prepend(o)),(i=this.$(">video",o)).length||(i=this.$('<video muted="muted"></video>'),o.append(i)),i.attr("class",this._getBackgroundVideoCssClass(e)),i.attr("preload",a.getObjectValueByPath(e,"preload","metadata")),a.getObjectValueByPath(e,"loop")?i.attr("loop","loop"):i.attr("loop",null),n=a.getObjectValueByPath(e,"track.webm.path"),r=this.$('source[type="video/webm"]',i),n?(r.length||(r=this.$('<source type="video/webm">'),i.prepend(r)),r.attr("src",s.getUploadAbsoluteUrl(n)),t&&r.replaceWith(this._windowContext.document.createComment('--@<source type="video/webm" src="{{ Linker.file(\''+n+"') }}\">@--"))):r.remove(),n=a.getObjectValueByPath(e,"track.mp4.path"),r=this.$('source[type="video/mp4"]',i),n?(r.length||(r=this.$('<source type="video/mp4">'),i.append(r)),r.attr("src",s.getUploadAbsoluteUrl(n)),t&&r.replaceWith(this._windowContext.document.createComment('--@<source type="video/mp4" src="{{ Linker.file(\''+n+"') }}\">@--"))):r.remove(),(r=this.$("source",i)).length?i[0].load():t||i.remove(),o.attr("data-moto-background-video",angular.toJson(e)),o.motoVideoBackground()):this.$(">.moto-background-video-container",this._$dom).remove())},o.prototype._transformBackgroundVideo=function(){var e=angular.copy(this.properties.bgVideo);angular.isObject(e)&&e.track&&(e.track.webm&&e.track.webm.path?(delete e.track.webm.id,delete e.track.webm.filesize,delete e.track.webm.length):e.track.webm=null,e.track.mp4&&e.track.mp4.path?(delete e.track.mp4.id,delete e.track.mp4.filesize,delete e.track.mp4.length):e.track.mp4=null),this._updateBackgroundVideoInDom(e,!0)},e.addTrait("WidgetBackground",o)}]),angular.module("core.library.Widget").run(["coreLibraryWidgetTraits","core.library.editor.WidgetLockerService",function(e,t){function o(){}o.prototype._allowToUseContentEditor=!0,o.prototype.onContentEditor=function(e,t){console.warn(this.name,"onContentEditor : please implement method")},o.prototype.traitLockAllChildren=function(){t.lockChildren(this,this)},e.addTrait("UsingContentEditor",o)}]),angular.module("core.library.Widget").provider("motoWidgetsWhiteList",[function(){var o={},i=this;i.add=function(t,e){return!!angular.isString(t)&&(angular.isUndefined(o[t])&&(o[t]=[]),angular.isArray(e)?(e.forEach(function(e){i.add(t,e)}),!0):!!angular.isString(e)&&(-1===o[t].indexOf(e)&&(o[t].push(e),!0)))},i.get=function(e){return!angular.isString(e)||angular.isUndefined(o[e])?[]:angular.copy(o[e])},i.isAllowed=function(e,t){return!!angular.isString(e)&&(!!angular.isString(t)&&(!!angular.isUndefined(o[e])||-1!==o[e].indexOf(t)))},i.$get=[function(){return{get:i.get,isAllowed:i.isAllowed}}]}]),function(){var t,n,a,d,o,i,r,s,u={},l=["insert","delete","save","load","remove"],c="__MODEL__";s=function(e){var o={};return this.forIn(function(e,t){"_"!=e[0]&&(t&&"object"==typeof t?(t.toJSON=t.toJSON||s,o[e]=t.toJSON()):t instanceof Function||(o[e]=!0===t?1:!1===t?0:t))}),o},(o=function(e,t){var o=this,i=u[e].classObj;o.indexes=i.index,o.indexes.indexOf("id")<0&&o.indexes.push("id"),o.index={},t.forEach(function(e,t){o.add(e,t)})}).prototype={PREF:"idx_",index:null,indexes:null,add:function(t,o){var i=this;i.indexes.forEach(function(e){i.index[e]=i.index[e]||{},t.hasOwnProperty(e)&&(i.index[e][i.PREF+t[e]]=o)})},remove:function(e,t){var o=this;o.indexes.forEach(function(e){o.index[e]=o.index[e]||{},t.hasOwnProperty(e)&&o.index.hasOwnProperty(e)&&o.index[e].hasOwnProperty(o.PREF+t[e])&&delete o.index[e][o.PREF+t[e]]})},getKey:function(e,t){var o=this;return o.index.hasOwnProperty(e)&&o.index[e].hasOwnProperty(o.PREF+t)?o.index[e][o.PREF+t]:null}},(i=function(e,t){var o=this;o.maps=t.maps||{list:"getList"},o.params=t.params||{page:1,limit:0},o.service=t.service||null,o.records=t.records||null,o.isReady=!0,o.promise_success=[],o.promise_error=[],null==o.service&&t.records instanceof Array&&(u[e].cache={records:t.records},o.createIndexes(e,t.records))}).prototype={maps:null,params:null,service:null,records:null,isReady:!0,promise_success:null,promise_error:null,setSuccess:function(e){e&&e instanceof Function&&this.promise_success.indexOf(e)<0&&this.promise_success.push(e)},setError:function(e){e&&e instanceof Function&&this.promise_error.indexOf(e)<0&&this.promise_error.push(e)},createIndexes:function(e,t){u[e].indexes=new o(e,t)},runPromiseSuccess:function(t){var e=this;e.promise_success.forEach(function(e){e.apply(t)}),e.promise_success=e.promise_success.splice(),e.promise_error=e.promise_error.splice()},runPromiseError:function(t){var e=this;e.promise_error.forEach(function(e){e.apply(t)}),e.promise_success=e.promise_success.splice(),e.promise_error=e.promise_error.splice()},load:function(t,e,o){var i=this,r=t._p.getProp("modelName");i.isReady&&(i.isReady=!1,void 0===e&&(e=!0),null==i.service||e?(i.isReady=!0,Signals.trigger(c+r,"load"),i.runPromiseSuccess(t)):i.service&&"object"==typeof i.service&&i.service.hasOwnProperty(i.maps.list)&&i.service[i.maps.list](o||i.params).then(function(e){"object"!=typeof e||e.hasOwnProperty("meta")||e.hasOwnProperty("records")||(e={meta:{},records:[e]}),e.records&&Array.isArray(e.records)&&(u[r].cache=e,i.createIndexes(r,e.records),Signals.trigger(c+r,"load")),i.isReady=!0,i.runPromiseSuccess(t)},function(e){i.isReady=!0,i.runPromiseError(t)}))}},r=function(){var o={};return{setProp:function(e,t){o[e]=t},getProp:function(e,t){return o.hasOwnProperty(e)?!o[e]&&t?t:o[e]:t||null}}},((n=function(i,e){var o=this,r=["proxy","record","limit","orderBy","first"],t=u[i].classObj,n=t.record;o.push.apply(o,e),o.forEach(function(e,t,o){n instanceof Function?o[t]=new n(i,e):o[t]=new a(i,e)}),t.forIn(function(e,t){r.indexOf(e)<0&&t instanceof Function&&(o[e]=t)})}).prototype=new Array).first=function(){return 0<this.length?this[0]:null},n.prototype.limit=function(e,t){var o,i,r,n=this;return i=(o=20*((e=e||1)-1))+(t=t||20),r=n.slice(o,i),n.splice(0),n.push.apply(n,r),n},n.prototype.orderBy=function(r,n){return this.sort(function(e,t){var o=e[r],i=t[r];return"string"!=typeof o||"string"!=typeof i?"number"==typeof o&&"number"==typeof i?"asc"==n?o-i:i-o:"boolean"==typeof o&&"boolean"==typeof i?(o=!0===o?1:0,i=!0===i?1:0,"asc"==n?i-o:o-i):0:[o,i].sort()[0]===o?"asc"==n?-1:1:"asc"==n?1:-1}),this},(a=function(e,s){var l=this,c=[],p=u[e].classObj.record;p&&p.forIn(function(e,t){var o,i,r,n,a;if(c.indexOf(e)<0)if(t instanceof d)if(s){if(i={cls:t,val:s[e]},o=e,t.isForeign()){if(o=o.replace("_id",""),l.hasOwnProperty(o))throw'Record is have a property "'+o+'"';Object.defineProperty(l,e,{set:function(e){i.val=e},get:function(){return i.cls.option.type.transform(i.val)},enumerable:!0})}Object.defineProperty(l,o,{set:function(e){i.val=e},get:function(){return i.cls.transform(i.val)},enumerable:!0})}else l[e]=null;else t instanceof Function&&s&&s.hasOwnProperty(e)?l[e]=t.apply(l,[s[e]]):t instanceof Function?l[e]=function(){return t.apply(l,arguments)}:s&&s.hasOwnProperty(e)?l[e]=s[e]:(r=Object.getOwnPropertyDescriptor(p,e))&&r.get instanceof Function&&r.set instanceof Function?(n=r.set,a=r.get,Object.defineProperty(l,e,{set:function(e){n.call(this,e)},get:function(){return a.call(this)},enumerable:!0,configurable:!0})):l[e]=t})}).prototype={},(t=function(e){this._p=r(),this._p.setProp("modelName",e)}).prototype={_p:null,get loading(){return!u[this._p.getProp("modelName")].proxy.isReady},set loading(e){},count:function(){var e=this._p.getProp("modelName"),t=0;return u[e]&&Array.isArray(u[e].cache.records)&&(t=u[e].cache.records.length),t},load:function(e,t){return u[this._p.getProp("modelName")].proxy.load(this,e,t),this},newRecord:function(e){var t=u[this._p.getProp("modelName")].classObj.record;return t instanceof Function?new t(this._p.getProp("modelName"),e):new a(this._p.getProp("modelName"),e)},insert:function(e){var t,o,i=this._p.getProp("modelName");return(e=e||{}).toJSON=e.toJSON||s,t=e.toJSON(),!(!u[i]||!Array.isArray(u[i].cache.records))&&(o=u[i].cache.records.push(t),u[i].indexes.add(t,o-1),Signals.trigger(c+this._p.getProp("modelName"),"insert",e,t),!0)},remove:function(e){var t,o=this._p.getProp("modelName");return!!(e&&e.id&&null!=(t=u[o].indexes.getKey("id",e.id))&&u[o].cache.records&&u[o].cache.records[t])&&(u[o].cache.records.splice(t,1),u[o].proxy.createIndexes(o,u[o].cache.records),Signals.trigger(c+this._p.getProp("modelName"),"remove",e),!0)},save:function(e){var t,o,i=this._p.getProp("modelName");if(e&&e.hasOwnProperty("id")){if(null==(o=u[i].indexes.getKey("id",e.id)))return this.insert(e);if(u[i].cache.records&&u[i].cache.records[o])return e.toJSON=e.toJSON||s,t=e.toJSON(),u[i].cache.records[o]=t,u[i].proxy.createIndexes(i,u[i].cache.records),Signals.trigger(c+this._p.getProp("modelName"),"save",e),!0}return!1},on:function(e,t){0<=l.indexOf(e)&&t instanceof Function&&Signals.connect(c+this._p.getProp("modelName"),e,t)},off:function(e,t){0<=l.indexOf(e)&&t instanceof Function&&Signals.disconnect(c+this._p.getProp("modelName"),e,t)},getByField:function(e,t){var o,i,r=this._p.getProp("modelName");return u[r]&&u[r].indexes&&u[r].indexes.getKey&&null!=(o=u[r].indexes.getKey(e,t))&&u[r].cache.records&&u[r].cache.records[o]?(i=u[r].cache.records[o],new n(r,[i]).first()):null},objects:function(e){var t=this._p.getProp("modelName"),o=[];return u[t]&&Array.isArray(u[t].cache.records)&&(o=e&&e instanceof Function?u[t].cache.records.filter(e):u[t].cache.records),new n(t,o)},success:function(e){return u[this._p.getProp("modelName")].proxy.setSuccess(e),this},error:function(e){return u[this._p.getProp("modelName")].proxy.setError(e),this},setParams:function(e){e=e||{},u[this._p.getProp("modelName")].proxy.params=e}},(d=function(e,t){var o=this;o.type=e||"string",o.option=t||{},o.option.decimal=o.option.decimal||0,o.option.foreignKey=o.option.foreignKey||"id"}).prototype={type:null,option:null,isForeign:function(){return"foreign"==this.type},bool:function(e){return"1"!==e&&"0"!==e||(e=parseInt(e)),!!e},string:function(e){return e?e.toString():""},integer:function(e){return e?parseInt(e):0},number:function(e){return this.option.decimal?Math.round(parseFloat(e)*Math.pow(10,this.option.decimal))/Math.pow(10,this.option.decimal):parseFloat(e)},date:function(e){return e?new Date(e):null},foreign:function(e){var t;if(!(t=Model(this.option.model)))throw'Model "'+this.option.model+'" is not defined';return t.getByField(this.option.foreignKey,e)},transform:function(e){var t=this;if("string"==t.type)return t.string(e);if("integer"==t.type)return t.integer(e);if("number"==t.type)return t.number(e);if("date"==t.type)return t.date(e);if("foreign"==t.type)return t.foreign(e);if("bool"==t.type)return t.bool(e);throw"Model. Type field is not defined"}},(Model=function(e){return u.hasOwnProperty(e)?new t(e):null}).register=function(e,t){t.proxy=t.proxy||{},t.index=t.index||[],u[e]={classObj:t,cache:[],indexes:{},proxy:null},u[e].proxy=new i(e,t.proxy)},Model.fields={bool:function(e){return new d("bool",e)},string:function(e){return new d("string",e)},integer:function(e){return new d("integer",e)},number:function(e){return new d("number",e)},date:function(e){return new d("date",e)},foreign:function(e){return(e=e||{}).model=e.model||null,e.type=e.type||Model.fields.integer(),new d("foreign",e)}}}();var Signals=function(e){if(e)return e;var d,t,o,i,u,g,m,f,r={},n={},h="production";function m(e,t){this._i=e,this._fn=t}function f(e,t,o){var i=!1,r=!1,n=null;return{ns:e,name:t,names:t.split("."),args:o,stopPropagation:function(){i=!0},isStop:function(){return i},freeze:function(){r=!0},unfreeze:function(){var e=n;r=!1,n=null,e&&e.keepOn()},isFreeze:function(){return r},registerFrezer:function(e){r&&e instanceof m&&(n=e)}}}function u(e,t,o){if(n[e][t]=n[e][t]||[],void 0===n[e][t].count&&(n[e][t].count=10),0<=n[e][t].indexOf(o)){if(n[e][t].count--,n[e][t].count<0)throw g(e,t),'Signals. !!!Collision!!! Trigger "'+t+'" go to recursion.'}else n[e][t].push(o)}function g(e,t){delete n[e][t]}function d(e){return r[e]=r[e]||{},n[e]=n[e]||{},r[e]}function t(e,t,o,i){var r;"function"==typeof o&&(void 0===i&&(i=0),o._priority=i,(r=d(e))[t]=r[t]||[],r[t].indexOf(o)<0&&r[t].push(o))}function o(e,t,o){var i,r;"function"==typeof o&&(i=d(e))[t]&&(0<=(r=i[t].indexOf(o))&&i[t].splice(r,1),0==i[t].length&&(delete i[t],delete n[t]))}function a(e,t){var o;(o=d(e))[t]&&(delete o[t],delete n[t])}function i(r,n){var a,e,t,o,i,s,l,c=(e=n,l=[],t=d(r),0<=(s=o=e).indexOf(".")&&(s=[],o.split(".").forEach(function(e){i?(i=i+"."+e,s.push(i)):(i=e,s.push(e))})),"string"==typeof(e=s)?(t[e]=t[e]||[],l=t[e]):Array.isArray(e)&&e.forEach(function(e){t[e]=t[e]||[],l.push.apply(l,t[e])}),l.sort(function(e,t){return e._priority-t._priority}),l),p=[];p.push.apply(p,arguments),p=p.splice(2),a=new f(r,n,p),function e(t){var o,i=0;for(void 0!==t&&(i=t+1);i<c.length;i++){if(a.isStop())return void g(r,n);o=c[i],u(r,n,o);try{o.apply(a,a.args)}catch(e){"development"==h&&(console.error("Error on Signals Calling",e),console.info("Dump idx : ",t),console.info("Dump fn : ",o),console.info("Dump trigger (t) : ",a),console.info("Dump arguments : ",a.args))}if(a.isFreeze())return void a.registerFrezer(new m(i,e));c.length-1==i&&g(r,n)}}()}return m.prototype={_i:0,_fn:null,keepOn:function(){this._fn(this._i)},isInstance:function(e){return e instanceof m}},e={setEnvironmentStage:function(e){h=e||h},create:function(e){var t=this,o=e||{}.set_id();return{parent:t,getNameSpace:function(){return o},on:function(){var e=[];return e.push.apply(e,arguments),e.unshift(o),t.on.apply(t,e),this},off:function(){var e=[];return e.push.apply(e,arguments),e.unshift(o),t.off.apply(t,e),this},clearAll:function(){var e=[];return e.push.apply(e,arguments),e.unshift(o),t.clearAll.apply(t,e),this},trigger:function(){var e=[];return e.push.apply(e,arguments),e.unshift(o),t.trigger.apply(t,e),this}}},on:function(){return t.apply(t,arguments),this},off:function(){return o.apply(o,arguments),this},clearAll:function(){return a.apply(a,arguments),this},trigger:function(){return i.apply(i,arguments),this},connect:function(){return this.on.apply(this,arguments),this},disconnect:function(){return this.off.apply(this,arguments),this},signal:function(){return this.trigger.apply(this,arguments),this}}}(Signals);function defer_expr(e,t){var o;e()?t():o=setInterval(function(){e()&&(clearInterval(o),t())},0)}String.prototype.replace_all=function(e,t){var o=this.valueOf();for(e=e||"",t=t||"";0<=o.indexOf(e);)o=o.replace(e,t);return o},window._id_counter=-1,Object.prototype.hasOwnProperty("_id")||Object.defineProperty(Object.prototype,"_id",{value:"",enumerable:!1,writable:!0}),Object.prototype.hasOwnProperty("set_id")||Object.defineProperty(Object.prototype,"set_id",{value:function(e){return this._id=e||(window._id_counter++,"__"+window._id_counter+"__"),this._id},enumerable:!1,writable:!1}),Object.prototype.hasOwnProperty("forIn")||Object.defineProperty(Object.prototype,"forIn",{value:function(e){var t;if(e)for(t in this)e(t,this[t])},enumerable:!1,writable:!1});var app=app||{};!function(){var o,r,n=[];app.config=app.config||{},app.config.test="good",void 0===app.config.settings&&(app.config.settings={website:{language_code:"en"}}),app.providers={},r=function(e,t){app.providers.$stateProvider.state(e,t),n.push(e)},o=function(e,t){var o,i=e.split(".");1===i.length?r(e,t):(i.pop(),o=i.join("."),defer_expr(function(){return 0<=n.indexOf(o)},function(){r(e,t)}))},app.state=function(e,t){defer_expr(function(){return"object"==typeof app.providers.$stateProvider},function(){o(e,t)})}}();var app=app||{};app.core=angular.module("application",["application.templates","application.core","application.auth","application.users","application.profile","application.settings","application.pages","application.menus","application.media_library","application.content_service","application.design","application.extra","application.widget.abstract","application.widget.abstract_container","application.widget.abstract_form-element","application.widget.abstract_form-field","application.widget.section","application.widget.row","application.widget.container","application.widget.block","application.widget.text","application.widget.image","application.widget.button","application.widget.divider_horizontal","application.widget.menu","application.widget.contact_form","application.widget.mail_chimp","application.widget.social_links","application.widget.social_buttons","application.widget.map","application.widget.iframe","application.widget.video","application.widget.slider","application.widget.embed","application.widget.grid_gallery","application.widget.spacer","application.widget.carousel","application.widget.disqus","application.widget.pinterest","application.widget.facebook_page_plugin","application.widget.sound_cloud","application.widget.twitter.time_line","application.widget.slideshare","application.widget.pagination","application.widget.audio_player","application.widget.video_player","application.widget.auth_form","application.widget.countdown","application.widget.accordion","application.widget.completion_bars","application.widget.social_links_extended","application.widget.back_to_top","application.widget.tabs","application.widget.paypal_button","application.widget.cookie_notification","application.widget.tile_gallery","application.widget.broken","application.actions.widgets","application.integrations.widgets","application.widget.instagram.post","application.widget.google_map_pro","application.form_elements.widgets","application.blog","chieffancypants.loadingBar","core.library.HttpRequestQueue","revolunet.stepper","rzModule","ngMaterial","application.plugins","moto.constants"]),angular.module("application.core",["ui.router","motoUI","moto.directive","moto.translations","core.library","core.library.jsonrpc","core.library.config","core.library.PathResolver","core.library.validate","core.library.messenger","core.library.modal","core.library.tutorial","core.library.integration","core.library.interceptors","core.library.urlGenerator","core.library.CurrentValue","core.library.styles","core.library.Widget","core.library.LivePreview","core.library.CssGenerator","core.library.Features","core.library.editor","core.library.history","core.library.storage","core.library.brand","core.library.viewportInitialScale","core.library.deviceDetection","core.library.Accounts","core.library.languages","ui.bootstrap","ngAnimate","ipCookie","pascalprecht.translate","angularMoment","kr.ngNamespaceUrl","ngSanitize","ui.select"]),angular.module("application").config(["coreLibraryHttpRequestQueueProvider","coreLibraryConfigProvider",function(e,t){try{e.addRequestValidator(function(e){return e.url===t.get("apiUrl")}),0<t.get("api.settings.concurrentConnections",0)&&(e.setConcurrentConnections(t.get("api.settings.concurrentConnections")),e.enable())}catch(e){}}]),angular.module("application.core").config(["$locationProvider","$stateProvider","$urlRouterProvider","$translateProvider","$httpProvider","motoFeaturesProvider","motoUI.MenuServiceProvider","motoUI.BrowserTabCloseConfirmationProvider","coreLibraryTutorialProvider","coreLibraryIntegrationProvider","$namespaceUrlProvider","motoBrandProvider","$compileProvider","coreLibraryInterceptorsProvider","coreLibraryAccountsProvider","coreLibraryLanguagesProvider","coreLibraryConfigProvider","jsonrpcProvider",function(e,t,o,i,r,n,a,s,l,c,p,d,u,g,m,f,h,y){var b,_,v,E,w=["tutorialCenter","systemFavicon"];for(b in o.otherwise("/"),app.providers.$stateProvider=t,u.debugInfoEnabled(!1),r.useApplyAsync(!0),p.enable(),p.setPrefix("@"),app.config.path)app.config.path.hasOwnProperty(b)&&(-1<w.indexOf(b)||(v="dir",_=app.config.path[b],0<b.indexOf("File")&&(v="file"),p.setResource({name:b,src:_,type:v})));p.setResource({name:"views",src:"views"}),p.setResource({name:"website",src:app.config.getUrl("website")}),app.state("app",{url:"/",abstract:!0,title:"MODULE.DASHBOARD.PAGE_TITLE",views:{"header@":{templateUrl:"views/layouts/header.tpl.html",controller:"application.auth.controllers.HeaderController"},"footer@":{templateUrl:"views/layouts/footer.tpl.html"},"content@":{templateUrl:"views/application/dashboard/main.tpl.html"}}}),e.hashPrefix("!"),i.preferredLanguage(f.getProfileLocale()),i.fallbackLanguage(["en_US","en"]),i.useSanitizeValueStrategy(null),l.set("url",app.config.getUrl("tutorialCenter")),E=h.get("settings.website.features"),angular.isObject(E)&&n.addList(E),E=h.get("__features__"),angular.isObject(E)&&n.addList(E);var S=["$templateCache",function(t){return{request:function(e){return e.cache&&"GET"==e.method&&void 0===t.get(e.url)&&(0<e.url.indexOf(".tpl.html")&&(e.ignoreLoadingBar=!0),e.url=e.url+(-1===e.url.indexOf("?")?"?":"&")+"_="+(new Date).getTime()),e}}}];r.interceptors.push(S),y.setBasePath(h.get("apiUrl")),s.setOption("messageKey","COMMON.TEXT.UNSAVED_CHANGES_CONFIRMATION"),h.exists("settings.website.integrations")&&c.addCollections(h.get("settings.website.integrations")),h.exists("brand")&&d.bootstrap(h.get("brand"));try{g.setEnvironmentStage(h.getStage()),window.Signals&&Signals.setEnvironmentStage(h.getStage())}catch(e){}m.setOptions(h.get("externalModules.accounts"))}]),angular.module("application.core").run(["$rootScope","coreLibraryMessenger","jsonrpc","$translate","$state","coreLibraryModal","motoFeatures","motoUI.BrowserTabCloseConfirmation","motoBrand","$localStorage","$location","coreLibraryConfig","coreLibraryLanguages","amMoment",function(o,e,t,i,r,n,a,s,l,c,p,d,u,g){var m,f=c["redirect-after-login"];function h(){var e,t;o.pageTitle=i.instant((e=r.current.title,t=r.current.title+".TITLE",e&&0<=e.indexOf("MODULE")?e:t))}o.$on("$stateChangeStart",function(e,t){t.motoParams&&t.motoParams.redirectTo&&(e.preventDefault(),r.go(t.motoParams.redirectTo))}),o.$state=r,o.systemMessenger=e,o.$motoFeatures=a,o.$motoBrand=l,o.isDemoMode=d.isDemoMode(),o.websiteSettings=d.get("settings.website"),g.changeLocale(u.getProfileLocale()),f&&(p.path(f),delete c["redirect-after-login"],o.$apply()),o.isDemoMode&&(m=o.$on("$stateChangeSuccess",function(){n("views/components/ui/modal/information.tpl.html",function(e,t){e.title="DEMO_MODE.POPUP.TITLE",e.message="DEMO_MODE.POPUP.MESSAGE",e.ok=function(){m(),t.close(e)}})})),t.setEndErrorRequest(function(e,t){try{t&&t.message&&("COMMON.WARNING_MESSAGE.ACCESS_DENIED"!==t.message&&"ERROR.ACCESS_DENIED"!==t.message||!o.isDemoMode?"COMMON.ERROR.SESSION_EXPIRED"!==t.message&&"COMMON.ERROR_MESSAGE.ACCESS_DENIED"!==t.message&&"ERROR.ACCESS_DENIED"!==t.message||("COMMON.ERROR.SESSION_EXPIRED"===t.message?o.systemMessenger.error(t.message,null,2e4):o.systemMessenger.error(t.message)):o.systemMessenger.warning("DEMO_MODE.WARNING_MESSAGE.ACCESS_DENIED"))}catch(e){}}),o.$on("$stateChangeSuccess",h),o.$on("$translateChangeSuccess",h),s.enableStatesObservation(),o.loadNeededSDKs=function(e){var t,o,i;e&&e.$&&(t=e.$(".moto-widget-facebook_page_plugin"),o=e.$(".moto-widget-twitter_time_line"),i=e.$(".moto-widget-pinterest"),t&&0<t.length&&e.ScriptsInjector.inject("facebook"),o&&0<o.length&&e.ScriptsInjector.inject("twitter"),i&&0<i.length&&e.ScriptsInjector.inject("pinterest"))}}]),angular.module("moto.constants",[]).constant("MotoDevicesConstants",{SIZE:{DESKTOP:1040,TABLET:780,"MOBILE-H":570,"MOBILE-V":320},LIST:["desktop","tablet","mobile-h","mobile-v"]}),angular.module("application.templates",[]),angular.module("application.plugins",[]);var app=app||{};app.auth=angular.module("application.auth",["core.library.jsonrpc","core.library.config","core.library.validate","ui.bootstrap"]),app.core.config([function(){app.state("app.logout",{url:"logout/",title:"MODULE.AUTH.LOGIN.PAGE_TITLE",views:{"content@":{template:'<div class="dashboard-block"><div class="dashboard-block-inner"></div></div>',controller:"application.auth.controllers.LogoutController"}}}),app&&app.user||(app.state("forgot",{url:"/auth/forgot/",title:"MODULE.AUTH.COMMON.PASSWORD_RESET_PAGE_TITLE",views:{content:{templateUrl:"views/application/auth/forgot_password.tpl.html"}}}),app.state("reset",{url:"/auth/reset/:token/",title:"MODULE.AUTH.COMMON.PASSWORD_RESET_PAGE_TITLE",views:{content:{templateUrl:"views/application/auth/reset_password.tpl.html"}}}),app.state("activation",{url:"/activation/",title:"MODULE.AUTH.ACTIVATION.PAGE_TITLE",views:{content:{templateUrl:"views/application/auth/activation.tpl.html"}}}))}]),app.Blog=angular.module("application.blog",["core.library.utils","application.core","application.blog.widgets"]),angular.module("application.blog.widgets",[]),angular.module("application.blog").config(["motoUI.MenuServiceProvider","motoFeaturesProvider",function(e,t){t.isDisabled("theme_content_blog")||(app.state("app.blog",{abstract:!0,url:"blog/",views:{"content@":{templateUrl:"views/application/blog/blog.tpl.html"},"blog_menu@app.blog":{templateUrl:"views/application/blog/menu.tpl.html"}}}),e.getMenu("main_menu").addItem({label:"MODULE.BLOG.MENU_LABEL",state:"app.blog.posts.list",stateWildcard:"app.blog",indicate:!1,priority:7,itemId:"blog"}))}]).run(["motoFeatures","motoUI.LinkToService","application.pages.services.PagesModel","application.design.services.PageList",function(e,t,n,o){e.isDisabled("theme_content_blog")||(o.addGroup("blog",{title:"MODULE.BLOG.MENU_LABEL",priority:10,types:["blog.index","template.blog.post","template.blog.tag","template.blog.category"]}),t.addAction({name:"blog.index",label:"UI.ELEMENT.LINK_TO.OPTIONS.BLOG_INDEX",templateUrl:"views/application/blog/linkto/blog_index.tpl.html",priority:100,defaultProperties:{target:"_self"},parseDomElement:function(e,t,o){var i=o.href.indexOf("#");t.target=o.target||"_self",t.anchor=-1<i?o.href.substring(i+1):"",t.anchor=t.anchor.replace(/'.*}}$/,""),t.id=parseInt(o.data.id)},compileDomElement:function(e,t,o){var i,r=null;for(i=n.getByField("id",t.id),o.text||(o.text=i.name);i;)r=r?i.url+"/"+r:i.url,i=i.parent;t.anchor&&(r+="#"+t.anchor),o.target=t.target,o.href=r,o.data.id=t.id},linkTransform:function(e,t){var o;t.href&&(o=t.href.trim(),o="{{ Linker.pageLink('"+t.data.id+"','"+o+"') }}",e.attr("href",o))}}),t.addAction({name:"blog.post",label:"UI.ELEMENT.LINK_TO.OPTIONS.BLOG_POST",templateUrl:"views/application/blog/linkto/blog_post.tpl.html",priority:105,defaultProperties:{target:"_self"},parseDomElement:function(e,t,o){var i=o.href.indexOf("#");t.target=o.target||"_self",t.anchor=-1<i?o.href.substring(i+1):"",t.anchor=t.anchor.replace(/'.*}}$/,""),t.id=parseInt(o.data.id)},compileDomElement:function(e,t,o){var i,r=null;for(i=n.getByField("id",t.id),o.text||(o.text=i.name);i;)r=r?i.url+"/"+r:i.url,i=i.parent;t.anchor&&(r+="#"+t.anchor),o.target=t.target,o.href=r,o.data.id=t.id},linkTransform:function(e,t){var o;t.href&&(o=t.href.trim(),o="{{ Linker.pageLink('"+t.data.id+"','"+o+"') }}",e.attr("href",o))}}))}]);var app=app||{};app.ContentService=angular.module("application.content_service",["ui.bootstrap","core.library.jsonrpc","core.library.config","core.library.validate","core.library.modal","core.library.utils","core.library.viewportInitialScale"]),app.core.config(["motoFeaturesProvider","motoUI.MenuServiceProvider",function(e,t){app.state("app.content",{url:e.isEnabled("engine_dashboard")?"content/":"",title:"MODULE.PAGES.PAGE_TITLE",views:{"content@":{templateUrl:"views/application/content_service/top.tpl.html",controller:"application.content_service.TopController"}},motoParams:{confirmBrowserTabClose:!0,tutorialUrl:"content"}}),t.getMenu("main_menu").addItem({label:"MODULE.PAGES.PAGE_TITLE",state:"app.content",indicate:!1,priority:2,itemId:"pages"})}]),app.core.config(["motoFeaturesProvider","motoUI.MenuServiceProvider",function(e,t){e.isEnabled("engine_dashboard")&&(app.state("app.dashboard",{url:"",title:"MODULE.DASHBOARD.PAGE_TITLE"}),t.getMenu("main_menu").addItem({label:"MODULE.DASHBOARD.PAGE_TITLE",state:"app.dashboard",indicate:!1,priority:1,itemId:"home"}))}]);var app=app||{};app.Design=angular.module("application.design",["ui.bootstrap","core.library.jsonrpc","core.library.validate","core.library.modal","core.library.utils","core.library.styles","application.design.editor"]),app.core.config(["motoUI.MenuServiceProvider","$namespaceUrlProvider",function(e,t){app.state("app.design",{url:"design/",title:"MODULE.DESIGN.PAGE_TITLE",views:{"content@":{templateUrl:"views/application/design/top.tpl.html",controller:"application.design.controllers.TopController"},"design-content@app.design":{templateUrl:"views/application/design/design-menu.tpl.html"}}}),app.state("app.design.notfound",{url:"notfound/",title:"MODULE.DESIGN.PAGE_TITLE",views:{"design-content":{templateUrl:"views/application/design/not_found.tpl.html"}}}),e.getMenu("main_menu").addItem({label:"MODULE.DESIGN.PAGE_TITLE",state:"app.design",indicate:!1,priority:3,itemId:"design"}),t.setResource({name:"design",src:"js/src/application/design"})}]),app.Design.run(["application.design.services.PageList",function(e){e.addGroup("pages",{title:"MODULE.PAGES.PAGE_TITLE",priority:5,types:"page"})}]),angular.module("application.extra",["core.library.jsonrpc"]),angular.module("application.media_library",["ui.bootstrap","ui.router","core.library.config","core.library.jsonrpc","core.library.validate","core.library.modal","core.library.uploader","core.library.utils","core.library.CurrentValue","core.library.dragDrop","application.users"]).config(["motoUI.MenuServiceProvider","$stateProvider",function(e,t){t.state("app.medialibrary",{url:"medialibrary/",title:"MODULE.MEDIA_LIBRARY.PAGE_TITLE",views:{"content@":{templateUrl:"views/application/media_library/top.tpl.html",controller:"application.media_library.controllers.TopController"}},motoParams:{tutorialUrl:"medialibrary"}}),e.getMenu("main_menu").addItem({label:"MODULE.MEDIA_LIBRARY.PAGE_TITLE",state:"app.medialibrary",indicate:!1,priority:4,itemId:"medialibrary"})}]).run(["application.media_library.services.UploadedFilesDispatcherService","application.media_library.services.MediaLibraryService","$q","application.media_library.services.MediaLibraryModelService","$rootScope","motoFeatures",function(e,i,r,t,o,n){i.uploader().addInterceptor({priority:50,itemType:"image",onSuccess:function(t){var o=r.defer();return n.isEnabled("engine_thumbnails_available")?i.generateThumbnails({id:t.id}).then(function(e){t.setThumbnails(e.thumbnails),o.resolve()},function(){e.thumbnailsNotGenerated(t.id),o.reject()}):o.resolve(),o.promise}}),e.init()}]),angular.module("application.menus",["ui.bootstrap","core.library.jsonrpc","core.library.validate","core.library.modal","core.library.urlGenerator","application.users","core.library.utils","ui.tree"]);var app=app||{};app.pages=angular.module("application.pages",["ui.bootstrap","core.library.jsonrpc","core.library.validate","core.library.modal","core.library.urlGenerator","core.library.utils"]);var app=app||{};app.profile=angular.module("application.profile",["core.library.jsonrpc","core.library.validate"]),app.core.config(["motoUI.MenuServiceProvider",function(e){app.state("app.profile",{url:"profile/",title:"MODULE.PROFILE.PAGE_TITLE",views:{"content@":{templateUrl:"views/application/profile/edit.tpl.html"}}}),e.getMenu("profile_menu").addItem({label:"MODULE.PROFILE.PAGE_TITLE",state:"app.profile",priority:1,itemId:"profile",icon:"icon-profile"})}]);var app=app||{};app.settings=angular.module("application.settings",["ui.bootstrap","core.library.jsonrpc","core.library.validate","core.library.Accounts","core.library.modal"]),app.core.config(["motoUI.MenuServiceProvider",function(e){app.state("app.settings",{url:"settings/",title:"MODULE.SETTINGS.GENERAL.PAGE_TITLE",views:{"content@":{templateUrl:"views/application/settings/settings.tpl.html"}}}),app.state("app.settings.general",{url:"general/",title:"MODULE.SETTINGS.GENERAL.PAGE_TITLE",templateUrl:"views/application/settings/general.tpl.html",motoParams:{tutorialUrl:"settings/general"}}),e.getMenu("main_menu").addItem({label:"MODULE.SETTINGS.MENU_LABEL",state:"app.settings.general",stateWildcard:"app.settings",indicate:!1,priority:5,itemId:"settings"}),e.getMenu("settings_menu").addItem({label:"MODULE.SETTINGS.GENERAL.PAGE_HEADING",state:"app.settings.general",indicate:!1,priority:0,icon:"icon-settings-general",itemId:"general"})}]);var app=app||{};app.users=angular.module("application.users",["ui.bootstrap","core.library.jsonrpc","core.library.validate","core.library.modal","motoUI"]),angular.module("application").config(["$stateProvider","motoUI.MenuServiceProvider","motoFeaturesProvider",function(e,t,o){o.isDisabled("theme_content_blog")||(e.state("app.blog.categories",{abstract:!0,url:"categories/",views:{blog_content:{template:"<ui-view></ui-view>"}}}),e.state("app.blog.categories.list",{url:"list/",title:"MODULE.BLOG.CATEGORIES.PAGE_TITLE",views:{"":{templateUrl:"views/application/blog/categories/categories.tpl.html",controller:"application.blog.categories.controllers.ListController"}}}),t.getMenu("blog_menu").addItem({label:"MODULE.BLOG.CATEGORIES.PAGE_TITLE",state:"app.blog.categories.list",stateWildcard:"app.blog.categories",indicate:!1,priority:2,icon:"icon-blog-categories",itemId:"blog_categories"}))}]),app.core.config(["motoUI.MenuServiceProvider","motoFeaturesProvider",function(e,t){t.isDisabled("theme_content_blog")||(app.state("app.blog.posts",{abstract:!0,url:"posts/",views:{blog_content:{template:"<ui-view></ui-view>"}}}),app.state("app.blog.posts.list",{url:"list/",title:"MODULE.BLOG.POSTS.PAGE_TITLE",views:{"":{templateUrl:"views/application/blog/posts/posts.tpl.html",controller:"application.blog.posts.controllers.ListController"}},motoParams:{tutorialUrl:"blog/posts/list"}}),app.state("app.blog.posts.edit",{url:"edit/:postId",title:"MODULE.BLOG.POSTS.EDIT_POST_PAGE_TITLE",views:{"":{templateUrl:"views/application/blog/posts/post.tpl.html",controller:"application.content_service.TopController"},"blog_menu@app.blog":{}}}),e.getMenu("blog_menu").addItem({label:"MODULE.BLOG.POSTS.PAGE_TITLE",state:"app.blog.posts.list",stateWildcard:"app.blog.posts",indicate:!1,priority:1,icon:"icon-blog-posts",itemId:"blog_posts"}))}]),app.core.config(["motoUI.MenuServiceProvider","motoFeaturesProvider",function(e,t){t.isDisabled("theme_content_blog")||(app.state("app.blog.settings",{url:"settings/",abstract:!0,views:{blog_content:{template:"<ui-view></ui-view>",controller:"application.blog.controllers.SettingsController"}}}),app.state("app.blog.settings.general",{url:"general/",title:"MODULE.BLOG.SETTINGS.GENERAL.PAGE_TITLE",views:{"":{templateUrl:"views/application/blog/settings/general.tpl.html"}}}),e.getMenu("blog_menu").addItem({indicate:!1,priority:10,label:"MODULE.BLOG.SETTINGS.MENU_LABEL",state:"app.blog.settings.general",icon:"icon-blog-settings",itemId:"blog_settings"}))}]),angular.module("application").config(["motoUI.MenuServiceProvider","motoFeaturesProvider",function(e,t){t.isDisabled("theme_content_blog")||(app.state("app.blog.tags",{abstract:!0,url:"tags/",views:{blog_content:{template:"<ui-view></ui-view>"}}}),app.state("app.blog.tags.list",{url:"list/",title:"MODULE.BLOG.TAGS.PAGE_TITLE",views:{"":{templateUrl:"views/application/blog/tags/tags.tpl.html",controller:"application.blog.tags.controllers.ListController"}}}),e.getMenu("blog_menu").addItem({label:"MODULE.BLOG.TAGS.PAGE_TITLE",state:"app.blog.tags.list",stateWildcard:"app.blog.tags",indicate:!1,priority:3,icon:"icon-blog-tags",itemId:"blog_tags"}))}]),app.core.config(["motoUI.MenuServiceProvider","motoFeaturesProvider","$stateProvider",function(e,t,o){t.isDisabled("theme_content_blog")||(o.state("app.blog.templates",{url:"templates/",abstract:!0,views:{blog_content:{template:"<ui-view></ui-view>"}}}),o.state("app.blog.templates.main_page",{url:"main_page/",title:"MODULE.BLOG.TEMPLATES.MAIN_PAGE.PAGE_TITLE",views:{"":{templateUrl:"views/application/blog/templates/main_page/main_page.tpl.html",controller:"application.content_service.TopController"},"blog_menu@app.blog":{}},motoParams:{tutorialUrl:"blog/templates/main_page"}}),o.state("app.blog.templates.post",{url:"post/",title:"MODULE.BLOG.TEMPLATES.POST.PAGE_TITLE",views:{"":{templateUrl:"views/application/blog/templates/post/post.tpl.html",controller:"application.content_service.TopController"},"blog_menu@app.blog":{}}}),o.state("app.blog.templates.tag",{url:"tag/",title:"MODULE.BLOG.TEMPLATES.TAG.PAGE_TITLE",views:{"":{templateUrl:"views/application/blog/templates/tag/tag.tpl.html",controller:"application.content_service.TopController"},"blog_menu@app.blog":{}}}),o.state("app.blog.templates.category",{url:"category/",title:"MODULE.BLOG.TEMPLATES.CATEGORY.PAGE_TITLE",views:{"":{templateUrl:"views/application/blog/templates/category/category.tpl.html",controller:"application.content_service.TopController"},"blog_menu@app.blog":{}}}),e.getMenu("blog_menu").addItem({label:"MODULE.BLOG.TEMPLATES.MENU_LABEL",state:"app.blog.templates.main_page",priority:5,icon:"blog-templates-icon",itemId:"templates",items:[{label:"MODULE.BLOG.TEMPLATES.MAIN_PAGE.MENU_LABEL",state:"app.blog.templates.main_page"},{label:"MODULE.BLOG.TEMPLATES.POST.MENU_LABEL",state:"app.blog.templates.post"},{label:"MODULE.BLOG.TEMPLATES.CATEGORY.MENU_LABEL",state:"app.blog.templates.category"},{label:"MODULE.BLOG.TEMPLATES.TAG.MENU_LABEL",state:"app.blog.templates.tag"}]}))}]),app.core.config(["motoUI.MenuServiceProvider",function(e){app.state("app.design.background",{url:"background/",title:"MODULE.DESIGN.BACKGROUNDS.PAGE_TITLE",views:{"design-content":{templateUrl:"views/application/design/background/background.tpl.html",controller:"application.design.background.controllers.BackgroundController"}}}),app.state("app.design.background.edit",{url:":id/",title:"MODULE.DESIGN.BACKGROUNDS.PAGE_TITLE",motoParams:{tutorialUrl:"design/background"}}),e.getMenu("design_menu").addItem({label:"MODULE.DESIGN.BACKGROUNDS.MENU_LABEL",state:"app.design.background",indicate:!1,priority:3,itemId:"background",icon:"icon-background"})}]),app.core.config(["motoUI.MenuServiceProvider",function(e){app.state("app.design.colorizer",{url:"color/",title:"MODULE.DESIGN.COLORS.PAGE_TITLE",views:{"design-content":{templateUrl:"views/application/design/colorizer/colorizer.tpl.html",controller:"application.design.colorizer.controllers.ColorizerController"}},motoParams:{tutorialUrl:"design/color"}}),e.getMenu("design_menu").addItem({label:"MODULE.DESIGN.COLORS.PAGE_TITLE",state:"app.design.colorizer",indicate:!1,priority:2,itemId:"colorizer",icon:"icon-colors"})}]),angular.module("application.design.editor",[]),app.core.config(["motoUI.MenuServiceProvider",function(e){app.state("app.design.styles",{url:"styles/",title:"MODULE.DESIGN.TEXT_STYLES.PAGE_TITLE",views:{"design-content":{templateUrl:"views/application/design/styles/list.tpl.html"},"@app.design.styles":{templateUrl:"views/application/design/styles/list-data.tpl.html"}},motoParams:{tutorialUrl:"design/styles"}}),app.state("app.design.styles.edit",{url:"edit/:styleId/",title:"MODULE.DESIGN.TEXT_STYLES.EDIT.PAGE_TITLE",views:{"":{templateUrl:"views/application/design/styles/edit.tpl.html"}},motoParams:{tutorialUrl:"design/styles"}}),app.state("app.design.styles.add",{url:"add/",title:"MODULE.DESIGN.TEXT_STYLES.ADD.PAGE_TITLE",views:{"":{templateUrl:"views/application/design/styles/add.tpl.html"}},motoParams:{tutorialUrl:"design/styles"}}),e.getMenu("design_menu").addItem({label:"MODULE.DESIGN.TEXT_STYLES.PAGE_TITLE",state:"app.design.styles",indicate:!1,priority:1,itemId:"styles",icon:"icon-text-styles"})}]),app.core.config(["motoFeaturesProvider",function(e){e.isEnabled("engine_grid_settings")&&app.state("app.design.theme.row",{url:"row/",title:"MODULE.DESIGN.THEME_VALUES.GRID.PAGE_TITLE",views:{"":{controller:"application.design.theme.row.RowController",templateUrl:"views/application/design/theme/row/row.tpl.html"}}})}]),app.core.config([function(){app.state("app.design.theme.headings",{url:"headings/",title:"MODULE.DESIGN.THEME_VALUES.HEADINGS.PAGE_TITLE",views:{"":{controller:"application.design.theme.headings.HeadingsController",templateUrl:"views/application/design/theme/headings/headings.tpl.html"}}})}]),app.core.config(["motoUI.MenuServiceProvider","motoFeaturesProvider",function(e,t){app.state("app.design.theme",{url:"theme/",title:"MODULE.DESIGN.THEME_VALUES.PAGE_TITLE",views:{"design-content":{templateUrl:"views/application/design/theme/theme.tpl.html"}}}),t.isEnabled("theme_spacings")&&e.getMenu("design_menu").addItem({label:"MODULE.DESIGN.THEME_VALUES.PAGE_TITLE",state:"app.design.theme",indicate:!1,priority:4,itemId:"spacings",icon:"icon-size-and-values"})}]),app.core.config([function(){app.state("app.design.theme.spacings",{url:"spacings/",title:"MODULE.DESIGN.THEME_VALUES.SPACINGS.PAGE_TITLE",views:{"":{controller:"application.design.theme.spacings.controllers.SpacingsController",templateUrl:"views/application/design/theme/spacings/spacings.tpl.html"}},motoParams:{tutorialUrl:"design/theme/spacings"}})}]),app.DesignWidgets=angular.module("WidgetsDesign",[]),app.core.config(["motoUI.MenuServiceProvider","motoFeaturesProvider",function(e,t){app.state("app.design.widgets",{url:"widgets/",title:"MODULE.DESIGN.WIDGETS.PAGE_TITLE",views:{"design-content":{templateUrl:"views/application/design/widgets/widgets.tpl.html",controller:"application.design.widgets.controllers.WidgetsController"}},motoParams:{tutorialUrl:"design/widgets"}}),app.state("app.design.widgets.presets",{url:":widget/",title:"MODULE.DESIGN.WIDGETS.PRESETS.PAGE_TITLE",views:{"":{templateUrl:"views/application/design/widgets/presets_list.tpl.html",controller:"application.design.widgets.controllers.PresetsListController"}},motoParams:{tutorialUrl:"design/widgets"}}),app.state("app.design.widgets.presets.edit",{url:"edit/:presetId/",title:"MODULE.DESIGN.WIDGETS.PRESETS.EDIT.PAGE_TITLE",views:{"":{templateUrl:"views/application/design/widgets/edit.tpl.html",controller:"application.design.widgets.controllers.EditController"}},motoParams:{tutorialUrl:"design/widgets"}}),t.isEnabled("theme_presets")&&e.getMenu("design_menu").addItem({label:"MODULE.DESIGN.WIDGETS.PAGE_TITLE",state:"app.design.widgets",indicate:!1,priority:5,itemId:"",icon:"icon-widgets"})}]),app.core.config(["motoUI.MenuServiceProvider",function(e){app.state("app.settings.advanced_settings",{url:"advanced_settings/",title:"MODULE.SETTINGS.GENERAL.ADVANCED_SETTINGS_HEADING",templateUrl:"views/application/settings/advanced_settings/advanced_settings.tpl.html",controller:"application.settings.advanced_settings.controllers.AdvancedSettingsController"}),e.getMenu("settings_menu").addItem({label:"MODULE.SETTINGS.GENERAL.ADVANCED_SETTINGS_HEADING",state:"app.settings.advanced_settings",indicate:!1,priority:40,icon:"icon-settings-advanced",itemId:"advanced_settings"})}]),app.core.config(["motoUI.MenuServiceProvider",function(e){app.state("app.settings.analytics",{url:"analytics/",title:"MODULE.SETTINGS.ANALYTICS.PAGE_TITLE",templateUrl:"views/application/settings/analytics/analytics.tpl.html",controller:"application.settings.analytics.controllers.AnalyticsController"}),e.getMenu("settings_menu").addItem({label:"MODULE.SETTINGS.ANALYTICS.PAGE_TITLE",state:"app.settings.analytics",indicate:!1,priority:10,icon:"icon-settings-analytics",itemId:"analytics"})}]),angular.module("application").config(["motoUI.MenuServiceProvider","motoFeaturesProvider",function(e,t){t.isDisabled("engine_code_injection")||(app.state("app.settings.code_injection",{url:"code_injection/",title:"MODULE.SETTINGS.CODE_INJECTION.PAGE_TITLE",templateUrl:"views/application/settings/code_injection/code_injection.tpl.html",controller:"application.settings.code_injection.controllers.CodeInjectionController"}),e.getMenu("settings_menu").addItem({label:"MODULE.SETTINGS.CODE_INJECTION.PAGE_TITLE",state:"app.settings.code_injection",indicate:!1,priority:20,icon:"icon-settings-code-injection",itemId:"code_injection"}))}]),app.core.config(["motoUI.MenuServiceProvider",function(e){app.state("app.settings.fonts",{url:"fonts/",title:"MODULE.SETTINGS.FONTS.PAGE_TITLE",templateUrl:"views/application/settings/fonts/fonts.tpl.html",controller:"application.settings.fonts.controllers.FontsController",motoParams:{tutorialUrl:"settings/fonts"}}),e.getMenu("settings_menu").addItem({label:"MODULE.SETTINGS.FONTS.PAGE_TITLE",state:"app.settings.fonts",indicate:!1,priority:15,icon:"icon-settings-fonts",itemId:"fonts"})}]),angular.module("application").config(["$stateProvider","motoUI.MenuServiceProvider",function(e,t){e.state("app.settings.integration",{url:"integration/",template:"<ui-view></ui-view>",motoParams:{redirectTo:"app.settings.integration.general"}}),e.state("app.settings.integration.general",{url:"general/",title:"MODULE.SETTINGS.INTEGRATION.PAGE_TITLE",templateUrl:"views/application/settings/integration/general.tpl.html",controller:"application.settings.integration.controllers.IntegrationController",motoParams:{tutorialUrl:"settings/integration"}}),e.state("app.settings.integration.live_chat",{url:"live_chat/",title:"MODULE.SETTINGS.INTEGRATION.LIVE_CHAT.PAGE_TITLE",templateUrl:"views/application/settings/integration/live_chat.tpl.html",controller:"application.settings.integration.controllers.LiveChatController"}),t.getMenu("settings_menu").addItem({label:"MODULE.SETTINGS.INTEGRATION.PAGE_TITLE",state:"app.settings.integration",indicate:!1,priority:30,icon:"icon-settings-integration",itemId:"integration",items:[{label:"MODULE.SETTINGS.GENERAL.PAGE_HEADING",state:"app.settings.integration.general"},{label:"MODULE.SETTINGS.INTEGRATION.LIVE_CHAT.PAGE_TITLE",state:"app.settings.integration.live_chat"}]})}]),angular.module("application").config(["motoUI.MenuServiceProvider",function(e){app.state("app.settings.mail_options",{url:"mail_options/",title:"MODULE.SETTINGS.MAIL_OPTIONS.PAGE_TITLE",templateUrl:"views/application/settings/mail_options/mail_options.tpl.html",controller:"application.settings.mail_options.controllers.MailOptionsController"}),e.getMenu("settings_menu").addItem({label:"MODULE.SETTINGS.MAIL_OPTIONS.PAGE_TITLE",state:"app.settings.mail_options",indicate:!1,priority:25,icon:"icon-settings-mail-options",itemId:"mail_options"})}]),app.core.config(["motoFeaturesProvider","motoUI.MenuServiceProvider",function(e,t){e.isEnabled("engine_redirects")&&(app.state("app.settings.redirects",{url:"redirects/",title:"MODULE.SETTINGS.REDIRECTS.PAGE_TITLE",templateUrl:"views/application/settings/redirects/redirects.tpl.html",controller:"application.settings.redirects.RedirectsController",motoParams:{tutorialUrl:"settings/redirects"}}),t.getMenu("settings_menu").addItem({label:"MODULE.SETTINGS.REDIRECTS.PAGE_TITLE",state:"app.settings.redirects",indicate:!1,priority:35,icon:"icon-settings-redirects",itemId:"redirects"}))}]),app.core.config(["motoUI.MenuServiceProvider","motoFeaturesProvider",function(e,t){t.isDisabled("engine_seo_settings")||(app.state("app.settings.seo",{url:"seo/",title:"MODULE.SETTINGS.SEO.PAGE_TITLE",templateUrl:"views/application/settings/seo/seo.tpl.html",controller:"application.settings.seo.controllers.SeoController"}),e.getMenu("settings_menu").addItem({label:"MODULE.SETTINGS.SEO.PAGE_TITLE",state:"app.settings.seo",indicate:!1,priority:7,icon:"icon-settings-seo",itemId:"seo"}))}]),app.core.config(["motoUI.MenuServiceProvider",function(e){app.state("app.settings.updates",{url:"updates/",title:"MODULE.SETTINGS.UPDATES.PAGE_TITLE",templateUrl:"views/application/settings/updates/updates.tpl.html",controller:"application.settings.updates.controllers.UpdatesController",motoParams:{tutorialUrl:"settings/updates"}}),e.getMenu("settings_menu").addItem({label:"MODULE.SETTINGS.UPDATES.PAGE_TITLE",state:"app.settings.updates",indicate:!1,priority:5,icon:"icon-settings-updates",itemId:"updates"})}]),app.auth.controller("application.auth.controllers.ActivationController",["$rootScope","$state",function(e,t){e.autificationData||t.go("login")}]),app.auth.controller("application.auth.controllers.AuthController",["$rootScope","$scope","$q","$state","application.auth.services.AuthService",function(t,o,e,i,r){o.form={email:"",password:"",remember:!1},t.isDemoMode&&t.demoAuth&&angular.extend(o.form,t.demoAuth);var n=function(e){e&&0<e.id&&document.location.reload(!0)};o.submit=function(){o.loginForm&&o.loginForm.validate()&&r.login(o.form).success(n).error(function(e){if({"ERROR.COULDNOT_ENCRYPT_SOURCE":{},"ERROR.NETWORK":{},"ERROR.WRONG_RESPONSE_FORMAT":{},"ERROR.ERROR_IN_RESPONSE":{},"ERROR.REPSONSE_PARSE_ERROR":{},"ERROR.UNABLE_DECRYPT_REPSONSE":{},"ERROR.TIME_IS_FAKED":{},"ERROR.AUTHORIZATION_FAILED":{},"ERROR.PRODUCT_IS_NOT_ACTIVATED":{},PRODUCT_IS_NOT_ACTIVATED:{}}[e.message])return t.autificationData=o.form,t.controlPanelInfo=e.data.errors.info,t.activationErrorName=e.message,t.activationError={name:e.message,data:e.data.errors.error},o.systemMessenger.error("MODULE.AUTH.ACTIVATION."+e.message.replace(/^ERROR\./,"ERROR_MESSAGE."),{},1e4),void i.go("activation");o.systemMessenger.error(e.message,{},2e4),o.loginForm.setValidity(e)})}}]),app.auth.controller("application.auth.controllers.ForgotPasswordController",["$scope","$rootScope","application.auth.services.AuthService","$state",function(t,e,o,i){t.form={email:""},e.isDemoMode&&e.demoAuth&&(t.form.email=e.demoAuth.email);var r=function(e){t.systemMessenger.success("MODULE.AUTH.FORGOT_PASSWORD.FORGOT_PASSWORD_SUCCESS_MESSAGE"),i.go("login")},n=function(e){t.systemMessenger.error("MODULE.AUTH.FORGOT_PASSWORD.INCORRECT_EMAIL_ERROR_MESSAGE","forgot")};t.submit=function(){if(t.forgotForm&&t.forgotForm.validate()){if(e.isDemoMode)return void e.systemMessenger.warning("DEMO_MODE.WARNING_MESSAGE.ACCESS_DENIED");o.forgotPassword(t.form).success(r).error(n)}}}]),app.auth.controller("application.auth.controllers.HeaderController",["$scope","$rootScope","application.auth.services.AuthService","ipCookie","coreLibraryModal","$window","MotoLocalStorage","application.auth.services.SupportService","$translate","coreLibraryConfig",function(o,e,t,i,r,n,a,s,l,c){var p,d;p={ignorePHPExpiry:{name:"hide_php_5_5_expiration_panel"}},e.showPHPVersionPanel=c.exists("environment.php.id")&&c.get("environment.php.id")<50600&&!i(p.ignorePHPExpiry.name),e.hidePHPExpiryPanel=function(){e.showPHPVersionPanel=!1,i(p.ignorePHPExpiry.name,1,{expires:9999})},o.username="",app&&app.user&&app.user.name&&(o.username=app.user.name),o.profileUpdated=function(){app&&app.user&&app.user.name&&(o.username=app.user.name)},Signals.on("PROFILE","profile.update",o.profileUpdated),d=function(){document.location.reload(!0)},o.submit=function(){t.logout().success(d)},o.showProfileList=function(){angular.element(".js-profile-list").is(":visible")?o.hideProfileList():angular.element(".js-profile-list").show(25)},o.hideProfileList=function(){angular.element(".js-profile-list").hide(25)},o.showFeedBackForm=function(){r("views/application/auth/feedback.tpl.html",function(e){var t=a.getValue("support_feedback");t&&(e.subject=t.subject,e.message=t.message),e.saveMessage=function(e,t){a.setValue("support_feedback",{subject:e,message:t})},e.submit=function(){e.feedbackForm.$setDirty(),e.feedbackForm&&e.feedbackForm.validate()&&s.sendFeedback({subject:e.subject,body:e.message}).success(function(){o.systemMessenger.success(l.instant("COMMON.TEXT.SEND_MESSAGE_SUCCESS_MESSAGE")),e.saveMessage("",""),e.ok()}).error(function(e){o.systemMessenger.error(l.instant(e.message))})}})},o.$on("$destroy",function(){Signals.off("PROFILE","profile.update",o.profileUpdated)})}]),app.auth.controller("application.auth.controllers.LogoutController",["$scope","$state","application.auth.services.AuthService",function(e,t,o){o.logout().success(function(){document.location.reload(!0)})}]),app.auth.controller("application.auth.controllers.ResetPasswordController",["$scope","$rootScope","application.auth.services.AuthService","$state","$stateParams",function(t,e,o,i,r){t.form={token:"",password:"",confirm:""};var n=function(){t.systemMessenger.success("MODULE.AUTH.RESET_PASSWORD.RESET_PASSWORD_SUCCESS_MESSAGE","login"),i.go("login")},a=function(e){t.systemMessenger.error("MODULE.AUTH.RESET_PASSWORD.RESET_PASSWORD_ERROR_MESSAGE","reset"),t.resetForm.setValidity(e)};t.submit=function(){t.form.token=r.token,t.resetForm&&t.resetForm.validate()&&o.resetPassword(t.form).success(n).error(a)}}]),app.auth.service("application.auth.services.AuthService",["jsonrpc",function(e){var t=e.newService("AuthService");this.login=t.createMethod("login"),this.logout=t.createMethod("logout"),this.forgotPassword=t.createMethod("forgotPassword"),this.resetPassword=t.createMethod("resetPassword")}]),app.auth.service("application.auth.services.SupportService",["jsonrpc",function(e){var t=e.newService("SupportService");this.sendFeedback=t.createMethod("sendFeedback")}]),angular.module("application.blog").controller("application.blog.categories.controllers.ListController",["$scope","application.blog.services.CategoryService","coreLibraryModal","coreLibraryUrlGenerator","coreLibraryUtils",function(n,a,e,s,t){var o={name:"",slug:"",type:"blog.category",short_description:"",long_description:"",properties:{meta:{canonical_url:null,description:null,hideCanonical:!1,nofollow:!1,noindex:!1,title:null}}};function l(){a.getList().then(function(e){n.categoriesData=e.records,n.pageChanged()}).catch(function(){n.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")})}function i(r){e("views/application/blog/categories/edit_category.tpl.html",function(o,e){var i=s();function t(e,t){return o.editingCategoryModel[e].length>t?(o.$broadcast("MotoEvent:MotoCkeditor.ShowValidationBalloon",{messageKey:"COMMON.VALIDATION_ERROR.HTML_LENGTH_TOO_LONG",messageParams:{maximum_character_count:t},key:e}),!1):(o.$broadcast("MotoEvent:MotoCkeditor.ClearValidationBalloon"),!0)}o.isNew=angular.isUndefined(r.id),(o.urlGenerator=i).value=r.slug,o.editingCategoryModel=r,o.$watch("editingCategoryModel.name",function(e,t){e!==t&&(i.setValue(e),o.editCategoryForm.clearErrors())}),o.ok=function(){o.editingCategoryModel.slug=o.urlGenerator.value,o.editCategoryForm.validate()&&t("short_description",5e3)&&t("long_description",16e3)&&a.save(o.editingCategoryModel).then(function(){l(),n.systemMessenger.success("COMMON.MESSAGES.CREATE_SUCCESS"),e.close(o)}).catch(function(e){n.systemMessenger.error("COMMON.MESSAGES.CREATE_ERROR"),o.editCategoryForm.setValidity(e)})}},null,"code-editor-modal")}n.categoriesData=[],n.categoriesPage=[],n.paginationVariants=[10,20,30,50],n.itemsPerPage=10,n.currentPage=1,n.totalItems=0,n.start=0,n.end=0,n.pageChanged=function(){n.totalItems=n.categoriesData.length,n.categoriesPage=function(e,t,o){var i,r;if(e)return r=(i=t*o)+o,e.slice(i,r)}(n.categoriesData,n.currentPage-1,n.itemsPerPage),n.start=(n.currentPage-1)*n.itemsPerPage+1,n.end=n.start+n.categoriesPage.length-1},l(),n.setPage=function(e){n.currentPage=e},n.editCategory=function(e){angular.isUndefined(e)?i(angular.copy(o)):a.getById({id:e}).then(i).catch(function(){n.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")})},n.deleteCategory=function(e){t.openConfirmationBox({yesHandler:function(){a.delete({id:e}).then(function(){l(),n.systemMessenger.success("COMMON.MESSAGES.DELETE_SUCCESS")}).catch(function(){n.systemMessenger.error("COMMON.MESSAGES.DELETE_ERROR")})},question:"WIDGET.COMMON.REMOVE_WIDGETS_ITEM_CONFIRMATION"})}}]),angular.module("application.blog").service("application.blog.services.CategoryService",["jsonrpc",function(e){var t=e.newService("Content.Blog.CategoryService");this.save=t.createMethod("save"),this.getList=t.createMethod("getList"),this.getById=t.createMethod("getById"),this.delete=t.createMethod("delete")}]),angular.module("application.blog").controller("application.blog.controllers.EditShortDescriptionController",["$scope","motoUI.LinkToService",function(t,o){t.shortDescription=t.currentPage.short_description,t.ok=function(){var e=$("<div>"+t.shortDescription.trim()+"</div>");o.transformLinks(e),16e3<e.html().length?t.$broadcast("MotoEvent:MotoCkeditor.ShowValidationBalloon",{messageKey:"COMMON.VALIDATION_ERROR.HTML_LENGTH_TOO_LONG",messageParams:{maximum_character_count:16e3}}):5e3<e.text().length?t.$broadcast("MotoEvent:MotoCkeditor.ShowValidationBalloon",{messageKey:"COMMON.VALIDATION_ERROR.STRING_LENGTH_TOO_LONG",messageParams:{maximum_character_count:5e3}}):(t.$broadcast("MotoEvent:MotoCkeditor.ClearValidationBalloon"),t.currentPage.short_description=e.html(),t.$parent.ok())}}]),app.Blog.controller("application.blog.posts.controllers.ListController",["$scope","$rootScope","$state","application.pages.services.PagesService","application.users.services.UsersService","application.pages.services.PagesModel","coreLibraryModal","coreLibraryUrlGenerator","coreLibraryUtils","coreLibraryLanguages",function(r,e,t,n,o,i,a,s,l,c){function p(e){return e=e.replace(" ","T"),new Date(e)}function d(e){i.success(function(){r.postsData=i.objects(function(e){return"blog.post"==e.type}).sort(function(e,t){return p(t.created)-p(e.created)}),r.blogPage=i.objects(function(e){return"blog.index"==e.type}),r.pageChanged(),r.totalItems=r.postsData.length}).error(function(){r.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(e)}r.users=[],r.currentLanguage=c.getProfileCode(),r.postsData=[],r.blogPage=null,r.currentPage=1,r.itemsPerPage="10",r.totalItems=0,r.start=0,r.end=0,r.postsPage=[],d(!(r.pageChanged=function(){r.postsPage=function(e,t,o){var i,r;if(o=parseInt(o),e)return r=(i=t*o)+o,e.slice(i,r)}(r.postsData,r.currentPage-1,r.itemsPerPage),r.start=(r.currentPage-1)*r.itemsPerPage+1,r.end=r.start+r.postsPage.length-1})),o.getList().success(function(e){r.users=e.records}).error(function(){r.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}),r.getAuthorById=function(e){var t;for(t=0;t<r.users.length;t++)if(e==r.users[t].id)return r.users[t];return null},r.setPage=function(e){r.currentPage=e},r.addNewPost=function(){a("views/application/blog/posts/add_new.tpl.html",function(o,t){var i=s(),e=r.blogPage[0].id;o.genUrl=i,o.newPostModel={name:"",url:"",type:"blog.post",parent_id:e,content:""},o.$watch("newPostModel.name",function(e,t){e!==t&&(i.setValue(e),o.createPostForm.clearErrors())}),o.ok=function(){o.newPostModel.url=o.genUrl.value,o.createPostForm.validate()&&n.save(o.newPostModel).success(function(e){t.close(o),d(!1),r.setPage(1),r.systemMessenger.success("COMMON.MESSAGES.CREATE_SUCCESS"),r.editPost(e.id)}).error(function(e){r.systemMessenger.error("COMMON.MESSAGES.CREATE_ERROR"),o.createPostForm.setValidity(e)})}})},r.deletePost=function(e){var t=e.name;30<=t.length&&(t=t.substring(0,30),t+="..."),l.openConfirmationBox({yesHandler:function(){n.deletePage({id:e.id}).success(function(){i.remove(e),d(!1),r.systemMessenger.success("COMMON.MESSAGES.DELETE_SUCCESS")}).error(function(){r.systemMessenger.error("COMMON.MESSAGES.DELETE_ERROR")})},question:"MODULE.BLOG.POSTS.DELETE_POST_CONFIRMATION",translate_params:{name:t}})},r.editPost=function(e){e&&t.go("app.blog.posts.edit",{postId:e})}}]),angular.module("application.blog").controller("application.blog.PostController",["$scope","application.pages.services.PagesModel","application.blog.services.TagService","application.blog.services.CategoryService","$stateParams","CurrentValue","application.media_library.services.MediaLibraryService","coreLibraryModal",function(o,e,t,i,r,n,a,s){o.availableTags=[],o.availableCategories=[],e.success(function(){o.setPage(r.postId||null)}).error(function(){o.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(!1),t.getList({type:"blog.post"}).then(function(e){o.availableTags=e.records}).catch(function(){o.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}),i.getList({type:"blog.post"}).then(function(e){o.availableCategories=e.records}).catch(function(){o.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}),o.$on("$destroy",function(){n.clear("content_service","page")}),o.editShortDescription=function(){s("views/application/blog/posts/edit_short_description.tpl.html",function(e,t){e.currentPage=o.currentPage,e.ok=function(){o.currentPage.short_description=e.currentPage.short_description,t.close(e)}},null,"modal-with-ckeditor")},o.editImage=function(){a.open({value:o.currentPage.properties.feature_media.src||null,thumbnails:!0,filters:["image"],onApply:function(e,t){a.getDataByThumbnailPath(o.currentPage.properties.feature_media.src).originalPath!=e.path&&(o.currentPage.properties.feature_media.alt=e.alt,o.currentPage.properties.feature_media.title=e.title),o.currentPage.properties.feature_media.src=t?e.getThumbnailPath(t):e.path},onCancel:function(){}})},o.deleteImage=function(){o.currentPage.properties.feature_media={}},o.$on("NEW EVENT: MotoEditor.config:before",function(e,t){t.setGlobal("permanent_highlighted_sections",["content"])})}]),angular.module("application.blog").controller("application.blog.controllers.SettingsController",["$scope","coreLibraryContentSection","coreLibraryIntegration","coreLibraryConfig","application.widget.DisqusService","coreLibraryModal",function(i,e,r,t,n,o){i.currentTime=new Date,i.disqusShortname=r.first("disqus").get("shortname"),i.editShortName=function(){o("@websiteWidgets/disqus/views/set_options.tpl.html",function(t,o){t.shortname=i.disqusShortname,t.showTooltip=!0,t.ok=function(){t.editWidgetOptions&&!t.editWidgetOptions.validate()||n.setOptions({shortname:t.shortname}).success(function(e){e&&void 0!==e.shortname&&(i.shortname=i.disqusShortname=e.shortname,r.first("disqus").set("shortname",i.shortname),i.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS")),o.close(t)}).error(function(){i.systemMessenger.error("WIDGET.DISQUS.SET_SHORTNAME_ERROR_MESSAGE")})},t.cancel=function(){o.close(t)}})},i.save=function(){e.setSettings({value:i.generalSettings}).success(function(){i.generalSettingsCloned=angular.copy(i.generalSettings),t.update("settings.website.content_section_blog",i.generalSettings),i.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS")}).error(function(){i.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")})},i.reset=function(){i.generalSettings=angular.copy(i.generalSettingsCloned)},e.getSettings().success(function(e){i.generalSettings=e,i.generalSettingsCloned=angular.copy(e)}).error(function(){i.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")})}]),angular.module("application.blog").controller("application.blog.tags.controllers.ListController",["$scope","application.blog.services.TagService","coreLibraryModal","coreLibraryUrlGenerator","coreLibraryUtils",function(n,a,e,s,t){var o={name:"",slug:"",type:"blog.tag",short_description:"",long_description:"",properties:{meta:{canonical_url:null,description:null,hideCanonical:!1,nofollow:!1,noindex:!1,title:null}}};function l(){a.getList().then(function(e){n.tagsData=e.records,n.pageChanged()}).catch(function(){n.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")})}function i(r){e("views/application/blog/tags/edit_tag.tpl.html",function(o,e){var i=s();function t(e,t){return o.editingTagModel[e].length>t?(o.$broadcast("MotoEvent:MotoCkeditor.ShowValidationBalloon",{messageKey:"COMMON.VALIDATION_ERROR.HTML_LENGTH_TOO_LONG",messageParams:{maximum_character_count:t},key:e}),!1):(o.$broadcast("MotoEvent:MotoCkeditor.ClearValidationBalloon"),!0)}o.isNew=angular.isUndefined(r.id),(o.urlGenerator=i).value=r.slug,o.editingTagModel=r,o.$watch("editingTagModel.name",function(e,t){e!==t&&(i.setValue(e),o.editTagForm.clearErrors())}),o.ok=function(){o.editingTagModel.slug=o.urlGenerator.value,o.editTagForm.validate()&&t("short_description",5e3)&&t("long_description",16e3)&&a.save(o.editingTagModel).then(function(){l(),n.systemMessenger.success("COMMON.MESSAGES.CREATE_SUCCESS"),e.close(o)}).catch(function(e){n.systemMessenger.error("COMMON.MESSAGES.CREATE_ERROR"),o.editTagForm.setValidity(e)})}},null,"code-editor-modal")}n.tagsData=[],n.tagsPage=[],n.paginationVariants=[10,20,30,50],n.itemsPerPage=10,n.currentPage=1,n.totalItems=0,n.start=0,n.end=0,n.pageChanged=function(){n.totalItems=n.tagsData.length,n.tagsPage=function(e,t,o){var i,r;if(e)return r=(i=t*o)+o,e.slice(i,r)}(n.tagsData,n.currentPage-1,n.itemsPerPage),n.start=(n.currentPage-1)*n.itemsPerPage+1,n.end=n.start+n.tagsPage.length-1},l(),n.setPage=function(e){n.currentPage=e},n.editTag=function(e){angular.isUndefined(e)?i(angular.copy(o)):a.getById({id:e}).then(i).catch(function(){n.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")})},n.deleteTag=function(e){t.openConfirmationBox({yesHandler:function(){a.delete({id:e}).then(function(){l(),n.systemMessenger.success("COMMON.MESSAGES.DELETE_SUCCESS")}).catch(function(){n.systemMessenger.error("COMMON.MESSAGES.DELETE_ERROR")})},question:"WIDGET.COMMON.REMOVE_WIDGETS_ITEM_CONFIRMATION"})}}]),angular.module("application.blog").service("application.blog.services.TagService",["jsonrpc",function(e){var t=e.newService("Content.Blog.TagService");this.save=t.createMethod("save"),this.getList=t.createMethod("getList"),this.getById=t.createMethod("getById"),this.delete=t.createMethod("delete")}]),angular.module("application.blog").controller("application.blog.templates.CategoryController",["$scope","application.pages.services.PagesModel","CurrentValue",function(t,o,e){o.success(function(){var e;e=o.objects(function(e){return"template.blog.category"===e.type})[0],t.setPage(e.id)}).error(function(){t.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(!1),t.$on("$destroy",function(){e.clear("content_service","page")})}]),angular.module("application.blog").controller("application.blog.templates.MainPageController",["$scope","application.pages.services.PagesModel","CurrentValue",function(t,o,e){o.success(function(){var e;e=o.objects(function(e){return"blog.index"==e.type})[0],t.setPage(e.id)}).error(function(){t.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(!1),t.$on("$destroy",function(){e.clear("content_service","page")})}]),angular.module("application.blog").controller("application.blog.templates.PostController",["$scope","application.pages.services.PagesModel","CurrentValue",function(t,o,e){o.success(function(){var e;e=o.objects(function(e){return"template.blog.post"==e.type})[0],t.setPage(e.id)}).error(function(){t.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(!1),t.$on("$destroy",function(){e.clear("content_service","page")})}]),angular.module("application.blog").controller("application.blog.templates.TagController",["$scope","application.pages.services.PagesModel","CurrentValue",function(t,o,e){o.success(function(){var e;e=o.objects(function(e){return"template.blog.tag"===e.type})[0],t.setPage(e.id)}).error(function(){t.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(!1),t.$on("$destroy",function(){e.clear("content_service","page")})}]),angular.module("application.content_service").controller("application.content_service.controllers.ContentController",["$scope","coreLibraryWidget","application.content_service.services.ContentModelService","$translate","$injector","coreLibraryConfig",function(e,t,o,i,r,n){var a;function s(){a&&clearInterval(a),a=null}function l(){e.LivePreview.window&&e.LivePreview.window.MotoEditor&&(s(),function(){e.TopController.MotoEditor=e.LivePreview.window.MotoEditor;try{e.MotoEditor.setEnvironmentStage(n.getStage())}catch(e){}e.$emit("NEW EVENT: MotoEditor.config:before",e.MotoEditor.getEnvironment()),e.MotoEditor.setLivePreviewService(e.LivePreview),e.MotoEditor.setEventManager(e.EventManager),e.MotoEditor.setInjector(r),e.MotoEditor.setWidgetFactory(t),e.MotoEditor.setTranslator(i),e.MotoEditor.setScope(e.$new()),e.MotoEditor.setDeviceName(e.LivePreview.getDevice()),e.$emit("NEW EVENT: MotoEditor.config:after",e.MotoEditor.getEnvironment()),e.$emit("NEW EVENT: MotoEditor.run:before",e.MotoEditor.getEnvironment()),e.MotoEditor.run(),e.$emit("NEW EVENT: MotoEditor.run:after",e.MotoEditor.getEnvironment()),e.$apply()}())}function c(){e.LivePreview.document&&(s(),a=setInterval(l,300))}e.EventManager.on("LivePreview.load",c),e.$on("$destroy",function(){e.EventManager.off("LivePreview.load",c)})}]),angular.module("application.content_service").controller("application.content_service.controllers.EditorElementsController",["$scope","$rootScope","core.library.editor.WidgetsService","motoFeatures","core.library.editor.BlocksService","coreLibraryUtils","coreLibraryMessenger",function(r,n,e,t,o,i,a){var s=null;function l(){r.systemMessenger.warning("WIDGET.COMMON.UNIQUE_WIDGET_FOR_SECTION_WARNING_MESSAGE")}function c(){var e=r.getCurrentEntityRecord();s!==e.type&&(s=e.type,"popup"===e.type?r.elementsPanel.showOnlyTabs("widgets"):r.elementsPanel.showOnlyTabs("*"))}r.devBlocksBuilderForThemeEnabled=t.isEnabled("dev_blocks_builder_for_theme"),r.deleteBlockFromTheme=function(e,t){i.openConfirmationBox({yesHandler:function(){o.deleteFromTheme({id:e,category:t}).then(function(){a.success("Block was removed successfully"),r.elementsPanel.getTab("blocks").loadContent()},function(e){console.log("Error on deleting block template",e),a.error("Error on deleting block template")})},question:"Do you want to remove this block?"})},r.dragDropCallbacks={beforeStart:function(e,t,o){o.addClass("widget-item_thumb")},dragstart:function(e,t,o){var i={currentMode:r.elementsPanel.getCurrentTabName(),widget:t,$element:o,currentPage:r.currentPage||null,currentSection:r.currentSection||null,sectionName:r.sectionSelected&&r.sectionSelected.replace("section-","")||null};return t.options=t.options||{},n.$broadcast("NEW EVENT: User start drag new widget",i),t.name&&n.$broadcast("NEW EVENT: User start drag new widget:"+t.name,i),r.EventManager.trigger("widget.new.dragStart",t.name,t.options),n.$emit("MotoUI.Sidebar.SlideDown",{targetPosition:"left"}),!0},dragend:function(e,t,o){var i={currentMode:r.elementsPanel.getCurrentTabName(),widget:t,$element:o,currentPage:r.currentPage||null,currentSection:r.currentSection||null,sectionName:r.sectionSelected&&r.sectionSelected.replace("section-","")||null};return n.$broadcast("NEW EVENT: User stop drag new widget",i),t.name&&n.$broadcast("NEW EVENT: User stop drag new widget:"+t.name,i),e.preventDefault(),e.stopPropagation(),r.EventManager.trigger("widget.new.dragEnd"),n.loadNeededSDKs(r.LivePreview),o.removeClass("widget-item_thumb"),!1},drop:function(e){return e.preventDefault(),e.stopPropagation(),!1}},r.EventManager.on("Widget.Create.AccessDenied.Duplicate",l),r.$on("$destroy",function(){r.EventManager.off("Widget.Create.AccessDenied.Duplicate",l)}),c(),r.$on("$content.currentEntityChanged",c)}]),angular.module("application.content_service").controller("application.content_service.controllers.PagePropertiesController",["$scope","application.pages.services.PagesModel","application.pages.services.PagesService","application.content_service.services.LayoutsModelService","application.content_service.services.ContentService","application.content_service.services.ContentModelService","coreLibraryUrlGenerator","core.library.styles.StylesModel","coreLibraryModal","coreLibraryUtils","CurrentValue","CodeEditor",function(a,e,t,o,s,l,i,r,c,n,p,d){var u=i();function g(){a.genUrl.value||a.genUrl.setValue(a.currentPage.name),a.currentPage.url=a.genUrl.value,a.currentPage.properties.meta.hideCanonical&&(a.currentPage.properties.meta.canonical_url=""),"password"==a.currentPage.visibility&&"unique"==a.TopController.password_option||(a.currentPage.properties.password="")}a.setPageView("settings"),a.layouts=[],a.backgrounds=[],a.setEditForm(function(){return a.editPageForm||a.$$childTail.editPageForm}),a.genUrl=u,a.EventManager.on("page.presave",g),a.$on("$destroy",function(){var e;a.getEditForm().$invalid&&(e=p.get("content_service","page"),a.setPage(a.page,!0),e?p.set("content_service","page",e):p.clear("content_service","page")),a.EventManager.off("page.presave",g)}),a.$watch("currentPage.name",function(e,t){e!==t&&u.setValue(e)}),a.setBackground=function(){a.backgrounds&&a.currentPage&&(a.backgrounds.forEach(function(e){e.id==a.currentPage.background_id&&(a.currentPage._background=e)}),a.currentPage._background&&a.LivePreview.setBodyBackground(a.currentPage._background.class_name))},a.clearFormErrors=function(){a.getEditForm().clearErrors()},a.$on("currentPage.changed",a.setBackground),a.$on("currentPage.changed",a.clearFormErrors),r.success(function(){a.backgrounds=r.objects(function(e){return"background"==e.type}),a.setBackground()}).load(),a.setLayout=function(e){var t=a.currentPage;t&&a.layouts.getLayoutByName&&(e=e||a.layouts.getLayoutByName(t.layout.name),(a.currentLayout=e).name!=t.layout.name&&(t.setLayout(e),a.updateLivePreview(),a.EventManager.trigger("layout.change")))},a.load=function(){o.success(function(){a.layouts=o.objects(),a.setLayout(),null===a.$$phase&&a.$apply()}).load()},a.load(),a.$watch("currentPage",function(e){e&&(a.genUrl.value=a.currentPage.url,a.setLayout())}),a.createBlock=function(r){var n=a.currentPage;c("views/application/content_service/create_section.tpl.html",function(o,i){o.block={name:"",type:r.type,content:""},o.ok=function(){var t;o.createSectionBlockForm&&(t=o.createSectionBlockForm)&&t.validate()&&s.save(o.block).success(function(e){var t;e?(t=l.newRecord(e),l.save(t),n.layout.section(r.name).id=t.id,a.updateLivePreview(),a.load(),a.systemMessenger.success("COMMON.MESSAGES.CREATE_SUCCESS"),i.close(o)):a.systemMessenger.error("COMMON.MESSAGES.CREATE_ERROR")}).error(function(e){a.systemMessenger.error("COMMON.MESSAGES.CREATE_ERROR"),e.data.errors.block_name=e.data.errors.name,t.setValidity(e)})}})},a.renameBlock=function(r){var e,t;e=a.currentPage.layout.section(r.name).id,r=a.currentLayout.getSectionByName(r.name),t=r.getBlockById(e),c("views/application/content_service/rename_block.tpl.html",function(o,i){o.contentBlock=angular.copy(t),o.ok=function(){var t;o.createSectionBlockForm&&(t=o.createSectionBlockForm)&&t.validate()&&s.save(o.contentBlock).success(function(e){var t;e?(t=l.newRecord(e),l.save(t),r.loadBlocks(),a.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS"),i.close(o)):a.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")}).error(function(e){a.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR"),e.data.errors.block_name=e.data.errors.name,t.setValidity(e)})}})},a.deleteBlock=function(t){var e,o=a.currentPage;(e=o.layout.section(t.name).id)&&a.doDeleteContentBlock(e,"MODULE.PAGES.DELETE_SECTION").then(function(){var e;e=l.objects(function(e){return e.type===t.type&&1==e.is_system}).first(),o.layout.section(t.name).id=e.id,a.updateLivePreview(),a.load(),a.systemMessenger.success("COMMON.MESSAGES.DELETE_SUCCESS")},function(){a.systemMessenger.error("COMMON.MESSAGES.DELETE_ERROR")})},a.duplicateBlock=function(t){var e,o=a.currentPage;(e=o.layout.section(t.name).id)&&a.doDuplicateContentBlock(e,"MODULE.PAGES.DUPLICATE_SECTION").then(function(e){o.layout.section(t.name).id=e.id,a.updateLivePreview(),a.load(),a.systemMessenger.success("COMMON.MESSAGES.CREATE_SUCCESS"),r.success(function(){a.LivePreview.useStyle()}).load(!1)},function(){a.systemMessenger.error("COMMON.MESSAGES.CREATE_ERROR")})},a.editCodeInEditor=function(e,t){d.openModal(e,{maxLen:4e3}).then(function(e){a.currentPage.properties.custom_code[t]=e})}}]),angular.module("application.content_service").controller("application.content_service.controllers.PagesAndPopupsListController",["$scope","MotoLocalStorage","CurrentValue",function(t,o,i){t.currentTab=i.get("PagesAndPopupsList","currentTab","pages"),t.currentSorting=o.getValue("pages_and_popups_listing_sorting")||"record.created",t.searchFieldIsVisible=!1,t.searchTerm={name:""},t.setCurrentSorting=function(e){t.currentSorting=t.currentSorting===e?"-"+e:e,o.setValue("pages_and_popups_listing_sorting",t.currentSorting)},t.setCurrentTab=function(e){t.currentTab=e,i.set("PagesAndPopupsList","currentTab",e)},t.toggleSearchField=function(){t.searchFieldIsVisible=!t.searchFieldIsVisible,t.searchTerm.name=""}}]),angular.module("application.content_service").controller("application.content_service.PagesController",["$scope","CurrentValue","application.pages.services.PagesModel","application.content_service.services.ContentModelService","coreLibraryConfig",function(e,t,o,i,r){o.success(function(){e.updatePagesList(),e.setPage(t.get("content_service","page",parseInt(r.get("settings.website.main_page")))),e.updateContentRecords()}).error(function(){e.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(!1),i.success(e.updatePopupList).error(function(){e.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(!1),e.$on("NEW EVENT: MotoEditor.config:before",function(e,t){t.setGlobal("only_drag_placeholder_sections",["header","content","footer"])})}]),angular.module("application.content_service").controller("application.content_service.controllers.PopupPropertiesController",["$scope","$timeout","application.content_service.services.ContentService","application.content_service.services.ContentModelService",function(o,t,i,r){function n(){var e;(e=o.getCurrentEntityRecord())&&"popup"===e.type?angular.isUndefined(e.properties.width)&&(e.properties.width="600px"):console.warn("contentRecord not a popup"),o.popupRequest=null,t(function(){o.popupRequest=function(e,t){var o,i,r={};if(!angular.isObject(e))return r;if(angular.isString(t)&&(t=[t]),!angular.isArray(t))return r;for(o=0,i=t.length;o<i;o++)r[t[o]]=angular.copy(e[t[o]]);return r}(e,["id","name","type","properties"])})}o.setPageView("settings"),o.popupRequest=null,n(),o.$on("$content.currentEntityChanged",n),o.onChangeProperty=function(e,t){if(o.MotoEditor&&"width"===e){if(!(0<(t=parseInt(t))))return!1;o.LivePreview.$(".moto-popup .mfp-content").css("width",t+"px"),o.MotoEditor.Widgets.massCall(o.MotoEditor.Widgets.getWidgetsWithWidthChanged(),{method:"onWidthChanged"})}},o._initPropertyForm=function(e){o.setEditForm(function(){return e})},o.$on("$content.needSavePopupProperties",function(){var e=o.getEditForm();e&&(e.validate(),e.$invalid)||i.save(o.popupRequest).then(function(e){r.save(r.newRecord(e)),o.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS"),o.updatePopupList(),o.showContentList(),n()},function(e){o.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR"),o.getEditForm()&&o.getEditForm().setValidity(e)})})}]),angular.module("application.content_service").controller("application.content_service.controllers.SectionPropertiesController",["$scope","$timeout",function(e,t){var o=null;e.sectionSizeChanged=function(){o&&t.cancel(o),o=t(function(){e.updateLivePreview()},250)}}]),angular.module("application.content_service").controller("application.content_service.TopController",["$scope","$rootScope","$timeout","$state","$q","application.pages.services.PagesModel","application.pages.services.PagesService","application.content_service.services.ContentService","application.content_service.services.ContentModelService","CurrentValue","coreLibraryUrlGenerator","coreLibraryModal","coreLibraryWidget","coreLibraryLivePreview","jsonrpc","core.library.styles.StylesModel","coreLibraryUtils","motoFeatures","application.pages.services.PagesUtilsService","MotoEditorValues","EditorHistoryManager","coreLibraryConfig","WidgetContentEditorClass","core.library.editor.ElementsPanelClass",function(l,e,r,i,n,a,s,c,p,d,u,t,g,o,m,f,h,y,b,_,v,E,w,S){var M,C={page:!1,block:!1},I=!1;function T(e,t){t&&(l.setPageView("settings"),(l.currentWidget=null)===l.$$phase&&l.$apply(),l.currentWidget=l.MotoEditor.ContentManager.revivePublicInstance(t,l),null===l.$$phase&&l.$apply())}function O(e){l.currentWidget=null,r(function(){null===l.$$phase&&l.$apply()})}function k(e,t){(l.currentWidget===t.__getPublicInstance()||l.currentWidget&&l.currentWidget.isInside(t))&&(l.currentWidget=null),r(function(){null===l.$$phase&&l.$apply()})}function A(){r(function(){null===l.$$phase&&l.$apply()})}function P(){l.currentWidget=null,l.contentChanged=!1,null===l.$$phase&&l.$apply()}function L(e){e.needToSelect&&(l.currentWidget=null)===l.$$phase&&l.$apply()}function D(e){var t,o,i=l.contentProxyData.currentEntity,r="page";i&&(r=i.type),l.currentSection=null,l.pageSectionSelected=!1,l.contentChanged=!0,l.sectionSelected=e,l.isContentListVisible=!1,l.$broadcast("$content.currentEntityChanged",i),t=e.split("section-")[1],"popup"===r?l.currentSection=p.getByField("id",i.id):"content"!==t?(o=l.currentPage.layout.sections[t].id,l.currentSection=p.getByField("id",o),l.currentSection.properties&&l.currentSection.properties.sticky&&(l.currentSection.properties.sticky=parseInt(l.currentSection.properties.sticky))):l.pageSectionSelected=!0,null===l.$$phase&&l.$apply()}function R(){l.editorHistoryManager=v.create(l.MotoEditor),l.MotoEditor.setHistoryManager(l.editorHistoryManager),l.undoTransactions=l.editorHistoryManager.getUndoTransactions(),l.redoTransactions=l.editorHistoryManager.getRedoTransactions()}function W(){l.editorHistoryManager=null,l.undoTransactions=null,l.redoTransactions=null}function $(){l.password_option=l.currentPage.getUniquePassword()?"unique":"general"}function N(e){var t;p.save(e),t=m.createBatch(),l.EventManager.trigger("section.saved",t),t.doRequest().finally(function(){l.EventManager.clearAll("section.saved"),l.sectionSelected=null,l.currentSection=null,l.currentWidget=null,l.showContentList(),l.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS"),l.updateLivePreview()})}function U(e){var t;l.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR"),(t=l.getEditForm())&&t.setValidity(e),l.EventManager.clearAll("section.saved"),l.sectionSelected=null,l.currentWidget=null,l.pageSectionSelected=!1,l.updateLivePreview()}function x(e){var t=a.newRecord(e);return t.properties.password=h.base64Encode(t.properties.password),a.save(t),t.properties.password=h.base64Decode(t.properties.password),l.updatePagesList(),l.sectionSelected=null,l.currentWidget=null,l.pageSectionSelected=!1,l.showContentList(),l.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS"),l.currentPage=t,$(),g.setCurrentPage(null),l.updateLivePreview(),l.$broadcast("currentPage.changed",l.currentPage),g.setCurrentPage(l.currentPage),function(e){var t;for(t=0;t<l.pages.length;t++)if(l.pages[t].id===e.id){l.pages[t].name=e.name;break}}(t),e}function F(e){var t;l.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR");try{e.data.errors.status[0]&&l.systemMessenger.error(e.data.errors.status[0])}catch(e){}return(t=l.getEditForm())&&t.setValidity(e),l.updateLivePreview(),n.reject(e)}function G(e){x(e),l.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS"),l.reloadPages()}function B(e){F(e),l.currentPage.status="draft",l.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")}l.currentPage=null,l.currentWidget=null,l.LivePreview=o(),l.page=null,l.contentChanged=!1,l.mainPageId=parseInt(E.get("settings.website.main_page")),l.pageView="settings",l.minHeight=0,l.MotoEditor=null,l.EventManager=Signals.create(),l.sectionSelected=null,l.pageSectionSelected=!1,l.currentSection=null,l.isContentListVisible=!0,l.pagesExcludeCurrent=[],l._editFormFn=null,l.device="desktop",l.statuses=[{label:"MODULE.PAGES.STATUSES.PUBLISH",value:"publish"},{label:"MODULE.PAGES.STATUSES.DRAFT",value:"draft"}],l.visibilities=[{label:"MODULE.PAGES.VISIBILITIES.PUBLIC",value:"public"},{label:"MODULE.PAGES.VISIBILITIES.PASSWORD",value:"password"}],l.blocksEnabled=y.isEnabled("theme_widget_block"),l.websitePasswordProtection=E.get("settings.website.password_protection"),l.password_option="general",(l.TopController=l).copiedWidget=_.copiedWidget,l.elementsPanel=new S(l),l.elementsPanel.loadContent().then(function(){e.$broadcast("$Editor.ElementsPanel.loaded",l.elementsPanel)},function(){e.$broadcast("$Editor.ElementsPanel.notLoaded",l.elementsPanel)}),l.LivePreview.setEventManager(l.EventManager),g.setEventManager(l.EventManager),angular.element("#id_live_preview").on("load",function(){l.currentPage&&I&&(I=!1,l.LivePreview.setBodyBackground(l.currentPage._background.class_name)),e.loadNeededSDKs(l.LivePreview)}),l.showContentList=function(){l.isContentListVisible=!0},l.isContentChanged=function(){return l.contentChanged},l.EventManager.on("Widget.Create.AccessGranted",L),l.EventManager.on("section.edit",D),l.$on("NEW EVENT: MotoEditor.run:before",function(e,t){var o,i,r=t.getEditor(),n=r.getScope();r.setContentEntity((i=l.currentPage,l.contentProxyData.currentEntity?l.contentProxyData.currentEntity:("page"===(o={id:i.id,name:i.name,type:i.type,category:null,record:i}).type&&(o.category="Pages"),"popup"===o.type&&(o.category="Popups"),l.contentProxyData.currentEntity=o))),r.setElementsPanel(l.elementsPanel),n.$on("NEW EVENT: Move widget after",A),n.$on("NEW EVENT: Widget was created",A),n.$on("NEW EVENT: Widget was selected",T),n.$on("NEW EVENT: Widget was unselected",O),n.$on("NEW EVENT: Widget was removed",k),n.$on("NEW EVENT: Editor finish running",R),n.$on("NEW EVENT: Editor self destroyed",W),l.dragElementsDisabling=!1}),l.$on("$stateChangeStart",function(e,t,o){l.isContentChanged()&&(l.contentChanged=!1,e.preventDefault(),h.openConfirmationBox({yesHandler:function(){P(),l.EventManager.clearAll("section.presave"),l.EventManager.clearAll("section.saved"),i.go(t.name,o)},noHandler:function(){l.contentChanged=!0}}))}),l.cancelSection=function(){l.isContentChanged()?h.openConfirmationBox({yesHandler:function(){l.contentChanged=!1,l.cancelSection()}}):(l.pageSectionSelected=!1,l.contentChanged=!1,l.sectionSelected=null,l.currentSection=null,l.currentWidget=null,l.showContentList(),l.onChangeCurrentEntity(l.contentProxyData.currentEntity),l.EventManager.trigger("section.editCanceled"),P(),l.EventManager.clearAll("section.presave"),l.EventManager.clearAll("section.saved"),l.updateLivePreview())},l.setDevice=function(e){l.LivePreview.setDevice(e),l.MotoEditor&&l.MotoEditor.setDeviceName(e),l.device=e},l.setPageView=function(e){e&&(l.pageView=e,r(function(){l.$broadcast("rzSliderForceRender")}))},l.setPage=function(e,t){var o,i;i=l.page,l.page=e||i,l.currentPage=a.getByField("id",l.page),l.currentPage&&(l.sectionSelected=null,l.currentPage.properties.meta.nofollow=Boolean(l.currentPage.properties.meta.nofollow),l.currentPage.properties.meta.noindex=Boolean(l.currentPage.properties.meta.noindex),l.currentPage.properties.meta.hideCanonical=Boolean(l.currentPage.properties.meta.hideCanonical),$(),l.setPageView("settings"),g.setCurrentPage(null),l.currentPage&&(d.set("content_service","page",l.page),l.content=l.currentPage,l.currentLayout=l.currentPage.layout,"page"===l.currentPage.type&&(o=[],(o=function t(o,i){return l.pages.forEach(function(e){e.parent_id===o&&(t(e.id,i),i.push(e.id))}),i}(l.page,o)).push(l.page),l.pagesExcludeCurrent=a.objects(function(e){return o.indexOf(parseInt(e.id))<0&&"page"===e.type})),l.$broadcast("currentPage.changed"),g.setCurrentPage(l.currentPage)),t||l.updateLivePreview(),r(function(){var e;(e=l.getEditForm())&&e.validate()}))},l.updateLivePreview=function(e){var t=l.contentProxyData.currentEntity,o="page";e&&!0===e&&(I=!0),l.MotoEditor&&(l.MotoEditor.destroy(),l.MotoEditor=null),t&&(o=t.type),l.currentPagePreviewUrl="popup"===o?(l.LivePreview.setUrl("./preview.php?mode=preview&type=popup&workspace=content&id="+t.id+"&t="+(new Date).getTime()),null):(l.LivePreview.setUrl("./preview.php?page_id="+l.currentPage.id+l.currentPage.layout.getSrc()+l.currentPage.layout.getSectionSrc()+"&mode=preview&t="+(new Date).getTime()),h.generateFullPageUrl(l.currentPage)),l.dragElementsDisabling=!0},l.setEditForm=function(e){l._editFormFn=e},l.getEditForm=function(){return l._editFormFn&&l._editFormFn()},l.saveSection=function(){var e,t,o;if(l.isDemoMode)l.systemMessenger.warning("DEMO_MODE.WARNING_MESSAGE.ACCESS_DENIED");else if(l.MotoEditor){if(l.MotoEditor.onBeforeSaveSection({useTransform:!y.isEnabled("content_as_object")}),y.isEnabled("content_as_object"))return o=l.MotoEditor.getWidgetSectionById(l.sectionSelected),t=m.createBatch(),l.EventManager.trigger("section.presave",t),void t.doRequest().then(function(){l.EventManager.clearAll("section.presave"),o.exportToObject().then(function(e){var t=o.exportForSave();angular.equals(e,t)||(console.error("Content exportToObject & exportForSave not equal"),console.info("exportToObject",e),console.info("exportForSave",t)),l.pageSectionSelected?(l.currentPage.content=angular.toJson(e),l.savePage()):(l.currentSection.content=angular.toJson(e),c.save(l.currentSection).then(N,U))})},U);P(),e=(e=l.MotoEditor.getHtmlById(l.sectionSelected))&&e.trim(),t=m.createBatch(),l.EventManager.trigger("section.presave",t),t.doRequest().then(function(){l.EventManager.clearAll("section.presave"),l.pageSectionSelected?(l.currentPage.content=e,l.savePage()):(l.currentSection.content=e,c.save(l.currentSection).then(N,U))},U)}},l.saveDraft=function(){l.savePage()},l.savePage=function(o,i){var e;if(!(e=l.getEditForm())||(e.validate(),!e.$invalid))return"general"!==l.password_option&&"public"!==l.currentPage.visibility||(l.currentPage.properties.password=""),l.EventManager.trigger("page.presave"),angular.isFunction(o)||(o=x),angular.isFunction(i)||(i=F),s.save(l.currentPage).then(function(e){var t;return l.pageSectionSelected?(t=m.createBatch(),l.EventManager.trigger("section.saved",t),t.doRequest().then(function(){return o(e),e},i)):(o(e),e)},i)},l.reloadPages=function(){a.success(function(){l.setPage()}).error(function(){l.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(!1)},l.currentContentBlock=null,l.startEditContentBlock=function(e){e?(l.currentContentBlock=p.getByField("id",e),l.currentContentBlock?(l.sectionSelected=null,l.setPageView("settings"),g.setCurrentPage(null),d.set("content_service","lastEntityType",l.currentContentBlock.type),d.set("content_service","ContentEntity",{id:e,type:l.currentContentBlock.type}),l.content=l.currentPage,l.currentLayout=null,l.$broadcast("currentPage.changed"),g.setCurrentPage(l.currentContentBlock),l.updateLivePreview(),r(function(){var e;(e=l.getEditForm())&&e.validate()})):console.warn("startEditContentBlock : Content block [ @id=",e," ] not found")):console.warn("startEditContentBlock : Invalid item id")},l.isAllowDuplicateEntity=function(e){return!l.sectionSelected&&(!(!e||!e.record)&&(!e.record.is_system&&!("page"===e.type&&!l.$motoFeatures.isEnabled("engine_pages_unlimited_mode"))))},l.isAllowDeleteEntity=function(e){if(l.sectionSelected)return!1;if(!e||!e.record)return!1;if(e.record.is_system)return!1;if("page"===e.type){if(!l.$motoFeatures.isEnabled("engine_pages_unlimited_mode"))return!1;if(e.record.id===l.mainPageId)return!1}return!0},l.doDeleteContentBlock=function(t,e){var o=n.defer();return 0<(t=parseInt(t))?angular.isString(e)?h.openConfirmationBox({yesHandler:function(){c.deleteBlock({id:t}).then(function(e){p.remove({id:t}),o.resolve(e)},o.reject)},question:e}):o.reject({error:"Invalid question",value:e}):o.reject({error:"Invalid content block id",value:t}),o.promise},l.deleteContentEntity=function(e){return e&&e.record?"page"===e.type?l.deletePage(e.record.id,function(e,t){e&&console.warn("Page not deleted by error : ",e),l.updateContentRecords(!0)}):void l.doDeleteContentBlock(e.record.id,"MODULE.POPUPS.DELETE_POPUP_QUESTION").then(function(){d.clear("content_service","lastEntityType"),d.clear("content_service","ContentEntity"),l.contentProxyData.currentEntity=null,l.updatePopupList(),l.page=l.mainPageId,l.setPage(),l.systemMessenger.success("COMMON.MESSAGES.DELETE_SUCCESS"),l.updateContentRecords(!0)},function(){l.systemMessenger.error("COMMON.MESSAGES.DELETE_ERROR")}):(console.warn("Entity is empty - can not delete them"),!1)},l.doDuplicateContentBlock=function(e,t){var o=n.defer();return 0<(e=parseInt(e))?angular.isString(t)?h.openConfirmationBox({yesHandler:function(){c.duplicateBlock({id:e}).then(function(e){var t=p.newRecord(e);p.save(t),o.resolve(t)},o.reject)},question:t}):o.reject({error:"Invalid question",value:t}):o.reject({error:"Invalid content block id",value:e}),o.promise},l.duplicateContentEntity=function(e){return e&&e.record?"page"===e.type?l.duplicatePage(e.record.id,function(e,t){e&&console.warn("Page not duplicated by error : ",e),l.updateContentRecords(!0)}):void l.doDuplicateContentBlock(e.record.id,"MODULE.POPUPS.DUPLICATE_POPUP_QUESTION").then(function(e){f.success(l.LivePreview.useStyle).load(!1),l.updatePopupList(),l.systemMessenger.success("COMMON.MESSAGES.CREATE_SUCCESS"),l.contentProxyData.currentEntity.id=e.id,l.contentProxyData.currentEntity.type=e.type,l.updateContentRecords(),l.onChangeCurrentEntity(l.contentProxyData.currentEntity)},function(){l.systemMessenger.error("COMMON.MESSAGES.CREATE_ERROR")}):(console.warn("Entity is empty - can not duplicate them"),!1)},l.savePopupProperties=function(){l.$broadcast("$content.needSavePopupProperties")},l.savePopupContent=function(){l.saveSection()},l.contentProxyData={contentRecords:[],currentEntity:null},l.popupRecords=null,l.setCurrentEntity=function(e){e&&(l.contentProxyData.currentEntity=e,l.onChangeCurrentEntity(e))},l.onChangeCurrentEntity=function(e){e&&(l.currentPage=null,"popup"===e.type?l.startEditContentBlock(e.id):l.setPage(e.id),l.$broadcast("$content.currentEntityChanged",e))},l.getCurrentEntityRecord=function(){return l.contentProxyData.currentEntity?l.contentProxyData.currentEntity.record:l.currentPage},l.updateContentRecords=function(e){var t,o,i,r,n=l.contentProxyData.currentEntity,a="page",s=l.contentProxyData.contentRecords;if(s.length=0,l.pages&&l.pages.length){for(n&&(a=n.type),e&&(n=null),t=0,o=l.pages.length;t<o;t++)r={id:(i=l.pages[t]).id,name:i.name,type:"page",category:"Pages",record:i},s.push(r),"page"===a&&(!n&&i.id===l.page||n&&n.id===i.id)&&(n=r);if(l.popupRecords&&l.popupRecords.length)for(t=0,o=l.popupRecords.length;t<o;t++)r={id:(i=l.popupRecords[t]).id,name:i.name,type:"popup",category:"Popups",record:i},s.push(r),"popup"===a&&n&&n.id===i.id&&(n=r);l.contentProxyData.currentEntity=n}},l.updatePopupList=function(){l.popupRecords=p.objects(function(e){return"popup"===e.type}),l.updateContentRecords()},l.updatePagesList=function(){var e;e=y.isEnabled("engine_pages_unlimited_mode")?a.objects(function(e){return"page"===e.type}):b.getPagesForLimitedMode(),l.pages=e,l.updateContentRecords()},p.success(function(){C.block=!0,C.page&&C.block&&l.setPage()}).error(function(){l.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(),M=e.$on("MotoUI.Sidebar.Toggled",function(){l.MotoEditor&&l.MotoEditor.updateWidgetsWidth()}),l.$on("$destroy",function(){l.EventManager.off("Widget.Create.AccessGranted",L),l.EventManager.off("section.edit",D),M(),l.MotoEditor&&(l.MotoEditor.destroy(),l.MotoEditor=null),l.LivePreview.destroy(),g.setCurrentPage(null)}),l.setAsHome=function(e){e=e||l.currentPage.id,h.openConfirmationBox({yesHandler:function(){s.setMainPage({id:e}).then(function(){l.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS"),l.reloadPages(),l.mainPageId=e,E.update("settings.website.main_page",e)},function(){l.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")})},question:"MODULE.PAGES.SET_AS_HOME"})},l.startEditingContentEntity=function(e){e!==l.contentProxyData.currentEntity&&l.setCurrentEntity(e),l.isContentListVisible=!1},l.createPage=function(){t("views/application/content_service/create_page.tpl.html",function(o,t){var i=u();o.newPageModel={name:"",url:"",content:""},o.genUrl=i,o.$watch("newPageModel.name",function(e,t){e!==t&&(i.setValue(e),o.createPageForm.clearErrors())}),o.ok=function(){o.newPageModel.url=o.genUrl.value,o.createPageForm.validate()&&s.save(o.newPageModel).then(function(e){a.save(e),l.updatePagesList(),l.page=parseInt(e.id),l.contentProxyData.currentEntity=null,l.setPage(),l.updateContentRecords(!0),t.close(o),l.systemMessenger.success("COMMON.MESSAGES.CREATE_SUCCESS")},function(e){l.systemMessenger.error("COMMON.MESSAGES.CREATE_ERROR"),o.createPageForm.setValidity(e)})}})},l.createPopup=function(){t("views/application/content_service/create_popup.tpl.html",function(o,i){o.newPopupModel={name:"",type:"popup",content:"",properties:{width:"600px"}},o.submit=function(){o.createPopupForm.validate()&&c.save(o.newPopupModel).then(function(e){var t=p.newRecord(e);p.save(t),i.close(o),l.systemMessenger.success("COMMON.MESSAGES.CREATE_SUCCESS"),l.updatePopupList(),l.contentProxyData.currentEntity={id:t.id,type:"popup"},l.updateContentRecords(),l.onChangeCurrentEntity(l.contentProxyData.currentEntity)},function(e){l.systemMessenger.error("COMMON.MESSAGES.CREATE_ERROR"),o.createPopupForm.setValidity(e)})}})},l.duplicatePage=function(e,t){return angular.isFunction(t)||(t=angular.noop),angular.isUndefined(e)&&!l.currentPage?t({error:"CurrentPage is empty"}):0<(e=parseInt(e))?(e=e||l.currentPage.id,void h.openConfirmationBox({yesHandler:function(){s.duplicate({id:e}).then(function(e){a.save(e),l.updatePagesList(),l.page=parseInt(e.id),l.setPage(),l.systemMessenger.success("COMMON.MESSAGES.CREATE_SUCCESS"),f.success(function(){l.LivePreview.useStyle()}).load(!1),t(null,e)},function(e){l.systemMessenger.error("COMMON.MESSAGES.CREATE_ERROR"),t(e)})},question:"MODULE.PAGES.DUPLICATE_PAGE"})):t({error:"Invalid page id",value:e})},l.deletePage=function(e,t){var o;return angular.isFunction(t)||(t=angular.noop),angular.isUndefined(e)&&!l.currentPage?t({error:"CurrentPage is empty"}):0<(e=parseInt(e))?(e=e||l.currentPage.id,o=a.getByField("id",e),void h.openConfirmationBox({yesHandler:function(){s.deletePage({id:e}).then(function(){a.remove(o),l.updatePagesList(),d.clear("content_service","page"),l.page=l.mainPageId,l.setPage(),l.systemMessenger.success("COMMON.MESSAGES.DELETE_SUCCESS"),t(null,o)},function(e){l.systemMessenger.error("COMMON.MESSAGES.DELETE_ERROR"),t(e)})},question:"MODULE.PAGES.DELETE_PAGE"})):t({error:"Invalid page id",value:e})},l.publish=function(){l.currentPage.status="publish",l.savePage(G,B)},l.copyWidget=function(){l.currentWidget&&l.currentWidget.isCopyable()&&(l.copiedWidget=l.currentWidget.exportForCopy(),_.copiedWidget=l.copiedWidget)},l.pasteWidget=function(){l.currentWidget&&l.copiedWidget&&l.MotoEditor.userWantsToPasteWidget(l.copiedWidget)},l.$watch("currentWidget.properties",function(e,t){l.currentWidget&&e&&t&&!l.editorHistoryManager.isUndoOrRedoInProcess()&&(angular.equals(l.currentWidget.__getInternalInstance().properties,e)||(l.MotoEditor.ContentManager.setWidgetInternalProperties(l.currentWidget,e),l.$broadcast("widgetPropertiesChanged",e,t)))},!0),l.$watch(function(){var e=null;return l.currentWidget&&(e=l.currentWidget.__getInternalDiff())&&l.currentWidget.__syncProperties(),e},function(){}),l.widgetContentEditor=null,l.startEditWidgetContent=function(e){var t=l.widgetContentEditor;if(angular.isObject(e)){if(!t)return t=new w(e),(l.widgetContentEditor=t).activate().then(function(){});console.warn('One "Content Editor" already defined by widget',t.getMainWidget())}else console.warn("Bad argument")},l.finishEditWidgetContent=function(){var e=l.widgetContentEditor;return e.deactivate().then(function(){l.widgetContentEditor=null,e.destroy()})},l.$on("TopController.startEditWidgetContent",function(e,t,o){l.startEditWidgetContent(t).then(o)}),l.$on("TopController.finishEditWidgetContent",function(e,t,o){l.finishEditWidgetContent(t).then(o)})}]),angular.module("application.content_service").controller("application.content_service.controllers.WidgetPropertiesController",["$scope","$rootScope","$timeout","coreLibraryWidget","application.media_library.services.MediaLibraryModelService","application.media_library.services.MediaLibraryService","core.library.styles.StylesModel",function(e,t,o,i,r,n,a){e.getWidgetFactory=function(){return i},e.getMediaLibraryModel=function(){return r},e.getStylesModel=function(){return a},e.setAction=function(){"url"!==e.currentWidget.properties.link.action||e.currentWidget.properties.link.properties.target||(e.currentWidget.properties.link.properties.target="_self")},e.setWidth=function(e){e.update()},e.setModelValue=function(e){e.update()},e.clearImage=function(e){e.clearImage()},e.changeImage=function(e){e.changeImage()},e.sizeValues=[{id:"small",name:"WIDGET.COMMON.SIZE.SMALL"},{id:"medium",name:"WIDGET.COMMON.SIZE.MEDIUM"},{id:"large",name:"WIDGET.COMMON.SIZE.LARGE"}],e.presetChanged=function(e,t){return e.updateContentView(t)}}]),angular.module("application.content_service").directive("motoEditorElementsPanel",[function(){return{restrict:"E",priority:400,templateUrl:"views/application/content_service/directives/editor_elements_panel.tpl.html"}}]),angular.module("application.content_service").directive("motoEditorRightPanel",function(){return{restrict:"E",templateUrl:"views/application/content_service/directives/editor_right_panel.tpl.html",scope:!0,controllerAs:"editorRightPanel",controller:["$attrs",function(e){angular.isDefined(e.hidePreviewBtn)&&(this.hidePreviewBtn=!0)}]}}),angular.module("application.content_service").provider("application.content_service.services.ContentModelService",[function(){this.$get=["application.content_service.services.ContentService","core.library.styles.ClassesStylesModel","coreLibraryUtils",function(e,t,o){var i,r,n,a;return i=t.ClassStyleProperties(),(a=function(e){var t;i.call(this,e),t=o.deepExtend({desktop:{base:{height:""}}},this),o.deepExtend(this,t)}).prototype=new i(null),((n=function(e){var t;i.call(this,e),t=o.deepExtend({desktop:{base:{height:"100px"}}},this),o.deepExtend(this,t)}).prototype=new(a.prototype.constructor=i)(null)).constructor=i,(r=function(e,t){var o=this;t&&(o.id=parseInt(t.id),o.name=t.name,o.type=t.type,o.is_system=!!parseInt(t.is_system),o.content=t.content,o.properties=angular.fromJson(t.properties||{}),"body"==o.type?o.styles=new a(t.styles||{}):"header"!=o.type&&"footer"!=o.type||(o.styles=new n(t.styles||{})),o.modified=t.modified,o.created=t.created)}).prototype={id:null,name:null,type:null,is_system:null,content:null,properties:null,styles:null,modified:null,created:null},Model.register("ContentService",{proxy:{service:e,maps:{list:"getContent"}},record:r}),Model("ContentService").load(!1)}]}]),angular.module("application.content_service").service("application.content_service.services.ContentService",["jsonrpc",function(e){var t=e.newService("ContentService");this.getContent=t.createMethod("getContent"),this.deleteBlock=t.createMethod("delete"),this.duplicateBlock=t.createMethod("duplicate"),this.save=t.createMethod("save")}]),angular.module("application.content_service").provider("application.content_service.services.LayoutsModelService",["coreLibraryConfigProvider",function(t){this.$get=["application.content_service.services.ContentModelService",function(o){function i(e){var t=this;t.label=e.label||"",t.name=e.name||"",t.type=e.type||"",t.blocks=[],t.loadBlocks=function(){o.success(function(){t.blocks=o.objects(function(e){return e.type==t.type}).sort(function(e,t){return parseInt(t.id)-parseInt(e.id)})}).load()},t.loadBlocks()}function e(e,t){var o=this;o.label=t.label||"MODULE.PAGES.LAYOUTS.DEFAULT.LABEL",o.name=t.name||"",o.title=t.title||"MODULE.PAGES.LAYOUTS.DEFAULT.TITLE",o.sections=[],t.sections&&Array.isArray(t.sections)&&t.sections.forEach(function(e){o.sections.push(new i(e))})}return i.prototype={label:null,name:null,type:null,blocks:null,getBlockById:function(e){for(var t,o=0,i=this.blocks.length;o<i;o++)if(this.blocks[o].id===e){t=this.blocks[o];break}return t}},e.prototype={label:null,name:null,title:null,sections:null,getSectionByName:function(e){for(var t,o=0,i=this.sections.length;o<i;o++)if(this.sections[o].name===e){t=this.sections[o];break}return t}},Model.register("Layouts",{proxy:{records:angular.fromJson(t.get("settings.website.layouts"))},record:e,getLayoutByName:function(e){var t,o=null;for(t=0;this[t];t++)if(this[t].name===e){o=this[t];break}return o}}),Model("Layouts").load(!1)}]}]),angular.module("application.design").controller("application.design.background.controllers.BackgroundController",["$scope","core.library.styles.StylesService","core.library.styles.StylesModel","application.media_library.services.MediaLibraryService","coreLibraryModal","$state","$filter","coreLibraryUtils","motoUI.BrowserTabCloseConfirmation","MotoDevicesConstants",function(r,n,o,e,t,i,a,s,l,c){var p,d=c.LIST;function u(e){var t,o=null;for(e=parseInt(e),t=0;r.backgrounds[t];t++)if(r.backgrounds[t].id==e){o=r.backgrounds[t];break}return o}function g(e){i.params.id!=e&&i.go((i.includes("**.edit")?"^":"")+".edit",{id:e})}function m(){return r.backgrounds&&r.currentPage&&r.currentPage.background_id?g(r.currentPage.background_id):r.defaultBackground?g(r.defaultBackground.id):void 0}function f(){r.defaultBackground=null,r.backgrounds.forEach(function(e){e.is_system&&(r.defaultBackground=angular.copy(e))})}function h(){return!!r.backgrounds.length&&(i.params.id?(r.backgroundData.selectedBackground=u(i.params.id),r.backgroundData.selectedBackground?(r.background=angular.copy(r.backgroundData.selectedBackground),r.LivePreview.setBodyBackground(r.background.class_name),p.save(r.background),r.changeBackground(),void l.enable({isChangedFunction:p.isChanged})):(r.systemMessenger.error("MODULE.DESIGN.BACKGROUNDS.FIND_BACKGROUND_ERROR_MESSAGE",i.params),m())):m())}function y(e){o.save(e),e.id==r.defaultBackground.id&&f(),r.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS"),r.load(!1,h)}function b(e){r.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR"),r.editStyleForm.setValidity(e)}function _(e,o){if(!e||"function"!=typeof n[e])return!1;s.openConfirmationBox({yesHandler:function(){if(!r.background||!r.background.id)return this.noHandler();n[e]({id:r.background.id}).success(function(t){r.load(!0,function(){Array.isArray(o)?o.forEach(function(e){angular.isFunction(e)&&e(t)}):angular.isFunction(o)&&o(t)}),"delete"===e?r.systemMessenger.success("COMMON.MESSAGES.DELETE_SUCCESS"):r.systemMessenger.success("COMMON.MESSAGES.CREATE_SUCCESS")}).error(function(){"delete"===e?r.systemMessenger.success("COMMON.MESSAGES.DELETE_ERROR"):r.systemMessenger.success("COMMON.MESSAGES.CREATE_ERROR")})},question:"MODULE.DESIGN.BACKGROUNDS."+e.toUpperCase()+"_BACKGROUND_CONFIRMATION_TEXT"})}function v(){r.background&&r.background.class_name&&(r.LivePreview.setBodyBackground(r.background.class_name),r.LivePreview.useStyle({stylesRecord:r.background}))}r.backgroundSizes=[{label:"UI.ELEMENT.BACKGROUND_IMAGE.SIZE.ORIGINAL_VALUE",value:"auto"},{label:"UI.ELEMENT.BACKGROUND_IMAGE.SIZE.COVER_VALUE",value:"cover"},{label:"UI.ELEMENT.BACKGROUND_IMAGE.SIZE.CONTAIN_VALUE",value:"contain"}],r.backgroundRepeat=[{label:"UI.ELEMENT.BACKGROUND_IMAGE.REPEAT.NO_REPEAT_VALUE",value:"no-repeat"},{label:"UI.ELEMENT.BACKGROUND_IMAGE.REPEAT.REPEAT_VALUE",value:"repeat"},{label:"UI.ELEMENT.BACKGROUND_IMAGE.REPEAT.REPEAT_X_VALUE",value:"repeat-x"},{label:"UI.ELEMENT.BACKGROUND_IMAGE.REPEAT.REPEAT_Y_VALUE",value:"repeat-y"}],r.backgrounds=[],r.background=null,r.backgroundData={selectedBackground:null},r.defaultBackground=null,r.defaultStyle={},r.currentStyle={},r.editStyleForm={},r.$on("$stateChangeStart",function(e,t,o){p.isChanged()&&(e.preventDefault(),s.openConfirmationBox({yesHandler:function(){r.cancel(),i.go(t.name,o)},noHandler:function(){r.backgroundData.selectedBackground=u(i.params.id)}}))}),p=new function(){var t,o;this.save=function(e){t=null,e&&(t=angular.copy(e),o=e)},this.revert=function(e){t&&e&&(angular.extend(e,t),e.properties=angular.copy(t.properties))},this.clear=function(){t=null},this.isChanged=function(){return!(!t||!o)&&!angular.equals(t,o)},this.getPrev=function(){return o},this.getUndo=function(){return t}},r.$watch("background",function(e,t){e&&t&&(r.LivePreview.useStyle({stylesRecord:e}),r.editStyleForm&&r.$evalAsync(r.editStyleForm.validate))},!0),r.$watch("backgroundData.selectedBackground",function(e){e&&g(e.id)}),r.changeBackground=function(){r.background&&(r.setDevice(r.LivePreview.getDevice()),r.defaultStyle=r.background.properties.desktop.base)},r.setDevice=function(e){r.currentStyle=r.background.properties.desktop.base,r.currentProperties=r.background.properties,r.$parent.setDevice(e)},r.unsetBgAttachmentProperty=function(){r.currentProperties.desktop.base["background-attachment"]="scroll"},r.save=function(e){var t,i;e=e||r.background,r.editStyleForm&&r.editStyleForm.validate()&&(t=angular.copy(e),(i=t)&&(delete i.properties.fixed,d.forIn(function(e,t){var o;i.properties[t]&&(o=i.properties[t].base)&&(o["background-image"]||(delete o["background-size"],delete o["background-position"],delete o["background-repeat"],delete o["background-attachment"]))})),t=i,p.clear(),n.save(t).then(y,b))},r.load=function(e,t){o.success(function(){p.clear(),r.defaultBackground=null,r.backgrounds=o.objects(function(e){return"background"==e.type}),f(),angular.isFunction(t)&&t()}).error(function(){r.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(!e)},r.cancel=function(){p.revert(r.background),r.changeBackground()},r.create=function(e){p.isChanged()?s.openConfirmationBox({yesHandler:function(){r.cancel(),r.create(e)}}):t("views/application/design/background/create.tpl.html",function(t,o){var e;t.modalModel={name:function t(o,i,r){var n;return n=o+((r=r||0)?" "+r:""),angular.forEach(i,function(e){e.name==n&&(n=t(o,i,r+(r?1:2)))}),n}(a("translate")("MODULE.DESIGN.BACKGROUNDS.NEW_BACKGROUND_DEFAULT_VALUE"),r.backgrounds),type:"background",tag:"body"},(e=r.defaultBackground)&&e.properties&&e.properties.desktop&&e.properties.desktop.base&&e.properties.desktop.base["background-color"]&&(t.modalModel.properties={desktop:{base:{"background-color":e.properties.desktop.base["background-color"]}}}),t.ok=function(){t.modalForm&&t.modalForm.validate()&&n.save(t.modalModel).success(function(e){r.load(!0,function(){g(e.id)}),r.systemMessenger.success("COMMON.MESSAGES.CREATE_SUCCESS"),o.close(t)}).error(function(e){r.systemMessenger.error("COMMON.MESSAGES.CREATE_ERROR"),t.modalForm.setValidity(e)})}},e)},r.delete=function(){var e=r.background.id;_("delete",function(){r.currentPage&&r.currentPage.background_id==e&&(r.currentPage.background_id=r.defaultBackground.id),m()})},r.duplicate=function(e,t){!p.isChanged()||t?_("duplicate",function(e){e.id&&g(e.id)}):s.openConfirmationBox({yesHandler:function(){r.cancel(),r.duplicate(e,!0)}})},r.reset=function(){r.currentStyle["background-color"]=void 0},r.EventManager.on("LivePreview.load",v),r.$on("$destroy",function(){var e;for(e=0;e<r.backgrounds.length;e++)r.backgrounds[e].id==r.currentPage.background_id&&(r.LivePreview.useStyle(),r.LivePreview.setBodyBackground(r.backgrounds[e].class_name));r.EventManager.off("LivePreview.load",v),l.disable()}),r.load(!0,h),r.$on("$stateChangeSuccess",h)}]),app.Design.controller("application.design.colorizer.controllers.ColorizerController",["$scope","application.design.colorizer.services.DesingColorizerService","application.design.colorizer.DesignColorizerModel","core.library.styles.StylesService",function(o,i,t,e){var r,n={},a=null;o.colorPickerOptions={showInput:!0,showAlpha:!1,showInitial:!0,preferredFormat:"hex",clickoutFiresChange:!1},o.keyColors=[1,2,3,4,5],o.colors={base:{1:["#ffffff"],2:["#ffffff"],3:["#ffffff"],4:["#ffffff"],5:["#ffffff"]},custom:{1:"#ffffff",2:"#ffffff",3:"#ffffff",4:"#ffffff",5:"#ffffff"}},o.colors.base.forIn(function(e,t){o.colors.base[e]=i.getBrightness(t[0])}),t.success(function(){var e;(e=t.objects().first())&&(o.colors=e),r=angular.copy(o.colors)}).error(function(){o.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(),o.revertBaseColor=function(e){n.base&&n.base[e]&&(o.colors.base[e]=angular.copy(n.base[e]),o.$apply())},o.startEditBaseColor=function(e){null!==a&&a!=e&&o.revertBaseColor(a),a=e,n.base={},n.base[e]=angular.copy(o.colors.base[e])},o.stopEditBaseColor=function(e){o.changeBaseColor(e),a=null},o.changeBaseColor=function(e){o.colors.base[e]=i.getBrightness(o.colors.base[e][0]),o.$apply()},o.save=function(){e.setColorTheme(o.colors).success(function(){o.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS"),r=angular.copy(o.colors),t.load(!1)}).error(function(){o.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")})},o.cancel=function(){o.colors=angular.copy(r)},o.$watch("colors",function(e){o.LivePreview.isLoad&&e&&o.LivePreview.setColorsTheme(e).useStyle()},!0),o.$on("$destroy",function(){o.LivePreview.setColorsTheme(r).useStyle()})}]),app.Design.directive("motoColorPicker",["$filter",function(p){var d=0;return{restrict:"A",require:"ngModel",replace:!0,template:'<span><input class="input-small" /></span>',link:function(t,e,o,i){var r,n=t.$eval(o.motoColorPicker)||{},a=e.find("input"),s=t.$eval(o.fallbackValue);function l(e){t.$apply(function(){c(e)}),o.cpChange&&t.$eval(o.cpChange)}function c(e){var t=s;e?t=e.toString():angular.isUndefined(s)&&(t=e),i.$setViewValue(t)}n=angular.extend({},n),d++,angular.element("#wrapSpectrum").length||angular.element("body").append('<div id="wrapSpectrum" class="spectrum-wrap"></div>'),r=angular.extend({color:i.$viewValue,beforeShow:function(){o.cpBeforeShow&&t.$eval(o.cpBeforeShow)},move:function(e){l(e),o.cpMove&&t.$eval(o.cpMove)},change:l,hide:function(){o.cpHide&&t.$eval(o.cpHide)},cancel:function(e){t.$apply(function(){c(e)}),o.cpCancel&&t.$eval(o.cpCancel)},apply:function(e){t.$apply(function(){c(e)}),o.cpApply&&t.$eval(o.cpApply)},cancelText:p("translate")("UI.ELEMENT.COLOR_PICKER.CANCEL_LABEL"),chooseText:p("translate")("UI.ELEMENT.COLOR_PICKER.OK_LABEL"),newText:p("translate")("UI.ELEMENT.COLOR_PICKER.NEW_COLOR_LABEL"),currentText:p("translate")("UI.ELEMENT.COLOR_PICKER.CURRENT_COLOR_LABEL"),containerClassName:"color-picker-container-"+d,replacerClassName:"color-picker-replacer-"+d,inputUpdateOriginal:!1,initialOffset:{left:300,top:300},appendTo:"#wrapSpectrum"},n),i.$render=function(){a.spectrum("set",i.$viewValue||"")},a.spectrum(r),t.$on("$destroy",function(){a.spectrum("destroy"),angular.element("."+r.containerClassName).remove(),angular.element("."+r.replacerClassName).remove(),angular.element("#wrapSpectrum").remove()})}}}]),app.Design.provider("application.design.colorizer.DesignColorizerModel",[function(){var i;function o(e,t){var o=this;o.base={},o.custom={},t.base.forIn(function(e,t){o.base[e]=t.slice(0)}),t.custom.forIn(function(e,t){o.custom[e]=t})}o.prototype={base:null,custom:null,getKeysByName:function(e){var t;return e&&0<=e.indexOf("@baseColor")?(t=e.replace("@baseColor","").split("_"),{key:parseInt(t[0]),id:parseInt(t[1]),type:"base"}):e&&0<=e.indexOf("@customColor")?{key:parseInt(e.replace("@customColor","")),type:"custom"}:{}},getColorByName:function(e){var t;return e&&0<=e.indexOf("@baseColor")?(t=e.replace("@baseColor","").split("_"),this.base[t[0]][parseInt(t[1])]):e&&0<=e.indexOf("@customColor")?this.custom[e.replace("@customColor","")]:e},getNameByClassName:function(e){if(e)return 0<=e.indexOf("custom")?"@customColor"+e[e.length-1]:"@baseColor"+e[e.length-3]+"_"+e[e.length-1]},getClassNameByColorName:function(e,t){var o;return(o=this.getKeysByName(e)).id?this.getBaseClassName(o.key,o.id,t):o.key?this.getCustomClassName(o.key,t):""},getColorByClassName:function(e,t){var o;t=t||"moto-color";return e&&0<=e.indexOf(t+"_custom")?this.custom[e.replace(t+"_custom","")]:e&&0<=e.indexOf(t)?(o=e.replace(t,"").split("_"),this.base[o[0]][parseInt(o[1])]):e},getNameByFont:function(e){var t,o=i.objects();for(t=0;t<o.length;t++)if(o[t].class_name==e.fontClass)return e.link?o[t].link.desktop.base.color:o[t].properties.desktop.base.color},getBaseName:function(e,t){return"@baseColor"+e+"_"+t},getCustomName:function(e){return"@customColor"+e},getBaseClassName:function(e,t,o){o=o||"moto-color";return 0==t?o+e:o+e+"_"+t},getCustomClassName:function(e,t){return(t=t||"moto-color")+"_custom"+e},getAllClasses:function(){var i=this,r=[];return i.base.forIn(function(o,e){e.forEach(function(e,t){r.push(i.getBaseClassName(o,t))})}),i.custom.forIn(function(e){r.push(i.getCustomClassName(e))}),r},getConstants:function(){var i="";return this.base.forIn(function(o,e){e.forEach(function(e,t){i+=0==t?"@baseColor"+o+": "+e+";\n":"@baseColor"+o+"_"+t+": "+e+";\n"})}),this.custom.forIn(function(e,t){i+="@customColor"+e+": "+t+";\n"}),i},getVariables:function(){var i={};return this.base.forIn(function(o,e){e.forEach(function(e,t){0==t?i["@baseColor"+o]=e:i["@baseColor"+o+"_"+t]=e})}),this.custom.forIn(function(e,t){i["@customColor"+e]=t}),i}},this.$get=["core.library.styles.StylesService","core.library.styles.StylesModel",function(e,t){return i=t,Model.register("DesignColorizer",{proxy:{maps:{list:"getColorTheme"},service:e},record:o}),Model("DesignColorizer").load(!1)}]}]),app.Design.service("application.design.colorizer.services.DesingColorizerService",["coreLibraryUtils",function(p){this.getBrightness=function(e){var t,o,i,r=[],n=p.rgb(),a=parseInt(e.slice(1,3),16),s=parseInt(e.slice(3,5),16),l=parseInt(e.slice(5,7),16),c=n.rgbToHsl(a,s,l);return r.push(e),(i=(o=Math.round(100*c[2]))-10)<0&&(i=0),t=n.hslToRgb(c[0],c[1],i/100),r.push("#"+n.convertToTwoDigitHexCodeFromDecimal(t[0])+n.convertToTwoDigitHexCodeFromDecimal(t[1])+n.convertToTwoDigitHexCodeFromDecimal(t[2])),(i=o-5)<0&&(i=0),t=n.hslToRgb(c[0],c[1],i/100),r.push("#"+n.convertToTwoDigitHexCodeFromDecimal(t[0])+n.convertToTwoDigitHexCodeFromDecimal(t[1])+n.convertToTwoDigitHexCodeFromDecimal(t[2])),r.push(e),100<(i=o+5)&&(i=100),t=n.hslToRgb(c[0],c[1],i/100),r.push("#"+n.convertToTwoDigitHexCodeFromDecimal(t[0])+n.convertToTwoDigitHexCodeFromDecimal(t[1])+n.convertToTwoDigitHexCodeFromDecimal(t[2])),100<(i=o+10)&&(i=100),t=n.hslToRgb(c[0],c[1],i/100),r.push("#"+n.convertToTwoDigitHexCodeFromDecimal(t[0])+n.convertToTwoDigitHexCodeFromDecimal(t[1])+n.convertToTwoDigitHexCodeFromDecimal(t[2])),r}}]),angular.module("application.design").controller("application.design.controllers.TopController",["$scope","$rootScope","application.pages.services.PagesModel","CurrentValue","coreLibraryLivePreview","coreLibraryUtils","$translate","coreLibraryWidget","DesignEditor","motoFeatures","application.pages.services.PagesUtilsService","coreLibraryConfig","application.design.services.PageList",function(i,e,o,t,r,n,a,s,l,c,p,d,u){function g(){i.currentPage&&(t.set("content_service",i.currentPage.type,i.currentPage.id),i.LivePreview.setUrl("./preview.php?page_id="+i.currentPage.id+"&mode=preview&t="+(new Date).getTime()),i.currentPagePreviewUrl=n.generateFullPageUrl(i.currentPage))}i.pagesOnlyListOfTypes=u.getTypesOnly(),i.pagesGroupList=u.getAllGroups(),i.pages=[],i.currentPage=null,i.LivePreview=r(),i.EventManager=Signals.create("design"),i.device="desktop",i.LivePreview.setEventManager(i.EventManager),i.$on("$destroy",function(){l.destroy(),i.LivePreview.destroy(),s.setCurrentPage(null)}),angular.element("#id_live_preview").on("load",function(){e.loadNeededSDKs(i.LivePreview)}),i.setDevice=function(e){i.LivePreview.setDevice(e),i.device=e},i.getGroupPageTitle=function(t){var o="";return angular.forEach(i.pagesGroupList,function(e){-1!==e.types.indexOf(t)&&(o=a.instant(e.title))}),o},i.loadPages=function(e,t){e=!e,o.success(function(){c.isEnabled("engine_pages_unlimited_mode")?i.pages=o.objects().filter(function(e){return 0<=i.pagesOnlyListOfTypes.indexOf(e.type)}):i.pages=p.getPagesForLimitedMode(),t&&t()}).error(function(){i.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(e)},i.selectPageById=function(t){t=parseInt(t),i.pages.forEach(function(e){e.id===t&&(i.currentPage=e,s.setCurrentPage(e))}),g()},i.changeCurrentPage=function(e){s.setCurrentPage(e),g(),"page"===e.type&&(i.currentPage=e)},i.loadPages(!0,function(){i.selectPageById(t.get("content_service","page",parseInt(d.get("settings.website.main_page"))))}),l.init(i.LivePreview)}]),app.Design.directive("deviceSwitch",["$timeout",function(i){return{restrict:"E",scope:!0,replace:!0,template:['<ul class="devices-list" style="visibility: hidden">','<li class="device-item">','<a href="" class="device-link" ng-class="{ \'device-link_active\': LivePreview.getDevice() == \'desktop\' }" ng-click="setDevice(\'desktop\')"><span class="icon device-desktop"></span></a>',"</li>",'<li class="device-item">','<a href="" class="device-link" ng-class="{ \'device-link_active\': LivePreview.getDevice() == \'tablet\' }" ng-click="setDevice(\'tablet\')"><span class="icon device-tablet"></span></a>',"</li>",'<li class="device-item">','<a href="" class="device-link" ng-class="{ \'device-link_active\': LivePreview.getDevice() == \'mobile-h\' }" ng-click="setDevice(\'mobile-h\')"><span class="icon device-mobile-h"></span></a>',"</li>",'<li class="device-item">','<a href="" class="device-link" ng-class="{ \'device-link_active\': LivePreview.getDevice() == \'mobile-v\' }" ng-click="setDevice(\'mobile-v\')"><span class="icon device-mobile-v"></span></a>',"</li>","</ul>"].join(""),link:function(e,t,o){o.setDeviceSwitch&&o.livePreview&&(e.setDevice=e.$eval(o.setDeviceSwitch),e.LivePreview=e.$eval(o.livePreview),i(function(){t.css("visibility","")}))}}}]),angular.module("application.design.editor").service("DesignEditor",["$rootScope","DesignEditorHelpers","DesignEditorSelection","core.library.styles.StylesModel","core.library.editor.PresetsModel","application.design.styles.services.FontsService","core.library.editor.PresetsService",function(t,o,i,r,n,a,s){var l,c,p,d,u=this,g=!1;function m(e){e.preventDefault()}function f(){g?(o.drawSelectedHelpers(),g=!1):(i.resetSelection(),o.hideSelectedHelpers())}function h(){g=!1,i.setSelection(d)}function y(e){var t,o,i,r,n;return o=(t=l.window.$(e.target)).closest(".moto-widget"),(n=s.getWidget(o.data("widget")))&&n.base&&n.name.split(".")[0]===n.base&&(o=1===(i=t.closest('.moto-widget[data-widget="'+n.base+'"]')).length?i:o,n=s.getWidget(n.base)),r=a.getFontDataByElement(t),"text"===o.data("widget")||n&&n.enabled||(o=null),{textElement:r&&r.element,widgetElement:o}}function b(e){var t=y(e);o.drawHoverHelpers(t),e.preventDefault(),e.stopPropagation()}function _(e){var t=y(e);d=i.getSelection(),i.setSelection({textElement:t.textElement,widgetElement:t.widgetElement,targetElement:l.window.$(e.target)}),e.preventDefault(),e.stopPropagation(),i.goToEditState()?g=!0:o.drawSelectedHelpers()}function v(){var e;u.reset(),o.reset(),i.resetSelection(),l.window&&l.window.$&&((e=l.window.$("body")).on("mouseover",".moto-widget",b),e.on("mousedown",".moto-widget",m),e.on("click",".moto-widget",_),e.addClass("moto-preview-mode_design"))}this.init=function(e){(l=e)._em.on("LivePreview.load",v),i.setLivePreview(l),r.load(),n.load(),c=t.$on("$stateChangeSuccess",f),p=t.$on("Moto.UnsavedChanges.No",h)},this.destroy=function(){var e;l.window&&l.window.$&&((e=l.window.$("body")).off("mouseover",".moto-widget",b),e.off("mousedown",".moto-widget",m),e.off("click",".moto-widget",_),e.removeClass("moto-preview-mode_design")),c(),p(),i.resetSelection(),i.resetLivePreview()},this.reset=function(){d=null}}]),angular.module("application.design.editor").service("DesignEditorHelpers",["DesignEditorSelection",function(t){var n,o,i,a,s,r;function l(e){var t;for(t=0;t<e.length;t++)e[t]&&e[t].remove()}this.drawHoverHelpers=function(e){var t,o,i,r;t=e&&e.widgetElement?e.widgetElement:n&&n.widgetElement,o=e&&e.textElement?e.textElement:null,n&&(n.textElement&&n.textElement.removeClass("text-helper-hover"),n.widgetElement&&n.widgetElement.removeClass("moto-widget_preset-hover")),i=s,t&&(s=$('<div class="moto-editor-outline moto-editor-outline_preset-hover"></div>'),t.prepend(s),t.addClass("moto-widget_preset-hover")),r=a,o&&t&&"text"===t.data("widget")&&(o.addClass("text-helper-hover"),a=$('<div class="moto-editor-outline moto-editor-outline_text-hover"></div>'),o.prepend(a)),l([i,r]),e&&(n=e)},this.drawSelectedHelpers=function(){var e=t.getSelection();e&&e.widgetElement&&(this.hideSelectedHelpers(),e&&(r=$('<div class="moto-editor-outline moto-editor-outline_preset-selected"></div>'),e.widgetElement.prepend(r),e.textElement&&e.widgetElement&&"text"===e.widgetElement.data("widget")&&(e.textElement.addClass("text-helper-selected"),i=$('<div class="moto-editor-outline moto-editor-outline_text-selected"></div>'),e.textElement.prepend(i),e.widgetElement.addClass("moto-widget_preset-selected")),o=e))}.bind(this),this.hideSelectedHelpers=function(){o&&(o.textElement&&(o.textElement.removeClass("text-helper-selected"),l([i])),o.widgetElement&&o.widgetElement.removeClass("moto-widget_preset-selected"),l([r]))},this.reset=function(){r=s=a=i=o=n=null}}]),angular.module("application.design.editor").service("DesignEditorSelection",["$state","application.design.styles.services.FontsService","core.library.styles.StylesModel","core.library.editor.PresetsService","core.library.editor.PresetsModel",function(o,a,e,s,l){var c,p;function d(e,t){return(o.current.name!==e||(t=t||{},!angular.equals(t,o.params)))&&(o.go(e,t),!0)}this.setSelection=function(e){c=e},this.getSelection=function(){return c},this.resetSelection=function(){c=null},this.setLivePreview=function(e){p=e},this.resetLivePreview=function(){p=null},this.goToEditState=function(){var e,t,o,i,r,n;if(c&&c.widgetElement){if("text"===(e=c.widgetElement.data("widget"))){if((n=a.getFontDataByElement(c.targetElement))&&n.textStyle)return d("app.design.styles.edit",{styleId:n.textStyle.id})}else{r=s.getPresetsWidget(e);try{o=c.widgetElement.data("widget-id")||c.widgetElement.attr("id"),t=p.window.MotoEditor.getCacheOptionsByWidgetId(o).properties.preset}catch(e){}if(t||(t=c.widgetElement.data("preset")),i=function(e,t){var o,i="moto-preset-"+t,r=l.objects();for(o=0;o<r.length;o++)if(r[o].class_name===i&&r[o].widget_name===e)return r[o].id;return null}(r,t))return d("app.design.widgets.presets.edit",{widget:s.getWidget(r).stateParam,presetId:i})}return d("app.design.notfound")}}}]),angular.module("application.design").provider("application.design.services.PageList",[function(){var e=this,i={};e.addGroup=function(e,t){return!(angular.isUndefined(e)||!angular.isObject(t))&&(angular.isUndefined(t.priority)?(console.warn("Priority is required option!"),!1):i.hasOwnProperty(e)&&!angular.isUndefined(i[e])?(console.warn('Group "'+e+'" already exist!'),!1):(t.hasOwnProperty("types")&&angular.isString(t.types)&&(t.types=[t.types]),function(e){var t=!0;for(var o in i)i.hasOwnProperty(o)&&e.forEach(function(e){-1!==i[o].types.indexOf(e)&&(t=!1)});return t}(t.types)?(angular.isUndefined(i[e])&&t.hasOwnProperty("types")&&(i[e]=t),!0):(console.warn('Group with type(s): "'+t.types+'" already exist!'),!1)))},e.addTypeToGroup=function(t,e){return!(angular.isUndefined(t)||!angular.isArray(e)&&!angular.isString(e))&&(angular.isDefined(e)&&angular.isString(e)&&(e=[e]),angular.isDefined(i[t])&&angular.isArray(e)&&e.forEach(function(e){i[t].types.push(e)}),!0)},e.getGroupByName=function(e){return!angular.isString(e)||angular.isUndefined(i[e])?{}:angular.copy(i[e])},e.getAllGroups=function(){return angular.copy(i)},e.getTypesOnly=function(){var t=[];for(var e in i)i.hasOwnProperty(e)&&i[e].types.forEach(function(e){t.push(e)});return t},e.$get=[function(){return{addGroup:e.addGroup,addTypeToGroup:e.addTypeToGroup,getGroupByName:e.getGroupByName,getTypesOnly:e.getTypesOnly,getAllGroups:e.getAllGroups}}]}]),app.Design.controller("application.design.styles.controllers.AddController",["$scope","core.library.styles.StylesService","core.library.styles.StylesModel","application.design.styles.services.FontsModel","$state",function(t,e,o,i,r){var n;function a(){t.systemMessenger.success("COMMON.MESSAGES.CREATE_SUCCESS"),t.reloadList(!0),t.isSaveButtonBlocked=!1,r.go("app.design.styles")}function s(e){t.systemMessenger.error("COMMON.MESSAGES.CREATE_ERROR"),t.addStyleForm.setValidity(e),t.style.class_name=t.class_name}t.defaultDevice="desktop",t.responsiveDevices=["tablet","mobile-h","mobile-v"],t.linkState="base",t.deviceStyle={color:null,"line-height":"1.2","letter-spacing":"0"},t.class_name="style-add-erase-name",t.style={},t.setDevicesStyles=function(){t.responsiveDevices.forEach(function(e){t.style.properties[e]||(t.style.properties[e]={base:{}})}),t.deviceStyle=t.style.properties[t.defaultDevice].base,t.deviceLinkStyle=t.style.link[t.defaultDevice].base},t.setLinkState=function(e){t.linkState=e,t.deviceLinkStyle=t.style.link[t.defaultDevice][e]},o.success(function(){(n=o.getByField("class_name","moto-text_normal"))&&(n.id=null,n.name="",n.is_responsive=0,n.class_name=t.class_name,t.style=o.newRecord(n),t.setDevicesStyles())}).error(function(){t.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(),t.fonts=[],i.success(function(){t.fonts=i.objects()}).error(function(){t.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(),t.save=function(){t.addStyleForm&&t.addStyleForm.validate()&&(t.style.class_name=null,e.save(t.style).success(a).error(s))}}]),app.Design.controller("application.design.styles.controllers.EditController",["$scope","$rootScope","core.library.styles.StylesService","core.library.styles.StylesModel","application.design.styles.services.FontsModel","$state","$stateParams","coreLibraryUtils","motoUI.BrowserTabCloseConfirmation","simpleHistory",function(t,i,o,r,e,n,a,s,l,c){function p(e){t.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS"),r.save(e),t.reloadList(),n.go("app.design.styles")}function d(e){t.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR"),t.editStyleForm.setValidity(e)}t.styleId=a.styleId,t.defaultDevice="desktop",t.responsiveDevices=["tablet","mobile-h","mobile-v"],t.linkState="base",t.deviceStyle={"line-height":"1.2","letter-spacing":"0"},t.$on("$stateChangeStart",function(e,t,o){c.isChanged()&&(e.preventDefault(),s.openConfirmationBox({yesHandler:function(){c.clear(),n.go(t.name,o)},noHandler:function(){i.$broadcast("Moto.UnsavedChanges.No")}}))}),t.setDevicesStyles=function(){t.responsiveDevices.forEach(function(e){t.style.properties[e]||(t.style.properties[e]={base:{}})}),t.deviceStyle=t.style.properties[t.defaultDevice].base,t.deviceLinkStyle=t.style.link[t.defaultDevice].base},t.setLinkState=function(e){t.linkState=e,t.deviceLinkStyle=t.style.link[t.defaultDevice][e]},r.success(function(){t.style=r.getByField("id",t.styleId),t.style?(c.init(t.style),t.setDevicesStyles()):(t.systemMessenger.error("MODULE.DESIGN.TEXT_STYLES.TEXT_STYLE_NOT_EXIST_ERROR_MESSAGE",n.params),n.go("app.design.styles"))}).error(function(){t.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(),t.fonts=[],e.success(function(){t.fonts=e.objects()}).error(function(){t.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(),t.$watch("style",function(){t.style&&t.LivePreview.renderStylesRecord(t.style)},!0),t.save=function(){t.editStyleForm&&t.editStyleForm.validate()&&(c.clear(),o.save(t.style).success(p).error(d))},t.duplicateStyle=function(e){c.isChanged()?s.openConfirmationBox({yesHandler:function(){c.reset(t.style),t.duplicateStyle(e)}}):s.openConfirmationBox({yesHandler:function(){o.duplicate({id:e}).success(function(e){t.systemMessenger.success("COMMON.MESSAGES.CREATE_SUCCESS"),t.reloadList(!0),n.go("app.design.styles.edit",{styleId:e.id})}).error(function(){t.systemMessenger.error("COMMON.MESSAGES.CREATE_ERROR")})},question:"MODULE.DESIGN.TEXT_STYLES.DUPLICATE_TEXT_STYLE_CONFIRMATION"})},t.getTagName=function(e){return e||"None"},l.enable({isChangedFunction:c.isChanged}),t.$on("fontStyleDelete",function(){c.clear()}),t.EventManager.on("LivePreview.load",function(){t.LivePreview.useStyle({stylesRecord:t.style})}),t.$on("$destroy",function(){t.LivePreview.useStyle(),l.disable()})}]),app.Design.controller("application.design.styles.controllers.ListController",["$scope","$state","application.design.colorizer.DesignColorizerModel","core.library.styles.StylesService","core.library.styles.StylesModel","coreLibraryUtils",function(o,t,i,r,n,a){i.success(function(){var e;(e=i.objects().first())&&(o.systemColors=e)}).error(function(){o.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(),o.reloadList=function(e){e=!e,n.success(function(){o.styles=n.objects(function(e){return"text"==e.type}),o.LivePreview.useStyle()}).error(function(){o.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(e)},o.reloadList(!0),o.deleteStyle=function(e){a.openConfirmationBox({yesHandler:function(){o.$broadcast("fontStyleDelete"),r.delete({id:e}).success(function(){o.systemMessenger.success("COMMON.MESSAGES.DELETE_SUCCESS"),o.reloadList(!0),t.go("app.design.styles")}).error(function(){o.systemMessenger.error("COMMON.MESSAGES.DELETE_ERROR")})},question:"MODULE.DESIGN.TEXT_STYLES.DELETE_TEXT_STYLE_CONFIRMATION"})},o.getTextColorByName=function(e){var t;return e&&o.systemColors?0<=e.indexOf("@baseColor")?(t=e.replace("@baseColor","").split("_"),o.systemColors.base[t[0]][parseInt(t[1])]):0<=e.indexOf("@customColor")?o.systemColors.custom[e.replace("@customColor","")]:e:""}}]),app.Design.directive("deviceFontSetting",[function(){return{restrict:"E",scope:{styleModel:"=styleModel"},replace:!0,template:["<div>",'<div class="form-group stepper-inline-block">',"<label>{{ ::'UI.ELEMENT.FONT.SIZE_LABEL' | translate }}</label>",'<div class="form-control-container">','<div rn-stepper class="stepper" ng-model="fontSize" ng-change="setFontSize()" min="fontSizeConfig.min" max="fontSizeConfig.max"></div>','<span class="stepper-units">px</span>',"</div>","</div>",'<moto-ui-control-slider ng-model="styles[\'line-height\']" min="0.5" max="3" step="0.1" precision="1" label="UI.ELEMENT.FONT.LINE_HEIGHT_LABEL"></moto-ui-control-slider>','<moto-ui-control-slider ng-model="styles[\'letter-spacing\']" min="-10" max="50" step="1" postfix="px" model-with-postfix="true" label="UI.ELEMENT.FONT.LETTER_SPACING_LABEL"></moto-ui-control-slider>',"</div>"].join(""),controller:["$scope","$element","$attrs",function(t,e,o){t.device=o.device,t.defaultDevice="desktop",t.propertiesToExtend=["font-size","line-height","letter-spacing"],t.fontSizeConfig={min:6,max:999},t.update=function(){t.styles=t.styleModel[t.device].base,t.defaultDeviceStyles=t.styleModel[t.defaultDevice].base,t.propertiesToExtend.forEach(function(e){t.styles[e]||(t.styles[e]=t.defaultDeviceStyles[e])}),t.fontSize=t.styles["font-size"]?t.styles["font-size"].replace("px",""):t.fontSizeConfig.min},t.setFontSize=function(){t.styles["font-size"]=t.fontSize+"px"},t.update()}]}}]),app.Design.directive("motoTextStylePreview",["$translate","coreLibraryCssGenerator",function(l,c){return{restrict:"A",priority:500,template:'<div class="styles-preview"><iframe class="frame-preview_desktop"></iframe></div>',link:function(r,e,t){var n,a=r.$eval(t.motoTextStylePreview),s=e.find("iframe");r.$watch("style",function(){var e,t,o,i;r.style&&r.style.class_name&&(n||(t=a.link?"a":"div",o=(new Date).getTime(),i=s.contents(),(e=s[0].contentDocument).open(),e.write('<link rel="stylesheet" href="'+app.config.getUrl("@userFontsFile?_time="+o)+'"><div class="moto-preview-text '+r.style.class_name+'"><'+t+' class="moto-preview-editable-text" contenteditable>'+l.instant(a.previewText)+"</"+t+'></div><style>body{margin:0;}.moto-preview-text{height:60px;padding:10px;word-wrap:break-word;overflow:hidden;position:relative;}.moto-preview-editable-text{outline:0;position:absolute;left:10px;right: 10px;}</style><style id="style_preview_css"></style>'),e.close(),n=i.find("#style_preview_css"),setTimeout(function(){e.getElementsByTagName("body")[0].style.width=s.parent().innerWidth()+"px"},0)),c.renderStylesRecord({stylesRecord:r.style,callback:function(e){n.html(e)}}))},!0)}}}]),app.Design.filter("fontName",function(){return function(e){return e.match(/[\w ][^,']+/g)[0]}}),app.Design.provider("application.design.styles.services.FontsModel",[function(){this.$get=["application.design.styles.services.FontsService",function(e){return Model.register("Fonts",{proxy:{maps:{list:"getActiveList"},service:e},record:{active:"1",is_protected:!1,active_subsets:function(e){return angular.isString(e)?JSON.parse(e):e},active_variants:function(e){return angular.isString(e)?JSON.parse(e):e},category:"",family:"",id:null,name:"",provider:"system",subsets:"",variants:""}}),Model("Fonts").load(!1)}]}]),app.Design.service("application.design.styles.services.FontsService",["jsonrpc","core.library.styles.StylesModel",function(e,a){var s=this,t=e.newService("FontsService");s.getActiveList=t.createMethod("getActiveList"),s.getById=t.createMethod("getById"),s.save=t.createMethod("save"),s.delete=t.createMethod("delete"),s.getFontClassByClasses=function(e){var t,o;if(e)for(o=(t=e.split(" ")).length-1;0<=o;o--)if("moto-text"==t[o].substring(0,9))return t[o];return null},s.getFontDataByElement=function(e){var t,o,i,r,n;return e.hasClass("moto-widget")?null:(t=e.attr("class"),(o=s.getFontClassByClasses(t))&&(i=a.getByField("class_name",o))?((n=e.closest("p,h1,h2,h3,h4,li"))&&n.length&&(e=n),{element:e,textStyle:i}):((r=e.parent()).hasClass("moto-widget-text-content"),s.getFontDataByElement(r)))}}]),angular.module("application.design").controller("application.design.theme.row.RowController",["$scope","application.design.theme.services.ThemeService","coreLibraryUtils","$state","motoUI.BrowserTabCloseConfirmation",function(i,e,r,n,t){var a,s=!1;i.startThemeGrid={},i.themeGrid={},i.$watch("themeGrid",function(e,t){i.LivePreview.isLoad&&Object.keys(i.themeGrid).length&&(i.LivePreview.renderGridStyles(i.themeGrid),e&&t&&(angular.equals(e,t)||i.LivePreview.window.$(i.LivePreview.window).trigger("widthChanged")))},!0),a=function(){return!angular.equals(i.themeGrid,i.startThemeGrid)},e.getGridOptions().success(function(e){i.startThemeGrid=angular.copy(e),i.themeGrid=e}).error(function(){i.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}),i.save=function(){e.setGridOptions(i.themeGrid).success(function(){i.startThemeGrid=angular.copy(i.themeGrid),i.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS")}).error(function(){i.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")})},i.$on("$stateChangeStart",function(e,t,o){!s&&a()&&(e.preventDefault(),r.openConfirmationBox({yesHandler:function(){s=!0,i.themeGrid=i.startThemeGrid,setTimeout(function(){n.go(t.name,o)},0)}}))}),t.enable({isChangedFunction:a}),i.$on("$destroy",function(){i.LivePreview.useStyle(),i.LivePreview.removeTempStyleTag(),t.disable()})}]),angular.module("application.design").controller("application.design.theme.headings.HeadingsController",["$scope","$state","application.design.theme.services.ThemeService","coreLibraryUtils","motoUI.BrowserTabCloseConfirmation",function(i,r,e,n,t){var a,s=!1;i.startHeadingSpacings={},i.headingSpacings=null,e.getHeadingSpacings().then(function(e){i.startHeadingSpacings=angular.copy(e),i.headingSpacings=e},function(){i.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}),i.$watch("headingSpacings",function(){i.LivePreview.isLoad&&i.headingSpacings&&i.LivePreview.renderHeadingSpacingsStyles(i.headingSpacings)},!0),i.save=function(){e.setHeadingSpacings(i.headingSpacings).then(function(){i.startHeadingSpacings=angular.copy(i.headingSpacings),i.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS")},function(){i.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")})},i.$on("$stateChangeStart",function(e,t,o){!s&&a()&&(e.preventDefault(),n.openConfirmationBox({yesHandler:function(){s=!0,i.headingSpacings=i.startHeadingSpacings,setTimeout(function(){r.go(t.name,o)},0)}}))}),a=function(){return!angular.equals(i.headingSpacings,i.startHeadingSpacings)},t.enable({isChangedFunction:a}),i.$on("$destroy",function(){i.LivePreview.useStyle(),i.LivePreview.removeTempStyleTag(),t.disable()})}]),app.Design.service("application.design.theme.services.ThemeService",["jsonrpc",function(e){var t=e.newService("ThemeService");this.getSpacings=t.createMethod("getSpacings"),this.setSpacings=t.createMethod("setSpacings"),this.getGridOptions=t.createMethod("getGridOptions"),this.setGridOptions=t.createMethod("setGridOptions"),this.getHeadingSpacings=t.createMethod("getHeadingSpacings"),this.setHeadingSpacings=t.createMethod("setHeadingSpacings")}]),app.Design.controller("application.design.theme.spacings.controllers.SpacingsController",["$scope","$state","application.design.theme.services.ThemeService","coreLibraryUtils","motoUI.BrowserTabCloseConfirmation",function(i,r,e,n,t){var a,s=!1;i.startSpacings={},i.spacings=null,e.getSpacings().success(function(e){i.startSpacings=angular.copy(e),i.spacings=e}).error(function(){i.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}),i.$watch("spacings",function(e,t){i.LivePreview.isLoad&&i.spacings&&(i.LivePreview.renderSpacingsStyles(i.spacings),e&&t&&(angular.equals(e[i.device],t[i.device])||i.LivePreview.window.$(i.LivePreview.window).trigger("widthChanged")))},!0),i.save=function(){e.setSpacings(i.spacings).success(function(){i.startSpacings=angular.copy(i.spacings),i.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS")}).error(function(){i.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")})},i.$on("$stateChangeStart",function(e,t,o){!s&&a()&&(e.preventDefault(),n.openConfirmationBox({yesHandler:function(){s=!0,i.spacings=i.startSpacings,setTimeout(function(){r.go(t.name,o)},0)}}))}),a=function(){return!angular.equals(i.spacings,i.startSpacings)},t.enable({isChangedFunction:a}),i.$on("$destroy",function(){i.LivePreview.useStyle(),i.LivePreview.removeTempStyleTag(),t.disable()})}]),app.Design.controller("application.design.widgets.controllers.EditController",["$scope","$rootScope","$state","$stateParams","$translate","core.library.editor.PresetsService","core.library.editor.PresetsModel","coreLibraryUtils","simpleHistory","motoUI.BrowserTabCloseConfirmation","$timeout",function(i,r,n,e,t,o,a,s,l,c,p){var d=!1;function u(){i.LivePreview.isLoad&&i.LivePreview.document&&$(i.LivePreview.document.body).attr("class",$(i.LivePreview.document.body).attr("class").replace(/(^|\s)moto-preview_selected-widget-\S+/g,""))}function g(){i.LivePreview.isLoad&&i.LivePreview.document&&(u(),$(i.LivePreview.document.body).addClass("moto-preview_selected-widget-"+i.preset.widget_name))}i.presetId=e.presetId,i.preset=null,i.presetProperties=null,i.styleModel={},i.desktopView=!0,i.mobileView=!1,i.selectView=function(e){"mobile"==e?(i.mobileView=!0,i.desktopView=!1):"desktop"==e&&(i.desktopView=!0,i.mobileView=!1)},a.success(function(){i.preset=angular.copy(a.getByField("id",i.presetId)),g(),p(function(){l.init(i.preset)}),i.preset&&(i.presetControls=o.getPresetControls(i.currentWidgetName,i.preset.class_name)),i.widgetData.checkPresetControls&&function(){var e;if(i.presetControls)for(e in i.presetControls)if(i.presetControls.hasOwnProperty(e)&&i.presetControls[e])return;i.hidePresetControls=!0}()}).error(function(){i.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(),c.enable({isChangedFunction:l.isChanged}),i.$watch("preset",function(e,t){i.LivePreview.isLoad&&i.preset&&(g(),r.$emit("Design.WidgetPreset.Changed",{newValue:e,oldValue:t}),d?(i.LivePreview.useStyle({widgetPreset:i.preset}),i.LivePreview.removeTempStyleTag(),d=!1):i.LivePreview.renderPresetStyles(i.preset))},!0),i.setStyleModel=function(e){var t,o=e.entities.split(",");for(t=0;t<o.length;t++)i.preset.properties[o[t]]||(i.preset.properties[o[t]]={desktop:{base:{},hover:{}},mobile:{base:{},hover:{}}}),i.preset.properties[o[t]].desktop?i.styleModel[o[t]]=i.preset.properties[o[t]].desktop[e.value]:i.preset.properties[o[t]].mobile&&(i.styleModel[o[t]]=i.preset.properties[o[t]].mobile[e.value]);i.$broadcast("widget.properties.setCache",i.currentCashKey),i.currentCashKey=e.entities+e.value,i.currentStyleOptions=e},i.initEntities=function(e,t){!function e(t){var o;if(angular.isArray(t)||!angular.isObject(t))return!1;for(o in t)t.hasOwnProperty(o)&&(angular.isArray(t[o])?t[o].length||(t[o]={}):angular.isObject(t[o])&&e(t[o]));return!0}(i.preset.properties),i.setStyleModel({entities:e,value:t||"base",init:!1})},i.resetEntities=function(e,t){t&&i.setStyleModel({entities:e,value:t})},i.save=function(){o.save(i.preset).success(function(e){i.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS"),a.save(e),i.reloadList(),l.clear(),n.go("app.design.widgets.presets",{widget:i.currentWidgetStateParam})}).error(function(){i.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")})},i.reset=function(){var e,t,o;if(l.reset(i.preset),i.styleModel&&i.currentStyleOptions)for(t in e=i.currentStyleOptions.entities.split(","),i.styleModel)i.styleModel.hasOwnProperty(t)&&(o=-1<e.indexOf(t)?i.currentStyleOptions.value:"base",i.preset.properties[t].desktop?i.styleModel[t]=i.preset.properties[t].desktop[o]:i.preset.properties[t].mobile&&(i.styleModel[t]=i.preset.properties[t].mobile[o]))},i.getParent=function(e,t){return"base"==i.currentStyleOptions.value?null:t?i.preset.properties[e].desktop.base[t]:i.preset.properties[e].desktop.base},i.tabChanged=function(){p(function(){i.$broadcast("rzSliderForceRender")},50)},i.$on("$stateChangeStart",function(e,t,o){l.isChanged()&&(e.preventDefault(),s.openConfirmationBox({yesHandler:function(){l.clear(),n.go(t.name,o)},noHandler:function(){r.$broadcast("Moto.UnsavedChanges.No")}}))}),i.$on("$destroy",function(){i.LivePreview.useStyle(),u(),c.disable()}),i.$on("MotoUI.StateSwitcher.Changed",function(e,t){i.setStyleModel(t)}),i.$on("MotoUI.Style.Clear",function(){d=!0}),i.EventManager.on("LivePreview.load",function(){i.LivePreview.useStyle({widgetPreset:i.preset}),g()})}]),app.Design.controller("application.design.widgets.controllers.PresetsListController",["$scope","$stateParams","$state","core.library.editor.PresetsService","core.library.editor.PresetsModel",function(e,t,o,i,r){e.hidePresetControls=!1,e.currentWidgetName=t.widget,e.widgetData=i.getWidget(e.currentWidgetName),e.widgetData?e.currentWidgetStateParam=e.currentWidgetName:(e.currentWidgetStateParam=e.currentWidgetName,e.currentWidgetName=i.getWidgetByStateParam(e.currentWidgetStateParam).name,e.widgetData=i.getWidget(e.currentWidgetName)),e.currentWidgetPresets=[],e.presetsLabel="WIDGET."+e.currentWidgetName.toUpperCase()+".PRESETS_GROUP_TITLE",e.widgetData.presetPropertiesView?e.presetUrl=e.widgetData.presetPropertiesView:e.presetUrl="@websiteWidgets/"+e.currentWidgetName+"/views/preset_properties.tpl.html",e.widgetData.enabled||o.go("app.design"),e.reloadList=function(){r.success(function(){var t;e.currentWidgetPresets=r.objects((t=e.currentWidgetName,function(e){return e.widget_name==t}))}).error(function(){e.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load()},e.reloadList()}]),app.Design.controller("application.design.widgets.controllers.WidgetsController",["$scope","$state",function(e,t){e.isThemePresetsEnabled=e.$motoFeatures.isEnabled("theme_presets"),e.isThemePresetsEnabled||t.go("app.design")}]),angular.module("application.extra").service("application.extra.services.ExtraService",["jsonrpc",function(e){var t=e.newService("ExtraService");this.getUrlFrameOptions=t.createMethod("getUrlFrameOptions"),this.getUrlHeaders=t.createMethod("getUrlHeaders")}]),app.users.service("application.language.services.LanguagesService",["jsonrpc",function(e){var t=e.newService("LanguagesService");this.getList=t.createMethod("getList")}]),angular.module("application.users").provider("application.users.services.LanguagesModelService",[function(){this.$get=["application.language.services.LanguagesService",function(e){return Model.register("Languages",{proxy:{service:e},record:{id:Model.fields.integer(),code:Model.fields.string(),locale:Model.fields.string(),name:Model.fields.string()}}),Model("Languages").load(!1)}]}]),angular.module("application.media_library").component("motoUploadFilesProcess",{templateUrl:"views/application/media_library/upload_files_process.tpl.html",controller:["$timeout","application.media_library.services.MediaLibraryService","coreLibraryModal","coreLibraryMessenger",function(r,e,t,n){var a=this,o=!1,s=angular.element("body"),l=[],c=e.uploader(),p=!1;function i(){o||(o=!0,t("views/application/media_library/details.tpl.html",function(e){e.errorFiles=l},null,"details-popup").result.then(null,function(){o=!1}))}function d(){var e,t,o,i,r,n;for(r in e=c.poolMessages())if(o=[],"error"==(t=e[r]).type){if(t.args[2]&&t.args[2].data&&"object"==typeof t.args[2].data.errors)for(n in t.args[2].data.errors)t.args[2].data.errors.hasOwnProperty(n)&&o.push(t.args[2].data.errors[n].toUpperCase());i=t.args[2]&&t.args[2].message||null,l.push({name:t.args[3].name,keys:o,msg:i})}}function u(){p||(a.info=c.info(),d())}function g(e,t){l.push({name:t.name,keys:[e]})}function m(){p=!(l=[]),s.addClass("upload-file-status").addClass("hide-spinner"),u()}function f(){var e,t,o,i;d(),t=[],a.info=c.info();e:for(o=0;o<l.length;o++){for(i=0;i<t.length;i++)if(l[o].name==t[i].name)continue e;t.push(l[o])}l=t,a.info.error=l.length,e={success_count:a.info.success,error_count:a.info.error},a.info.error?n.warning("MODULE.MEDIA_LIBRARY.UPLOADING_INFO_WARNING_MESSAGE",e,1e4):n.success("MODULE.MEDIA_LIBRARY.UPLOADING_INFO_SUCCESS_MESSAGE",e),p=!0,r(function(){s.removeClass("hide-spinner").removeClass("upload-file-status")},1200),r(function(){a.info=c.info()},1500)}a.info=c.info(),a.cancelUpload=function(){c.cancel()},a.$onInit=function(){c.on("before",m),c.on("after",f),c.on("progress",u),c.on("validate",g),s.on("click",".details_link",i),0<a.info.all&&m()},a.$onDestroy=function(){c.off("before",m),c.off("after",f),c.off("progress",u),c.off("validate",g),s.off("click",".details_link",i)}}]}),angular.module("application.media_library").controller("application.media_library.controllers.AddController",["$scope","application.media_library.services.MediaLibraryService","CurrentValue",function(t,e,o){var i=e.uploader();t.info=i.info(),t.uploaderParams={is_protected:0},t.init=function(){t.showAddController(!0)},i.on("after",t.getDiskInfo),t.uploadFiles=function(e){t.isDemoMode?t.systemMessenger.warning("DEMO_MODE.WARNING_MESSAGE.ACCESS_DENIED"):(t.info=i.info(),i.upload({files:e,params:{folder_id:o.get("media_library","folder",0),is_protected:t.uploaderParams.is_protected}}))}}]),angular.module("application.media_library").controller("application.media_library.controllers.FoldersController",["$scope","application.media_library.services.MediaLibraryModelService","application.media_library.services.MediaLibraryService","application.media_library.services.BlockedFolders","application.media_library.services.DeleteFolderService","coreLibraryModal","coreLibraryUtils",function(i,e,r,o,n,t,a){var s=e;i.createFolder=function(){i.$parent.validAddFolder()?t("views/application/media_library/create_folder.tpl.html",function(t,o){t.createFolder={name:"",parent_id:i.$parent.currentFolderId},t.ok=function(){t.createFolderForm&&t.createFolderForm.validate()&&(t.isButtonBlocked=!0,r.createFolder(t.createFolder).then(function(e){i.$parent.load(e.id),i.systemMessenger.success("COMMON.MESSAGES.CREATE_SUCCESS"),o.close(t),t.isButtonBlocked=!1},function(e){i.systemMessenger.error("COMMON.MESSAGES.CREATE_ERROR"),t.isButtonBlocked=!1,t.createFolderForm.setValidity(e)}))}}):i.systemMessenger.warning("MODULE.MEDIA_LIBRARY.MAXIMUM_SUBFOLDERS_INPUT_LEVEL_MESSAGE",{max_level:i.maxFoldersLevel})},i.renameFolder=function(){var e;i.$parent.currentFolderId&&(e=(e=i.$parent.models.folders.objects(function(e){return e.id==i.$parent.currentFolderId}).first())||{name:""},t("views/application/media_library/rename_folder.tpl.html",function(t,o){t.renameFolder={name:e.name,id:i.$parent.currentFolderId},t.ok=function(){e.name===t.renameFolder.name?o.close(t):t.renameFolderForm&&t.renameFolderForm.validate()&&(t.isButtonBlocked=!0,r.renameFolder(t.renameFolder).then(function(e){i.$parent.load(e.id),i.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS"),o.close(t),t.isButtonBlocked=!1},function(e){i.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR"),t.isButtonBlocked=!1,t.renameFolderForm.setValidity(e)}))}}))},i.onDeleteFolder=function(){0===i.$parent.$parent.selectedItems.length&&(i.$parent.currentItem||o.isBlock(i.$parent.currentFolderId)||i.deleteFolder())},i.deleteFolder=function(){var t;i.currentFolderId&&!o.isBlock(i.currentFolderId)&&(t=n.getChildren(i.currentFolderId),0<s.items.objects(function(e){return-1<t.indexOf(parseInt(e.folder_id))&&parseInt(e.is_protected)}).length?i.systemMessenger.error("MODULE.MEDIA_LIBRARY.DELETE_FOLDER_WITH_PROTECTED_FILES_ERROR_MESSAGE"):a.openConfirmationBox({yesHandler:function(){r.deleteFolders({id:t}).then(function(){n.remove(t),i.updateAllModels(),i.setFolder(i.rootFolderId),i.getDiskInfo(),i.systemMessenger.success("COMMON.MESSAGES.DELETE_SUCCESS")},function(e){i.systemMessenger.error(e.message,e.data)})},question:n.isEmpty(i.currentFolderId)?"MODULE.MEDIA_LIBRARY.DELETE_EMPTY_FOLDER_CONFIRMATION_TEXT":"MODULE.MEDIA_LIBRARY.DELETE_NOT_EMPTY_FOLDER_CONFIRMATION_TEXT"}))}}]),angular.module("application.media_library").controller("application.media_library.controllers.InfoController",["$scope","application.media_library.services.MediaLibraryService",function(t,o){function i(e){t.modelItems.save(e),t.itemPropertiesForm&&t.itemPropertiesForm.$setPristine(),t.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS"),t.setGlobalFilters()}function r(){t.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")}t.$on("SET_PRISTINE",function(){t.itemPropertiesForm&&(t.itemPropertiesForm.$setPristine(),t.itemPropertiesForm.clearErrors())}),t.saveItemProperties=function(){var e;t.itemPropertiesForm&&!t.itemPropertiesForm.$valid||(e={id:t.selectedItems[0].id,title:t.selectedItemProperty.title,alt:t.selectedItemProperty.alt,caption:t.selectedItems[0].caption},o.saveItem(e).then(i,r))}}]),angular.module("application.media_library").controller("application.media_library.controllers.ItemsController",["$scope","application.media_library.services.MediaLibraryService","application.media_library.services.MediaLibraryModelService","coreLibraryUtils","application.media_library.services.UploadedFilesDispatcherService","coreLibraryIntegration","motoFeatures","$timeout","$rootScope","coreLibraryLanguages",function(i,o,r,e,n,t,a,s,l,c){var p,d;function u(e){var t;(t=r.items.getByField("id",e)).is_ready=1,r.items.save(t),i.updateAllModels(),i.systemMessenger.success("COMMON.MESSAGES.SAVE_SUCCESS")}function g(){var e;p=new Aviary.Feather({apiKey:i.aviaryClientId||"d0e6a92dca154ae48c03fb82b6ef486b",apiVersion:3,theme:"dark",tools:"all",appendTo:"",displayImageSize:!0,language:(e=c.getProfileLocale(),"uk_UA"===e&&(e="en_US"),"pt_BR"!==e&&(e=e.substring(0,2)),e),onLoad:function(){i.imageEditorLoaded=!0,i.$apply()},onReady:function(){i.imageEditorReady=!0,d&&s.cancel(d)},onSave:function(e,t){o.downloadFile({url:t,filename:i.editingItem.name,folder_id:i.editingItem.folder_id}).then(function(e){(e=r.items.newRecord(e)).is_ready=0,r.items.insert(e),a.isEnabled("engine_thumbnails_available")?o.generateThumbnails({id:e.id}).then(function(e){n.setThumbnailsInModel(e),u(e.id),i.setCurrentItem(r.items.getByField("id",e.id)),s(function(){l.$emit("MotoUI.Scrollbar.ScrollToElement",{key:"mediaLibraryItems",element:angular.element("#ml-item_"+e.id)})},500)},function(){n.thumbnailsNotGenerated(e.id),u(e.id)}):u(e.id),p.close()},function(){i.systemMessenger.error("COMMON.MESSAGES.SAVE_ERROR")})},onError:function(e){i.systemMessenger.error(e.message)}})}i.aviaryClientId=t.first("aviary").get("client_id",""),i.editingItem=null,i.imageEditorLoaded=!1,i.imageEditorReady=!1,i.fileNotFoundSrc=app.config.getPath("@adminImages/file-not-found.svg"),i.$on("$destroy",function(){p&&p.close()}),window.Aviary?(g(),i.imageEditorLoaded=!0):e.loadScript("aviary_image_editor","//dme0ih8comzn4.cloudfront.net/imaging/v3/editor.js").then(g),i.launchFeatherEditor=function(e){var t,o;i.imageEditorLoaded&&(o=a.getValue("avairy_media_library_upload_path"),i.editingItem=e,t=angular.isString(o)&&o.length?app.config.getUploadUrl(e.path,{userUploads:o}):app.config.getUploadAbsoluteUrl(e.path),i.imageEditorReady=!1,p.launch({image:"mlimage"+e.id,url:t}),d=s(p.showWaitIndicator,75))},i.updateMLItems=function(e){var t=[];i.selectedItems.forEach(function(e){t.push(e.id)}),o.updateItems({id:t,update:e}).success(function(e){e.forEach(function(e){i.modelItems.save(e)}),i.setGlobalFilters(),i.setIsDeleteEnabledFlag(),i.systemMessenger.success("Selected items were updated succesfully 😉")}).error(function(){i.systemMessenger.error("Selected items were not updated 😥")})},i.getImageSrc=function(e){return e.loadSrcError?i.fileNotFoundSrc:app.config.getUploadAbsoluteUrl(e._previewSrc)},i.onLoadSrcSuccess=function(e){e.loadSrcSuccess=1,r.items.save(e)},i.onLoadSrcError=function(e){e.loadSrcError=1,r.items.save(e)}}]),angular.module("application.media_library").controller("application.media_library.controllers.TopController",["$scope","application.media_library.services.MediaLibraryModelService","application.media_library.services.MediaLibraryService","motoFeatures","CurrentValue","dragDropBoxService","$window","$translate","coreLibraryUtils","$rootScope","$timeout","$filter","coreLibraryConfig",function(n,r,a,e,o,i,t,s,l,c,p,d,u){var g,m,f,h,y,b,_,v,E,w,S,M={},C=null;function I(){var e=Math.min(128,Math.floor(($("#media-library__items-canvas").width()-15)/161));return 1<e?C=e:e=C,Math.max(3,e)}function T(){var e,t;n.itemsRows=function(e,t){var o,i,r=[],n=[];for(t=t||I(),o=0,i=e.length;o<i;o++)o%t==0&&(n.length&&r.push(n),n=[]),e[o].__rowIndex=r.length,n.push(e[o]);return n.length&&r.push(n),r}(n.items),n.emptyItemsInLastRow=(t=n.itemsRows.length)?(e=I(),new Array(e-n.itemsRows[t-1].length)):[]}n.errorFiles=[],n.filters=[],n.initialFiltersAmount=0,n.currentFilters={},n.extensions=[],n.allThumbnailsTypes=[],n.selectedThumbnailType="",n.isDeleteEnabled=!1,_=o.get("media_library","popup_config",null),n.isPopup=null!==_,n.thumbnail=!!n.isPopup&&_.thumbnails,o.set("media_library","popup_config",null),n.models=r,n.modelItems=r.items,n.rootFolderId=0,n.addController=!1,n.selectedItems=[],n.ctrlKey=!1,n.devBlocksBuilderForThemeEnabled=e.isEnabled("dev_blocks_builder_for_theme"),n.isSelected=function(e){var t;for(t=0;t<n.selectedItems.length;t++)if(n.selectedItems[t].id==e.id)return!0;return!1},h=function(){n.ctrlKey=!1},y=function(e){-1!==navigator.userAgent.indexOf("Mac OS X")?n.ctrlKey=e.metaKey:n.ctrlKey=e.ctrlKey},angular.element(window).on("keydown",y),angular.element(window).on("keyup",h),n.treeFolders=[],n.maxFoldersLevel=5,n.validAddFolder=function(){var e,t;if(0==n.currentFolderId)return!0;for(e=0;e<n.treeFolders.length;e++)if(n.treeFolders[e].id==n.currentFolderId){t=n.treeFolders[e]._level;break}return t<n.maxFoldersLevel},m=function(){n.currentFilter||b(o.get("media_library","folder",0))},f=function(){n.currentFilter?n.setFilter(n.currentFilter,!0):n.setFolder(n.currentFolderId,!0)},n.modelItems.on("insert",m),n.modelItems.on("remove",f),n.$on("$destroy",function(){n.modelItems.off("insert",m),n.modelItems.off("remove",f),angular.element(window).off("keydown",y),angular.element(window).off("keyup",h),n.isPopup||angular.element(window).off("resize",void 0),r.savedCurrentFilter=n.currentFilter,r.savedCurrentFolderId=n.currentFolderId}),n.updateAllModels=function(){n.folders=r.folders.objects(),n.items=r.items.objects(),n.items=d("orderBy")(n.items,["created","id"]),n.properties=r.properties,n.treeFolders=[],g(),n.setGlobalFilters()},n.$on("MotoEvent:uploadedItemReady",function(){n.updateAllModels()}),n.websiteUrl=u.get("settings.website.address"),n.setCurrentFilters=function(){n.filters.length&&n.filters.forEach(function(e){n.currentFilters[e]=!0})},n.load=function(i){r.success(function(){var e,t,o=!1;n.updateAllModels(),n.uploadMaxSize=r.properties.upload_max_size,n.configureDiskInfo(r.properties),_&&(_.filters&&(n.filters=_.filters,n.initialFiltersAmount=_.filters.length||0),n.extensions=_.extensions,n.customFilter=_.customFilter,(_.id&&0<_.id||_.value&&"none"!==_.value)&&(_.id&&0<_.id&&(e=r.items.getByField("id",_.id)),e||(/thumbnails\//.test(_.value)&&(t=a.getDataByThumbnailPath(_.value),_.size=t.size,_.value=t.originalPath),e=r.items.getByField("path",_.value)),e?(n.setFolder(e.folder_id),n.setCurrentItem(e),M[e.id]?p(function(){n.itemsTopIndex=M[e.id].__rowIndex},500):p(function(){angular.element("#ml-item_"+e.id).length&&c.$emit("MotoUI.Scrollbar.ScrollToElement",{key:"mediaLibraryItems",element:angular.element("#ml-item_"+e.id)})},500),o=!(_.value=null)):(n.systemMessenger.error("MODULE.MEDIA_LIBRARY.FILE_NOT_FOUND_ERROR_MESSAGE"),_.value=null))),n.setCurrentFilters(),o||(void 0===i?(n.currentFilter=r.savedCurrentFilter,n.currentFolderId=r.savedCurrentFolderId,f()):n.setFolder(i)),n.$broadcast("MotoEvent:MediaLibrary.Ready")}).error(function(){n.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load()},n.load(),n.getDiskInfo=function(){a.getMediaLibraryProperties().then(n.configureDiskInfo)},n.configureDiskInfo=function(e){var t=e.disk_total_space-e.disk_free_space;n.diskInfo={totalSpace:e.disk_total_space,freeSpace:e.disk_free_space,usedSpace:t,usedPercentage:parseInt(t/e.disk_total_space*100)}},g=function(t,o){t||o||n.treeFolders.splice(),t=t||0,o=o||0,r.folders.objects(function(e){return e.parent_id==t}).forEach(function(e){e._level=o,n.treeFolders.push(e),g(e.id,o+1)})},n.toggleFilesFilter=function(e){var t;-1<(t=n.filters.indexOf(e))?n.filters.splice(t,1):n.filters.push(e),n.setGlobalFilters()},b=function(e){var t;t=r.items.getByField("id",o.get("media_library","current_item_id",null)),n.setCurrentItem(t),o.set("media_library","folder",e),n.currentFolderId=e},n.setFolder=function(e,t){(t||n.currentFolderId!=e||n.addController||n.currentFilter)&&(n.currentFilter=void 0,n.selectedItems=[],b(e),n.setGlobalFilters(),n.showAddController())},n.setFilter=function(e,t){(t||e!==n.currentFilter||n.addController)&&(n.currentFilter=e||null,n.currentFolderId=0,n.setGlobalFilters(),n.selectedItems=[],n.showAddController())},n.setSorting=function(e){n.sort=e,n.setGlobalFilters()},n.toggleSorting=function(e){n.sort=e||null,n.setGlobalFilters()},n.toggleConditioning=function(e){n.cond=e||null,n.setGlobalFilters()},$(window).on("resize",function(){p(T)}),c.$on("MotoUI.Sidebar.Toggled",function(){p(T,500)}),n.itemsTopIndex=0,n.setGlobalFilters=function(){var e,t,o=r.items.objects();for(e=0,t=o.length;e<t;e++)M[o[e].id]=o[e];n.items=a.getItemsByFilters(o,{folder:"all"===n.currentFilter?null:n.currentFolderId,types:n.filters,extensions:n.extensions,customFilter:n.customFilter,sort:n.sort,cond:n.cond}),n.items=d("orderBy")(n.items,["created","id"]),T()},n.selectedItemProperty={alt:"",title:""},n.setIsDeleteEnabledFlag=function(e){if(0===n.selectedItems.length||e&&e.is_protected)return n.disableDeleteItemsFlag();e&&1===n.selectedItems.length?e.is_protected?n.disableDeleteItemsFlag():n.enableDeleteItemsFlag():!e&&n.isDeleteEnabled||e&&!e.is_protected||(n.enableDeleteItemsFlag(),n.selectedItems.forEach(function(e){e.is_protected&&n.disableDeleteItemsFlag()}))},n.enableDeleteItemsFlag=function(){n.isDeleteEnabled=!0},n.disableDeleteItemsFlag=function(){n.isDeleteEnabled=!1},n.setCurrentItem=function(e){var t;e&&(n.ctrlKey||(n.selectedItems=[]),(t=n.selectedItems.indexOf(e))<0?(n.selectedItemProperty.title=e.title,n.selectedItemProperty.alt=e.alt,n.selectedItems.push(e),n.setIsDeleteEnabledFlag(e)):(n.selectedItems.splice(t,1),n.setIsDeleteEnabledFlag()),n.$broadcast("SET_PRISTINE"),n.isPopup&&_.thumbnails&&n.setCurrentImageThumbnailSizeOptions(e))},n.showAddController=function(e){e&&(n.selectedItems=[]),n.addController=e||!1},n.isApplyDisabled=function(){return _.multiSelect?0===n.selectedItems.length:1!=n.selectedItems.length},n.cancelPopup=function(){_.onCancel()},n.isPopup&&(S=u.get("settings.website.thumbnails"))&&S.forEach(function(e){n.allThumbnailsTypes.push({label:s.instant(e.label)+" ("+e.height+"x"+e.width+")",name:e.name})}),n.setCurrentImageThumbnailSizeOptions=function(e){var t,o,i;for(t in n.thumbnailsTypes=[{label:s.instant("MODULE.MEDIA_LIBRARY.THUMBNAILS.ORIGINAL_LABEL"),name:""}],n.selectedThumbnailType="",e.thumbnails){for(o=0,i=n.allThumbnailsTypes.length;o<i;o++)n.allThumbnailsTypes[o].name===t&&n.thumbnailsTypes.push(n.allThumbnailsTypes[o]);t===_.size&&(n.selectedThumbnailType=t)}},n.applyPopup=function(){_.thumbnails?_.onApply((_.multiSelect?n.selectedItems:n.selectedItems[0])||null,n.selectedThumbnailType):_.onApply((_.multiSelect?n.selectedItems:n.selectedItems[0])||null)},n.deleteItems=function(e){var t=[];0<e.length&&l.openConfirmationBox({yesHandler:function(){t=e.map(function(e){return e.id}),a.deleteItems({id:t}).then(function(){n.systemMessenger.success("COMMON.MESSAGES.DELETE_SUCCESS"),e.forEach(function(e){r.items.remove(e)}),n.currentFilter?n.setFilter(n.currentFilter,!0):n.setFolder(n.currentFolderId,!0),n.getDiskInfo()},function(){n.systemMessenger.error("COMMON.MESSAGES.DELETE_ERROR")})},question:"MODULE.MEDIA_LIBRARY.DELETE_FILE"+(1===e.length?"":"S")+"_CONFIRMATION_TEXT"})},n.onDeleteItem=function(e,t){e.stopPropagation(),e.preventDefault(),n.deleteItems([t])},i.init(),v=w=null,n.prepareCanvasForDrag=function(e){var t;t=-1!==n.selectedItems.indexOf(e)?n.selectedItems.length:n.selectedItems.length+1,i.drawItemsInCanvas(t,1)},n.configDDItems={box:i.itemsBox(),cssClass:null,beforeStart:function(e){n.ctrlKey?(n.setCurrentItem(e),n.selectedItems.indexOf(e)<0&&n.selectedItems.push(e)):n.selectedItems.indexOf(e)<0&&(n.setCurrentItem(e),n.selectedItems=[e]),n.$digest(),1===n.selectedItems.length?this.box(!0):this.box(!1)},dragstart:function(e,t){return e&&0===e.id?(t.preventDefault(),!1):(v=e,!0)},dragend:function(e,t){var o;return v&&w&&v.folder_id!=w.id&&(o=w,a.moveItems({id:n.selectedItems.map(function(e){return e.id}),folder_id:o.id}).then(function(){n.selectedItems.forEach(function(e){e.folder_id=o.id,r.items.save(e)}),n.selectedItems=[],f(),n.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS")},function(){n.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")})),v=w=null,t.stopPropagation(),t.preventDefault(),!1}},n.configDDFolders={box:i.foldersBox(),cssClass:"folders-list-item_dragover",_validMove:function(e,t){var o,i;for(o=0;o<n.folders.length;o++)if(n.folders[o].parent_id==e){if(n.folders[o].id==t)return!1;if(!(i=this._validMove(n.folders[o].id,t)))return i}return!0},_getInternalFolders:function(e,t){var o,i;for(o=0,i=n.folders.length;o<i;o++)n.folders[o].parent_id==e&&(t=this._getInternalFolders(n.folders[o].id,t+1));return t},_getInternalLevels:function(e,t){var o,i,r=t;for(t++,i=0;i<n.folders.length;i++)n.folders[i].parent_id==e.id&&r<(o=this._getInternalLevels(n.folders[i],t))&&(r=o);return r},_highlightDraggedArea:function(e,t,o){var i,r;for(i=this._getInternalFolders(e,0),r=0;r<=i;r++)o?t.classList.add("drag-folder"):t.classList.remove("drag-folder"),t=t.nextElementSibling},dragstart:function(e,t){return e&&0==e.id?(t.preventDefault(),!1):(E=t.currentTarget,v=e,this._highlightDraggedArea(v.id,E,!0),!0)},dragenter:function(e){return w=e,!1},dragover:function(e,t){return w=e,c.$emit("Moto.MediaLibrary.DragOverFolder",{e:t}),!1},dragleave:function(e,t){return c.$emit("Moto.MediaLibrary.DragLeaveFolder",{e:t}),w=null,!1},dragend:function(e,t){var o,i;if(this._highlightDraggedArea(v.id,E,!1),v&&w&&v.id!=w.id&&v.parent_id!=w.id&&(o=v,i=w,this._validMove(o.id,i.id))){if(this._getInternalLevels(o,1)+i._level>n.maxFoldersLevel)return void n.systemMessenger.warning("MODULE.MEDIA_LIBRARY.MAXIMUM_SUBFOLDERS_INPUT_LEVEL_MESSAGE",{max_level:n.maxFoldersLevel});a.saveFolders({folders:n.folders.map(function(e){return{id:e.id,parent_id:e.id==o.id?i.id:e.parent_id,order:0}})}).then(function(e){e&&e.records&&Array.isArray(e.records)&&e.records.forEach(function(e){var t;(t=r.folders.newRecord(e))&&r.folders.save(t)}),n.updateAllModels(),f(),n.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS")},function(){n.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")})}return c.$emit("Moto.MediaLibrary.DragEndInFolder",{e:t}),v=w=null,E=null,t.stopPropagation(),t.preventDefault(),!1}}}]),angular.module("application.media_library").directive("ngKeyDelete",[function(){return{restrict:"A",link:function(t,o,e){var i,r=!1;function n(e){e&&46===e.keyCode&&o.has($(e.target)).length&&i&&t.$eval(i)}function a(){return r&&(angular.element(window).unbind("keyup",n),r=!1),!1}e.$observe("ngKeyDelete",function(e){return e?(i=e,r||(angular.element(window).bind("keyup",n),r=!0),!0):a()}),t.$on("$destroy",function(){a()})}}}]),angular.module("application.media_library").directive("mediaLibraryFolders",["$rootScope","$timeout",function(s,l){return{restrict:"C",templateUrl:"views/application/media_library/folders.tpl.html",link:function(e,r){var t,o,i,n;function a(){r.css("top",r.parent().height()+"px")}l(function(){a(),r.addClass("media-library-folders_visible")},200),e.$on("MotoEvent:MediaLibrary.Ready",function(){l(a)}),t=s.$on("Moto.MediaLibrary.DragOverFolder",function(e,t){var o,i;l.cancel(n),o=r.offset().top,i=r.height()+o,t.e.originalEvent.clientY-o<20?s.$emit("MotoUI.Scrollbar.StartScrolling",{key:"mediaLibraryFolders"}):i-t.e.originalEvent.clientY<20?s.$emit("MotoUI.Scrollbar.StartScrolling",{key:"mediaLibraryFolders",toBottom:!0}):s.$emit("MotoUI.Scrollbar.StopScrolling",{key:"mediaLibraryFolders"})}),o=s.$on("Moto.MediaLibrary.DragEndInFolder",function(){l.cancel(n),s.$emit("MotoUI.Scrollbar.StopScrolling",{key:"mediaLibraryFolders"})}),i=s.$on("Moto.MediaLibrary.DragLeaveFolder",function(){l.cancel(n),n=l(function(){s.$emit("MotoUI.Scrollbar.StopScrolling",{key:"mediaLibraryFolders"})},500)}),e.$on("$destroy",function(){t(),o(),i()})}}}]),angular.module("application.media_library").provider("application.media_library.services.BlockedFolders",[function(){this.$get=["CurrentValue","application.media_library.services.MediaLibraryModelService",function(r,e){var n,a="media_library.blocked",s="folders",l=e.folders;return n=function(t){var e,o=l.objects(function(e){return parseInt(e.parent_id)==t}),i=!1;for(e=0;e<o.length;e++){if(0<=r.get(a,s,[]).indexOf(o[e].id)){i=!0;break}i=n(o[e].id)}return i},{block:function(e){var t=r.get(a,s,[]);t.indexOf(e)<0&&(t.push(e),r.set(a,s,t))},unblock:function(t){var e=r.get(a,s,[]);e=e.filter(function(e){return e!=t}),r.set(a,s,e)},isBlock:function(e){return 0<=r.get(a,s,[]).indexOf(e)||n(e)}}}]}]),angular.module("application.media_library").service("application.media_library.services.DeleteFolderService",["application.media_library.services.MediaLibraryModelService",function(e){var o,r;return o=e.items,r=e.folders,{isEmpty:function(t){return!(0<r.objects(function(e){return parseInt(e.parent_id)==t}).length)&&o.objects(function(e){return parseInt(e.folder_id)==t}).length<=0},getChildren:function(e){var t,o=[];return(t=r.getByField("id",e))&&(!function t(o,i){r.objects(function(e){return parseInt(e.parent_id)==o}).forEach(function(e){t(e.id,i),i.push(e.id)})}(t.id,o),o.push(t.id)),o},remove:function(e){e.forEach(function(e){var t=r.getByField("id",e);t&&(o.objects(function(e){return parseInt(e.folder_id)==t.id}).forEach(function(e){o.remove(e)}),r.remove(t))})}}}]),angular.module("application.media_library").provider("application.media_library.services.MediaLibraryModelService",[function(){this.$get=["coreLibraryUtils","application.media_library.services.MediaLibraryService","application.users.services.UsersModel",function(e,o,t){var i,r,n,a,s,l,c,p,d,u,g,m,f=[],h=[];return g=function(t){f.forEach(function(e){e.call(t)}),f=f.splice(),h=h.splice()},m=function(t,o){h.forEach(function(e){e.call(t,o)}),f=f.splice(),h=h.splice()},(a=function(e){var t=this;e&&(t.id=parseInt(e.id),t.folder_id=parseInt(e.folder_id),t.author_id=parseInt(e.author_id),t.name=e.name,t.path=e.path,t.type=e.type,t.extension=e.name.split(".").pop().toLowerCase(),t.filesize=parseInt(e.filesize),e.properties=e.properties||"{}",t.properties=angular.fromJson(e.properties),t.title=e.title,t.caption=e.caption,t.alt=e.alt,t.created=e.created,t.modified=e.modified,t.is_protected=parseInt(e.is_protected),t.del=!!e.del,t.is_ready=angular.isDefined(e.is_ready)?e.is_ready:1)}).prototype={id:null,folder_id:null,author_id:null,getAuthorName:function(){var e;return(e=t.getByField("id",this.author_id))?e.name:""},name:null,path:null,type:null,extension:null,filesize:null,getSize:function(){return e.fileSize(this.filesize)},properties:null,title:null,caption:null,alt:null,created:null,modified:null,is_protected:null,del:null,is_ready:null},((s=function(e){a.call(this,e),this.setThumbnails(e.thumbnails),this.loadSrcSuccess=e.loadSrcSuccess||0,this.loadSrcError=e.loadSrcError||0}).prototype=new a).constructor=a,s.prototype.getThumbnailPath=function(e){var t,o,i;return e?this.thumbnails[e]?(t=this.path.lastIndexOf("/"),o=this.path.lastIndexOf("."),i=this.path.substring(t+1,o)+"_"+e+"_"+this.thumbnails[e].width+"x"+this.thumbnails[e].height+this.path.substring(o,this.path.length),this.path.substring(0,t)+"/thumbnails/"+i):null:this.path},s.prototype.setThumbnails=function(e){this.thumbnails=angular.fromJson(e||"{}"),this._previewSrc=this.getThumbnailPath("s")||this.path},(l=function(e){a.call(this,e)}).prototype=new a,(c=function(e){a.call(this,e)}).prototype=new(l.prototype.constructor=a),(p=function(e){a.call(this,e)}).prototype=new(c.prototype.constructor=a),(d=function(e){a.call(this,e)}).prototype=new(p.prototype.constructor=a),((u=function(e){e.type="file",a.call(this,e)}).prototype=new(d.prototype.constructor=a)).constructor=a,r=function(e,t){return t.type=t.type||"file","image"===t.type?new s(t):"video"===t.type?new l(t):"audio"===t.type?new c(t):"doc"===t.type?new p(t):"archive"===t.type?new d(t):new u(t)},(i=function(e){(e=e||{}).folders=e.folders||{},e.items=e.items||{},Model.register("MediaLibFolders",{proxy:{records:e.folders.records||[]},record:{id:Model.fields.integer(),name:Model.fields.string(),parent_id:Model.fields.integer(),created:null,modified:null,del:Model.fields.bool(),_level:0}}),Model.register("MediaLibItems",{proxy:{records:e.items.records||[]},index:["path"],record:r})})(),(n=function(e){var t=this;t.allowed_ext_list=e.allowed_ext_list||t.allowed_ext_list,t.denied_ext_list=e.denied_ext_list||t.denied_ext_list,t.disk_free_space=parseInt(e.disk_free_space)||t.disk_free_space,t.disk_total_space=parseInt(e.disk_total_space)||t.disk_total_space,t.upload_max_size=parseInt(e.upload_max_size)||t.upload_max_size}).prototype={allowed_ext_list:[],denied_ext_list:[],disk_free_space:0,disk_total_space:0,upload_max_size:0},{folders:Model("MediaLibFolders"),items:Model("MediaLibItems"),properties:null,savedCurrentFilter:"all",savedCurrentFolderId:0,load:function(){var t=this;o.getMediaLibrary().then(function(e){i(e),t.properties=new n(e.properties),g(t),Model("MediaLibFolders").load(),Model("MediaLibItems").load()},function(e){m(t,e)})},success:function(e){return e instanceof Function&&f.push(e),this},error:function(e){return e instanceof Function&&h.push(e),this}}}]}]),angular.module("application.media_library").service("application.media_library.services.MediaLibraryService",["jsonrpc","coreLibraryUploader","coreLibraryModal","CurrentValue",function(e,t,r,n){var a,s,l,c,p,d,o=this,i=e.newService("MediaLibraryService");o.getMediaLibrary=i.createMethod("getMediaLibrary"),o.getMediaLibraryProperties=i.createMethod("getMediaLibraryProperties"),o.createFolder=i.createMethod("createFolder"),o.renameFolder=i.createMethod("renameFolder"),o.deleteFolders=i.createMethod("deleteFolders"),o.saveItem=i.createMethod("saveItem"),o.itemUpload=i.createUploadMethod("upload"),o.uploader=function(){return t(o.itemUpload)},o.deleteItems=i.createMethod("deleteItems"),o.open=function(e){var o,i,t;i=e.onApply||function(){},t=e.onCancel||function(){},o={value:e.hasOwnProperty("value")?e.value:null,fileType:e.hasOwnProperty("fileType")?e.fileType:"image",id:e.hasOwnProperty("id")?e.id:null,filters:e.hasOwnProperty("filters")?e.filters:null,extensions:e.hasOwnProperty("extensions")?e.extensions:null,customFilter:e.hasOwnProperty("customFilter")?e.customFilter:null,thumbnails:!!e.hasOwnProperty("thumbnails")&&e.thumbnails,size:e.hasOwnProperty("size")?e.size:null,windowClass:e.hasOwnProperty("windowClass")?"media-library-popup "+e.windowClass:"media-library-popup",dialog:null,dialogScope:null,multiSelect:!!e.hasOwnProperty("multiSelect")&&e.multiSelect,onCancel:function(){this.dialog&&this.dialogScope&&this.dialog.close(this.dialogScope),angular.isFunction(t)&&this.dialog.closed.then(function(){t.call(null)})},onApply:function(e,t){this.dialog&&this.dialogScope&&this.dialog.close(this.dialogScope),angular.isFunction(i)&&this.dialog.closed.then(function(){i.call(null,e,t)})}},n.set("media_library","popup_config",o),r("views/application/media_library/popup/popup.tpl.html",function(e,t){o.dialog=t,o.dialogScope=e},null,o.windowClass)},o.moveItems=i.createMethod("moveItems"),o.saveFolders=i.createMethod("saveFolders"),o.generateThumbnails=i.createMethod("generateThumbnails"),l=function(e,t){var o=[];return 0===e.length?e:(e.forEach(function(e){parseInt(e.folder_id)==t.folder&&o.push(e)}),o)},c=function(e,t){var o=[];return 0===e.length?e:(e.forEach(function(e){-1<t.types.indexOf(e.type)&&o.push(e)}),o)},p=function(e,t){var o=[];return 0===e.length||0===t.extensions.length?e:(e.forEach(function(e){-1<t.extensions.indexOf(e.extension)&&o.push(e)}),o)},a=function(e,o){return 0===e.length||("number"==typeof e[0][o.sort.field]?"desc"==o.sort.order?e.sort(function(e,t){return t[o.sort.field]-e[o.sort.field]}):e.sort(function(e,t){return e[o.sort.field]-t[o.sort.field]}):"desc"==o.sort.order?e.sort(function(e,t){return e[o.sort.field].toUpperCase()<t[o.sort.field].toUpperCase()}):e.sort(function(e,t){return e[o.sort.field].toUpperCase()>t[o.sort.field].toUpperCase()})),e},s=function(e,t){var o=[];return 0===e.length?e:"number"!=typeof e[0][t.cond.field]?e:("<"==t.cond.condition?e.forEach(function(e){e[t.cond.field]<t.cond.value&&o.push(e)}):e.forEach(function(e){e[t.cond.field]>=t.cond.value&&o.push(e)}),o)},d=function(e,t){return 0===e.length?e:t.customFilter(e)},o.getItemsByFilters=function(e,t){var o=e,i=[];return null!==t.folder&&i.push(l),0<t.types.length&&i.push(c),t.extensions&&i.push(p),t.sort&&i.push(a),t.cond&&i.push(s),t.customFilter&&i.push(d),0<i.length&&(i.forEach(function(e){o=e(o,t)}),o.sort(function(e,t){return e.name-t.name})),o},o.getItem=i.createMethod("getItem"),o.updateItems=i.createMethod("updateItems"),o.downloadFile=i.createMethod("downloadFile"),this.getDataByThumbnailPath=function(e){var t,r=null;return/thumbnails\//.test(t=e)&&(t=(t=t.replace(/thumbnails\//,"")).replace(/_([a-z]+)(_\d+x\d+)?(\.\w+$)/,function(e,t,o,i){return r=t,i})),{size:r,originalPath:t}}}]),angular.module("application.media_library").provider("application.media_library.services.UploadedFilesDispatcherService",[function(){var i,r,n,a,s,l;function c(e){var t,o=n.items.objects();for(t=0;t<o.length;t++)if(o[t].id==e.id)return o[t].setThumbnails(e.thumbnails),void n.items.save(o[t])}function p(e){r.getItem({id:e}).success(c)}s=function(e){var t,o;e&&e.params&&e.params.hasOwnProperty("folder_id")&&(t=e.params.folder_id,a.block(t),o=function(){a.unblock(t),i.off("after",o)},i.on("after",o))},l=function(){i.setOptions(n.properties)},this.$get=["application.media_library.services.MediaLibraryService","application.media_library.services.MediaLibraryModelService","application.media_library.services.BlockedFolders",function(e,t,o){return a=o,n=t,i=(r=e).uploader(),{setThumbnailsInModel:c,thumbnailsNotGenerated:p,init:function(){n.items.on("load",l),i.on("before",s)}}}]}]),angular.module("application.menus").controller("application.menus.controllers.TopController",["$scope","application.menus.services.MenusModel","application.menus.services.MenusService","coreLibraryModal","CurrentValue","coreLibraryUtils",function(r,i,n,e,t,o){function a(){r.menuId=t.get("menu","menuId",r.menuId),r.currentMenu=i.getByField("id",r.menuId),r.currentMenu&&r.currentMenu.getItems(function(e){r.items=e,r.itemsTree=r.tree(),r.setNotChangedStateForMenu()})}function s(e){angular.isUndefined(e)&&(e=!0),i.success(function(){r.menus=i.objects(),a()}).error(function(){r.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(e)}r.menuItem=null,r.currentMenu=null,r.menuId=null,r.itemId=null,r.menus=[],r.items=[],r.parents=[],r.widgetMenuLevels=r.$motoFeatures.getValue("theme_widget_menu_levels",2),r.setNotChangedStateForMenu=function(){r.isItemsDeleted=!1,r.startMenuName=r.currentMenu.name},r.isMenuChanged=function(){return!!r.currentMenu&&(r.isItemsDeleted||r.isTreeChanged(r.itemsTree,0)||r.startMenuName!==r.currentMenu.name)},r.isTreeChanged=function(e,t){var o,i=!1;if(e)for(o=0;o<e.length;o++)e[o].parent_id!==t&&(i=!0),i||(i=r.isTreeChanged(e[o]._children,e[o].id));return i},s(),r.load=s,r.setMenuId=function(e){e=parseInt(e),t.set("menu","menuId",e),r.menuId!==e&&(r.menuId=e||null,a())},r.updateItem=function(e){e&&r.currentMenu.saveItem(e)},r.refreshTree=function(e){r.items.push(e),r.itemsTree.push(e)},r.tree=function(){return function t(o,i){var e;return(e=o.filter(function(e){return null===e.parent_id&&(e.parent_id=0),e.parent_id==i&&!e.isDeleted()}).sort(function(e,t){return e.order-t.order})).forEach(function(e){e._children=t(o,e.id)}),e}(r.items,0)},r.setItemId=function(e){r.itemId=e},r.deleteMenu=function(e){o.openConfirmationBox({yesHandler:function(){n.deleteMenu({id:e}).then(function(){r.menuId=null,r.load(!1),r.systemMessenger.success("COMMON.MESSAGES.DELETE_SUCCESS"),r.setMenuId(1)},function(){r.systemMessenger.error("COMMON.MESSAGES.DELETE_ERROR")})},question:"MODULE.MENU.MENU_DELETE_CONFIRMATION"})},r.$on("$destroy",function(){t.set("menu","menuId",null)}),r.duplicate=function(e){r.isMenuChanged()?o.openConfirmationBox({yesHandler:function(){r.showDuplicatePopup(e)}}):r.showDuplicatePopup(e)},r.showDuplicatePopup=function(e){o.openConfirmationBox({yesHandler:function(){n.duplicate({id:e}).then(function(e){r.load(!1),r.setMenuId(e.id),r.systemMessenger.success("COMMON.MESSAGES.CREATE_SUCCESS")},function(){r.systemMessenger.error("COMMON.MESSAGES.CREATE_ERROR")})},question:"MODULE.MENU.MENU_DUPLICATE_CONFIRMATION"})},r.addNewMenu=function(){r.isMenuChanged()?o.openConfirmationBox({yesHandler:function(){r.showAddMenuPopup()}}):r.showAddMenuPopup()},r.showAddMenuPopup=function(){e("views/application/menus/add.tpl.html",function(t,o){t.modalModel={name:""},t.ok=function(){t.modalForm&&t.modalForm.validate()&&n.save(t.modalModel).then(function(e){i.save(e),r.systemMessenger.success("COMMON.MESSAGES.CREATE_SUCCESS"),r.load(!1),o.close(t),r.setMenuId(e.id)},function(e){r.systemMessenger.error("COMMON.MESSAGES.CREATE_ERROR"),t.modalForm.setValidity(e)})}})},r.editMenu=function(e){e!=r.menuId&&(r.isMenuChanged()?o.openConfirmationBox({yesHandler:function(){r.setMenuId(e)}}):r.setMenuId(e))},0==r.activeCurrentWidget?r.setMenuId(1):r.setMenuId(r.activeCurrentWidget),r.addMenuItem=function(){e("views/application/menus/item_add_edit_popup.tpl.html",function(t,o){t.pages=r.pages,t.successButtonText="COMMON.BUTTON.ADD",t.titleText="COMMON.TEXT.ADD_ITEM",t.item={label:"",order:r.items.length+1,menu_id:r.currentMenu.id,action:"none",properties:{}},t.ok=function(){t.modalForm&&t.modalForm.validate()&&n.saveItem(t.item).then(function(e){e._children=[],r.currentMenu.saveItem(e),r.refreshTree(e),o.close(t),r.systemMessenger.success("COMMON.MESSAGES.CREATE_SUCCESS")},function(e){r.systemMessenger.error("COMMON.MESSAGES.CREATE_ERROR"),t.modalForm.setValidity(e)})}})},r.editMenuItem=function(i){e("views/application/menus/item_add_edit_popup.tpl.html",function(t,o){t.item=angular.copy(i),t.item.properties.email||(t.item.properties.email=""),t.pages=r.pages,t.successButtonText="COMMON.BUTTON.SAVE",t.titleText="COMMON.TEXT.EDIT_ITEM",t.ok=function(){t.modalForm&&t.modalForm.validate()&&n.saveItem(t.item).then(function(e){i.label=e.label,i.action=e.action,i.properties=e.properties,o.close(t),r.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS")},function(e){r.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR"),t.modalForm.setValidity(e)})}})},r.deleteMenuItem=function(e){o.openConfirmationBox({yesHandler:function(){r.itemId=e.id,void 0!==e.setDelete&&e.setDelete(),r.deleteItem(e),r.deleteItemById(r.itemsTree),r.isItemsDeleted=!0},question:"MODULE.MENU.ITEM_DELETE_CONFIRMATION"})},r.menu=i.newRecord(),r.deleteItem=function(e){var t,o,i;for(t=(o=function(e){var t;for(t=0;t<r.items.length;t++)if(e.parent_id==r.items[t].id)return r.items[t].isDeleted()?o(r.items[t]):r.items[t].id;return 0})(e),i=0;i<r.items.length;i++)r.items[i].id==e.id&&void 0!==r.items[i].setDelete&&r.items[i].setDelete(),r.items[i].parent_id==e.id&&(r.items[i].parent_id=t)},r.deleteItemById=function(e){var t,o;for(t=0;t<e.length;t++){if(e[t].id==r.itemId){if(void 0!==e[t]._children&&e[t]._children.length)for(o=0;o<e[t]._children.length;o++)e[t]._children[o].parent_id=e[t].parent_id,e.push(e[t]._children[o]);e.splice(t,1);break}void 0!==e[t]._children&&e[t]._children.length&&r.deleteItemById(e[t]._children)}},r.applyPopup=function(){r.currentMenu.items=function e(t,o,i,r){var n;for(r=r||0,o=o||[],n=0;n<t.length;n++)o.push({id:t[n].id,parent_id:i?i.id:0,label:t[n].label,order:r}),void 0!==t[n]._children&&t[n]._children.length&&e(t[n]._children,o,t[n]),r++;return o}(r.itemsTree),n.save(r.currentMenu).then(function(){delete r.currentMenu.items,r.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS"),r.load(!1)},function(){delete r.currentMenu.items,r.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")})},r.cancelPopup=function(e){e&&e.preventDefault(),r.isMenuChanged()?o.openConfirmationBox({yesHandler:function(){r.cancel()}}):r.cancel()},r.$on("motoPopupCanceled",r.cancelPopup)}]),angular.module("application.menus").provider("application.menus.services.ClassMenuItemsModel",[function(){var e;(e=function(e,t){var o=this;t=t||{},o._name=e,o.id=t.id?parseInt(t.id):0,o.parent_id=t.parent_id?parseInt(t.parent_id):0,o.menu_id=t.menu_id?parseInt(t.menu_id):0,o.label=t.label||null,o.action=t.action||"none",o.order=t.order?parseInt(t.order):0,o.status=t.status||"draft",o._isDeleted=!1,o._children=[],o.properties={},t.properties?o.properties=angular.fromJson(t.properties):o.properties={},"none"==o.action?o.properties={}:"page"==o.action?o.properties={id:o.properties.id||null,target:o.properties.target||"_self",nofollow:o.properties.nofollow||!1,anchor:o.properties.anchor||""}:"popup"==o.action?o.properties={id:o.properties.id||null,target:o.properties.target||"_self"}:"url"==o.action?o.properties={url:o.properties.url||null,target:o.properties.target||"_self",nofollow:o.properties.nofollow||!1}:"mail"==o.action?o.properties={email:o.properties.email||null,subject:o.properties.subject||null,body:o.properties.body||null}:"file"==o.action?o.properties={file:o.properties.file||null,media_id:o.properties.mediaId||null,forceDownload:o.properties.forceDownload||null,fileName:o.properties.fileName||null}:"box"==o.action&&(o.properties={src:o.properties.src||null,media_id:o.properties.media_id||null})}).prototype={id:null,menu_id:null,parent_id:null,label:null,action:null,order:null,status:null,properties:null,created:null,modified:null,_name:null,_children:[],_isDeleted:!1,setDelete:function(){this._isDeleted=!0},isDeleted:function(){return this._isDeleted},isDraft:function(){return"draft"==this.status},factory:function(){return new e(this._name,this)},toJSON:function(){var o={};return this.forIn(function(e,t){"_"==e[0]||t instanceof Function||(o[e]=t,"parent_id"==e&&null==t&&(o[e]=0))}),o},getHtmlAttributes:function(){return'href="#"'}},this.$get=[function(){return{getClass:function(){return e}}}]}]),angular.module("application.menus").provider("application.menus.services.MenusModel",[function(){this.$get=["application.menus.services.MenusService","application.menus.services.ClassMenuItemsModel",function(i,e){var r=e.getClass();return Model.register("Menu",{proxy:{service:i},record:{id:Model.fields.integer(),name:null,is_system:Model.fields.integer(),created:null,modified:null,_modelItems:null,tree:function(t,o){o=o||null,this.getItems(function(e){t(function t(o,i,r){var e;return(e=o.filter(function(e){return!(r&&r!=e.status||(null===e.parent_id&&(e.parent_id=0),e.parent_id!=i||e.isDeleted()))}).sort(function(e,t){return e.order-t.order})).forEach(function(e){e.items=t(o,e.id,r)}),e}(e,0,o))})},getItems:function(e){var t=this,o="MenuItems_"+t.id;t._modelItems||(Model.register("MenuItems_"+t.id,{proxy:{service:i,maps:{list:"getItemsList"}},record:r}),t._modelItems=Model(o)),t._modelItems.success(function(){e(t._modelItems.objects())}).load(!1,{id:t.id})},saveItem:function(e){this._modelItems&&e&&this._modelItems.save(e)},createItem:function(){return this._modelItems.newRecord()}}}),Model("Menu").load(!1)}]}]),angular.module("application.menus").service("application.menus.services.MenusService",["jsonrpc",function(e){var t=e.newService("MenusService");this.getList=t.createMethod("getList"),this.getById=t.createMethod("getById"),this.save=t.createMethod("save"),this.deleteMenu=t.createMethod("delete"),this.duplicate=t.createMethod("duplicate"),this.getItemsList=t.createMethod("getItemsList"),this.saveItem=t.createMethod("saveItem"),this.deleteItem=t.createMethod("deleteItem")}]),app.pages.provider("application.pages.services.PagesModel",[function(){this.$get=["application.users.services.UsersModel","application.pages.services.PagesService","core.library.styles.ClassesStylesModel","application.content_service.services.ContentModelService","application.content_service.services.LayoutsModelService","application.settings.services.SettingsService","coreLibraryUtils",function(e,t,o,n,i,r,a){var s,l;function c(t,e){var o,i=this,r=!0;i._id=parseInt(e.id),i.name=t,i.visible=!0,e.hasOwnProperty("visible")&&(i.visible=Boolean(e.visible)),(o=n.objects(function(e){return r=r&&!(e.id==i._id),e.type==t&&1==e.is_system}).first())&&r&&(i._id=o.id)}function p(e){var t,o=this;e=angular.fromJson(e),o.name=e.name||"default",o.label=null,o.title=null,o.sections={},e.sections&&e.sections.forIn(function(e,t){o.sections[e]=new c(e,t)}),(t=l.getLayoutByName(o.name))&&(o.label=t.label,o.title=t.title)}return c.prototype={_id:null,set id(e){this._id=parseInt(e)},get id(){return this._id},visible:null,name:null,toSrc:function(){return'"'+this.name+'": {"id":'+this.id+',"visible":'+this.visible+"}"},toJSON:function(){return{id:this.id,visible:this.visible}}},p.prototype={name:null,label:null,title:null,sections:null,section:function(e){return this.sections[e]},getSrc:function(){return"&layout="+this.name},getSectionSrc:function(){var o=[];return this.sections.forIn(function(e,t){o.push(t.toSrc())}),"&sections="+encodeURIComponent(a.base64Encode("{"+o.join(",")+"}"))},toJSON:function(){var o={};return o.name=this.name,o.sections={},this.sections.forIn(function(e,t){o.sections[e]=t.toJSON()}),o}},l=i.objects(),s=o.ClassStyleProperties(),Model.register("Pages",{proxy:{service:t},record:{id:Model.fields.integer(),parent_id:Model.fields.foreign({model:"Pages",type:Model.fields.integer()}),is_system:Model.fields.integer(),category_id:Model.fields.integer(),category:{},author_id:Model.fields.foreign({model:"Users",type:Model.fields.integer()}),name:null,status:null,getUniquePassword:function(){return this.properties.password},title:null,type:null,url:null,visibility:null,properties:function(e){return e&&(e=angular.fromJson(e)),e=e||{},angular.isArray(e.feature_media)&&(e.feature_media={}),{meta:e.meta||{keywords:"",description:"",noindex:"",nofollow:"",noodp:"",noydir:"",robots:"",hideCanonical:"",canonical_url:""},menu:e.menu||{label:"",title:""},blocks:{header:!e.blocks||void 0===e.blocks.header||e.blocks.header,footer:!e.blocks||void 0===e.blocks.footer||e.blocks.footer},custom_code:e.custom_code||{header:"",footer:""},password:a.base64Decode(e.password)||"",template:e.template||"",feature_media:e.feature_media||{},show_comments:void 0===e.show_comments||e.show_comments}},layout:function(e){return new p(e)},setLayout:function(e){var o,i=this,r={};r.name=e.name,r.sections={},e.sections.forEach(function(t){i.layout.sections[t.name]?r.sections[t.name]={id:i.layout.sections[t.name].id,visible:i.layout.sections[t.name].visible}:(o=n.objects(function(e){return e.type==t.type&&1==e.is_system}).first())&&(r.sections[t.name]={id:o.id,visible:!0})}),i.layout=new p(r)},styles:function(e){return new s(e)},header_id:Model.fields.integer(),header:function(){return n.getByField("id",this.header_id)},footer_id:Model.fields.integer(),footer:function(){return n.getByField("id",this.footer_id)},_background:null,background_id:null,short_description:null,published:null,created:null,modified:null,tags:[],relative_url:null,getAbsoluteUrl:function(){return a.generateFullPageUrl(this,{permalinks:!0,suffix:!1})},isTemplate:function(){return/^(tpl|template)\./.test(this.type||"")}}}),Model("Pages").load(!1)}]}]),app.pages.service("application.pages.services.PagesService",["jsonrpc",function(e){var t=e.newService("PagesService");this.getList=t.createMethod("getList"),this.getById=t.createMethod("getById"),this.save=t.createMethod("save"),this.publish=t.createMethod("publish"),this.getRevisionsList=t.createMethod("getRevisionsList"),this.deletePage=t.createMethod("delete"),this.restoreFromRevision=t.createMethod("restoreFromRevision"),this.duplicate=t.createMethod("duplicate"),this.setMainPage=t.createMethod("setMainPage")}]),app.pages.service("application.pages.services.PagesUtilsService",["application.settings.services.SettingsService","application.pages.services.PagesModel","coreLibraryConfig",function(e,n,a){this.getPagesForLimitedMode=function(){var e,t,o,i,r=a.get("settings.website");return e=r.main_page,t=r.under_construction.page_id,o=r.notfound_page_id,n.objects((i={ids:[parseInt(e),parseInt(t),parseInt(o)]},function(e){var t=!0;return i&&i.ids&&(t=0<=i.ids.indexOf(parseInt(e.id))),t}))}}]),angular.module("application.profile").controller("application.profile.controllers.EditController",["$scope","$rootScope","$translate","$window","application.profile.services.ProfileService","application.users.services.UsersModel","application.users.services.LanguagesModelService","coreLibraryModal","amMoment",function(o,e,t,i,r,n,a,s,l){var c=n,p=a;function d(){c.save(o.profile),o.languageId!==o.profile.language_id&&i.location.reload(),app&&app.user&&app.user.name&&(app.user.name=o.profile.name,Signals.trigger("PROFILE","profile.update")),o.cachedProfile=angular.copy(o.profile),o.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS")}function u(e){o.editProfileForm.setValidity(e),o.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")}o.cachedProfile=null,o.languages=[],o.profile=null,o.languageId=null,c.success(function(){o.profile=c.getByField("id",parseInt(app.user.id)),o.profile&&(o.languageId=o.profile.language_id),o.cachedProfile=angular.copy(o.profile)}).error(function(){o.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(),p.success(function(){o.languages=p.objects()}).error(function(){o.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(),o.reset=function(){o.profile=angular.copy(o.cachedProfile),o.editProfileForm.clearErrors()},o.save=function(){o.editProfileForm&&o.editProfileForm.validate()&&r.save(o.profile).success(d).error(u)},o.changePassword=function(){s("views/application/profile/change_password.tpl.html",function(t,e){t.passwordModel={old_password:"",new_password:"",confirm_password:""},t.ok=function(){r.changePassword(t.passwordModel).success(function(){o.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS"),e.close(t)}).error(function(e){t.changeProfilePasswordForm.setValidity(e),o.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")})}})}}]),app.profile.service("application.profile.services.ProfileService",["jsonrpc",function(e){var t=e.newService("ProfileService");this.get=t.createMethod("get"),this.save=t.createMethod("save"),this.changePassword=t.createMethod("changePassword")}]),app.settings.controller("application.settings.advanced_settings.controllers.AdvancedSettingsController",["$scope","application.settings.services.SettingsService","motoUI.LinkToService",function(t,o,i){var r={controls:{visible:"close",accept:{label:"Got it",preset:"default",size:"medium",cookie_lifetime:365}}};function n(){t.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS"),t.savedSettings=angular.copy(t.advancedSettings)}function a(){t.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")}t.savedSettings=null,t.timezone={failed:!1,records:[]},o.getAdvancedSettings().then(function(e){angular.isUndefined(e.cookie_notification.controls)&&angular.extend(e.cookie_notification,r),t.advancedSettings=e,t.savedSettings=angular.copy(e)},function(){t.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}),o.getTimezoneList().then(function(e){t.timezone.records=e.records},function(e){t.timezone.failed=!0,"COMMON.MESSAGES.FAILED_DEPENDENCY"===e.message&&t.systemMessenger.error("MODULE.SETTINGS.GENERAL.WEBSITE_TIMEZONE_ERROR_MESSAGE",e.data)}),t.save=function(){var e;t.advancedSettingsForm&&t.advancedSettingsForm.validate()&&(e=$("<div>"+t.advancedSettings.cookie_notification.content.trim()+"</div>"),i.transformLinks(e),2e3<e.text().length?(t.$broadcast("MotoEvent:MotoCkeditor.ShowValidationBalloon",{messageKey:"COMMON.VALIDATION_ERROR.STRING_LENGTH_TOO_LONG",messageParams:{maximum_character_count:2e3}}),0):(t.$broadcast("MotoEvent:MotoCkeditor.ClearValidationBalloon"),t.advancedSettings.cookie_notification.content=e.html(),1))&&o.setAdvancedSettings(t.advancedSettings).then(n,a)},t.reset=function(){t.advancedSettings=angular.copy(t.savedSettings),t.$broadcast("MotoEvent:MotoCkeditor.setData",t.advancedSettings.cookie_notification.content),t.advancedSettingsForm.clearErrors()}}]),app.settings.controller("application.settings.analytics.controllers.AnalyticsController",["$scope","application.settings.services.SettingsService",function(t,o){var i="website",r={};function n(e){angular.isString(e.yandex_metrica_counter)&&(e.yandex_metrica_counter=angular.fromJson(e.yandex_metrica_counter)),angular.isString(e.google_analytics)&&(e.google_analytics=angular.fromJson(e.google_analytics))}function a(e){n(e.website),t.savedSettings=angular.copy(e.website),t.analytics=e.website,t.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS")}function s(e){t.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")}t.savedSettings=null,o.get([i]).success(function(e){n(e),t.analytics=e||{},t.analytics.yandex_metrica_counter_id&&t.analytics.yandex_metrica_counter&&!t.analytics.yandex_metrica_counter.id&&(t.analytics.yandex_metrica_counter.id=t.analytics.yandex_metrica_counter_id),t.savedSettings=angular.copy(e),t.$broadcast("motoUI.update-fixed-panel")}).error(function(){t.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}),t.reset=function(){t.analytics=angular.copy(t.savedSettings),t.editAnalyticsForm.clearErrors()},t.save=function(){var e;t.editAnalyticsForm&&t.editAnalyticsForm.validate()&&(r[i]=angular.copy(t.analytics),e=r[i],angular.isObject(e.yandex_metrica_counter)&&(e.yandex_metrica_counter=JSON.stringify(e.yandex_metrica_counter)),angular.isObject(e.google_analytics)&&(e.google_analytics=JSON.stringify(e.google_analytics)),o.save(r).success(a).error(s))}}]),app.settings.controller("application.settings.code_injection.controllers.CodeInjectionController",["$rootScope","$scope","coreLibraryConfig","application.settings.services.SettingsService",function(e,t,o,i){function r(){t.savedSettings=angular.copy(t.codeInjectionsSettings),t.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS"),o.update("settings.website.custom_code_execution",t.savedSettings.execution),o.update("settings.website.widget_embed_execution",t.savedSettings.widget_embed_execution),e.websiteSettings.widget_embed_execution=t.savedSettings.widget_embed_execution}function n(){t.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")}i.getCodeInjections().success(function(e){t.codeInjectionsSettings=e,t.savedSettings=angular.copy(e),t.$broadcast("motoUI.update-fixed-panel")}).error(function(){t.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}),t.save=function(){t.codeInjectionForm&&t.codeInjectionForm.validate()&&i.setCodeInjections(t.codeInjectionsSettings).success(r).error(n)},t.reset=function(){t.codeInjectionsSettings=angular.copy(t.savedSettings),t.codeInjectionForm.clearErrors()}}]),app.settings.controller("application.settings.controllers.EditController",["$scope","$rootScope","application.settings.services.SettingsService","application.users.services.LanguagesModelService","application.media_library.services.MediaLibraryService","coreLibraryUtils","coreLibraryConfig",function(i,e,t,o,r,n,a){var s={};function l(e){return angular.isString(e.back_to_top_button)&&(e.back_to_top_button=angular.fromJson(e.back_to_top_button)),angular.isString(e.password_protection)&&(e.password_protection=angular.fromJson(e.password_protection),e.password_protection.enabled||(e.password_protection.password="")),e}function c(e){delete e.main_page,l(e),i.settings=e||{},i.settings.password_protection&&i.settings.password_protection.enabled&&(i.settings.password_protection.password=n.base64Decode(i.settings.password_protection.password)),i.settings.language_id=parseInt(i.settings.language_id),i.savedSettings=angular.copy(e),i.$broadcast("motoUI.update-fixed-panel")}function p(){i.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}function d(o){var e;i.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS"),e=a.get("settings.website"),angular.forEach(e,function(e,t){if(angular.isObject(e)&&o.website[t]&&angular.isString(o.website[t]))try{o.website[t]=angular.fromJson(o.website[t])}catch(e){}}),l(o.website),i.savedSettings.language_id=parseInt(i.savedSettings.language_id),i.savedSettings.password_protection&&i.savedSettings.password_protection.enabled&&(i.savedSettings.password_protection.password=n.base64Encode(i.savedSettings.password_protection.password)),i.savedSettings=angular.copy(i.settings),a.update("settings.website",o.website)}function u(e){i.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")}i.savedSettings=null,i.reset=function(){i.settings=angular.copy(i.savedSettings),i.settings.language_id=parseInt(i.settings.language_id),i.editSettingsForm.clearErrors()},i.titleFormatValues=["{{page.title}}","{{page.title}} | {{website.title}}","{{page.title}} - {{website.title}}"],i.languages=[],o.success(function(){i.languages=o.objects()}).error(function(){i.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(),i.get=function(){t.get(["website"]).success(c).error(p)},i.get(),i.save=function(){var e;i.editSettingsForm&&i.editSettingsForm.validate()&&(s.website=(e=angular.copy(i.settings),angular.isObject(e.password_protection)&&(e.password_protection.enabled||delete e.password_protection.password,e.password_protection&&e.password_protection.enabled&&(e.password_protection.password=n.base64Encode(e.password_protection.password)),e.password_protection=angular.toJson(e.password_protection)),e),t.save(s).success(d).error(u))},i.clearFavicon=function(){i.settings.favicon=""},i.changeFavicon=function(){r.open({value:i.settings.favicon,thumbnails:!0,filters:["image"],onApply:function(e,t){i.settings.favicon=t?e.getThumbnailPath(t):e.path}})}}]),app.settings.controller("application.settings.fonts.controllers.FontsController",["$scope","application.design.styles.services.FontsModel","application.design.styles.services.FontsService","coreLibraryModal","coreLibraryUtils","application.settings.services.FontsManagerService",function(i,r,n,e,t,a){function s(){i.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}i.totalItems=0,i.itemsPerPage=10,i.currentPage=1,i.tableItems=[],i.updateTable=function(){i.tableItems=function(e,t,o){var i,r;if(e)return r=(i=t*o)+o,e.slice(i,r)}(i.webFonts,i.currentPage-1,i.itemsPerPage),i.start=(i.currentPage-1)*i.itemsPerPage+1,i.end=i.start+i.tableItems.length-1,i.totalItems=i.webFonts.length,i.$broadcast("motoUI.update-fixed-panel")},i.updateWebFontsData=function(){r.success(function(){i.webFonts=r.objects(function(e){return"system"!==e.provider}),i.updateTable()}).error(s).load(!1)},i.updateWebFontsData(),i.addOrEditTableItem=function(t){e("views/application/settings/fonts/popup.tpl.html",function(o,e){o.activeVariants=[],o.activeSubsets=[],o.checkboxModels={variantsModel:{},subsetsModel:{}},o.isEditingMode=!!t,o.popupTitle=t?"COMMON.TEXT.EDIT_ITEM":"COMMON.TEXT.ADD_ITEM",o.isEditingMode?n.getById({id:t}).then(function(e){o.font=e,o.font.variants.forEach(function(e){o.checkboxModels.variantsModel[e]=-1<o.font.active_variants.indexOf(e)}),o.font.subsets.forEach(function(e){o.checkboxModels.subsetsModel[e]=-1<o.font.active_subsets.indexOf(e)}),o.activeVariants=o.font.active_variants,o.activeSubsets=o.font.active_subsets},s):(o.fontLanguages=a.getLanguagesList(),o.languageFilter=o.fontLanguages[0],o.setLanguageFilter=function(t){if(o.font={},o.setWebFont(),"all"===t.code)return o.webFonts=o.originalWebFonts;o.webFonts=o.originalWebFonts.filter(function(e){return-1<e.subsets.indexOf(t.code)})},a.getList().then(function(e){o.webFonts=e.filter(function(t){return 0===i.webFonts.filter(function(e){return e.name===t.name}).length}),o.originalWebFonts=angular.copy(o.webFonts)},s),o.font=r.newRecord()),o.toggleVariant=function(e){var t=o.activeVariants.indexOf(e);-1<t?o.activeVariants.splice(t,1):o.activeVariants.push(e)},o.toggleSubset=function(e){var t=o.activeSubsets.indexOf(e);-1<t?o.activeSubsets.splice(t,1):o.activeSubsets.push(e)},o.setWebFont=function(){o.activeSubsets=[],o.activeVariants=[],o.checkboxModels={subsetsModel:{},variantsModel:{}},angular.equals(o.font,{})||o.magicallyFillFontData()},o.magicallyFillFontData=function(){var e,t;e=-1<o.font.subsets.indexOf("latin")?"latin":o.font.subsets[0],t=-1<o.font.variants.indexOf("regular")?"regular":o.font.variants[0],o.activeSubsets.push(e),o.activeVariants.push(t),o.checkboxModels.subsetsModel[e]=!0,o.checkboxModels.variantsModel[t]=!0},o.ok=function(){o.font.family&&0!==o.activeSubsets.length&&0!==o.activeVariants.length&&(o.font.active_subsets=o.activeSubsets,o.font.active_variants=o.activeVariants,n.save(o.font).then(function(){i.updateWebFontsData(),e.close(o),o.isEditingMode?i.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS"):i.systemMessenger.success("COMMON.MESSAGES.CREATE_SUCCESS")},function(){o.isEditingMode?i.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR"):i.systemMessenger.error("COMMON.MESSAGES.CREATE_ERROR")}))}})},i.deleteTableItem=function(e){t.openConfirmationBox({yesHandler:function(){n.delete({id:e}).then(function(){i.systemMessenger.success("COMMON.MESSAGES.DELETE_SUCCESS"),i.updateWebFontsData()},function(){i.systemMessenger.error("COMMON.MESSAGES.DELETE_ERROR")})},question:"MODULE.SETTINGS.FONTS.DELETE_FONT_CONFIRMATION_TEXT"})}}]),angular.module("application.settings").service("application.settings.services.FontsManagerService",["jsonrpc",function(e){var t=e.newService("FontsManagerService");this.getList=t.createMethod("getList"),this.getLanguagesList=function(){return[{code:"all",name:"All Languages"},{code:"arabic",name:"Arabic"},{code:"bengali",name:"Bengali"},{code:"cyrillic",name:"Cyrillic"},{code:"cyrillic-ext",name:"Cyrillic Extended"},{code:"devanagari",name:"Devanagari"},{code:"greek",name:"Greek"},{code:"greek-ext",name:"Greek Extended"},{code:"gujarati",name:"Gujarati"},{code:"gurmukhi",name:"Gurmukhi"},{code:"hebrew",name:"Hebrew"},{code:"kannada",name:"Kannada"},{code:"khmer",name:"Khmer"},{code:"latin",name:"Latin"},{code:"latin-ext",name:"Latin Extended"},{code:"malayalam",name:"Malayalam"},{code:"myanmar",name:"Myanmar"},{code:"oriya",name:"Oriya"},{code:"sinhala",name:"Sinhala"},{code:"tamil",name:"Tamil"},{code:"telugu",name:"Telugu"},{code:"thai",name:"Thai"},{code:"vietnamese",name:"Vietnamese"}]}}]),angular.module("application.settings").controller("application.settings.integration.controllers.IntegrationController",["$scope","coreLibraryIntegration","application.widget.DisqusService","application.settings.services.SettingsService",function(t,o,e,i){t.disqusShortname=o.first("disqus").get("shortname",""),t.aviaryClientId=o.first("aviary").get("client_id",""),t.recaptcha={v2:o.first("recaptcha").get("v2",{key:"",secret_key:""})},t.googleMapApiKey=o.first("google_map").get("api_key",""),t.previousGoogleMapApiKey=t.googleMapApiKey,t.saveShortname=function(){e.setOptions({shortname:t.disqusShortname}).success(function(e){e.shortname=e.shortname||t.disqusShortname,o.first("disqus").set("shortname",e.shortname),t.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS")}).error(function(){t.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")})},t.saveAviaryClientId=function(){i.setIntegrationValue({type:"aviary",items:[{client_id:t.aviaryClientId}]}).success(function(e){o.first("aviary").set("client_id",e.client_id),t.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS")}).error(function(){t.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")})},t.saveRecaptchaKeys=function(){i.setIntegrationValue({type:"recaptcha",items:[t.recaptcha]}).then(function(e){o.first("recaptcha").set("v2",e.v2),t.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS")},function(){t.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")})},t.saveGoogleMapKey=function(){i.setIntegrationValue({type:"google_map",items:[{api_key:t.googleMapApiKey}]}).then(function(e){o.first("google_map").set("api_key",e.api_key),t.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS"),$.fn.motoGoogleMap.isSdkInjected()&&t.previousGoogleMapApiKey!==e.api_key?location.reload():$.fn.motoGoogleMap.setApiKey(e.api_key)},function(){t.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")})}}]),angular.module("application.settings").controller("application.settings.integration.controllers.LiveChatController",["$scope","coreLibraryIntegration","application.settings.services.SettingsService",function(t,e,o){var i={provider:"none",options:{visibility:{notFoundPage:!0,underConstructionPage:!0}},providers:{LiveChatInc:{licenceNumber:"",showOnlyAgentsAreAvailable:!1}}};t.currentSettings=null,t.settings=null,t.saveSettings=function(){if(!angular.isObject(t.settings))return console.warn("Settings is not Object"),!1;o.setLiveChatSettings(t.settings).then(function(e){t.currentSettings=e,t.settings=angular.copy(t.currentSettings),t.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS")},function(e){console.warn("Error while saving data",e),t.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")})},t.resetSettings=function(){t.settings=angular.copy(t.currentSettings)},o.getLiveChatSettings().then(function(e){angular.isObject(e)||(e=angular.copy(i)),t.currentSettings=e,t.settings=angular.copy(t.currentSettings)},function(e){console.warn("Error while getting data from server",e),t.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")})}]),app.settings.controller("application.settings.mail_options.controllers.MailOptionsController",["$scope","application.settings.services.SettingsService",function(t,e){function o(e){t.mailOptions=angular.copy(e),t.mailOptions.transport.parameters&&t.mailOptions.transport.parameters.connection_config&&(t.mailOptions.transport.parameters.connection_config.ssl=t.mailOptions.transport.parameters.connection_config.ssl||""),t.enabledUsingSMTP="Smtp"==t.mailOptions.transport.class,t.savedSettings=angular.copy(e),t.$broadcast("motoUI.update-fixed-panel")}function i(e){o(e),t.savedSettings=angular.copy(e),t.mailOptions.transport.parameters&&t.mailOptions.transport.parameters.connection_config&&(t.savedSettings.transport.parameters.connection_config.ssl=t.savedSettings.transport.parameters.connection_config.ssl||""),t.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS")}function r(){t.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")}t.savedSettings=null,t.toggleUsingSMTP=function(){t.mailOptions.transport.class=t.enabledUsingSMTP?"Smtp":"Sendmail",t.mailOptions.transport=t.mailOptions.transport||{},t.mailOptions.transport.parameters=t.mailOptions.transport.parameters||{connection_class:"login",connection_config:{}}},t.reset=function(){t.mailOptions=angular.copy(t.savedSettings),t.mailOptions.transport.parameters&&t.mailOptions.transport.parameters.connection_config&&(t.mailOptions.transport.parameters.connection_config.ssl=t.mailOptions.transport.parameters.connection_config.ssl||""),t.enabledUsingSMTP="Smtp"==t.mailOptions.transport.class,t.mailOptionsForm.clearErrors()},e.getDefaultMailOptions().success(o).error(function(){t.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}),t.save=function(){t.mailOptionsForm&&t.mailOptionsForm.validate()&&e.setDefaultMailOptions(t.mailOptions).success(i).error(r)}}]),app.settings.controller("application.settings.redirects.RedirectsController",["$scope","application.settings.services.SettingsService","coreLibraryModal","coreLibraryUtils",function(i,e,o,t){i.totalItems=0,i.itemsPerPage="10",i.currentPage=1,i.tableItems=[],e.getRedirection().success(function(e){i.redirects=e.rules,i.initialRedirects=angular.copy(i.redirects),i.updateTable()}).error(function(){i.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}),i.updateTable=function(){i.tableItems=function(e,t,o){var i,r;if(o=parseInt(o),e)return r=(i=t*o)+o,e.slice(i,r)}(i.redirects,i.currentPage-1,i.itemsPerPage),i.start=(i.currentPage-1)*i.itemsPerPage+1,i.end=i.start+i.tableItems.length-1,i.totalItems=i.redirects.length,i.$broadcast("motoUI.update-fixed-panel")},i.deleteTableItem=function(e){t.openConfirmationBox({yesHandler:function(){i.redirects.splice(e,1),i.updateTable()},question:"MODULE.SETTINGS.REDIRECTS.DELETE_REDIRECT_CONFIRMATION_TEXT"})},i.save=function(){e.setRedirection({rules:i.redirects}).success(function(){i.initialRedirects=angular.copy(i.redirects),i.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS")}).error(function(){i.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")})},i.reset=function(){i.redirects=angular.copy(i.initialRedirects),i.updateTable()},i.addTableItem=function(){o("views/application/settings/redirects/add_redirect.tpl.html",function(o,e){o.redirect={source:{url:"",type:"wildcard"},target:{url:"",type:"wildcard"}},o.ok=function(){o.addRedirectForm.validate()&&(i.redirects.unshift(o.redirect),i.updateTable(),e.close(o))},o.setWildcard=function(e,t){o.redirect[e].type=t?"url":"wildcard"}}),i.updateTable()},i.editTableItem=function(t){o("views/application/settings/redirects/edit_redirect.tpl.html",function(o,e){o.redirect=angular.copy(i.redirects[t]),o.sourceRedirectWildcard="url"==o.redirect.source.type,o.targetRedirectWildcard="url"==o.redirect.target.type,o.ok=function(){o.editRedirectForm.validate()&&(i.redirects[t]=o.redirect,i.updateTable(),e.close(o))},o.setWildcard=function(e,t){o.redirect[e].type=t?"url":"wildcard"}}),i.updateTable()}}]),app.settings.controller("application.settings.seo.controllers.SeoController",["$rootScope","$scope","coreLibraryConfig","coreLibraryUtils","coreLibraryModal","application.settings.services.SettingsService","application.settings.services.SitemapService",function(e,i,t,o,r,n,a){var s={"@main_page":"COMMON.TEXT.HOME_PAGE",page:"COMMON.TEXT.PAGES","blog.index":"COMMON.TEXT.BLOG_MAIN_PAGE","blog.post":"COMMON.TEXT.BLOG_POSTS","blog.category":"COMMON.TEXT.BLOG_CATEGORIES","blog.tag":"COMMON.TEXT.BLOG_TAGS"};function l(){i.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}function c(e){i.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS"),i.savedSettings=angular.copy(i.seoSettings),t.extend("settings.website",e.website)}function p(){i.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")}n.getSeoOptions().then(function(e){i.seoSettings=e,i.externalSitemaps=e.sitemap.external_sitemaps,i.sitemapContentPrefs=e.sitemap.content_preferences,i.savedSettings=angular.copy(e),i.$broadcast("motoUI.update-fixed-panel")},l),a.getInfo().then(function(e){i.sitemapInfo=e},l),i.changePermalinks=function(){i.seoSettings.website.permalinks||(i.seoSettings.website.suffix=!1)},i.save=function(){i.seoSettingsForm&&i.seoSettingsForm.validate()&&n.setSeoOptions(i.seoSettings).then(c,p)},i.generateSitemap=function(e){a.generateAll({confirmed:e}).then(function(e){i.systemMessenger.success("COMMON.MESSAGES.CREATE_SUCCESS"),i.sitemapInfo=e},function(e){return angular.isObject(e)?409!==e.code?424===e.code&&e.data&&angular.isArray(e.data.errors)?("WEBSITE_DIR_NOT_WRITABLE"===e.data.errors[0]&&i.systemMessenger.error("MODULE.SETTINGS.SEO.SITEMAP_WEBSITE_DIR_NOT_WRITABLE_ERROR"),"PRIMARY_FILE_NOT_WRITABLE"===e.data.errors[0]&&i.systemMessenger.error("MODULE.SETTINGS.SEO.SITEMAP_PRIMARY_FILE_NOT_WRITABLE_ERROR"),void("NOT_ENOUGH_SPACE"===e.data.errors[0]&&i.systemMessenger.error("COMMON.MESSAGES.CREATE_NOT_ENOUGH_SPACE_ERROR"))):void i.systemMessenger.error("COMMON.MESSAGES.CREATE_ERROR"):void o.openConfirmationBox({question:"MODULE.SETTINGS.SEO.REWRITE_SITEMAP_QUESTION",yesHandler:function(){i.generateSitemap(!0)},noHandler:angular.noop}):p()})},i.saveAndGenerateSitemap=function(){i.seoSettingsForm&&i.seoSettingsForm.validate()&&n.setSeoOptions(i.seoSettings).then(function(e){c(e),i.generateSitemap()},p)},i.getContentTypeLabel=function(e){return s[e.type]||e.label||""},i.reset=function(){i.seoSettings=angular.copy(i.savedSettings),i.externalSitemaps=angular.copy(i.savedSettings.sitemap.external_sitemaps),i.sitemapContentPrefs=angular.copy(i.savedSettings.sitemap.content_preferences),i.seoSettingsForm.clearErrors()},i.addOrEditExternalSitemap=function(o){r("views/application/settings/seo/external_sitemap_popup.tpl.html",function(e,t){e.isEditingMode=void 0!==o,e.url=e.isEditingMode?i.seoSettings.sitemap.external_sitemaps[o]:"",e.ok=function(){e.externalSitemapForm.validate()&&(e.isEditingMode?i.externalSitemaps[o]=e.url:i.externalSitemaps.unshift(e.url),t.close(e))}},null,"modal-with-ckeditor")},i.deleteExternalSitemap=function(e){o.openConfirmationBox({yesHandler:function(){i.externalSitemaps.splice(e,1)},question:"MODULE.SETTINGS.SEO.DELETE_EXTERNAL_SITEMAP_CONFIRMATION_TEXT"})}}]),angular.module("application.settings").service("application.settings.services.SettingsService",["jsonrpc","coreLibraryConfig",function(e,t){var o=e.newService("SettingsService");this.get=o.createMethod("get"),this.save=o.createMethod("save"),this.getCodeInjections=o.createMethod("getCodeInjections"),this.setCodeInjections=o.createMethod("setCodeInjections"),this.getDefaultMailOptions=o.createMethod("getDefaultMailOptions"),this.setDefaultMailOptions=o.createMethod("setDefaultMailOptions"),this.setIntegrationValue=o.createMethod("setIntegrationValue"),this.getLiveChatSettings=o.createMethod("getLiveChatSettings"),this.setLiveChatSettings=o.createMethod("setLiveChatSettings"),this.setSystemEngine=o.createMethod("setSystemEngine"),this.getMainPageId=function(){try{return parseInt(t.get("settings.website.main_page"))}catch(e){}return 0},this.getWebsiteAddress=function(){try{return t.get("settings.website.address")}catch(e){}return"/"},this.getRedirection=o.createMethod("getRedirection"),this.setRedirection=o.createMethod("setRedirection"),this.getTimezoneList=o.createMethod("getTimezoneList"),this.getSeoOptions=o.createMethod("getSeoOptions"),this.setSeoOptions=o.createMethod("setSeoOptions"),this.getAdvancedSettings=o.createMethod("getAdvancedSettings"),this.setAdvancedSettings=o.createMethod("setAdvancedSettings")}]),angular.module("application.settings").service("application.settings.services.SitemapService",["jsonrpc",function(e){var t=e.newService("SitemapService");this.getInfo=t.createMethod("getInfo"),this.generateAll=t.createMethod("generateAll")}]),angular.module("application.settings").component("motoUpdatesAvailablePanel",{templateUrl:"views/application/settings/updates/updates_available_panel.tpl.html",controller:["$rootScope","$state","application.settings.updates.services.UpdatesService","motoUI.MenuService","ipCookie","coreLibraryConfig",function(e,t,o,r,n,a){var s={name:"ignore_release",expirationDays:10},l={name:"ignore_update",expirationDays:1};this.isPanelVisible=!1,this.state=t,this.checkReleaseUpdates=function(){o.getInfo().then(function(e){var t,o,i=a.get("settings.website.theme");e&&(this.themeUpdates=e.themes,(i&&this.themeUpdates&&this.themeUpdates[i]||e.engine.update||(t=e.plugins,o=!1,angular.forEach(t,function(e){angular.isObject(e.next)&&(o=!0)}),o))&&(r.getMenu("main_menu").getItem("settings").update({indicate:!0}),r.getMenu("settings_menu").getItem("updates").update({indicate:!0})),n(l.name)||(this.updates=e.engine,this.updates.last&&this.updates.last.build&&this.updates.last.build!==n(s.name)&&(this.isPanelVisible=!0)))}.bind(this))},this.ignoreUpdate=function(){n(l.name,1,{expires:l.expirationDays}),this.isPanelVisible=!1},this.ignoreRelease=function(){this.updates.last&&this.updates.last.build&&n(s.name,this.updates.last.build,{expires:s.expirationDays}),this.isPanelVisible=!1},this.checkReleaseUpdates()}]}),angular.module("application.settings").controller("application.settings.updates.controllers.UpdatesController",["$rootScope","$scope","$translate","application.settings.updates.services.UpdatesService","application.settings.updates.services.ThemesService","coreLibraryAccounts","coreLibraryModal","motoBrand","$window","coreLibraryPathResolver","motoFeatures","$sce","$interpolate",function(e,i,o,r,t,n,a,s,l,c,p,d,u){function g(){t.getList().then(function(e){e.records&&(i.themes=e.records)},function(){i.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")})}function m(){r.getInfo().then(function(e){var t;e&&(i.updatesInfo=e,i.data=e.engine,i.accountAuthUrl=n.getAuthUrl(e.productInformation),i.isExistsAnyUpdates=function(e){var t=!1,o="";if(e.engine&&(t=!!e.engine.update),e.themes)if(angular.isArray(e.themes))t|=!!e.themes.length;else if(angular.isObject(e.themes))for(o in e.themes)e.themes.hasOwnProperty(o)&&angular.isString(e.themes[o].version)&&(t=!0);return e.plugins&&angular.forEach(e.plugins,function(e){angular.isObject(e.next)&&(t=!0)}),t}(e),i.subscriptionData=e.subscription,i.updatesInfo.informers=function(e){var t;for(t in e)"html"===e[t].type&&(e[t].content=d.getTrustedHtml(u(e[t].content)(i)));return e}(i.updatesInfo.informers),angular.isArray(e.plugins)&&0<e.plugins.length&&(i.pluginUpdates=(t=e.plugins,t=angular.copy(t),angular.forEach(t,function(e){e._inMemory=o.instant(e.description_short)!==e.description_short}),t)))},function(){i.serverError=!0,i.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).finally(g)}i.accountAuthUrl=null,i.authFrame=null,i.isNeedAuthOnAccount=!1,i.isExistsAnyUpdates=!1,i.showSubscription=p.isEnabled("engine_subscription"),i.themesUrl=c.getUrl("@themes"),i.pluginUpdates=null,"motocms"===s.getName()?i.isNeedAuthOnAccount=n.isExpiredToken():i.showSubscription=!1,i.getThemeThumbnailUrl=function(e){return i.themesUrl+e+"/preview.png"},i.showPluginInfoPopup=function(t){a("views/application/settings/updates/plugin_info_popup.tpl.html",function(e){e.pluginInfo=t,e.getPreviewImageUrl=i.getPreviewImageUrl},null,"modal-plugin-info")},i.getPreviewImageUrl=function(e,t){var o,i;return angular.isString(t)||(t=""),""===(t=t.trim())&&(t="small"),i=e["preview_"+t],angular.isString(i)&&""!==i?(o="@"===i[0]?i:e.folder+"/"+i,c.getUrl(o)):null},m(),i.getUpdate=function(e){i.isDemoMode?i.systemMessenger.warning("DEMO_MODE.WARNING_MESSAGE.ACCESS_DENIED"):r.installNow(i,e)},i.installPluginUpdate=function(t,o){i.isDemoMode?i.systemMessenger.warning("DEMO_MODE.WARNING_MESSAGE.ACCESS_DENIED"):r.getActionsForUpdate({update:o}).then(function(e){r.installNow(i,o,{updateSteps:e.steps,onFinish:t.activated?"reload":"return"}).then(function(){console.log("Plugin ",t,"updated"),m()})})},i.authorizeIntoAccounts=function(){if(!i.accountAuthUrl)return console.error("$scope.accountAuthUrl not loaded yet"),!1;i.authFrame=a.iframe(i.accountAuthUrl,{windowClass:"moto-iframe-window_accounts",autoFocus:!0,enableLoader:!0})},i.activateEnabled=function(){return app.config.moto||i.$motoFeatures.isEnabled("dev_allow_theme_activation")},i.activateTheme=function(e){i.activateEnabled()&&t.activate({name:e}).then(function(){i.systemMessenger.success("MODULE.DESIGN.THEMES.THEME_ACTIVATION_SUCCESS_MESSAGE"),l.location.reload()},function(){i.systemMessenger.error("MODULE.DESIGN.THEMES.THEME_ACTIVATION_ERROR_MESSAGE")})},i.hasUpdates=function(e){return!!i.updatesInfo&&e in i.updatesInfo.themes},i.updateTheme=function(e,t){i.updatesInfo&&(parseInt(i.updatesInfo.engine.build)<parseInt(i.updatesInfo.themes[e].min_engine_build)?i.systemMessenger.error("MODULE.DESIGN.THEMES.PRODUCT_VERSION_COMPATIBILITY_ERROR_MESSAGE",{},2e4):r.UpdateTheme(i,e,t))},i.getStatusClass=function(){if(i.subscriptionData&&i.subscriptionData.statusId)switch(i.subscriptionData.statusId){case"ACTIVE":return"moto-ui-badge_2";case"FREE_FIRST_YEAR":case"FREE_LIFETIME":return"moto-ui-badge_1";case"EXPIRED":return"moto-ui-badge_3"}return""},e.$on("$motoAccounts.AccessTokenWasChanged",function(e,t){i.isNeedAuthOnAccount=n.isExpiredToken(),i.authFrame&&(i.authFrame.close(),i.authFrame=null),null===i.$$phase&&i.$apply()})}]),angular.module("application.settings").service("application.settings.updates.services.ThemesService",["jsonrpc",function(e){var t=e.newService("ThemesService");this.getList=t.createMethod("getList"),this.activate=t.createMethod("activate"),this.download=t.createMethod("download"),this.install=t.createMethod("install")}]),angular.module("application.settings").service("application.settings.updates.services.UpdatesService",["jsonrpc","coreLibraryModal","motoUI.BrowserTabCloseConfirmation","$window","$q","coreLibraryAccounts",function(e,o,d,u,i,g){var m=this,t=e.newService("UpdatesService","update/api.php");m.getInfo=t.createMethod("getInfo"),m.getUpdate=t.createMethod("getUpdate"),m.install=t.createMethod("install"),m.download=t.createMethod("download",{ignoreLoadingBar:!0}),m.executeAction=t.createMethod("executeAction",{ignoreLoadingBar:!0}),m.getActionsForUpdate=t.createMethod("getActionsForUpdate"),m.installNow=function(t,s,l){var c=i.defer();function p(){history.pushState(null,null,document.URL),t.systemMessenger.warning("MODULE.SETTINGS.UPDATES.UPDATE_IN_PROGRESS_WARNING_MESSAGE")}return angular.isObject(l)||(l={}),history.pushState(null,null,document.URL),u.addEventListener("popstate",p),d.enable(),o("views/application/settings/updates/update.tpl.html",function(o,e){var i=null;function r(e){i=null,angular.isObject(e)&&angular.isObject(e.next)&&(i=e.next.params),o.currentStep++,o.updateActions[o.currentStep]?a(o.updateActions[o.currentStep]):d.disable()}function n(e){t.systemMessenger.error("MODULE.SETTINGS.UPDATES.UPDATE_ERROR_MESSAGE"),e.data&&e.data.errors&&(o.errors=e.data.errors)}function a(t){if("downloadArchive"===t)return m.download({token:g.getAccessToken(),update:s}).then(function(e){!angular.isObject(e)||e.downloaded?(o.currentStep=1,a(o.updateActions[o.currentStep])):a(t)},n);m.executeAction({action:t,params:i,update:s}).then(r,n)}o.updateActions=["downloadArchive","checkRequirements","extractArchive","checkFiles","enableMaintenance","createBackup","updateFiles","updateDatabase","cleanCache","optimizeStyles","rebuildStyles","disableMaintenance","finishUpdate","saveCurrentBuild"],angular.isArray(l.updateSteps)&&(o.updateActions=angular.copy(l.updateSteps)),o.currentStep=0,o.errors=[],o.retryAction=function(){o.errors=[],a(o.updateActions[o.currentStep])},o.finishUpdate=function(){if("return"===l.onFinish)return e.close(),void c.resolve(!0);u.location.reload()},a("downloadArchive"),o.cancel=function(){d.disable(),u.removeEventListener("popstate",p),c.reject(),e.close()}},null,"install-update-modal",null,!0),c.promise},m.UpdateTheme=function(a,s,l){o("views/application/settings/updates/theme_update.tpl.html",function(t,e){function o(e){a.systemMessenger.error("MODULE.SETTINGS.UPDATES.UPDATE_ERROR_MESSAGE"),e.data&&e.data.errors&&(t.errors=e.data.errors,t.currentStep="errors")}function i(e){!angular.isObject(e)||e.downloaded?t.installUpdate():t.downloadUpdate()}function r(e){a.systemMessenger.error("MODULE.SETTINGS.UPDATES.UPDATE_ERROR_MESSAGE"),e.data&&e.data.errors&&(t.errors=e.data.errors,t.currentStep="errors")}function n(){t.currentStep=3}angular.element("body.app").addClass("hide-spinner"),t.currentStep=1,t.downloadUpdate=function(){t.errors=null,t.currentStep=1,t.process="download",m.download({type:"theme",name:s,token:g.getAccessToken(),update:l}).then(i,o)},t.installUpdate=function(){t.errors=null,t.currentStep=2,t.process="install",m.install({type:"theme",name:s,update:l}).then(n,r)},t.afterUpdate=function(){u.location.reload()},t.downloadUpdate(),t.cancel=function(){e.close(),angular.element("body.app").removeClass("hide-spinner")}},null,"install-update-modal")}}]),app.users.provider("application.users.services.RolesModelService",[function(){this.$get=["application.users.services.RolesService",function(e){return Model.register("Roles",{proxy:{service:e},record:{id:Model.fields.integer(),name:Model.fields.string()}}),Model("Roles").load(!1)}]}]),app.users.service("application.users.services.RolesService",["jsonrpc",function(e){var t=e.newService("RolesService");this.getList=t.createMethod("getList")}]),app.users.provider("application.users.services.UsersModel",[function(){this.$get=["application.users.services.UsersService","application.users.services.RolesModelService","application.users.services.LanguagesModelService",function(e,t,o){return Model.register("Users",{proxy:{service:e},record:{id:Model.fields.integer(),name:Model.fields.string(),login:null,email:Model.fields.string(),enabled:Model.fields.bool(),set _status(e){this.enabled="1"===e},get _status(){return this.enabled?"1":"0"},del:Model.fields.bool(),role_id:Model.fields.integer(),role:function(){return t.getByField("id",this.role_id)},language_id:Model.fields.integer(),language:function(){return o.getByField("id",this.language_id)},password:null,salt:null,_selected:!1},setSelected:function(t){this.forEach(function(e){e._selected=t})},selectedUsers:function(){return this.filter(function(e){return e._selected})},isSelected:function(){var e,t=!1;for(e=0;e<this.length;e++)if(this[e]._selected){t=!0;break}return t},selectedIds:function(){var t=[];return this.forEach(function(e){e._selected&&t.push(e.id)}),t},assignToUsers:function(t){return this.filter(function(e){return Array.isArray(t)?t.indexOf(e.id)<0:e.id!=t})},usersInRole:function(){var t={};return this.forEach(function(e){t.hasOwnProperty(e.role_id)?t[e.role_id]++:t[e.role_id]=1}),t}}),Model("Users").load(!1)}]}]),app.users.service("application.users.services.UsersService",["jsonrpc",function(e){var t=e.newService("UsersService");this.getList=t.createMethod("getList"),this.getById=t.createMethod("getById"),this.save=t.createMethod("save"),this.changePassword=t.createMethod("setPassword"),this.delete=t.createMethod("delete"),this.changeRole=t.createMethod("changeRole"),this.setStatus=t.createMethod("setStatus")}]),angular.module("moto.directive",[]),angular.module("moto.directive").directive("motoAutoFocus",["$timeout",function(r){return{restrict:"A",priority:1e3,link:function(e,t,o){var i;try{i=angular.fromJson(o.motoAutoFocus).delay}catch(e){}r(function(){var e=t[0];e.focus&&e.focus(),e.selectionStart=e.selectionEnd=e.value?e.value.length:0},i||500)}}}]),angular.module("moto.directive").directive("motoConvertToNumber",[function(){function r(e){return parseInt(e,10)}function n(e){return""+e}return{require:"ngModel",link:function(e,t,o,i){i.$parsers.push(r),i.$formatters.push(n)}}}]),angular.module("moto.directive").directive("motoDefaultValue",function(){return{restrict:"A",priority:451,require:"ngModel",link:function(e,t,o,i){var r;r=function(){i.$modelValue||(t.val(o.motoDefaultValue),i.$setViewValue(o.motoDefaultValue)),e.$$phase||e.$apply()},o.$observe("motoDefaultValue",r),t.bind("blur",r),e.$on("$destroy",function(){t.unbind("blur",r)})}}}),angular.module("moto.directive").directive("motoEventLast",function(){return{restrict:"A",link:function(e,t,o){o.motoEventLast&&e.$last&&e.$evalAsync(function(){e.$emit(o.motoEventLast,e,t,o)})}}}),angular.module("moto.directive").filter("motoFileSize",["coreLibraryUtils",function(t){return function(e){return angular.isNumber(e)&&(e=t.fileSize(e).replace(/\.00/,"")),e}}]),angular.module("moto.directive").directive("motoInitSortable",[function(){return{restrict:"A",scope:{sortableItems:"=motoInitSortable",placeholderClass:"<sortablePlaceholderClass",onStartSorting:"<onStartSorting",onChangeSorting:"<onChangeSorting",onStopSorting:"<onStopSorting"},link:function(o,e){var i,r,n,a,s,l;angular.isArray(o.sortableItems)&&(e.sortable({placeholder:o.placeholderClass||"sortable-place-highlight",cursor:"move",start:function(e,t){i=t.item.attr("item-id"),r=$(this).sortable("toArray",{attribute:"item-id"}),n=r.indexOf(i),l=o.sortableItems[n],angular.isFunction(o.onStartSorting)&&o.onStartSorting({item:l,itemId:i,itemNode:t.item,currentIndex:n,currentIndexes:r})},change:function(e,t){angular.isFunction(o.onChangeSorting)&&(a=$(this).sortable("toArray",{attribute:"item-id"}),s=a.indexOf(i),o.onChangeSorting({item:l,itemId:i,itemNode:t.item,newIndex:n,newIndexes:a,previousIndex:n,previousIndexes:r}))},stop:function(e,t){a=$(this).sortable("toArray",{attribute:"item-id"}),s=a.indexOf(i),l=o.sortableItems[n],s!==n&&(o.sortableItems.splice(n,1),o.sortableItems.splice(s,0,l)),angular.isFunction(o.onStopSorting)&&o.onStopSorting({item:l,itemId:i,itemNode:t.item,newIndex:s,newIndexes:a,previousIndex:n,previousIndexes:r}),o.$$phase||o.$apply()}}),o.$on("$destroy",function(){e.sortable("destroy")}))}}}]),angular.module("moto.directive").directive("motoInputCounter",["$compile",function(r){return{restrict:"A",scope:{ngModel:"<"},link:function(e,t,o){var i=r('<span class="moto-input-counter" style="display:none"><span class="moto-input-counter-current">{{ ngModel.length }}</span>/<span class="moto-input-counter-max" ng-class="{\'moto-input-counter-max_warning\' : ngModel.length >= maxChars}">{{ maxChars }}</span></span>')(e);e.maxChars=parseInt(o.maxlength)||1/0,t.after(i),t.on("focus",function(){i.show()}),t.on("blur",function(){i.hide()})}}}]),angular.module("moto.directive").directive("motoMaskInput",["$timeout",function(s){return{priority:450,restrict:"A",require:"ngModel",link:function(e,t,o,i){var r,n;o.ngTrim||o.$set("ngTrim","false");try{r=e.$eval(o.motoMaskInput)}catch(e){r=o.motoMaskInput}function a(){var e=null;i.$setViewValue(i.$modelValue),s(function(){this.selectionStart&&this.selectionEnd&&this.setSelectionRange&&(e={start:this.selectionStart}),t.val()!=i.$modelValue&&(t.val(i.$modelValue),e&&this.setSelectionRange(e.start-1,e.start-1))}.bind(this),0)}!r||r.length<1||(n=new RegExp("(["+r+"]+)","g"),i.$parsers.push(function(e){return e&&(e=e.replace(n,"")),e}),t.bind("input propertychange",a),e.$on("$destroy",function(){t.unbind("input propertychange",a)}))}}}]),angular.module("moto.directive").filter("motoStripTags",[function(){return function(e){var t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}}]),angular.module("moto.directive").directive("motoSortableWidgets",[function(){return{restrict:"A",link:function(o,e){var i,r;e.sortable({placeholder:"sortable-place-highlight",cursor:"move",start:function(e,t){i=o.MotoEditor.getWidgetById(t.item.attr("item-id")),r=i.getPositionIndexInContainer()},stop:function(){var e;e=$(this).sortable("toArray",{attribute:"item-id"}).indexOf(i.getId()),r!==e&&(r<e&&e++,o.MotoEditor.ContentManager.insertOrMoveWidgetByOptions({droppedWidgetOptions:{widget:i,widgetName:i.name},targetConfig:{targetWidgetId:i._parent.getId(),indexInContainer:e}}))}}),o.$on("$destroy",function(){e.sortable("destroy")})}}}]),angular.module("moto.directive").directive("motoSrcObserver",function(){return{restrict:"A",link:function(e,t,o){var i;function r(){if(angular.isDefined(o.motoErrorSrc)&&o.src!==o.motoErrorSrc&&o.$set("src",app.config.getPath(o.motoErrorSrc)),angular.isDefined(o.onMotoErrorSrc)){try{e.$eval(o.onMotoErrorSrc)}catch(e){}e.$$phase||e.$apply()}i()}function n(){if(angular.isDefined(o.onMotoLoadSrc)){try{e.$eval(o.onMotoLoadSrc)}catch(e){}e.$$phase||e.$apply()}i()}t.on("error",r),t.on("load",n),i=function(){t.off("error",r),t.off("load",n)},e.$on("$destroy",i)}}}),angular.module("moto.directive").filter("motoTruncateString",function(){return function(e,t,o){return o=o||"...",(isNaN(t)||t<o.length+1)&&(t=10),e.length>t&&(e=e.substr(0,t-o.length)+o),e}}),angular.module("core.library.tutorial").directive("motoTutorialButton",["coreLibraryTutorial",function(i){return{restrict:"E",scope:!0,template:'<a ng-show="enabled" class="view-site" ng-click="openModal()"><span class="tutorial"><i class="tutorial-icon fa fa-book" data-uk-tooltip="{pos: \'bottom-right\', cls: \'general-tip\'}" title="{{ \'COMMON.BUTTON.TUTORIAL\' | translate }}"></i>{{ \'COMMON.BUTTON.TUTORIAL\' | translate}}</span></a>',link:function(o,e,t){o.enabled=i.isEnabled(),o.openModal=function(){i.open(t.section)},o.$on("tutorialStatusChanged",function(e,t){o.enabled=t})}}}]),angular.module("moto.directive").directive("motoUrlInputFilter",function(){return{restrict:"A",priority:500,require:"ngModel",link:function(e,i,t,r){var o=e.$eval(t.motoUrlInputFilter);function n(e){return o.clear_protocol&&(e=e.replace(/^.*\/\//,"/")),o.clear_domain&&(e=e.replace(/^\/?((?=[a-z0-9-]{1,63}\.)(xn--)?[a-z0-9]+(-[a-z0-9]+)*\.)+([a-z]{2,63})(:[0-9]+)?/,function(){return 0<=$.inArray(arguments[4],["htm","html","php"])?arguments[0]:""})),o.clear_start_dot&&(e=e.replace(/^\.+/,"")),e}function a(){var e,t,o;i.is(":focus")&&(o=n(r.$modelValue),e=i.val().length-o.length,t=i[0].selectionStart-e,i.val(o),r.$setViewValue(o),i[0].setSelectionRange(t,t))}function s(){var e;e=n(r.$modelValue),i.val(e),r.$setViewValue(e)}i.bind("blur",s),i.closest("form").bind("submit",a),e.$on("$destroy",function(){i.unbind("blur",s),i.closest("form").unbind("submit",a)})}}}),angular.module("motoUI.ckeditor",["core.library.scriptsInjector","core.library.utils","core.library.languages","core.library.config"]).run(["ScriptsInjector","MotoCkeditor",function(e,t){e.addScript("ckeditor",function(){return $("<script><\/script>").attr("id","ckeditor_script").attr("src",t.getScriptSrc())})}]),angular.module("motoUI",["kr.ngNamespaceUrl","motoUI.Menu","motoUI.selectIcon","motoUI.ckeditor","motoUI.stepper","ui.bootstrap.datetimepicker"]).config(["$namespaceUrlProvider",function(e){e.setResource({name:"motoUI",src:"js/src/motoUI"})}]),angular.module("motoUI.Menu",["core.library.utils"]),angular.module("motoUI.selectIcon",["core.library.utils","core.library.config"]),angular.module("motoUI").directive("motoUiBackgroundImage",["application.media_library.services.MediaLibraryService",function(s){return{restrict:"E",priority:500,require:"ngModel",templateUrl:"@motoUI/background_image/background_image.tpl.html",link:function(o,e,t,i){var r,n=t.key,a=o.$eval(t.onCleanImage)||angular.noop;n&&(r=n.split(".")),o.clearImage=function(){delete o.properties["background-image"],delete o.properties["background-size"],delete o.properties["background-position"],delete o.properties["background-repeat"],a()},o.changeImage=function(){s.open({value:o.properties["background-image"],thumbnails:!0,filters:["image"],onApply:function(e,t){e&&(o.properties["background-image"]=t?e.getThumbnailPath(t):e.path,o.properties["background-size"]||(o.properties["background-size"]="auto"),o.properties["background-position"]||(o.properties["background-position"]="left top"),o.properties["background-repeat"]||(o.properties["background-repeat"]="no-repeat"))}})},o.isEmptyBackgroundImage=function(){var e=!o.properties;return e||(e=!o.properties["background-image"]||"none"==o.properties["background-image"]),e},i.$formatters.push(function(e){if(e)switch(o.properties=function(e,t){var o;if(t)for(o=0;o<t.length;o++)e=e[t[o]];return e}(e,r),"none"===o.properties["background-image"]&&o.clearImage(),o.properties["background-position"]){case"center center":o.properties["background-position"]="center";break;case"center top":o.properties["background-position"]="top";break;case"right center":o.properties["background-position"]="right";break;case"center bottom":o.properties["background-position"]="bottom";break;case"left center":o.properties["background-position"]="left"}})}}}]),angular.module("motoUI").provider("motoUI.BrowserTabCloseConfirmation",function(){var o,t,i,r=null,n={messageKey:""};function e(){return t.instant(n.messageKey)}function a(){return r?r()?e():void 0:e()}return{enable:(o=new function(){var o=this;o.isEnabled=!1,o.statesObservation=null,o.enable=function(e){o.isEnabled||(angular.element(window).on("beforeunload",a),o.isEnabled=!0,e&&e.isChangedFunction&&(r=e.isChangedFunction))},o.disable=function(){o.isEnabled&&(angular.element(window).off("beforeunload",a),o.isEnabled=!1,r=null)},o.enableStatesObservation=function(){o.statesObservation||(o.statesObservation=i.$on("$stateChangeSuccess",function(e,t){t.motoParams&&t.motoParams.confirmBrowserTabClose?o.enable():o.disable()}))},o.disableStatesObservation=function(){o.statesObservation&&o.statesObservation()},o.setOption=function(e,t){n[e]=t},o.getOption=function(e){return n[e]},o.configure=function(e){t=e.$translate,i=e.$rootScope}}).enable,disable:o.disable,setOption:o.setOption,getOption:o.getOption,$get:["$translate","$rootScope","coreLibraryUtils",function(e,t){return o.configure({$translate:e,$rootScope:t}),o}]}}),angular.module("motoUI.ckeditor").directive("motoCkeditor",["$translate","MotoCkeditor","coreLibraryUtils",function(f,h,y){return{restrict:"A",template:'<textarea class="moto-ckeditor-textarea"></textarea>',require:"ngModel",link:function(e,t,a,o){var i,s,r,n,l,c=(new Date).getTime(),p=window.app.config;function d(){l.contents().find("body").css("max-width",l.parent().css("width"))}function u(){angular.element("#cke_"+s).find(".balloon").remove(),t.closest(".form-group_ckeditor").removeClass("group-not-valid")}function g(){var e,t=l.contents(),o=t.find("body");o&&!o.hasClass("moto-widget-text")&&(o.addClass("moto-widget-text").css("max-width",l.parent().css("width")),(e=t.find("head")).append($("<link/>",{rel:"stylesheet",href:p.getUrl("@systemIncludes/css/font-awesome.min.css?_time="+c)})),e.append($("<link/>",{rel:"stylesheet",href:p.getUrl("@currentTheme/css/styles.css?_time="+c)})),e.append($("<link/>",{rel:"stylesheet",href:p.getUrl("@userStylesFile?_time="+c)})),e.append($("<link/>",{rel:"stylesheet",href:p.getUrl("@userFontsFile?_time="+c)})))}function m(){try{o.$setViewValue(n.getData()),e.$$phase||e.$apply()}catch(e){}}(i=t.find(">textarea")).uniqueId(),s=i.attr("id"),window.addEventListener("resize",d),u(),r={on:{instanceReady:function(){l=angular.element(n.element.$).next().find(".cke_wysiwyg_frame"),g(),l.on("load",g),l.addClass("frame-preview_desktop"),$("#cke_"+s).addClass("form-control-container"),l.closest(".cke_inner").addClass("form-control")}}},a.removePlugins&&(r.removePlugins=a.removePlugins),"disableAutoFocus"in a&&(r.startupFocus=!1),(r=angular.extend({},h.getBaseConfig(),r)).extraPlugins+=",motobgswitcher",a.extraPlugins&&(r.extraPlugins+=(r.extraPlugins.length?",":"")+a.extraPlugins),a.motoLinkAllowedActions&&(r.motoLinkAllowedActions=a.motoLinkAllowedActions),o.$formatters.push(function(){var e;angular.isString(o.$modelValue)&&!n&&y.loadScript("ckeditor",h.getScriptSrc()).then(function(){$("#"+s).length&&(h.processGlobalCKEDITOR(CKEDITOR),CKEDITOR.replace(s,r),n=CKEDITOR.instances[s],e=h.clearRedundantData(o.$modelValue),n.setData(e),n.on("change",m))})}),e.$on("MotoEvent:MotoCkeditor.ShowValidationBalloon",function(e,t){var o,i,r,n;(t=t||{}).key&&t.key!=a.key||(o=t,n=angular.element("#cke_"+s),i=o.position||"right",r=n.find(".balloon"),n.closest(".form-group_ckeditor").addClass("group-not-valid"),r.length||(r=$('<div class="balloon balloon-absolute balloon-'+i+'"><div class="balloon-item"><span class="balloon-text">'+f.instant(o.messageKey,o.messageParams)+"</span></div></div>"),n.append(r)),r.css(i,"-233px"),r.css("top",0))}),e.$on("MotoEvent:MotoCkeditor.ClearValidationBalloon",function(e,t){(t=t||{}).key&&t.key!=a.key||u()}),e.$on("MotoEvent:MotoCkeditor.setData",function(e,t){n&&angular.isString(t)&&n.setData(t)}),e.$on("$destroy",function(){n&&(l.off("load",g),h.destroyInstance(n),n=null),window.removeEventListener("resize",d)})}}}]),angular.module("motoUI.ckeditor").service("MotoCkeditor",["$injector","coreLibraryUtils","coreLibraryLanguages","coreLibraryConfig",function(e,o,t,i){var r=this,n=window.app.config;function a(){return n.getPath("@systemAssets/ckeditor/moto.css?t="+i.getBuild())}this.getBaseConfig=function(){return{language:t.getProfileLocale().toLowerCase().replace("_","-"),allowedContent:!0,startupFocus:!0,$injector:e,customConfig:!1,toolbarGroups:[{name:"textdecoration",groups:["basicstyles"]},{name:"moto",groups:["cssstyle"]},{name:"styles"},{name:"fonts",groups:["fonts"]},{name:"colorize",groups:["colorizer"]},{name:"textalign",groups:["align"]},{name:"links",groups:["link","motolinkto"]},{name:"indent",groups:["indentblock"]},{name:"list",groups:["list"]},{name:"motocontentplugins",groups:["mototexticon","motoimage"]},{name:"cleanstyles",groups:["cleanup"]},{name:"undo-redo",groups:["undo"]},{name:"motobgswitcher",groups:["motobgswitcher"]}],extraPlugins:"cssstyle,justify,font,colorizer,indentblock,motolinkto,undo,mototexticon,format",removeButtons:"Cut,Copy,Paste,Subscript,Superscript,Styles,Font",forcePasteAsPlainText:!0,contentsCss:a(),format_tags:"p;h1;h2;h3;h4",dialog_backgroundCoverColor:"#000"}},this.processGlobalCKEDITOR=function(o){o&&!o.__motoProcessed&&($(o.document.$).find("head").append('<link rel="stylesheet" href="'+a()+'">'),o.VERBOSITY_WARN=0,o.disableAutoInline=!0,o.timestamp=i.isDevelopment()?(new Date).getTime():i.getBuild(),o.__motoProcessed=!0,o.on("instanceReady",function(e){var t;e.editor.elementMode===o.ELEMENT_MODE_INLINE&&(t=e.editor.getData(),t=r.clearRedundantData(t),e.editor.setData(t)),e.editor.resetUndo()}))},this.clearRedundantData=function(e){var t;return t=e.replace(/\u200B/g,""),t=o.removeComments(t)},this.transformImagesSource=function(e,t){var o;return!!angular.isString(e)&&(angular.isUndefined(t)&&(t=""),!!angular.isString(t)&&((o=$("<div>"+e+"</div>")).find("img"+t).each(function(e,t){var o;(o=$(t))&&!/^(\{\{)(.*)(}})$/.test(o.attr("src"))&&o.attr("data-path")&&(o.attr("temp-transforming-image-src","{{ Linker.img('"+o.attr("data-path")+"') }}"),o.attr("src",null))}),o.html().replace(/ temp-transforming-image-src=\"\{\{/g,' src="{{')))},this.getScriptSrc=function(){return n.getPath("@systemAssets/ckeditor/ckeditor.js")+"?t="+i.getBuild()},this.destroyInstance=function(e){try{e.focusManager.blur(!0),e.fire("blur"),e.destroy(!0)}catch(e){}}}]),angular.module("motoUI").directive("motoCodeEditor",["$translate","coreLibraryUtils","$timeout",function(e,p,d){return{restrict:"A",priority:500,template:'<textarea style="display: none;"></textarea>',require:"ngModel",link:function(e,t,o,i){var r,n;function a(){e.$$phase||(i.$setViewValue(n.getValue()),e.$apply())}function s(e,t){var o,i;o=[8,9,13,16,17,18,19,20,27,33,34,35,36,37,38,39,40,45,46,91,92,93,107,109,110,111],i=e.getTokenAt(e.getDoc().getCursor()),!e.state.completionActive&&i.type&&i.string&&$.inArray(i.string,[""," ","<",">"])<0&&!/>$/.test(i.string)&&$.inArray(t.keyCode||t.which,o)<0&&CodeMirror.commands.autocomplete(e,null,{completeSingle:!1})}function l(){i.validate()}function c(){!n&&angular.isString(i.$modelValue)&&window.CodeMirror&&(r.val(i.$modelValue),n=window.CodeMirror.fromTextArea(r[0],{mode:{name:"htmlmixed",scriptTypes:[{matches:/javascript/i,mode:"javascript"}]},extraKeys:{"Ctrl-Space":"autocomplete"},lineNumbers:!0,styleActiveLine:!0,autoCloseTags:!0,autoCloseBrackets:!0,matchTags:{bothTags:!0},matchBrackets:!0}),t.find(".CodeMirror").addClass("form-control"),n.on("change",a),n.on("keyup",s),i.validate&&n.on("blur",l))}r=t.find("textarea"),o.$observe("ngModel",function(){p.loadScript("codemirror",app.config.getPath("@systemAssets/codemirror/codemirror.min.js")).then(function(){c()})}),i.$formatters.push(function(){angular.isDefined(i.$modelValue)&&(n?n.getDoc().setValue(i.$modelValue):d(c))}),e.$on("$destroy",function(){n.off("change",a),n.off("keyup",s),i.validate&&n.off("blur",l),n.setValue(""),n.clearHistory(),n=null})}}}]),angular.module("motoUI").service("CodeEditor",["coreLibraryModal","$q",function(e,t){this.openModal=function(o,i){var r=t.defer();return e("@motoUI/code_editor/code_editor_popup.tpl.html",function(e,t){e.code=o?angular.copy(o):"",e.validatorObject=i||{},e.ok=function(){if(e.codeEditorForm.validate())return t.close(e),r.resolve(e.code)},e.cancel=function(){return t.close(e),r.reject(o)}},null,"code-editor-modal"),r.promise}}]),angular.module("motoUI").directive("motoUiCssAnimation",[function(){return{restrict:"E",priority:500,require:"ngModel",templateUrl:"@motoUI/controls/css_animation/css_animation.tpl.html",scope:{baseModel:"=ngModel"},link:function(){}}}]),angular.module("motoUI").directive("moto.ui.control.font.style",[function(){return{restrict:"E",replace:!0,scope:{textStyle:"=uiStyle",fonts:"=uiFonts",fontFamily:"=?uiFontFamily",title:"@?uiTitle",id:"@?uiId"},templateUrl:"@motoUI/controls/font_style/font_style.tpl.html",controller:["$scope","$element","$attrs",function(r,e,t){!t.uiInheritMode||r.$eval(t.uiInheritMode);function o(){return t.uiFontFamily?r.fontFamily:r.textStyle["font-family"]}function i(){r.fontStyle=function(){var e,t,o,i;for(t=0,o=r.fontStyles.length;t<o;t++)(i=r.fontStyles[t])["font-weight"]==r.textStyle["font-weight"]&&i["font-style"]==r.textStyle["font-style"]&&(e=i);return e||(e=r.fontStyles[0]),e}(),r.fontStyle&&r.fontStyleChanged()}function n(){r.fonts&&r.fonts.length&&r.textStyle&&o()&&("bold"==r.textStyle["font-weight"]&&(r.textStyle["font-weight"]=700),r.font=function(e){var t,o,i=null;for(t=0,o=r.fonts.length;t<o;t++)if(r.fonts[t].family==e){i=r.fonts[t];break}return i&&i.active_variants&&angular.isString(i.active_variants)&&(i.active_variants=angular.fromJson(i.active_variants)),i}(o()),r.font&&("system"==r.font.provider?r.fontStyles=[{label:"Regular","font-weight":"400","font-style":"normal"},{label:"Italic","font-weight":"400","font-style":"italic"},{label:"Bold","font-weight":"700","font-style":"normal"},{label:"Bold Italic","font-weight":"700","font-style":"italic"}]:r.fontStyles=function(e,t){var o,i,r,n,a={100:{label:"100","font-weight":"100","font-style":"normal"},"100italic":{label:"100italic","font-weight":"100","font-style":"italic"},200:{label:"200","font-weight":"200","font-style":"normal"},"200italic":{label:"200italic","font-weight":"200","font-style":"italic"},300:{label:"300","font-weight":"300","font-style":"normal"},"300italic":{label:"300italic","font-weight":"300","font-style":"italic"},400:{label:"400","font-weight":"400","font-style":"normal"},"400italic":{label:"400italic","font-weight":"400","font-style":"italic"},regular:{label:"regular","font-weight":"400","font-style":"normal"},italic:{label:"italic","font-weight":"400","font-style":"italic"},500:{label:"500","font-weight":"500","font-style":"normal"},"500italic":{label:"500italic","font-weight":"500","font-style":"italic"},600:{label:"600","font-weight":"600","font-style":"normal"},"600italic":{label:"600italic","font-weight":"600","font-style":"italic"},700:{label:"700","font-weight":"700","font-style":"normal"},bold:{label:"bold","font-weight":"700","font-style":"normal"},"700italic":{label:"700italic","font-weight":"700","font-style":"italic"},800:{label:"800","font-weight":"800","font-style":"normal"},"800italic":{label:"800italic","font-weight":"800","font-style":"italic"},900:{label:"900","font-weight":"900","font-style":"normal"},"900italic":{label:"900italic","font-weight":"900","font-style":"italic"}},s=e.active_variants,l=[];for(r=0,n=s.length;r<n;r++)o=null,a[s[r]]?o=a[s[r]]:(i=s[r].match(/^([0-9]*)([a-z]*)$/i))&&(o={"font-weight":(i=s[r].match(/^([0-9]*)([a-z]*)$/i))[1]||"400","font-style":i[2]||"normal",label:i[1]+" "+i[2]}),o&&l.push(o);return l}(r.font),i()))}r.fontStyles=[],r.fontStyle=null,r.fontStyleChanged=function(){r.fontStyle["font-weight"]?r.textStyle["font-weight"]=r.fontStyle["font-weight"]:delete r.textStyle["font-weight"],r.fontStyle["font-style"]?r.textStyle["font-style"]=r.fontStyle["font-style"]:delete r.textStyle["font-style"],t.uiUpdateEmit&&r.$emit(t.uiUpdateEmit)},t.uiFontFamily&&r.$watch("fontFamily",n),t.uiWatch&&t.uiWatch.split(" ").forEach(function(e){r.$watch("$parent."+e,n)}),r.$watch("fonts",n),r.$watch('textStyle["font-family"]',n),r.$watch(function(){return r.textStyle?r.textStyle["font-weight"]+r.textStyle["font-style"]:null},i)}]}}]),angular.module("motoUI").directive("motoUiControlFont",["application.design.styles.services.FontsModel",function(n){return{restrict:"E",priority:500,require:"ngModel",templateUrl:"@motoUI/controls/font/font.tpl.html",scope:{baseModel:"=ngModel"},link:function(o,e,i,t){function r(e,t){i.splitGroup==t.splitGroup&&6==i.componentSet&&(o.viewElements["font-family"]=t.fontFamily)}o.viewElements={},o.componentSet=i.componentSet,1!=o.componentSet&&3!=o.componentSet||(o.maxFontSize=i.maxFontSize||72),t.$formatters.push(function(){t.$modelValue&&(o.viewElements["font-family"]=t.$modelValue["font-family"]||o.viewElements["font-family"],o.viewElements["font-style"]=t.$modelValue["font-style"],o.viewElements["font-weight"]=t.$modelValue["font-weight"])}),n.success(function(){o.fonts=n.objects()}).error(function(){o.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load(),o.currentFontFamilyChanged=function(e){t.$modelValue["font-family"]=e,i.splitGroup&&5==i.componentSet&&angular.element(window).trigger("MotoUI.Font.SplitMode.FontFamilyChanged",{fontFamily:e,splitGroup:i.splitGroup})},i.splitGroup&&6==i.componentSet&&(angular.element(window).on("MotoUI.Font.SplitMode.FontFamilyChanged",r),o.$destroy=function(){angular.element(window).off("MotoUI.Font.SplitMode.FontFamilyChanged",r)}),o.$on("MotoUI.FontStyle.Changed",function(){t.$modelValue["font-style"]=o.viewElements["font-style"],t.$modelValue["font-weight"]=o.viewElements["font-weight"]})}}}]),angular.module("motoUI").directive("motoUiControlHorizontalPosition",["$templateCache","$rootScope","$translate","MotoDevicesConstants",function(e,t,o,n){return{restrict:"E",priority:500,require:"ngModel",templateUrl:"@motoUI/controls/horizontal_position/horizontal_position.tpl.html",scope:{label:"@label",baseModel:"=ngModel",LivePreview:"=livePreview"},link:function(i,e,r){i.centerEnabled=null==r.hideCenter,i.devicesEnabled="object"==typeof i.baseModel[r.key],i.deviceReset=!1,i.tooltipText=r.tooltipText,i.getDeviceTranslation=function(e){return o.instant("UI.ELEMENT.HORIZONTAL_POSITION."+e.toUpperCase())},i.devicesEnabled&&(i.currentDevice=i.LivePreview.getDevice(),i.deviceReset=""==i.baseModel[r.key][i.currentDevice]),i.$on("MotoEvent:LivePreview.DeviceWasChanged",function(e,t){i.devicesEnabled&&t===i.LivePreview&&(i.currentDevice=t.getDevice(),i.position=i.baseModel[r.key][i.currentDevice]||i.baseModel[r.key][i.getParent(i.currentDevice)]||"left",i.deviceReset=""==i.baseModel[r.key][i.currentDevice])}),i.setPosition=function(e){i.position=e,i.deviceReset=!1,i.devicesEnabled?i.baseModel[r.key][i.currentDevice]=i.position:i.baseModel[r.key]=i.position},i.getParent=function(e){var t,o=n.LIST;return o.indexOf(e)<0?null:"desktop"==e?"desktop":(t=o[o.indexOf(e)-1],""!=i.baseModel[r.key][t]?t:i.getParent(t))},i.resetCurrentDevice=function(){"desktop"!=i.currentDevice&&(i.baseModel[r.key][i.currentDevice]="",i.deviceReset=!0)},i.$watch("baseModel",function(){i.baseModel&&i.baseModel[r.key]&&(i.devicesEnabled?i.position=i.baseModel[r.key][i.currentDevice]||i.baseModel[r.key][i.getParent(i.currentDevice)]||"left":i.position=i.baseModel[r.key]||"left")},!0)}}}]),angular.module("motoUI").directive("motoUiPosition",[function(){return{restrict:"E",priority:500,scope:{model:"=ngModel",label:"<"},templateUrl:"@motoUI/controls/position/position.tpl.html",link:function(e){switch(e.label=e.label||"UI.ELEMENT.BACKGROUND_IMAGE.POSITION_LABEL",e.model){case"center center":e.model="center";break;case"center top":e.model="top";break;case"right center":e.model="right";break;case"center bottom":e.model="bottom";break;case"left center":e.model="left"}}}}]),angular.module("motoUI").directive("motoUiControlSelectColor",["application.design.colorizer.DesignColorizerModel","$filter",function(d,u){return{restrict:"E",require:"ngModel",scope:!0,replace:!0,templateUrl:function(e,t){return"@motoUI/controls/select_color/select_color_"+(t.short?"short":"default")+".tpl.html"},link:function(o,e,i,r){var t,n=i.positionLeft?i.positionLeft:null,a=i.positionTop?i.positionTop:null,s={destroy:angular.noop},l=!!i.noHashSymbol&&i.noHashSymbol;function c(){return!o.parent||""!==o.color&&o.color?o.color:t.getColorByName(o.parent[i.key])}function p(t){o.$apply(function(){var e=t.value;r.$modelValue[i.key]!==t.value&&(e&&l&&(e=e.replace("#","")),r.$modelValue[i.key]=e,o.color=t.color,o.colorValue=t.value,o.$eval(i.ngChange))})}o.parentMode=angular.isDefined(i.parent),o.clearColorEnabled=angular.isUndefined(i.hideClearColor),o.showClearColorOnNormalState=angular.isDefined(i.showClearColorOnNormalState),o.showAlpha=angular.isDefined(i.showAlpha),o.hideMoreColorsButton=angular.isDefined(i.hideMoreColorsButton),o.color="",o.colorValue="",o.label=i.label?i.label:"UI.COMMON.COLOR_LABEL",o.rightPosition=angular.isDefined(i.rightPosition),i.$observe("parent",function(){o.parent=o.$eval(i.parent)}),o.selectColor=function(){t&&(s=e.colorizer({moreColorsOptions:{cancelText:u("translate")("UI.ELEMENT.COLOR_PICKER.CANCEL_LABEL"),chooseText:u("translate")("UI.ELEMENT.COLOR_PICKER.OK_LABEL"),newText:u("translate")("UI.ELEMENT.COLOR_PICKER.NEW_COLOR_LABEL"),currentText:u("translate")("UI.ELEMENT.COLOR_PICKER.CURRENT_COLOR_LABEL"),opacityLabel:u("translate")("UI.ELEMENT.COLOR_PICKER.OPACITY_LABEL")},positionLeft:n,positionTop:a,moreColorsText:u("translate")("UI.ELEMENT.COLOR_PICKER.MORE_COLORS_TEXT"),transparentText:u("translate")("UI.COMMON.TRANSPARENT_LABEL"),showAlpha:o.showAlpha,hideMoreColorsButton:o.hideMoreColorsButton,color:c(),colorValue:!o.parent||""!==o.color&&o.color?o.colorValue:o.parent[i.key],colors:angular.copy(t),fn:p,rightPosition:o.rightPosition,className:angular.isDefined(i.centeredPopups)?"colorizer_absolutely-centered":"",onlyMoreColors:i.onlyMoreColors||!1}))},d.success(function(){t=d.objects().first()||null,r.$render()}).load(),r.$render=function(){var e=r.$modelValue[i.key];e&&l&&"@"!==e[0]&&"#"!==e[0]&&(e="#"+e),r.$modelValue&&t?(o.colorValue=e,o.color=t.getColorByName(e)):(o.colorValue="",o.color="")},o.showClearColorBtn=function(){return o.clearColorEnabled&&""!==o.color&&o.color&&(!i.parent&&!o.parentMode||i.parent||o.showClearColorOnNormalState)},o.clearColor=function(){o.$emit("MotoUI.Style.Clear"),o.color="",r.$modelValue[i.key]=o.color,o.colorValue=o.color,o.$eval(i.ngChange)},o.setNoColorClass=function(){if((""===o.color||!o.color)&&r.$modelValue&&!o.parent||(""===o.color||!o.color)&&r.$modelValue&&o.parent&&(""===o.parent[i.key]||!o.parent[i.key]))return"moto-ui-control__select-color_no-color"},o.setBackgroundStyles=function(){return{"background-color":c()}},o.$on("$destroy",function(){try{s.destroy()}catch(e){}})}}}]),angular.module("motoUI").directive("motoUiControlSelectMlAudio",["application.media_library.services.MediaLibraryService",function(r){return{restrict:"E",templateUrl:"@motoUI/controls/select_ml_audio/select_ml_audio.tpl.html",scope:{itemModel:"=mlModel",label:"@label"},link:function(t,e,o){var i=o.extensions?o.extensions.split(","):null;t.changeItem=function(){r.open({value:t.itemModel?t.itemModel.path:"",id:t.itemModel?t.itemModel.id:null,filters:["audio"],extensions:i,onApply:function(e){t.setAudioFile(e)}})},t.setAudioFile=function(e){t.itemModel={id:e.id,path:e.path,name:e.name,filesize:e.filesize||null,length:e.properties.playtime_seconds||0,bitrate:e.properties.audio.bitrate||0,meta:{artist:"",title:"",album:""}}},t.clearItem=function(){t.itemModel={}}}}}]),angular.module("motoUI").directive("motoUiControlSelectMlItem",["application.media_library.services.MediaLibraryService","$rootScope",function(n,a){return{restrict:"E",templateUrl:"@motoUI/controls/select_ml_item/select_ml_item.tpl.html",scope:{itemModel:"=ngModel",label:"@label",observeProperty:"@observeProperty",key:"@key",getMlConfig:"@getMlConfig",onDelete:"@onDelete"},require:"ngModel",link:function(o,e,t,i){var r;o.changeItem=function(){n.open(o.$parent[o.getMlConfig]())},o.clearItem=function(){i.$modelValue[o.observeProperty]="",o.$parent[o.onDelete]()},r=a.$on("MotoUI.SelectMlItem.ChangeItem",function(e,t){o.key==t.key&&o.changeItem()}),o.$on("$destroy",function(){r()})}}}]),angular.module("motoUI").directive("motoUiControlSelectMlVideo",["application.media_library.services.MediaLibraryService",function(r){return{restrict:"E",templateUrl:"@motoUI/controls/select_ml_video/select_ml_video.tpl.html",scope:{itemModel:"=mlModel",label:"@label"},link:function(t,e,o){var i=o.extensions?o.extensions.split(","):null;t.changeItem=function(){r.open({value:t.itemModel?t.itemModel.path:"",id:t.itemModel?t.itemModel.id:null,filters:["video"],extensions:i,onApply:function(e){t.setVideoFile(e)}})},t.setVideoFile=function(e){t.itemModel={id:e.id,path:e.path,name:e.name,filesize:e.filesize||null,length:e.properties.playtime_seconds||0}},t.clearItem=function(){t.itemModel={}}}}}]),angular.module("motoUI").component("motoUiSelectWithSearchMultiple",{templateUrl:"@motoUI/controls/select_search/select_search_multi.tpl.html",bindings:{disableSearch:"<",options:"<",model:"=ngModel",key:"<",placeholder:"<",onlyIdInModel:"<",title:"<"},controller:[function(){var e=this;e.disableSearch=!!e.disableSearch,e.onlyIdInModel=!!e.onlyIdInModel,e.key=e.key||"name",e.placeholder=e.placeholder||"",e.title=e.title||""}]}),angular.module("motoUI").component("motoUiSelectWithSearch",{templateUrl:"@motoUI/controls/select_search/select_search.tpl.html",bindings:{disableSearch:"<",options:"<",model:"=ngModel",onSelect:"=?",key:"<",placeholder:"<",title:"<"},controller:[function(){var e=this;e.disableSearch=!!e.disableSearch,e.key=e.key||"name",e.placeholder=e.placeholder||"",e.title=e.title||"",e.onSelect=e.onSelect||angular.noop}]}),angular.module("motoUI").directive("motoUiControlSlider",["$timeout",function(t){return{restrict:"E",replace:!0,scope:{model:"=ngModel",label:"@",min:"@",max:"@",step:"@",precision:"@",postfix:"@",modelWithPostfix:"@"},templateUrl:"@motoUI/controls/slider/slider.tpl.html",require:"ngModel",compile:function(){return{pre:function(t,e,o,i){function r(e){t.modelWithPostfix&&angular.isString(e)?t.viewModel=e.slice(0,-t.postfix.length):t.viewModel=e}r(t.model),t.sliderOptions={hideLimitLabels:!0,showSelectionBar:!0,floor:angular.isDefined(t.min)?parseFloat(t.min):0,ceil:angular.isDefined(t.max)?parseFloat(t.max):100,step:angular.isDefined(t.step)?parseFloat(t.step):1,precision:angular.isDefined(t.precision)?parseFloat(t.precision):0,translate:function(e){return t.postfix?e+t.postfix:e},onChange:function(){var e;e=t.modelWithPostfix?t.viewModel+t.postfix:t.viewModel,i.$setViewValue(e),o.ngChange&&t.$parent.$eval(o.ngChange)}},i.$formatters.push(function(e){r(e)})},post:function(e){t(function(){e.$broadcast("rzSliderForceRender")})}}}}}]),angular.module("motoUI").directive("motoUiSpacings",[function(){return{restrict:"E",priority:500,require:"ngModel",templateUrl:"@motoUI/controls/spacings/spacings.tpl.html",scope:{spacingsModel:"=ngModel",label:"@",mode:"@",hideAuto:"<"},link:function(e){e.mode=e.mode||"full",e.label=e.label||"UI.ELEMENT.SPACINGS.NAME",e.hideAuto=!!e.hideAuto,e.spacings=["zero","auto","small","medium","large"],e.spacingTranslateKeys={zero:"UI.ELEMENT.SPACINGS.NONE_LABEL",auto:"UI.ELEMENT.SPACINGS.NOT_SET_LABEL",small:"UI.ELEMENT.SPACINGS.SMALL_LABEL",medium:"UI.ELEMENT.SPACINGS.MEDIUM_LABEL",large:"UI.ELEMENT.SPACINGS.LARGE_LABEL"},e.hideAuto&&e.spacings.splice(1,1)}}}]),angular.module("motoUI").directive("motoUiControlStateSwitcher",[function(){return{restrict:"E",require:"ngModel",scope:{switcherState:"=ngModel"},templateUrl:"@motoUI/controls/state_switcher/state_switcher.html",link:function(t,e,o,i){i.$render=function(){i.$viewValue||i.$setViewValue("base")},t.setSwitcherState=function(e){i.$setViewValue(e),o.entities&&void 0!==t.switcherState&&t.$emit("MotoUI.StateSwitcher.Changed",{entities:o.entities,value:e})}}}}]),angular.module("motoUI.stepper",["revolunet.stepper","pascalprecht.translate","core.library.utils","moto.constants"]).component("motoUiControlStepper",{templateUrl:"@motoUI/controls/stepper/stepper.tpl.html",bindings:{ngModel:"<",min:"<",max:"<",postfix:"<",modelWithoutPostfix:"<",livePreview:"<",key:"<",description:"<",label:"<"},require:{model:"ngModel"},controller:["$scope","$attrs","$translate","coreLibraryUtils","MotoDevicesConstants",function(r,n,e,a,s){var l,c=this,p="";function d(){return c.livePreview.getDevice()}function o(e){var t,o=d();function i(e){return angular.isDefined(e)&&e!==p}for(angular.isObject(e)||(e=c.ngModel);i(t=a.getObjectValueByPath(e,o+"."+c.key))||(o=s.LIST[s.LIST.indexOf(o)-1],l=o),!i(t)&&o;);l=o!==d()?o:null,c.viewModel=t}!0!==c.modelWithoutPostfix&&(c.modelPostfix=c.postfix),c.isSupportInheritance=function(){return c.livePreview&&c.key},c.isValueInherited=function(){return!!l},c.showReset=function(){return c.isSupportInheritance()&&!c.isValueInherited()&&d()!==s.LIST[0]},c.showInheritance=function(){return c.isSupportInheritance()&&c.isValueInherited()},c.modelChanged=function(){var e,t,o,i;if(c.isSupportInheritance()){for(t=d(),l=null,o=c.key.split("."),angular.isObject(c.ngModel[t])||(c.ngModel[t]={}),i=c.ngModel[t],e=0;e<o.length-1;e++)angular.isObject(i[o[e]])||(i[o[e]]={}),i=i[o[e]];i[o[o.length-1]]=c.viewModel,n.ngChange&&r.$parent.$eval(n.ngChange)}else c.model.$setViewValue(c.viewModel)},c.isSupportInheritance()?(r.$on("MotoEvent:LivePreview.DeviceWasChanged",function(e,t){c.livePreview===t&&o()}),c.getDeviceTranslation=function(){return e.instant("UI.ELEMENT.HORIZONTAL_POSITION."+l.toUpperCase())},c.reset=function(){c.viewModel=p,c.modelChanged(),o()},o()):c.viewModel=c.ngModel,c.$onInit=function(){c.model.$formatters.push(function(e){return c.isSupportInheritance()?o(e):c.viewModel=e,e})}}]}),angular.module("motoUI").directive("motoUiControlTextDecoration",[function(){return{restrict:"E",priority:500,require:"ngModel",scope:!0,templateUrl:"@motoUI/controls/text_decoration/text_decoration.tpl.html",link:function(e,t,o,i){o.$observe("parent",function(){e.parent=e.$eval(o.parent),e.visibleTextDecoration||e.parent&&(e.visibleTextDecoration=e.parent["text-decoration"])}),i.$render=function(){i.$modelValue["text-decoration"]||(e.visibleTextDecoration="none")},i.$formatters.push(function(){e.model=i.$modelValue,e.visibleTextDecoration=i.$modelValue["text-decoration"]}),e.clearTextDecoration=function(){e.$emit("MotoUI.Style.Clear"),i.$modelValue["text-decoration"]="",e.parent&&(e.visibleTextDecoration=e.parent["text-decoration"])},e.textDecorationCheckboxClick=function(){i.$modelValue["text-decoration"]=e.visibleTextDecoration}}}}]),angular.module("motoUI").directive("motoUiControlTextStyle",["core.library.styles.StylesModel",function(i){return{restrict:"E",priority:500,require:"ngModel",templateUrl:"@motoUI/controls/text_style/text_style.tpl.html",scope:{baseModel:"=ngModel"},link:function(e,t,o){e.onFocus=function(){if(o.ngFocus)try{e.$parent.$eval(o.ngFocus)}catch(e){}},e.onBlur=function(){if(o.ngBlur)try{e.$parent.$eval(o.ngBlur)}catch(e){}},i.success(function(){e.styles=i.objects(function(e){return"text"===e.type})}).error(function(){e.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load()}}}]),angular.module("motoUI").directive("motoUiWidgetPresetsSelect",["core.library.editor.PresetsModel","$timeout",function(n,t){var a={divider_horizontal:{count:3,presets:null},image:{count:5,presets:null},button:{count:5,presets:null},social_links:{count:3,presets:null},slider:{count:2,presets:null},grid_gallery:{count:3,presets:null},contact_form:{count:3,presets:null},menu:{count:3,presets:null},pagination:{count:1,presets:null}};return{restrict:"E",priority:500,replace:!0,templateUrl:"@motoUI/controls/widget_presets_select/widget_presets_select.tpl.html",scope:{baseModel:"=ngModel"},link:function(i,e,r){i.label=r.label||"WIDGET.COMMON.DESIGN_PRESET_NAME_LABEL",i.onChange=function(){r.onChange&&t(function(){i.$parent.$eval(r.onChange)})},n.success(function(){var t,e,o;i.widgetPresets=n.objects((t=r.widget,function(e){return e.widget_name==t})),i.widgetPresets.length<1&&(i.widgetPresets=(e=r.widget,o=o||[],a[e]?(a[e].presets||(a[e].presets=function(e,t){var o,i,r=[];for(o=0;o<t;o++)i={class_name:"moto-preset-"+(0<o?o+1:"default"),name:"Preset "+(o+1),widget_name:e},r.push(i);return r}(e,a[e].count)),a[e].presets):o)),i.widgetPresets.forEach(function(e){e.value=e.class_name.replace("moto-preset-","")})}).error(function(){i.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR")}).load()}}}]),angular.module("motoUI").directive("motoUiControlWidgetVisibleOn",["$timeout","MotoDevicesConstants",function(e,o){return{restrict:"E",replace:!0,scope:{model:"=ngModel",disabled:"=disabled"},require:"ngModel",templateUrl:"@motoUI/controls/widget_visible_on/widget_visible_on.tpl.html",link:function(i,r,e,t){i.label=e.label||"UI.ELEMENT.WIDGET_VISIBLE_ON.VISIBLE_ON_LABEL",i.tooltip=e.tooltip||!1,i.showOnDevicesSliderOptions={stepsArray:o.LIST,translate:function(e){return'<span class="widget-visible-on-icon icon_device-'+e+'"></span>'},onChange:i.setTicksClassNames,hideLimitLabels:!0,showTicksValues:!0,showSelectionBar:!0},angular.isDefined(e.disabled)&&(i.showOnDevicesSliderOptions.disabled=i.disabled,i.$watch("disabled",function(){i.showOnDevicesSliderOptions.disabled=i.disabled})),i.setTicksClassNames=function(){var e,t,o=[];for(e=i.showOnDevicesSliderOptions.stepsArray.indexOf(i.model),t=0;t<=e;t++)o.push("widget-visible-on_device-"+i.showOnDevicesSliderOptions.stepsArray[t]);o.push("rz-ticks"),r.find(".rz-ticks").removeClass().addClass(o.join(" "))},t.$formatters.push(function(e){return i.setTicksClassNames(),e})}}}]),angular.module("motoUI").directive("motoUiContentBody",["$rootScope",function(o){return{restrict:"C",link:function(e,t){o.$on("$stateChangeSuccess",function(){t.animate({scrollTop:0},0)})}}}]),angular.module("motoUI").filter("motoAbsoluteUrl",function(){return function(e){return app.config.getAbsoluteUrl(e)}}),angular.module("motoUI").filter("motoFilename",function(){return function(e){return angular.isString(e)?e.replace(/(.*)\/([^\/]+)$/,"$2").replace(/([#\?].*)$/,""):e}}),angular.module("motoUI").filter("motoFontVariant",function(){var t={100:"Thin","100italic":"Thin Italic",200:"Extra-Light","200italic":"Extra-Light Italic",300:"Light","300italic":"Light Italic",400:"Regular","400italic":"Italic",regular:"Regular",italic:"Italic",500:"Medium","500italic":"Medium Italic",600:"Semi-Bold","600italic":"Semi-Bold Italic",bold:"Bold",700:"Bold","700italic":"Bold Italic",800:"Extra-Bold","800italic":"Extra-Bold Italic",900:"Ultra-Bold","900italic":"Ultra-Bold Italic"};return function(e){return t[e=e||""]?t[e]:e}}),angular.module("motoUI").filter("motoRelativeUrl",function(){return function(e){return app.config.getRelativeUrl(e)}}),angular.module("motoUI").filter("motoResourcePath",function(){return function(e){return angular.isString(e)?e.replace(/^(@[^\/]+\/)/,""):e}}),angular.module("motoUI").filter("motoUploadAbsoluteUrl",function(){return function(e){return app.config.getUploadAbsoluteUrl(e)}}),angular.module("motoUI").filter("motoUploadUrl",function(){return function(e){return app.config.getUploadUrl(e)}}),angular.module("motoUI").directive("motoUiFixedPanel",["$timeout",function(n){return{restrict:"A",link:function(e,t,o){var i,r;i=o.motoUiFixedPanel?angular.element(o.motoUiFixedPanel):t.closest(".content-wrap_with-fixed_panel"),e.setPanelWidth=function(){var e=i.width();r!==e&&(r=e,t.width(r))},e.setPanelWidth(),n(e.setPanelWidth,600),angular.element(window).bind("resize",e.setPanelWidth),i.on("click",e.setPanelWidth),e.$on("motoUI.update-fixed-panel",function(){n(e.setPanelWidth,600)}),e.$on("$destroy",function(){angular.element(window).off("resize"),i.off("click")})}}}]),angular.module("motoUI").directive("motoUiImagePreview",[function(){return{restrict:"E",priority:500,require:"ngModel",templateUrl:"@motoUI/image_preview/image_preview.tpl.html",link:function(t,e,o,i){i.$formatters.push(function(e){t.imageUrl=app.config.getUploadAbsoluteUrl(e)})}}}]),angular.module("motoUI").component("motoUiInputDateTime",{templateUrl:"@motoUI/input_date_time/inputDateTime.tpl.html",bindings:{modelFormat:"<",viewFormat:"<",minuteStep:"<"},require:{model:"ngModel"},controller:["$scope","$element","$window","$filter",function(t,c,p,o){var d=this,u=c.find(".dropdown"),g=c.find(".dropdown-menu"),m="moto-ui-input-date-popup_top",f="moto-ui-input-date-popup_right",h="moto-ui-input-date-popup_opened";function y(e){d.opened&&!c.find(e.target).length&&(d.closePopup(),t.$$phase||t.$apply())}function e(e){e&&(angular.isString(d.modelFormat)?d.ngModel=new Date(d.model.$modelValue.replace(" ","T")):d.ngModel=d.model.$modelValue)}d.opened=!1,d.config={minuteStep:angular.isDefined(d.minuteStep)?d.minuteStep:5},d.viewFormat=d.viewFormat||"dd-MMMM-yyyy hh:mm a",d.openPopup=function(){var e=u.offset(),t=p.innerHeight,o=e.top,i=u.height(),r=g.height(),n=p.innerWidth,a=e.left,s=u.width(),l=g.width();t<o+i+r?c.addClass(m):c.removeClass(m),n<a+s+l?c.addClass(f):c.removeClass(f),g.addClass(h),d.opened=!0,$(document).on("click",y)},d.closePopup=function(){g.removeClass(h),d.opened=!1,$(document).off("click",y)},d.toggleInputDatePopup=function(){d.opened?d.closePopup():d.openPopup()},d.modelChanged=function(){var e;e=angular.isString(d.modelFormat)?o("date")(d.ngModel,d.modelFormat):d.ngModel,d.closePopup(),d.model.$setViewValue(e)},d.$onInit=function(){d.model.$formatters.push(e)},d.$onDestroy=function(){$(document).off("click",y)}}]}),angular.module("motoUI").directive("motoUiInputDate",[function(){return{restrict:"E",templateUrl:"@motoUI/input-date/input-date.tpl.html",scope:{dateModel:"=ngModel"},require:"ngModel",link:function(t,e,o,i){t.toggleInputDatePopup=function(e){e.preventDefault(),e.stopPropagation(),t.opened=!t.opened},t.dateOptions={formatYear:"yyyy",startingDay:0,showWeeks:0,showButtonBar:0,formatDay:"d",formatDayHeader:"EEE",formatDayTitle:"MMMM, yyyy"},i.$formatters.push(function(){o.ngChange&&t.$parent.$eval(o.ngChange)})}}}]).directive("uibDatepicker",[function(){return{priority:1,link:function(e,t){t.closest("moto-ui-input-date").is("[off-datepicker-focus]")&&e.$on("uib:datepicker.focus",function(){e.$$childTail.$$listeners["uib:datepicker.focus"]=[]})}}}]),angular.module("motoUI").controller("application.motoUI.controllers.BlogCategoryController",["$scope","application.blog.services.CategoryService",function(t,e){t.CategoriesList=[],t.loadList=function(){e.getList({type:"blog.post"}).then(function(e){t.CategoriesList=e.records},function(e){t.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR"),console.error(e)})},t.loadList()}]),angular.module("motoUI").controller("application.motoUI.controllers.BlogTagController",["$scope","application.blog.services.TagService",function(t,e){t.TagList=[],t.loadTagList=function(){e.getList({type:"blog.post"}).then(function(e){t.TagList=e.records},function(e){t.systemMessenger.error("COMMON.MESSAGES.LOAD_DATA_FROM_SERVER_ERROR"),console.error(e)})},t.loadTagList()}]),angular.module("motoUI").controller("application.motoUI.controllers.FileController",["$scope","$filter","application.media_library.services.MediaLibraryService",function(t,e,o){t.fileNameGetter=function(){return e("motoFilename")(t.link.properties.file)},t.changeFile=function(){o.open({value:t.link.properties.file||null,id:t.link.properties.mediaId||null,onApply:function(e){t.link.properties.mediaId=e.id,t.link.properties.file=e.path,t.link.properties.fileName=e.name}})},t.clearFile=function(){t.link.properties.file=null,t.link.properties.mediaId=null,t.link.properties.fileName=null}}]),angular.module("motoUI").controller("application.motoUI.controllers.LightboxController",["$scope","application.media_library.services.MediaLibraryService",function(e,t){var o=e.$parent.link;e.changeLightboxImage=function(){t.open({value:o.properties.src||null,id:o.properties.mediaId||null,size:o.properties.size||null,filters:["image"],thumbnails:!0,onApply:function(e,t){o.properties.mediaId=e.id,(o.properties.size=t)&&e.thumbnails[t]?o.properties.src=e.getThumbnailPath(t):o.properties.src=e.path}})},e.clearLightboxImage=function(){o.properties.src=null,o.properties.mediaId=null,o.properties.size=null}}]),angular.module("motoUI").controller("application.motoUI.controllers.PageListController",["$scope","application.pages.services.PagesModel","motoFeatures","application.pages.services.PagesUtilsService",function(o,i,r,n){function a(o){return function(e){var t=!0;return o&&(o.type&&(t=t&&e.type===o.type),t&&angular.isDefined(o.is_system)&&(t=t&&parseInt(e.is_system)===o.is_system)),t}}o.pages=[],o.loadPageList=function(e){var t;switch(e){case"page":t=r.isEnabled("engine_pages_unlimited_mode")?i.objects(a({type:o.link.action,is_system:0})):n.getPagesForLimitedMode();break;case"blog.post":t=i.objects(a({type:o.link.action,is_system:0}));break;case"blog.index":t=i.objects(a({type:o.link.action,is_system:1})),o.link.properties.id=t.length?t[0].id:""}o.pages=t},o.loadPageList(o.link.action)}]),angular.module("motoUI").controller("application.motoUI.controllers.PopupListController",["$scope","application.content_service.services.ContentModelService",function(e,t){e.popups=t.objects(function(e){return"popup"===e.type&&0===parseInt(e.is_system)})}]),angular.module("motoUI").directive("motoUiLinkTo",["$templateCache","application.pages.services.PagesModel","application.media_library.services.MediaLibraryService","motoFeatures","$window","motoUI.LinkToService","CurrentValue","coreLibraryConfig",function(e,s,t,o,i,l,c,p){var d={url:{noFollow:!0}};return{restrict:"E",scope:{link:"=ngModel",label:"@",allowedActions:"@",actionOptions:"<"},link:function(o){var r,n,a={},t=o.allowedActions?o.allowedActions.split(","):[];o.target=[{id:"_self",name:"UI.ELEMENT.LINK_TO.TARGET_CURRENT"},{id:"_blank",name:"UI.ELEMENT.LINK_TO.TARGET_NEW"}],o.link=o.link||{},o.link.action=o.link.action||"none",o.link.properties=o.link.properties||{},o.actions=l.getActions(),o.label=o.label||"UI.ELEMENT.LINK_TO.ACTION_LABEL",o.currentOptions=angular.extend({},d,o.actionOptions||{}),t.length&&(o.actions=o.actions.filter(function(e){return-1<t.indexOf(e.name)})),o.currentAction=l.getAction(o.link.action),o.link.properties=(r=o.link.action,n=o.link.properties,o.actions.forEach(function(e){var t,o,i;e.name!=r?(a[e.name]=angular.copy(e.defaultProperties||{}),t=e,i=parseInt(p.get("settings.website.main_page")),"page"===t.name&&(o=c.get("content_service","page",i),a[t.name].id=s.getByField("id",o).is_system?i:o)):a[e.name]=angular.extend({},e.defaultProperties||{},n)}),a[r]),o.$watch("link.action",function(e,t){e!=t&&(o.currentAction=l.getAction(e),o.link&&(o.link.properties=a[e]))})},templateUrl:function(e,t){return t.templateUrl?app.config.getUrl(t.templateUrl):"@motoUI/linkto/linkto.tpl.html"}}}]),angular.module("motoUI").provider("motoUI.LinkToService",["$windowProvider","coreLibraryUtilsProvider",function(e,n){var a,i,r,s,o=[];function l(e){if(!e.name)throw"name option must be specified.";if(!e.label)throw"label option must be specified.";if(!e.templateUrl)throw"templateUrl option must be specified.";if(e.parseDomElement&&!angular.isFunction(e.parseDomElement))throw"parseDomElement option must be function.";if(e.compileDomElement&&!angular.isFunction(e.compileDomElement))throw"compileDomElement option must be function.";if(e.linkTransform&&!angular.isFunction(e.linkTransform))throw"linkTransform option must be function.";angular.extend(this,e)}function t(){return o}function c(e){for(var t=0;t<o.length;t++)if(o[t].name===e)return o[t];return null}function p(e){var t;if(!angular.isObject(e))throw'Please provide action options e.g. {name: "exampleAction", label: "label_in_list_of_actions", templateUrl: "path/to/action/view", priority: 100, {url: \'default/url\', target: \'_self\'}, linkTransform: function(aNode){ do something with a node } }';if(!e.name)throw"name option must be specified.";if(c(e.name))throw"Action with name: '"+e.name+"' already exists.";t=e instanceof l?e:new l(e),o.push(t),n.sortArrayByProperty(o,"priority")}function d(e){var t;if((t="string"==typeof e?$("<div>"+e+"</div>"):e).find("a").each(function(e,t){var o,i,r;(o=$(t))&&!/^(\{\{)(.*)(}})$/.test(o.attr("href"))&&(i=o.data("action"))&&(r=s.getAction(i))&&!r.isStatic&&r.linkTransform&&r.linkTransform(o,s.getParseData(o))}),"string"==typeof e)return t.html()}function u(o){r("views/components/ui/modal/link_to.tpl.html",function(e,t){e.allowedActions=o.allowedActions||"",e.link=o.link||{},e.ok=function(){e.editLinkForm&&e.editLinkForm.validate()&&(t.close(e),o.okHandler&&o.okHandler(e.link))},e.cancel=function(){t.close(e),o.cancelHandler&&o.cancelHandler()}})}function g(e,t){var o,i,r={data:{}};for(i=n.getAttributes(e),o=0;o<i.length;o++)$.inArray(i[o],["text","class","data"])<0&&(/^data-/.test(i[o])?r.data[n.toCamelCase(i[o].replace(/^data-/,""))]=e.attr(i[o]):r[n.toCamelCase(i[o])]=e.attr(i[o]));return r.text=t||e.text(),r.class=e.attr("class")?e.attr("class").replace(/\s+/g," ").trim().split(" "):[],r}return l.prototype={priority:300,defaultProperties:{},defaultText:"UI.ELEMENT.LINK_TO.LINK_TEXT",isStatic:!1,parseDomElement:function(e,t,o){angular.extend(t,o.data),delete t.action},compileDomElement:function(e,t,o){angular.extend(o.data,t),angular.isDefined(t.target)&&(o.target=t.target)},linkTransform:function(e,t){delete t.data.action,e.attr("href","{{ Linker.getAction('"+this.name+"', '"+btoa(angular.toJson(t.data))+"').getUrl() }}")},getDefaultProperties:function(){return angular.copy(this.defaultProperties||{})},getDefaultText:function(e){return angular.isFunction(this.defaultText)?this.defaultText(e):i.instant(this.defaultText)}},(s=new function(){this.addAction=p,this.getActions=t,this.getAction=c,this.transformLinks=d,this.openPopup=u,this.getParseData=g}).addAction({name:"none",label:"UI.ELEMENT.LINK_TO.OPTIONS.NONE",templateUrl:"@motoUI/linkto/views/none.tpl.html",priority:0,isStatic:!0}),s.addAction({name:"home_page",label:"UI.ELEMENT.LINK_TO.OPTIONS.HOME_PAGE",templateUrl:"@motoUI/linkto/views/home_page.tpl.html",priority:10,defaultProperties:{target:"_self"},parseDomElement:function(e,t,o){t.target=o.target||"_self";try{angular.isDefined(o.data.anchor)?t.anchor=o.data.anchor:t.anchor=e.attr("data-anchor")}catch(e){}angular.isString(t.anchor)||(t.anchor="")},compileDomElement:function(e,t,o){var i=app.config.getUrl("@website");o.target=t.target,o.data.anchor="",angular.isString(t.anchor)&&0<t.anchor.length&&(i+="#"+t.anchor,o.data.anchor=t.anchor),o.href=i},linkTransform:function(e,t){var o;t.href&&(o="{{ Linker.homePage('"+(o=t.href.trim())+"') }}",e.attr("href",o))}}),s.addAction({name:"page",label:"UI.ELEMENT.LINK_TO.OPTIONS.PAGE",templateUrl:"@motoUI/linkto/views/page.tpl.html",priority:15,defaultProperties:{target:"_self"},parseDomElement:function(e,t,o){var i=o.href.indexOf("#");t.target=o.target||"_self",t.anchor=-1<i?o.href.substring(i+1):"",t.anchor=t.anchor.replace(/'.*}}$/,""),t.id=parseInt(o.data.id)},compileDomElement:function(e,t,o){var i,r=null;for(i=a.getByField("id",t.id),o.text||(o.text=i.name);i;)r=r?i.url+"/"+r:i.url,i=i.parent;t.anchor&&(r+="#"+t.anchor),o.target=t.target,o.href=r,o.data.id=t.id},linkTransform:function(e,t){var o;t.href&&(o=t.href.trim(),o="{{ Linker.pageLink('"+t.data.id+"','"+o+"') }}",e.attr("href",o))}}),s.addAction({name:"popup",label:"UI.ELEMENT.LINK_TO.OPTIONS.POPUP",templateUrl:"@motoUI/linkto/views/popup.tpl.html",priority:75,parseDomElement:function(e,t,o){t.id=parseInt(o.data.popupId)},compileDomElement:function(e,t,o){o.data.popupId=t.id},linkTransform:function(e,t){var o;o="{{ Linker.popupLink('"+t.data.popupId+"') }}",e.attr("href",o)}}),s.addAction({name:"url",label:"UI.ELEMENT.LINK_TO.OPTIONS.URL",templateUrl:"@motoUI/linkto/views/url.tpl.html",priority:200,isStatic:!0,defaultProperties:{url:(e.$get().location.protocol||"http:")+"//",target:"_self",nofollow:!1},parseDomElement:function(e,t,o){t.url=angular.isDefined(o.href)?o.href:"http://",t.target=o.target||"_self",t.nofollow="nofollow"==o.rel},compileDomElement:function(e,t,o){o.href=t.url,o.target=t.target,t.nofollow&&(o.rel="nofollow"),o.text||(o.text=t.url)}}),s.addAction({name:"mail",label:"UI.ELEMENT.LINK_TO.OPTIONS.MAIL",templateUrl:"@motoUI/linkto/views/mail.tpl.html",priority:210,isStatic:!0,defaultProperties:{email:""},parseDomElement:function(e,t,o){t.email=o.href.replace(/^mailto:/,"")},compileDomElement:function(e,t,o){o.href="mailto:"+t.email,o.text||(o.text=t.email)}}),s.addAction({name:"call",label:"UI.ELEMENT.LINK_TO.OPTIONS.CALL",templateUrl:"@motoUI/linkto/views/call.tpl.html",priority:215,isStatic:!0,defaultProperties:{phoneNumber:""},parseDomElement:function(e,t,o){t.phoneNumber=o.href.replace(/^tel:/,"")},compileDomElement:function(e,t,o){o.href="tel:"+t.phoneNumber,o.text||(o.text=t.phoneNumber)}}),s.addAction({name:"lightbox",label:"UI.ELEMENT.LINK_TO.OPTIONS.LIGHTBOX",templateUrl:"@motoUI/linkto/views/lightbox.tpl.html",priority:220,parseDomElement:function(e,t,o){t.mediaId=o.imgId,t.size=o.imgSize,t.src=o.savedHref},compileDomElement:function(e,t,o){o.imgId=t.mediaId,o.imgSize=t.size,o.savedHref=t.src,o.href=t.src,o.text||(o.text=t.src)},linkTransform:function(e,t){var o;t.savedHref&&(o="{{ Linker.img('"+(o=t.savedHref.trim())+"') }}",e.attr("href",o))}}),s.addAction({name:"file",label:"UI.ELEMENT.LINK_TO.OPTIONS.FILE",templateUrl:"@motoUI/linkto/views/file.tpl.html",priority:230,defaultProperties:{target:"_blank"},parseDomElement:function(e,t,o){t.mediaId=o.fileId,t.file=o.savedHref,t.fileName=o.fileName,o.hasOwnProperty("download")&&(t.forceDownload=!0)},compileDomElement:function(e,t,o){o.fileId=t.mediaId,o.savedHref=t.file,o.href=t.file,t.fileName&&(o.fileName=t.fileName),t.forceDownload?o.download=t.fileName||"":o.target="_blank"},defaultText:function(e){return e.file},linkTransform:function(e,t){var o;t.savedHref&&(o="{{ Linker.file('"+(o=t.savedHref.trim())+"') }}",e.attr("href",o))}}),s.addAction({name:"blog.tag",label:"UI.ELEMENT.LINK_TO.OPTIONS.BLOG_TAG",templateUrl:"@motoUI/linkto/views/blog_tag.tpl.html",priority:109,defaultProperties:{target:"_self"},parseDomElement:function(e,t,o){angular.extend(t,o.data),delete t.action,t.id=parseInt(t.id)},linkTransform:function(e,t){var o=n.getOnlyValues(t.data,["id","target","anchor"]),i="";o.id=parseInt(o.id),t.href&&(i=t.href.trim()),i="{{ Linker.taxonomyLink('"+btoa(angular.toJson(o))+"','"+i+"') }}",e.attr("href",i)}}),s.addAction({name:"blog.category",label:"UI.ELEMENT.LINK_TO.OPTIONS.BLOG_CATEGORY",templateUrl:"@motoUI/linkto/views/blog_category.tpl.html",priority:107,defaultProperties:{target:"_self"},parseDomElement:function(e,t,o){angular.extend(t,o.data),delete t.action,t.id=parseInt(t.id)},linkTransform:function(e,t){var o=n.getOnlyValues(t.data,["id","target","anchor"]),i="";o.id=parseInt(o.id),t.href&&(i=t.href.trim()),i="{{ Linker.taxonomyLink('"+btoa(angular.toJson(o))+"','"+i+"') }}",e.attr("href",i)}}),{addAction:s.addAction,getActions:s.getActions,getAction:s.getAction,linkTransform:s.linkTransform,openPopup:s.openPopup,getParseData:s.getParseData,$get:["application.pages.services.PagesModel","$translate","coreLibraryModal",function(e,t,o){return a=e,i=t,r=o,s}]}}]),angular.module("motoUI.Menu").directive("motoUiMenu",["$templateCache","motoUI.MenuService","$state",function(e,n,a){return{restrict:"E",replace:!0,templateUrl:function(e,t){return t.templateUrl?app.config.getUrl(t.templateUrl):"@motoUI/menu/views/"+t.templateName+".tpl.html"},controller:["$scope","$element","$attrs",function(o,e,t){var i,r=t.menuName;i=n.getMenu(r),o.items=i&&i.items?i.items:[],o.$on("MotoUI.Menu.Update",function(e,t){t.menuName!=r||o.$$phase||o.$apply()}),o.isActiveItem=function(e){var t;if(a.includes(e.state))return!0;if(e.stateWildcard&&a.includes(e.stateWildcard))return!0;if(e.items)for(t=0;t<e.items.length;t++){if(a.includes(e.items[t].state))return!0;if(e.items[t].stateWildcard&&a.includes(e.items[t].stateWildcard))return!0}return!1}}]}}]),angular.module("motoUI.Menu").provider("motoUI.MenuService",["coreLibraryUtilsProvider",function(e){var t,o,i=this,r=[],n={debug:!1},a={label:"Default Label",state:"app.dashboard",indicate:!1,priority:15,icon:""};function s(e,t){var o=this;void 0!==t.label?o.label=t.label:o.label=a.label,void 0!==t.state?o.state=t.state:o.state=a.state,void 0!==t.stateWildcard?o.stateWildcard=t.stateWildcard:o.stateWildcard=o.state,void 0!==t.indicate?o.indicate=t.indicate:o.indicate=a.indicate,void 0!==t.priority?o.priority=t.priority:o.priority=a.priority,void 0!==t.icon?o.icon=t.icon:o.icon=a.icon,angular.isDefined(t.hidden)&&(o.hidden=t.hidden),angular.isDefined(t.enabled)&&(o.enabled=t.enabled),o.items=t.items||a.items,o.itemId=t.itemId,o.getMenu=function(){return e}}function l(e){this.menuId=e,this.items=[],this.itemsId={},this.itemsState=[]}i.addRestrictedState=function(e){return n.debug&&console.info('MenuProvider : add state "',e,'" AS RESTRICTED STATE'),-1===r.indexOf(e)&&r.push(e),this},i.isRestrictedState=function(e){return 0<=r.indexOf(e)},i.isAllowedState=function(e){return-1===r.indexOf(e)},i.checkAllItemOnRestrict=function(){var e;return!!t&&((e=t.getMenuInstances())&&angular.forEach(e,i.checkMenuItemOnRestrict),!0)},i.checkMenuItemOnRestrict=function(e){var t,o,i=r.length;for(o=0;o<i;o++)t=r[o],e.isExistsItemState(t)&&e.getItemByState(t).hide()},i.setGlobalOption=function(e,t){n[e]=t},s.prototype.itemId=null,s.prototype.enabled=!0,s.prototype.hidden=!1,s.prototype.update=function(e){var t;for(t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);this.getMenu().update()},s.prototype.hide=function(){this.enabled=!1},s.prototype.show=function(){this.enabled=!0},l.prototype.menuId=null,l.prototype.items=[],l.prototype.itemsId={},l.prototype.itemsState={},l.prototype.isExistsItemId=function(e){return!!angular.isDefined(this.itemsId[e])},l.prototype.isExistsItemState=function(e){return!!angular.isDefined(this.itemsState[e])},l.prototype.addItem=function(e,t){var o;return angular.isDefined(e.state)&&i.isRestrictedState(e.state)?(n.debug&&console.info('Menu "',this.menuId,'" skip adding item "',e.itemId,'" because STATE IS RESTRICTED'),!1):this.isExistsItemId(e.itemId)?(n.debug&&console.info('Menu "',this.menuId,'" skip adding item "',e.itemId,'" because already registered'),!1):(o=new s(this,e),this.itemsId[o.itemId]=o,this.itemsState[o.state]=o,this.items.push(o),t||this.resort(),!0)},l.prototype.getItem=function(e){return this.isExistsItemId(e)?this.itemsId[e]:null},l.prototype.getItemByState=function(e){return this.isExistsItemState(e)?this.itemsState[e]:null},l.prototype.hideById=function(e){return this.isExistsItemId(e)&&this.getItem(e).hide(),this},l.prototype.hideByState=function(e){return this.isExistsItemState(e)&&this.getItemByState(e).hide(),this},l.prototype.addItems=function(e){var o=this;e.forIn(function(e,t){o.addItem(t,!0)}),o.resort()},l.prototype.update=function(){o.$broadcast("MotoUI.Menu.Update",{menuName:this.menuId})},l.prototype.resort=function(){e.sortArrayByProperty(this.items,"priority")},t=new function(){var o={};this.getMenu=function(e){return o[e]?o[e]:(o[t=e]=new l(t),o[t]);var t},this.getMenuInstances=function(){return o}},i.getMenu=t.getMenu,i.$get=["$rootScope",function(e){return o=e,t}]}]),angular.module("motoUI").directive("motoUiScrollbar",["$rootScope","deviceDetectionService",function(I,e){var T=!1,O=e.isMobileDevice();return{restrict:"A",priority:1e3,transclude:!0,template:'<div class="moto-scrollbar-scroller" ng-transclude></div>',link:function(e,i,t){var r,n,o,a,s,l,c,p,d,u,g,m,f,h=e.$eval(t.motoUiScrollbar)||{};function y(e,t){var o;e.closest("#"+i.attr("id")).length&&(o=-(e.offset().top-i.offset().top-parseInt(n.css("top").slice(0,-2))-50),!t&&n.addClass("no-transition"),o<0?o<=r.maxScrollY&&(o=r.maxScrollY):o=0,r.scrollTo(0,o),!t&&setTimeout(function(){n.removeClass("no-transition")},0))}function b(e){9==(e.keyCode||e.which)&&setTimeout(function(){y(angular.element(":focus"))},0)}function _(){T||(i.find(":hover").length?i.removeClass("moto-scrollbar_mouse-outside"):i.addClass("moto-scrollbar_mouse-outside"))}function v(){c=i.height(),p=n.height(),s==c&&l==p||(p<=c?r.enabled&&(i.addClass("moto-scrollbar_small-content"),r.disable()):r.enabled||(i.removeClass("moto-scrollbar_small-content"),r.enable()),r.refresh(),s=c,l=p),O||_()}function E(){T=!1,i.removeClass("moto-scrollbar_indicator-pressed"),$(window).off("mouseup pointerup",E)}function w(){T=!0,i.addClass("moto-scrollbar_indicator-pressed"),$(window).on("mouseup pointerup",E)}function S(){clearInterval(u),u=null}function M(){if(d){if(r.y-2>=r.maxScrollY)return void r.scrollTo(0,r.y-2)}else if(r.y+2<=0)return void r.scrollTo(0,r.y+2);S()}function C(){var e;(e=angular.element(":focus")).offset().top-i.offset().top+e.height()>i.height()&&y(e)}1===i[0].nodeType&&(n=i.children(":first"),i.addClass("moto-scrollbar"),h.key?i.attr("id",h.key):i.uniqueId(),c=i.height(),(p=n.height())<=c&&i.addClass("moto-scrollbar_small-content"),O?i.addClass("moto-scrollbar_mobile"):(i.addClass("moto-scrollbar_mouse-outside"),i.on("mouseenter mouseleave",_)),r=new IScroll(i[0],{mouseWheel:!0,disableMouse:!0,disablePointer:!0,disableTouch:!O,scrollbars:"custom",interactiveScrollbars:!O,preventDefault:!0,HWCompositing:!1,useTransform:!1,useTransition:!1,momentum:!1,bounce:!1,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT|A|DIV|SPAN)$/}}),o=i.find(".iScrollIndicator"),p<=c&&r.disable(),O||o.on("mousedown pointerdown",w),v(),a=setInterval(v,500),g=I.$on("MotoUI.Scrollbar.StartScrolling",function(e,t){var o;h.key==t.key&&(o={toBottom:!1,speed:10},t=angular.extend(o,t),u||(u=setInterval(M,t.speed),d=t.toBottom))}),m=I.$on("MotoUI.Scrollbar.StopScrolling",function(e,t){h.key==t.key&&S()}),f=I.$on("MotoUI.Scrollbar.ScrollToElement",function(e,t){h.key==t.key&&y(t.element)}),i.on("keydown",b),i.on("keydown","input,textarea,[contenteditable]",C),e.$on("$destroy",function(){O||(i.off("mouseenter mouseleave",_),o.off("mousedown pointerdown",w),$(window).off("mouseup pointerup",E)),clearInterval(a),S(),g(),m(),f(),i.off("keydown",b),i.off("keydown","input,textarea,[contenteditable]",C);try{r.destroy()}catch(e){}}))}}}]),angular.module("motoUI.selectIcon").component("motoUiFontAwesomePreview",{templateUrl:"@motoUI/select_icon/fontAwesomePreview.tpl.html",bindings:{id:"=",unicode:"="}}),angular.module("motoUI.selectIcon").component("motoUiIconsList",{templateUrl:"@motoUI/select_icon/iconsList.tpl.html",bindings:{icons:"<",filter:"<"},require:{model:"ngModel"},controller:["$scope","$element","$timeout",function(e,i,t){var r,o=this;r=e.$on("iconsViewReady",function(){t(function(){var e,t,o=i.find(".selected");o.length&&(t=(e=i.find(".icons-container")).offset().top+parseInt(e.css("padding-top").slice(0,-2))+parseInt(e.css("border-top-width").slice(0,-2)),e[0].scrollTop=e[0].scrollTop+o.offset().top-t),r()})}),o.isIconSelected=function(e){return e===o.model.$modelValue},o.selectIcon=function(e){o.model.$setViewValue(e)}}]}),angular.module("motoUI.selectIcon").component("motoUiSelectIcon",{templateUrl:"@motoUI/select_icon/selectIcon.tpl.html",bindings:{features:"<",emptyValue:"<",mode:"<",hidePreview:"<"},require:{model:"ngModel"},controller:["motoUI.SelectIconService","coreLibraryUtils",function(e,t){var o,i=this;i.$onInit=function(){o=angular.isString(i.features)?i.features.split(","):[],i.provider=i.model.$viewValue.provider||"FontAwesome",i.hidePreview=i.hidePreview||!1,i.emptyValue=i.emptyValue||null,i.model.$formatters.push(function(e){return angular.isUndefined(e)?i.emptyValue:e})},i.changeIcon=function(){e.openPopup({iconId:i.getIconId(),iconUnicode:i.getIconUnicode(),features:o,okHandler:function(e){e&&("id"===i.mode?i.model.$setViewValue(e.id):"unicode"===i.mode?i.model.$setViewValue(e.unicode):i.model.$setViewValue(e))}})},i.deleteIcon=function(){i.model.$setViewValue(i.emptyValue)},i.getIconId=function(){var e=t.getObjectValueByPath(i,"model.$modelValue.id");return e||"id"!==i.mode?e:i.model.$modelValue},i.getIconUnicode=function(){var e=t.getObjectValueByPath(i,"model.$modelValue.unicode");return e||"unicode"!==i.mode?e:i.model.$modelValue}}]}),angular.module("motoUI.selectIcon").provider("motoUI.SelectIconService",["coreLibraryConfigProvider",function(e){var o,i,r,n=[];function a(i){var r=i.features||[];o("@motoUI/select_icon/selectIconModal.tpl.html",function(t,o){var e;if(t.icons=n,t.fixedWidth=!1,t.fixedWidthEnabled=-1<r.indexOf("fixedWidth"),t.fixedWidthEnabled&&(t.fixedWidth=!1),t.ok=function(){var e;t.selectedIcon&&(e={provider:"FontAwesome",id:t.selectedIcon.id,unicode:t.selectedIcon.unicode},t.fixedWidthEnabled&&(e.fixedWidth=t.fixedWidth)),o.close(t),i.okHandler&&i.okHandler(e)},t.cancel=function(){o.close(t),i.cancelHandler&&i.cancelHandler()},i.iconId||i.iconUnicode)for(e=0;e<n.length;e++)if(n[e].id===i.iconId||n[e].unicode===i.iconUnicode){t.selectedIcon=n[e];break}},null,"modal-with-ckeditor")}function t(t){n.length?a(t):r.get("@systemAssets/ckeditor/plugins/mototexticon/data.json?t="+e.getBuild()).then(function(e){n=e.data,a(t)})}return{openPopup:(i=new function(){this.openPopup=t}).openPopup,$get:["coreLibraryModal","$http",function(e,t){return o=e,r=t,i}]}}]),angular.module("motoUI").directive("motoUiSidebar",["$rootScope","MotoLocalStorage",function(d,u){return{restrict:"A",scope:{},priority:1e3,replace:!0,transclude:!0,templateUrl:"@motoUI/sidebar/sidebar.tpl.html",link:function(o,i,e){var t,r,n,a,s;function l(){o.options.hideable?(o.slideDownColumn(),i.removeClass("moto-ui-sidebar_disabled"),t.addClass("content-block_"+o.options.position+"-sidebar"),t.removeClass(o.options.position+"-panel-hidden"),t.removeClass("content-block_"+o.options.position+"-sidebar-hidden")):(i.removeClass("moto-ui-sidebar_disabled"),i.removeClass("moto-ui-sidebar_hidden"),t.removeClass("content-block_"+o.options.position+"-sidebar-hidden"),t.removeClass("content-block_"+o.options.position+"-sidebar")),o.options.disabled&&(i.addClass("moto-ui-sidebar_disabled"),t.addClass("content-block_"+o.options.position+"-sidebar-hidden"))}function c(){s.off("blur",c),s=null,i.find(":hover").length||o.slideDownColumn()}function p(e){s||(s=$(e.target)).on("blur",c),s.is("input,textarea,[contenteditable]")&&i.hasClass("moto-ui-sidebar_hidden")&&(i.addClass("no-transition"),o.slideUpColumn(),setTimeout(function(){i.removeClass("no-transition")},0))}o.slideDownColumn=function(e){var t=angular.element(".uk-tooltip").data("isCursorInsideTooltip");!o.options.hideable||t&&e&&t(e)||e&&$(e.target).is("select")||e&&$(e.target).is("button")||i.addClass("moto-ui-sidebar_hidden")},o.slideUpColumn=function(){if(!o.options.hideable)return!1;i.removeClass("moto-ui-sidebar_hidden")},o.toggleControlPanel=function(){o.options.hideable=o.options.hideable?0:1,o.options.key&&(r!=o.options.hideable?u.addFlag("sidebars",o.options.key):u.removeFlag("sidebars",o.options.key)),l(),d.$emit("MotoUI.Sidebar.Toggled")},t=angular.element(".content-block"),o.options=o.$eval(e.motoUiSidebar),o.options.key&&(r=o.options.hideable,u.flagExists("sidebars",o.options.key)&&(o.options.hideable=!o.options.hideable)),i.addClass("moto-ui-sidebar_"+o.options.position),l(),i.css("display",""),angular.element("body").delegate(".uk-tooltip","mouseleave",o.slideDownColumn),n=d.$on("MotoUI.Sidebar.SetDisabled",function(e,t){o.options.position==t.targetPosition&&(o.options.disabled=t.disabled,l())}),a=d.$on("MotoUI.Sidebar.SlideDown",function(e,t){o.options.position==t.targetPosition&&o.slideDownColumn()}),i.on("keydown",p),o.$on("$destroy",function(){angular.element("body").undelegate(".uk-tooltip","mouseleave",o.slideDownColumn),n(),a(),i.off("keydown",p)})}}}]),angular.module("motoUI").directive("motoUiTimepicker",[function(){return{restrict:"E",templateUrl:"@motoUI/timepicker/timepicker.tpl.html",scope:{dateModel:"=ngModel",isMeridian:"=?timeMeridianMode"},require:"ngModel",link:function(t,e,o,i){t.showSeconds=!0,angular.isUndefined(t.isMeridian)&&(t.isMeridian=!0),t.setMeridian=function(e){t.isMeridian=e},i.$formatters.push(function(){o.ngChange&&t.$parent.$eval(o.ngChange)})}}}]),angular.module("motoUI").directive("motoUiToggleBlock",["$rootScope","MotoLocalStorage","$translate",function(e,g,m){return{restrict:"A",transclude:!0,replace:!0,priority:500,templateUrl:"@motoUI/toggle_block/toggle_block.tpl.html",link:function(e,t,o){var i,r=t.children(".sidebar-content-title"),n=t.children(".sidebar-content-container"),a=r.children(".moto-ui__toggle-block_icon"),s=r.children(".moto-ui__toggle-block_title"),l="moto-ui__toggle-block_closed",c="moto-ui__toggle-block_container_init-hidden",p=!1;function d(){p=p?(n.is("."+c)&&(n.removeClass(c),n.hide()),r.removeClass(l),n.slideDown(300),!1):(r.addClass(l),n.slideUp(300),!0),i.key&&(p!=i.closed?g.addFlag("toggle_blocks",i.key):g.removeFlag("toggle_blocks",i.key)),e.$$phase||e.$apply()}function u(e){e.preventDefault()}(i=e.$eval(o.motoUiToggleBlock))||(i={title:o.motoUiToggleBlock}),null==i.toggle&&(i.toggle=1),null==i.closed&&(i.closed=0),null==i.tooltipPosition&&(i.tooltipPosition="top-right"),(i.key&&g.flagExists("toggle_blocks",i.key)?!i.closed:i.closed)&&(p=!0,r.addClass(l),n.addClass(c)),i.toggle&&(r.on("click",d),r.on("mousedown",u),r.addClass("moto-ui__toggle-block_toggle")),i.iconClass&&a.addClass(i.iconClass),i.title&&s.text(m.instant(i.title)),i.tooltip&&s.append('<span class="help-tooltip" data-uk-tooltip="{pos: \''+i.tooltipPosition+"', cls: 'middle-tip'}\" title=\""+m.instant(i.tooltip)+'"></span>'),i.titleOnly&&n.hide(),i.noPadding&&n.addClass("sidebar-content-container_no-padding"),e.$on("$destroy",function(){r.off("click",d),r.off("mousedown",u)})}}}]),angular.module("application.actions.widgets",["application.actions.widget.open_popup"]),angular.module("application.blog.widgets",["application.core","application.blog.widget.post_list","application.blog.widget.recent_posts","application.blog.widget.post_content","application.blog.widget.post_name","application.blog.widget.post_author","application.blog.widget.post_published_on","application.blog.widget.post_tags","application.blog.widget.tag_name","application.blog.widget.tag_description","application.blog.widget.category_name","application.blog.widget.category_description","application.blog.widget.category_list","application.blog.widget.post_category","application.blog.widget.post_comments"]),angular.module("application.widget.carousel",["application.core"]),angular.module("application.form_elements.widgets",["application.widget.form_elements.button_submit","application.widget.form_elements.input","application.widget.form_elements.textarea","application.widget.form_elements.label","application.widget.form_elements.select","application.widget.form_elements.radio_buttons","application.widget.form_elements.status_message","application.widget.form_elements.checkbox","application.widget.form_elements.attachment","application.widget.form_elements.recaptcha"]).config(["core.library.editor.WidgetsServiceProvider",function(e){e.addCategory("form_elements","WIDGET.FORM_ELEMENTS.FORM_ELEMENTS_LABEL",12,!0)}]),angular.module("application.widget.google_map_pro",["application.core","core.library.scriptsInjector"]),angular.module("application.widget.grid_gallery",["application.widget.abstract","core.library.messenger"]),angular.module("application.integrations.widgets",["application.integrations.widget.acuity_scheduling","application.integrations.widget.opentable","application.integrations.widget.airbnb"]).config(["core.library.editor.WidgetsServiceProvider",function(e){e.addCategory("integrations","WIDGET.INTEGRATIONS.INTEGRATION_LABEL",24,!1)}]),angular.module("application.widget.row.resizer",[]).run(["$rootScope","MotoWidgetRowResizer","EditorHistoryManager",function(e,s,t){t.registerAction({name:"rowColumnsResized",run:function(e,t,o){e.getWidgetById(t.id).resizeColumn(t.columnIndex,t.deltaSize),s.hideResizer(),o()},transformDataFromInverseAction:function(e,t){return t.deltaSize*=-1,t}}),e.$on("NEW EVENT: MotoEditor.config:after",function(e,t){var i=t.getGlobal("$"),r=t.getEditor(),o=r.getScope();function n(){s.hideResizer()}function a(e){var t=r.Utils.getClosestWidgetElement(e.target),o=r.getWidgetByDom(t);o&&i(e.currentTarget).hasClass("moto-cell")&&o._parent&&"row"===o._parent.name&&s.showResizer(e,o._parent)}r._$window.on("resize",n),r._$body.on("mousemove",".moto-cell",a),o.$on("NEW EVENT: Widget will be removed",n),o.$on("NEW EVENT: Editor self destroyed",function(){s.destroyResizer(),r._$window.off("resize",n),r._$body.off("mousemove",".moto-cell",a)}),o.$on("NEW EVENT: Widget was selected",n),o.$on("NEW EVENT: Widget was moved by editor",n),o.$on("NEW EVENT: Widget properties were changed",n),o.$on("NEW EVENT: Editor finished activating section",function(){s.initializeResizer(r)})})}]),angular.module("application.widget.slider",["application.widget.abstract"]),angular.module("application.widget.tile_gallery",["application.widget.abstract"]),function(){var m="accordion",f="accordion.item";angular.module("application.widget.accordion_handlers",["ng"]).config(["motoWidgetsWhiteListProvider",function(e){e.add(m,[f,"text","image","button","divider_horizontal","spacer","row","row.column"])}]).run(["$rootScope","motoWidgetsWhiteList",function(e,i){var l,n=!1;function c(e){var t,o=!1;if(!e)return o;for(t=e;t;){if(t.name===m){o=!0;break}t=t._parent}return o}function p(e){return i.isAllowed(m,e)}function o(e,t,o){return c(o.targetWidget)?(n&&console.info("Start cleaning buffer by white list ",i.get(m)),function e(t){var o,i;if(!angular.isArray(t.children)||!t.children.length)return t;for(o=0;o<t.children.length;o++)p((i=t.children[o]).name)?angular.isArray(i.children)&&i.children.length&&(i=e(i)):(n&&console.warn("DROP widget from buffer",i.name),t.children.splice(o,1));return t}(t)):(n&&console.info("Ignore cleaning buffer because target widget not ",m),t)}function r(e,t,o){var i=o.targetWidget;return t&&(c(i)?o.buffer&&o.buffer.name?(t=p(o.buffer.name),n&&console.warn('Buffered widget "'+o.buffer.name+'" checked by "'+m+'" => ',t)):n&&console.warn("Cant checking for allow paste buffer because buffer is invalid",o.buffer):n&&console.info("Ignore checking for allow paste buffer target widget not ",m)),t}function a(e,t,o){var i=o.targetWidget,r=o.dropObject;return t&&c(i)?i.name===m&&r.widgetName!==f?(n&&console.info('Reject drop "'+r.widgetName+'" because primary child widget must be item "'+f+'" but target is "'+i.name+'"'),!1):(r.isNew?(t=p(r.widgetName),n&&console.warn('Drag NEW widget "'+r.widgetName+'" checked by "'+m+'" => ',t)):(t=function e(t){var o,i,r=p(t.name);if(!r)return n&&console.info('Denied use widget "'+t.name+'"'),r;if(!t.children||!t.children.length)return r;for(o=0,i=t.children.length;o<i;o++)if(!(r=e(t.children[o])))return r;return r}(r.widget),n&&console.warn('Drag existed widget "'+r.widget.name+'" checked by "'+m+'" => ',t)),t):t}function s(e,t,o){var i,r;return c(t)?t.name===m&&(i=o.position,r=t.getPositionInContent(),i.positionIndex=r.positionIndex+1,i.containerIndex=r.containerIndex,t=t._parent,n&&console.info("Target widget was fixed to",t)):n&&console.info('Ignore checking on paste widget target widget "'+t+'" not ',m),t}function d(e,t,o){var i,r,n,a,s;if(!c(t))return t;if(i=l.Utils.getContainerEdgeHeight(t),n=t._$dom.outerWidth(),r=t._$dom.outerHeight(),a=/(desktop|tablet)/.test(o.device),s=o.eventPositions.clientX-t._$dom.offset().left,t.isFirstInParent()&&o.eventPositions.targetWidgetOffsetY<=i||t.isLastInParent()&&o.eventPositions.targetWidgetOffsetY>=r-i||s<=20&&60<n&&a||n-20<=s&&60<n&&a||!p(o.droppedWidgetOptions.widgetName))for(;t&&t.name!==m;)t=t._parent;return t}function u(e,t,o){try{if("section"===o.parentWidget.name&&o.droppedWidgetOptions.widgetName===m)return!0}catch(e){n&&(console.warn("Error on onCheckIsNeedToWrapRow"),console.error(e))}return t}function g(e,t,o){var i;switch(t){case"removeWidget":case"createWidget":i=l.getWidgetById(o.parent);break;case"moveWidget":i=l.getWidgetById(o.targetWidgetId);break;case"setProperties":case"rowColumnsResized":case"widgetEditorActivated":case"widgetEditorDeactivated":i=l.getWidgetById(o.id);break;default:console.error("accordion_handlers.js : unexpected undo/redo action")}for(;i;){if(i.name===f)return void i.openOnPreview();i=i._parent}}e.$on("NEW EVENT: MotoEditor.config:after",function(e,t){(l=t.getEditor()).addInterceptor(l.INTERCEPTOR__PASTE_BUFFER_CLEANING,o),l.addInterceptor(l.INTERCEPTOR__BUFFER_IS_ALLOW_TO_PASTE,r),l.addInterceptor(l.INTERCEPTOR__IS_ALLOW_DROP_OBJECT,a),l.addInterceptor(l.INTERCEPTOR__PASTE_FROM_BUFFER,s),l.addInterceptor(l.INTERCEPTOR__DRAG_OVER_TARGET_WIDGET,d),l.addInterceptor(l.INTERCEPTOR__IS_NEED_TO_WRAP_WITH_ROW,u),l.addInterceptor(l.INTERCEPTOR__UNDO_REDO_ACTION_BEFORE,g)})}])}(),angular.module("application.widget.accordion_item",["application.widget.abstract_container"]).run(["coreLibraryWidget","core.library.editor.PresetsService",function(e,t){var o=e.get("AbstractContainerWidgetClass");function i(){this.properties={header:{content:"",icon:null}},o.apply(this,arguments)}((i.prototype=Object.create(o.prototype)).constructor=i).prototype.name="accordion.item",i.prototype.label="WIDGET.ACCORDION_ITEM.NAME",i.prototype._apiVersion=2,i.prototype._transformToMacros=!0,i.prototype._template={engine:"nunjucks",path:"@websiteWidgets/accordion/templates/item.twig.html"},i.prototype.getRenderVariables=function(){return{currentWidget:this}},i.prototype.isCopyable=function(){return!0},i.prototype.isDraggable=function(){return!1},i.prototype.isVisibleInNesting=function(){return!1},i.prototype.getHelperInsertPosition=function(){return"append"},i.prototype.getDomElementsWhereWidgetsCanBePlaced=function(){return this._$dom.find(">.moto-widget-accordion__content-wrapper>.moto-widget-accordion__content")},i.prototype.getTargetElement=function(e){return e&&0<=["prepend","append"].indexOf(e.position)?this.getDomElementsWhereWidgetsCanBePlaced():o.prototype.getTargetElement.call(this,e)},i.prototype.getWidgetForHelper=function(e){return"draghover"===e?this:this._parent.getWidgetForHelper(e)},i.prototype.manualUpdateContentView=function(){this._$dom.find(">.moto-widget-accordion__header>.moto-widget-accordion__header-title").html(this.properties.header.content),this._$dom.find(">.moto-widget-accordion__header>.moto-widget-accordion__header-icon").remove(),this.properties.header.icon&&this.properties.header.icon.id&&this._$dom.find(">.moto-widget-accordion__header").prepend('<span class="moto-widget-accordion__header-item moto-widget-accordion__header-icon"><span class="fa fa-fw fa-'+this.properties.header.icon.id+'" aria-hidden="true"></span></span>')},i.prototype.create=function(){this.updateEmptyClass(),o.prototype.create.apply(this,arguments)},i.prototype.initialize=function(){this.updateEmptyClass(),o.prototype.initialize.apply(this,arguments)},i.prototype.isOpenedOnPreview=function(){return this._$dom.hasClass("moto-widget-accordion__item_open")},i.prototype.closeOnPreview=function(){this.isOpenedOnPreview()&&this.toggleOnPreview()},i.prototype.openOnPreview=function(){this.isOpenedOnPreview()||this.toggleOnPreview()},i.prototype.toggleOnPreview=function(){this._$dom.find(">.moto-widget-accordion__header").click()},i.prototype.isOpenedByDefault=function(){return this.isFirstInParent()&&this._parent.properties.expandedFirstItem},i.prototype.onAppendChildEvent=function(){this.openOnPreview(),o.prototype.onAppendChildEvent.apply(this,arguments)},e.set(i.prototype.name,i),t.addWidget({name:"accordion.item",base:"accordion",enabled:!0})}]),angular.module("application.widget.accordion",["application.widget.abstract_container","application.widget.accordion_item","application.widget.accordion_handlers"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","core.library.editor.PresetsService","motoFeatures","coreLibraryModal","coreLibraryUtils",function(e,t,o,i,n,r){var a,s=e.get("AbstractContainerWidgetClass");function l(o){var i;o.data("_$scope")?o.data("_$scope").$broadcast("motoWidgetAccordion:updateData"):a.injector().invoke(["$rootScope","$compile",function(e,t){i=e.$new(),o.data("_$scope",i),t(o)(i),i.$digest()}])}function c(r){r.openItemPopup=function(o){var i={header:{content:"",icon:null}};n("@websiteWidgets/accordion/src/backend/views/item.tpl.html",function(e,t){e.editingMode=!!o,e.item=e.editingMode?angular.copy(o.properties):angular.copy(i),e.ok=function(){e.editAccordionItem.$valid&&(e.editingMode?o.setProperties({header:e.item.header}):r.currentWidget._Editor.ContentManager.insertOrMoveWidgetByOptions({droppedWidgetOptions:{isNew:!0,widgetName:"accordion.item",options:{properties:{header:e.item.header}}},position:"append",targetWidget:r.currentWidget}),t.close(e))},e.cancel=function(){t.close(e)}})},r.deleteItem=r.currentWidget._Editor.userWantsToRemoveWidget,r.duplicateItem=r.currentWidget._Editor.userWantsToDuplicateWidget}function p(){this.properties={preset:"default",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},closeOthers:!0,expandedFirstItem:!1,showCollapseIcon:!0,collapseIconAlign:"right",visible_on:"mobile-v",animation:""},s.apply(this,arguments)}c.$inject=["$scope"],((p.prototype=Object.create(s.prototype)).constructor=p).prototype.controller=c,p.prototype.name="accordion",p.prototype.label="WIDGET.ACCORDION.NAME",p.prototype._apiVersion=2,p.prototype._transformToMacros=!0,p.prototype._dragImagePath="@websiteWidgets/accordion/icons/drag.png",p.prototype._template={engine:"nunjucks",path:"@websiteWidgets/accordion/templates/default.twig.html"},p.prototype.getRenderVariables=function(){return{currentWidget:this}},p.prototype.isCopyable=function(){return!0},p.prototype.getHelperInsertPosition=function(e){var t=/(desktop|tablet)/.test(e.device),o=this._$dom.outerWidth();return e.eventPositions.targetWidgetOffsetX<=20&&60<o&&t?"left":e.eventPositions.targetWidgetOffsetX>=o-20&&60<o&&t?"right":e.eventPositions.targetWidgetOffsetY<=this._$dom.outerHeight()/2?"before":"after"},p.prototype.getDomElementsWhereWidgetsCanBePlaced=function(){return this._$dom.find(">.moto-widget-accordion__wrapper")},p.prototype.getTargetElement=function(e){return e&&0<=["prepend","append"].indexOf(e.position)?this.getDomElementsWhereWidgetsCanBePlaced():s.prototype.getTargetElement.call(this,e)},p.prototype.afterCreate=function(){this.properties.items&&!this.children.length&&(this.properties.items.forEach(function(e){this.children.push({name:"accordion.item",properties:{header:e.header},children:e.body.content})}.bind(this)),delete this.properties.items,e.reviveChildrenWidgets(this),this.renderPreview())},p.prototype.initialize=function(){l(this._$dom),this.updateEmptyClass(),s.prototype.initialize.apply(this,arguments)},p.prototype.create=function(){l(this._$dom),this.updateEmptyClass(),s.prototype.create.apply(this,arguments)},p.prototype.onAppendChildEvent=function(){s.prototype.onAppendChildEvent.apply(this,arguments),l(this._$dom)},p.prototype.onRemoveChildEvent=function(){s.prototype.onRemoveChildEvent.apply(this,arguments),l(this._$dom)},p.prototype.postRenderPreview=function(){s.prototype.postRenderPreview.apply(this,arguments),l(this._$dom)},p.prototype.manualUpdateContentView=function(e){var t,o=r.objectDiffQuick(this.properties,e);null!==o&&(angular.isDefined(o.closeOthers)&&(this.properties.closeOthers?(this._$dom.attr("data-close-others",""),l(this._$dom),this.children.reduce(function(e,t){return t.isOpenedOnPreview()?(e&&t.toggleOnPreview(),!0):e},!1)):(this._$dom.removeAttr("data-close-others"),l(this._$dom))),(angular.isDefined(o.showCollapseIcon)||angular.isDefined(o.collapseIconAlign))&&((t=this._$dom.find(">.moto-widget-accordion__wrapper>.moto-widget-accordion__item")).removeClass("moto-widget-accordion__item_collapse-icon-left moto-widget-accordion__item_collapse-icon-right moto-widget-accordion__item_collapse-icon-disabled").addClass("moto-widget-accordion__item_collapse-icon-"+(this.properties.showCollapseIcon?this.properties.collapseIconAlign:"disabled")).find(">.moto-widget-accordion__header>.moto-widget-accordion__collapse-icon").remove(),this.properties.showCollapseIcon&&t.find(">.moto-widget-accordion__header").prepend('<span class="moto-widget-accordion__header-item moto-widget-accordion__collapse-icon fa fa-fw" aria-hidden="true"></span>')),angular.isDefined(o.visible_on)&&this._$dom.removeClass("moto-visible-on_desktop moto-visible-on_tablet moto-visible-on_mobile-h").addClass(this.getVisibleOn("classes")),angular.isDefined(o.preset)&&this._$dom.attr("class",this._$dom.attr("class").replace(/(^|\s)moto-preset-\S+/g," moto-preset-"+this.properties.preset)))},p.prototype._replaceNode=function(e){var t;this._$dom&&(t=this._$dom.data("_$scope"))&&t.$destroy(),s.prototype._replaceNode.call(this,e)},e.doWhenLivePreviewReady(function(e){a=e.angular.element("<div></div>"),e.angular.bootstrap(a,["website.widget.accordion"]),e.angular.element(".moto-widget-accordion").each(function(){l(e.angular.element(this))})}),e.set(p.prototype.name,p),t.addWidget({name:p.prototype.name,label:p.prototype.label,category:"more",order:45,options:{children:[]},icons:{small:"icon icon-accordion",medium:"icon-accordion-medium",large:"icon icon-accordion"}}),o.addWidget({name:p.prototype.name,label:"WIDGET.ACCORDION.NAME",category:"more",order:3,enabled:!0,checkPresetControls:!1,stateParam:"accordion",template:{path:"@websiteWidgets/accordion/templates/default.twig.css",engine:"nunjucks"},icons:{small:"icon icon-accordion",medium:"icon icon-accordion-medium",large:"icon icon-accordion"}})}]),angular.module("application.actions.widget.open_popup",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","motoFeatures","$rootScope",function(e,t,o,i){var r=e.get("AbstractWidgetClass");function n(e,t,o){try{if("section"===o.parentWidget.name&&"actions.open_popup"===o.droppedWidgetOptions.widgetName)return!1}catch(e){}return t}function a(e,t){var o,i;o=e.currentWidget,(i=new Date).setHours(o.properties.delayTime/36e5%24,o.properties.delayTime/6e4%60,o.properties.delayTime/1e3%60,0),o.viewData.delayTime=i,o.viewData.overtime={days:Math.floor(o.properties.recurrenceOptions.overtime/86400),hours:Math.floor(o.properties.recurrenceOptions.overtime%86400/3600)},e.popups=t.objects(function(e){return"popup"===e.type&&0===parseInt(e.is_system)}),e.delayTimeChanged=function(){e.currentWidget.viewData.delayTime?e.currentWidget.properties.delayTime=1e3*e.currentWidget.viewData.delayTime.getSeconds()+6e4*e.currentWidget.viewData.delayTime.getMinutes()+36e5*e.currentWidget.viewData.delayTime.getHours():e.currentWidget.properties.delayTime=0},e.overtimeChanged=function(){e.currentWidget.properties.recurrenceOptions.overtime=86400*e.currentWidget.viewData.overtime.days+3600*e.currentWidget.viewData.overtime.hours}}function s(){this.properties={actionId:"",popupId:null,triggerType:"timer",delayTime:0,recurrenceCondition:"session",recurrenceOptions:{shows:1,overtime:86400}},this.viewData={},r.apply(this,arguments)}i.$on("NEW EVENT: MotoEditor.config:after",function(e,t){var o=t.getEditor();o.addInterceptor(o.INTERCEPTOR__IS_NEED_TO_WRAP_WITH_ROW,n)}),a.$inject=["$scope","application.content_service.services.ContentModelService"],((s.prototype=Object.create(r.prototype)).constructor=s).prototype._transformToMacros=!0,s.prototype.name="actions.open_popup",s.prototype.label="WIDGET.ACTIONS.OPEN_POPUP.NAME",s.prototype.controller=a,s.prototype._apiVersion=2,s.prototype._templateViewURL="@websiteWidgets/actions/views/open_popup_properties.tpl.html",s.prototype._dragImagePath="@websiteWidgets/actions/icons/open_popup/drag.png",s.prototype._template={engine:"nunjucks",path:"@websiteWidgets/actions/templates/open_popup.twig.html"},s.prototype.exportForFuture=function(){return null},s.prototype.isCopyable=function(){return!0},s.prototype.create=function(){this.properties.actionId=this._id+"_"+Date.now(),r.prototype.create.call(this)},t.addWidget({name:s.prototype.name,label:s.prototype.label,category:"more",order:47,enabled:o.isEnabled("theme_widget_actions_open_popup"),icons:{small:"icon icon-actions-open_popup",medium:"icon icon-actions-open_popup",large:"icon icon-actions-open_popup"}}),e.set(s.prototype.name,s)}]),angular.module("application.widget.audio_player",["application.widget.abstract","application.media_library"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","application.media_library.services.MediaLibraryService","core.library.editor.PresetsService","motoFeatures",function(e,t,o,i,r){var n=e.get("AbstractWidgetClass");function a(){this.properties={preset:"default",tracks:[{id:null,name:null,path:null,filesize:null,length:null,bitrate:null,meta:{artist:"",title:"",album:""}}],settings:{autoplay:!1,loop:!0,muted:!0,volume:1},buttons:{playpause:!0,stop:!0,muted:!0,loop:!0},animation:"",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"}},n.apply(this,arguments)}function s(e,t){e.mediaelementplayer({setDimensions:!1,alwaysShowControls:!0,motoTrackName:t.tracks[0].name||"",loop:t.settings.loop,timeAndDurationSeparator:"<span>/</span>",startVolume:1,playText:"",pauseText:"",stopText:"",features:["playpause",t.buttons.stop?"stop":"","progress","current","duration","mototrackname","volume",t.buttons.loop?"motoloop":"","motoskin"],plugins:[],keyActions:[],duration:t.tracks[0].length})}((a.prototype=Object.create(n.prototype)).constructor=a).prototype._transformToMacros=!0,a.prototype.name="audio_player",a.prototype.label="WIDGET.AUDIO_PLAYER.NAME",a.prototype._dragImagePath="@websiteWidgets/audio_player/icons/drag.png",a.prototype._apiVersion=2,a.prototype._template={engine:"nunjucks",path:"@websiteWidgets/audio_player/templates/default.twig.html"},a.prototype.postRenderPreview=function(){n.prototype.postRenderPreview.apply(this,arguments),s(this._$dom.find("audio"),this.properties)},a.prototype.isCopyable=function(){return!0},a.prototype.onWidthChanged=function(){var e=this._$dom.find("audio")[0].player;e&&(e.setPlayerSize(),e.setControlsSize())},a.prototype.initialize=function(){s(this._$dom.find("audio"),this.properties),n.prototype.initialize.call(this)},a.prototype.create=function(){s(this._$dom.find("audio"),this.properties),this._Editor.isSilentMode(this)||this.changeAudioFile(),n.prototype.create.call(this)},a.prototype.changeAudioFile=function(){var t=this;o.open({value:this.properties.tracks[0].path,id:this.properties.tracks[0].id,filters:["audio"],extensions:["mp3"],onApply:function(e){t.__getPublicInstance().properties.tracks[0]={id:e.id,path:e.path,name:e.name,filesize:e.filesize||null,length:e.properties.playtime_seconds||0,bitrate:e.properties.audio.bitrate||0,meta:{artist:"",title:"",album:""}}}})},a.prototype.onDoubleClickEvent=function(){this.changeAudioFile()},a.prototype.exportForFuture=function(){var e,t,o=n.prototype.exportForFuture.call(this);if(angular.isArray(o.properties.tracks))for(e=0,t=o.properties.tracks.length;e<t;e++)delete o.properties.tracks[e].id;return o},e.set(a.prototype.name,a),e.doWhenLivePreviewReady(function(e){e.$(".moto-widget-audio_player").each(function(){try{s(e.$(this).find("audio"),e.widgetCacheOptions[e.$(this).data("widget-id")].properties)}catch(e){}})}),e.doWhenWidthChanged(function(t){t.$(".moto-widget-audio_player").each(function(){var e=t.$(this).find("audio")[0].player;e.setPlayerSize(),e.setControlsSize()})}),t.addWidget({name:a.prototype.name,label:a.prototype.label,category:"media",order:50,enabled:!0,allowed:function(){return!0},icons:{small:"icon icon-audio_player",medium:"",large:"icon icon-audio_player"}}),i.addWidget({name:a.prototype.name,label:"WIDGET.AUDIO_PLAYER.BUILDER_NAME",category:"media",order:5,enabled:!0,checkPresetControls:!1,stateParam:"media-player",template:{path:"@websiteWidgets/audio_player/templates/default.twig.css",engine:"nunjucks"},icons:{small:"icon icon-audio_player",medium:"icon icon-audio_player-medium",large:"icon icon-audio_player"}})}]),angular.module("application.widget.auth_form",["application.core"]).config(["core.library.editor.PresetsServiceProvider",function(e){e.addWidget({name:"auth_form",base:"contact_form"})}]).run(["coreLibraryWidget","core.library.editor.WidgetsService","$translate",function(e,t,o){var i=e.get("AbstractWidgetClass");function r(){return{fields:{password:{placeholder:o.instant("WIDGET.AUTH_FORM.FORM_FIELD_NAME_VALUE")}},buttons:{submit:{label:o.instant("WIDGET.AUTH_FORM.FORM_BUTTON_VALUE")}},messages:{wrong_password:o.instant("WIDGET.AUTH_FORM.FORM_WRONG_PASSWORD_VALUE"),error:o.instant("WIDGET.AUTH_FORM.FORM_ERROR_SENDING_VALUE")}}}function n(){this.properties={preset:"default",animation:"",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},fields:{password:{enabled:!0,required:!0,type:"text"}},messages:{},buttons:{submit:{preset:"default",size:"medium",align:"left"}},settings:{}},this.properties=$.extend(!0,r(),this.properties),i.apply(this,arguments)}function a(e){e.defaultTranslates=r()}a.$inject=["$scope"],((n.prototype=Object.create(i.prototype)).constructor=n).prototype.controller=a,n.prototype._transformToMacros=!0,n.prototype._apiVersion=2,n.prototype.name="auth_form",n.prototype.label="WIDGET.AUTH_FORM.NAME",n.prototype._dragImagePath="@websiteWidgets/auth_form/icons/drag.png",n.prototype._template={engine:"nunjucks",path:"@websiteWidgets/auth_form/templates/default.twig.html"},n.prototype.isRemovable=function(){return!1},e.set("auth_form",n),t.addWidget({name:n.prototype.name,label:n.prototype.label,category:"basic",order:35,enabled:!1,icons:{small:"icon icon-contact_form",medium:"",large:"icon icon-contact-form"}})}]),angular.module("application.widget.back_to_top",["application.widget.abstract","core.library.config"]).run(["core.library.editor.PresetsService",function(e){e.addWidget({name:"back_to_top",label:"WIDGET.BACK_TO_TOP.NAME",category:"basic",stateParam:"back_to_top",checkPresetControls:!1,order:13,enabled:!0,icons:{small:"icon icon-back-to-top",medium:"icon icon-back-to-top-medium",large:"icon icon-back-to-top"},template:{path:"@websiteWidgets/back_to_top/templates/default.twig.css",engine:"nunjucks"}})}]),angular.module("application.widget.block",["application.widget.abstract_container","core.library.messenger","application.design"]).run(["$rootScope","coreLibraryWidget","coreLibraryMessenger","$translate","core.library.editor.WidgetsService","motoFeatures","coreLibraryModal","application.media_library.services.MediaLibraryService","$q","$http","$templateCache","coreLibraryWidgetTraits","coreLibrarySpacingHelper",function(e,s,a,l,t,c,p,d,r,n,u,o,i){var g,m,f,h,y=s.get("AbstractContainerWidgetClass"),b="row-fixed";function _(i,o){var r,n=i.currentWidget._Editor;i.devBlocksBuilderForThemeEnabled=c.isEnabled("dev_blocks_builder_for_theme"),i.lastItem=null,i.blocksCollection=null,i.request={action:"add",category:"headers",block:null,inProgress:!1},o.getBlocks().then(function(e){var t,o;for(i.blocksCollection=e,i.blockCategories=e.categories,i.blocksWithTemplateUrl=[],t=0;t<i.blocksCollection.items.length;t++)(o=i.blocksCollection.items[t])&&o.options&&o.options.templateUrl&&i.blocksWithTemplateUrl.push(i.blocksCollection.items[t])}),i.updateOldBlocks=function(){var e,t;if(r||($("#id_live_preview").hide().before('<h1 class="h1"><i class="fa fa-refresh fa-5x fa-spin" style="color: #ffab26; padding: 50px"></i></h1>'),$(".moto-ui-sidebar,.preview-controls").hide(),r=!0),!i.blocksWithTemplateUrl.length)return r&&($("#id_live_preview").show().prev().remove(),$(".moto-ui-sidebar,.preview-controls").show(),r=!1),void a.success("All blocks were updated! 🚀");t=i.blocksWithTemplateUrl.pop(),e=n.getCurrentSection(),n.ContentManager.insertOrMoveWidgetByOptions({targetWidget:e,droppedWidgetOptions:{isNew:!0,widgetName:"block",options:{templateUrl:t.options.templateUrl}},targetConfig:{indexInContainer:0,containerIndex:0},callback:function(e){o.saveToTheme({id:t.id,order:t.order,category:t.category,content:angular.toJson(e.exportForFuture())}).then(function(e){t.options=e.options,i.updateOldBlocks()},function(e){a.error("Error: "+l.instant(e.message,e.data))}),n.destroyWidget(e)}})},i.selectBlockPreview=function(e){i.request.block=e,i.onChangeRequest("block")},i.onChangeRequest=function(e){"category"!==e&&"action"!==e||(i.request.block=null)},i.saveToTheme=function(){var e=angular.toJson(i.currentWidget.exportForFuture()),t={id:null};i.request.inProgress=!0,i.lastItem=null,"update"===i.request.action&&(t={id:i.request.block.id,order:i.request.block.order}),t.content=e,t.category=i.request.category,!angular.isUndefined(i.request.allowed)&&i.request.allowed&&(t.allowed=i.request.allowed),o.saveToTheme(t,i.currentWidget).then(function(o){if(i.request.inProgress=!1,console.log("Block template saved",o),i.lastItem=o,i.elementsPanel.loadContent(),o.previewGenerated)return a.success("COMMON.MESSAGES.CREATE_SUCCESS"),void console.log("Preview generated for block:",o.id);p("views/components/ui/modal/information.tpl.html",function(e,t){e.title="",e.message="WIDGET.BLOCK.TEMPLATE_SAVING_SUCCESS_MESSAGE",e.translate_params={previewFilePath:o.getPreviewFilePath(),previewFileName:o.getPreviewFileName()},e.ok=function(){t.close(e)}})},function(e){console.log("Error on saving block template",e),i.request.inProgress=!1,a.error("Error on saving block template:<br/>"+l.instant(e.message,e.data))})},i.setFixed=function(e){(i.currentWidget.properties.fixed=e)?i.currentWidget._$dom.addClass(b):i.currentWidget._$dom.removeClass(b),i.currentWidget._Editor.getScope().$broadcast("Widget.WidthChangedByWidget",i.currentWidget)},i.unsetFixedAndParallaxedProperties=function(){i.currentWidget.properties.bgFixed=!1,i.currentWidget.properties.bgParallaxed=!1},i.clearImage=function(){delete i.currentWidget.properties.styles["background-image"],delete i.currentWidget.properties.styles["background-size"],delete i.currentWidget.properties.styles["background-position"],delete i.currentWidget.properties.styles["background-repeat"],i.unsetFixedAndParallaxedProperties()},i.changeImage=function(){d.open({value:i.currentWidget.properties.styles["background-image"],thumbnails:!0,filters:["image"],onApply:function(e,t){e&&(i.currentWidget.properties.styles["background-image"]=t?e.getThumbnailPath(t):e.path,i.currentWidget.properties.styles["background-size"]||(i.currentWidget.properties.styles["background-size"]="auto"),i.currentWidget.properties.styles["background-position"]||(i.currentWidget.properties.styles["background-position"]="left top"),i.currentWidget.properties.styles["background-repeat"]||(i.currentWidget.properties.styles["background-repeat"]="no-repeat"))}})}}function v(e){e=e||{},this.isFixable=!1,this.properties={anchor:"",stickyEnabled:!1,styles:{"background-color":""},fixed:!1,bgFixed:!1,bgParallaxed:!1,bgPosition:"left top",bgVideo:{loop:!0,preload:"metadata",track:{webm:null,mp4:null}},spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"}},y.apply(this,arguments),this.templateUrl=e.templateUrl||this.templateUrl,this.contentUrl=e.contentUrl||this.contentUrl}e.$on("NEW EVENT: MotoEditor.config:after",function(e,t){g=t.getEditor(),f=m=null,g.addInterceptor(g.INTERCEPTOR__PASTE_FROM_BUFFER,function(e,t,o){var i,r,n,a;if(!s.isWidget(t))return t;if(!t._parent||"section"===t.name)return t;if(!angular.isObject(o)||!angular.isObject(o.buffer)||!angular.isObject(o.position))return t;if("block"!==o.buffer.name)return t;for(i=o.position,n=r=t;r._parent&&"section"!==(r=r._parent).name;)r._parent&&(n=r);return a=n.getPositionInContent(),i.positionIndex=a.positionIndex+1,i.containerIndex=0,r}),g.HelperHover.registerTemplate("block",{render:function(e){return'<div class="moto-editor-helper moto-editor-helper_hover moto-editor-widget-block-helper moto-editor_no-draggable" draggable="true"><div class="moto-editor-outline"></div><div class="moto-editor-label moto-editor-label_'+(27<g.getElementCharacteristics(e.widget._$dom).top?"top":"bottom")+'"><span class="moto-editor_draggable" draggable="true"><span class="icon moto-editor-drag-icon"></span><span class="helper-label">'+l.instant(e.widget.label)+'</span></span><span class="moto-editor_duplicate-closest-widget moto-editor-label-button_widget-duplicate"></span><span class="moto-editor_remove-closest-widget moto-editor-label-button_widget-remove"></span></div ></div>'}}),g.HelperSelected.registerTemplate("block",{render:function(e){return'<div class="moto-editor-helper moto-editor-helper_selected moto-editor-widget-block-helper moto-editor_no-draggable" draggable="true"><div class="moto-editor-outline"></div><div class="moto-editor-label moto-editor-label_'+(27<g.getElementCharacteristics(e.widget._$dom).top?"top":"bottom")+'"><span class="moto-editor_draggable" draggable="true"><span class="icon moto-editor-drag-icon"></span><span class="helper-label">'+l.instant(e.widget.label)+'</span></span ><span class="moto-editor_duplicate-closest-widget moto-editor-label-button_widget-duplicate"></span><span class="moto-editor_remove-closest-widget moto-editor-label-button_widget-remove"></span></div ></div>'}})}),_.$inject=["$scope","core.library.editor.BlocksService"],(v.prototype=Object.create(y.prototype)).constructor=v,o.useTrait("WidgetBackground",v),v.prototype.__backgroundTraitVideoAllowed=!0,v.prototype._apiVersion=2,v.prototype.name="block",v.prototype.label="WIDGET.BLOCK.NAME",v.prototype.controller=_,v.prototype.allow=["section"],v.prototype.templateUrl=null,v.prototype._dragImagePath="@websiteWidgets/block/icons/drag.png",v.prototype._template={engine:"nunjucks",path:"@websiteWidgets/block/templates/default.twig.html"},v.prototype.updateSticky=function(){this._$dom.removeAttr("moto-sticky"),this.properties.stickyEnabled?this._$dom.attr("data-moto-sticky","{}"):this._$dom.removeAttr("data-moto-sticky")},v.prototype.isCopyable=function(){return!0},v.prototype._getTemplateUrl=function(){var e;return angular.isObject(this._template)&&this._template.path&&(e=this._template.path),this.templateUrl&&(e=this.templateUrl),e||(e=y.prototype._getTemplateUrl.call(this)),e},v.prototype.updateFixableState=function(){0===this._$dom.parents(".moto-widget-row,.row-fixed").length?this.isFixable=!0:(this.isFixable=!1,this.properties.fixed=!1)},v.prototype.getRowFixedClassName=function(){return this.properties.fixed?b:null},v.prototype.loadPropertiesFromDom=function(){var e;(e=this.getAnchorDomElement()).length&&(this.properties.anchor=e.attr("name")),this.properties.fixed=this._$dom.hasClass(b),this.properties.stickyEnabled=!!this._$dom.attr("moto-sticky")||!!this._$dom.attr("data-moto-sticky"),this._loadBackgroundColorFromDom(),this._loadBackgroundImageFromDom(),this._loadBackgroundParallaxedFromDom(),this._loadBackgroundFixedFromDom(),this._loadBackgroundVideoFromDom()},v.prototype.initialize=function(){this.updateEmptyClass(),this._propertiesLoaded||this.loadPropertiesFromDom(),this.updateFixableState(),this._updateBackgroundView(),y.prototype.initialize.call(this)},v.prototype.create=function(){this.updateEmptyClass(),this._propertiesLoaded||(this.loadPropertiesFromDom(),this._$dom.data("spacing")&&(this.properties.spacing=i.parseShort(this._$dom.data("spacing"),this.properties.spacing||{}),this.updateSpacingsInDOM())),this.__backgroundTraitMigrateStrucure(),this.updateFixableState(),this.children.length||0<this.getDomElementsWhereWidgetsCanBePlaced().find(">.moto-widget").length&&this._EditorContentManager.getWidgetProcessor("initialize").execute(this),y.prototype.create.call(this),this._updateBackgroundView()},v.prototype.transform=function(){this.updateAnchorDomElement(),this._$dom.removeClass("moto-widget_selected moto-widget_empty"),this._transformBackgroundImage(),this._transformBackgroundVideo(),y.prototype.transform.call(this)},v.prototype.isAutoShowHelpers=function(){return!1},v.prototype.isAutoHideHelpers=function(){return!1},v.prototype.onSelectedEvent=function(){g.HelperSelected.hideByWidget(f).updateByWidget(this),g.HelperHover.hideByWidget(m).hideByWidget(this),f=this},v.prototype.onChildHoveredEvent=function(e,t){if(t.isSelected()&&this!==t)return g.HelperHover.hideByWidget(m),void(m=null);h&&clearTimeout(h),m!==this&&(g.HelperHover.hideByWidget(m),this.isSelected()||g.HelperHover.showByWidget(this)),m=this},v.prototype.onDragEndEvent=function(e){this.onSelectedEvent(e)},v.prototype.onChildSelectedEvent=function(e,t){t!==this&&(f!==this&&(g.HelperSelected.hideByWidget(f).hideByWidget(this),f=null),g.HelperHover.hideByWidget(m).hideByWidget(this),m=null)},v.prototype.onChildUnSelectedEvent=function(){g.HelperSelected.hideByWidget(f),f=null,g.HelperHover.hideByWidget(m),m=null},v.prototype.onChildUnHoveredEvent=function(){h&&clearTimeout(h),h=setTimeout(function(){g.HelperHover.hideByWidget(m),m=null},150)},v.prototype.exportForFuture=function(){var e=y.prototype.exportForFuture.call(this);return delete e.properties.anchor,e},v.prototype.getDomElementsWhereWidgetsCanBePlaced=function(){return this._$dom.find(">.container-fluid>.row>.moto-cell")},v.prototype.getTargetElement=function(e){return 0<=["before","after"].indexOf(e.position)&&(!e.targetConfig||angular.isUndefined(e.targetConfig.containerIndex))?this._$dom:y.prototype.getTargetElement.call(this,e)},v.prototype.beforeDestroy=function(){f=m=null},v.prototype.getRenderVariables=function(){var o=this,i=r.defer();return this.contentUrl?n({url:this.contentUrl,method:"GET",cache:u,ignoreLoadingBar:!0,transformResponse:function(e){var t;try{u.put(o.contentUrl,e),t=angular.fromJson(e)}catch(e){i.reject(e)}return t}}).then(function(e){var t;t=e.data,angular.extend(o.properties,t.properties),o._propertiesLoaded=!0,o.children=t.children,s.reviveChildrenWidgets(o),o.contentUrl=null,i.resolve({currentWidget:o})},function(e){i.reject(e)}):i.resolve({currentWidget:this}),i.promise},v.prototype._updateBackgroundView=function(){this._updateBackgroundColorInDom(),this._updateBackgroundImageInDom(),this._updateBackgroundParallaxedInDom(),this._updateBackgroundFixedInDom(),this._updateBackgroundVideoInDom(this.properties.bgVideo)},v.prototype.manualUpdateContentView=function(){this._updateBackgroundView(),this.updateSticky(),this.updateAnchorDomElement()},v.prototype.getCustomAttributes=function(){var e={};return this.properties.stickyEnabled&&(e["data-moto-sticky"]="{}"),this.properties.bgParallaxed&&(e["data-stellar-background-ratio"]="0.5"),this.properties.styles["background-image"]&&(e["data-bg-image"]=this.properties.styles["background-image"]),e},v.prototype.getCssClasses=function(){var e,t="";return this.properties.fixed&&(t+=" row-fixed"),this.properties.styles["background-color"]&&(e=this.getColorizerModel().getClassNameByColorName(this.properties.styles["background-color"],"moto-bg-color"))&&(t+=" "+e),t+=" "+this.getSpacing("classes")},v.prototype.getStylesValue=function(){return angular.copy(this.properties.styles)},s.set("block",v),c.isEnabled("dev_blocks_builder_for_theme")&&t.addWidget({name:v.prototype.name,label:v.prototype.label,category:"structure",order:20,enabled:!0,icons:{small:"icon icon-block",medium:"",large:"icon icon-block"}}),e.$on("NEW EVENT: User start drag new widget:block",function(e,t){var o;try{if("blocks"!==t.currentMode)return;0<(o=t.widget.getAllowedSections(t.currentPage&&t.currentPage.type)).length&&g.lockAllSection().unlockSectionByName(o,{lockedBy:"BLOCK"})}catch(e){}}),e.$on("NEW EVENT: User stop drag new widget:block",function(){g.unlockAllSection({lockedBy:"BLOCK"})})}]),angular.module("application.blog.widget.category_description",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","motoFeatures",function(e,t,o){var i=e.get("AbstractWidgetClass");function r(){this.properties={source:"short_description",firstPageOnly:!1,visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"}},i.apply(this,arguments)}(r.prototype=Object.create(i.prototype)).name="blog.category_description",r.prototype.label="WIDGET.BLOG.CATEGORY_DESCRIPTION.NAME",(r.prototype.constructor=r).prototype._templateViewURL="@websiteWidgets/blog/views/category_description_properties.tpl.html",r.prototype._transformToMacros=!0,r.prototype._apiVersion=2,r.prototype._dragImagePath="@websiteWidgets/blog/icons/category_description/drag.png",r.prototype._template={engine:"nunjucks",path:"@websiteWidgets/blog/templates/category_description.twig.html"},r.prototype.exportForFuture=function(){return null},r.prototype.isCopyable=function(){return!0},r.prototype.shouldUpdateContentView=function(){return!1},e.set(r.prototype.name,r),t.addWidget({name:r.prototype.name,label:r.prototype.label,category:"blog",order:20,enabled:o.isEnabled("theme_content_blog"),allowed:function(e,t){return"template.blog.category"===e.type&&"content"===t},icons:{small:"icon icon-blog-category_description",medium:"",large:"icon icon-blog-category_description"}})}]),angular.module("application.blog.widget.category_list",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","core.library.editor.PresetsService","motoFeatures","application.blog.services.CategoryService","$q",function(e,t,o,i,r,n){var a=e.get("AbstractWidgetClass"),s=[];function l(){this.properties={preset:"default",listType:"all",customList:[],hideEmpty:!1,enableDelimiter:!0,icon:null,align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""},spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"}},a.apply(this,arguments)}function c(o){r.getList({type:"blog.post",has:[]}).then(function(e){var t;o.allCategories=e.records,t=o.currentWidget.properties.customList.filter(function(t){return o.allCategories.some(function(e){return t===e.id})}),o.currentWidget._Editor.HistoryManager.lockAction("setProperties"),o.currentWidget.setProperties({customList:t}).then(function(){o.currentWidget._Editor.HistoryManager.unlockAction("setProperties")})})}c.$inject=["$scope"],(l.prototype=Object.create(a.prototype)).name="blog.category_list",l.prototype.label="WIDGET.BLOG.CATEGORY_LIST.NAME",(l.prototype.constructor=l).prototype.controller=c,l.prototype._templateViewURL="@websiteWidgets/blog/views/category_list_properties.tpl.html",l.prototype._transformToMacros=!0,l.prototype._apiVersion=2,l.prototype._dragImagePath="@websiteWidgets/blog/icons/category_list/drag.png",l.prototype._template={engine:"nunjucks",path:"@websiteWidgets/blog/templates/category_list.twig.html"},l.prototype.exportForFuture=function(){return null},l.prototype.isCopyable=function(){return!0},l.prototype.getRenderVariables=function(){var t=n.defer(),e={type:"blog.post",has:[]};return this.properties.hideEmpty&&e.has.push({relation:"pages",where:"@published"}),r.getList(e).then(function(e){s=e.records,t.resolve({currentWidget:this})}.bind(this)).catch(function(e){t.reject(e)}),t.promise},l.prototype.getCssClasses=function(){var e="moto-preset-"+this.properties.preset;return e+=" "+this.getSpacing("classes"),e+=" "+this.getAlignClass(),this.properties.enableDelimiter&&(e+=" moto-widget-blog-category_list_show-delimiter"),this.properties.icon||(e+=" moto-widget-blog-category_list_no-icon"),e},l.prototype.getCategories=function(){var o=this.properties.customList;return"all"===this.properties.listType?s:s.filter(function(e){return 0<=o.indexOf(e.id)}).sort(function(e,t){return o.indexOf(e.id)<o.indexOf(t.id)?-1:o.indexOf(e.id)===o.indexOf(t.id)?0:1})},e.set(l.prototype.name,l),t.addWidget({name:l.prototype.name,label:l.prototype.label,category:"blog",order:20,enabled:i.isEnabled("theme_content_blog"),allowed:function(e,t){return!(!e||"popup"===e.type)&&("blog.post"!==e.type||"content"!==t)},icons:{small:"icon icon-blog-category_list",medium:"icon-blog-category_list-medium",large:"icon icon-blog-category_list"}}),o.addWidget({name:l.prototype.name,label:l.prototype.label,category:"blog",order:12,enabled:i.isEnabled("theme_content_blog"),stateParam:"category_list",checkPresetControls:!1,presetPropertiesView:"@websiteWidgets/blog/views/category_list_preset_properties.tpl.html",template:{path:"@websiteWidgets/blog/templates/category_list.twig.css",engine:"nunjucks"},icons:{small:"icon icon-blog-category_list",medium:"icon-blog-category_list-medium",large:"icon icon-blog-category_list"}})}]),angular.module("application.blog.widget.category_name",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","motoFeatures",function(e,t,o){var i=e.get("AbstractWidgetClass");function r(){this.properties={htmlTag:"h1",text_style:"moto-text_system_7",visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""}},i.apply(this,arguments)}(r.prototype=Object.create(i.prototype)).name="blog.category_name",r.prototype.label="WIDGET.BLOG.CATEGORY_NAME.NAME",(r.prototype.constructor=r).prototype._templateViewURL="@websiteWidgets/blog/views/category_name_properties.tpl.html",r.prototype._transformToMacros=!0,r.prototype._apiVersion=2,r.prototype._dragImagePath="@websiteWidgets/blog/icons/category_name/drag.png",r.prototype._template={engine:"nunjucks",path:"@websiteWidgets/blog/templates/category_name.twig.html"},r.prototype.exportForFuture=function(){return null},r.prototype.isCopyable=function(){return!0},e.set(r.prototype.name,r),t.addWidget({name:r.prototype.name,label:r.prototype.label,category:"blog",order:15,enabled:o.isEnabled("theme_content_blog"),allowed:function(e,t){return"template.blog.category"===e.type&&"content"===t},icons:{small:"icon icon-blog-category_name",medium:"",large:"icon icon-blog-category_name"}})}]),angular.module("application.blog.widget.post_author",["application.core"]).run(["core.library.editor.WidgetsService","motoFeatures","coreLibraryWidget",function(e,t,o){var i=o.get("AbstractWidgetClass");function r(){this.properties={visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},font_style:"moto-text_normal",align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""}},i.apply(this,arguments)}((r.prototype=Object.create(i.prototype)).constructor=r).prototype._transformToMacros=!0,r.prototype.name="blog.post_author",r.prototype.label="WIDGET.BLOG.POST_AUTHOR.NAME",r.prototype._templateViewURL="@websiteWidgets/blog/views/post_author_properties.tpl.html",r.prototype._apiVersion=2,r.prototype._dragImagePath="@websiteWidgets/blog/icons/post_author/drag.png",r.prototype._template={engine:"nunjucks",path:"@websiteWidgets/blog/templates/post_author.twig.html"},r.prototype.isCopyable=function(){return!0},o.set("blog.post_author",r),t.isEnabled("theme_content_blog")&&e.addWidget({name:r.prototype.name,label:r.prototype.label,category:"blog",order:10,enabled:!0,allowed:function(e,t){return"template.blog.post"===e.type&&"content"===t},icons:{small:"icon icon-blog-post_author",medium:"",large:"icon icon-blog-post_author"}})}]),angular.module("application.blog.widget.post_category",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","motoFeatures",function(e,t,o){var i=e.get("AbstractWidgetClass");function r(){this.properties={font_style:"moto-text_normal",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""},visible_on:"mobile-v"},i.apply(this,arguments)}(r.prototype=Object.create(i.prototype)).name="blog.post_category",r.prototype.label="WIDGET.BLOG.POST_CATEGORY.NAME",(r.prototype.constructor=r).prototype._templateViewURL="@websiteWidgets/blog/views/post_category_properties.tpl.html",r.prototype._transformToMacros=!0,r.prototype._apiVersion=2,r.prototype._dragImagePath="@websiteWidgets/blog/icons/post_category/drag.png",r.prototype._template={engine:"nunjucks",path:"@websiteWidgets/blog/templates/post_category.twig.html"},r.prototype.exportForFuture=function(){return null},r.prototype.isCopyable=function(){return!0},r.prototype.getCategory=function(){return{name:"Category Name"}},e.set(r.prototype.name,r),t.addWidget({name:r.prototype.name,label:r.prototype.label,category:"blog",order:15,enabled:o.isEnabled("theme_content_blog"),allowed:function(e,t){return"template.blog.post"===e.type&&"content"===t},icons:{small:"icon icon-blog-post_category",medium:"icon-blog-post_category-medium",large:"icon icon-blog-post_category"}})}]),angular.module("application.blog.widget.post_comments",["application.core"]).run(["core.library.editor.WidgetsService","motoFeatures","coreLibraryWidget",function(e,t,o){var i=o.get("AbstractWidgetClass");function r(){this.properties={visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"}},i.apply(this,arguments)}((r.prototype=Object.create(i.prototype)).constructor=r).prototype._transformToMacros=!0,r.prototype._apiVersion=2,r.prototype.name="blog.post_comments",r.prototype.label="WIDGET.BLOG.POST_COMMENTS.NAME",r.prototype._templateViewURL="@websiteWidgets/blog/views/post_comments_properties.tpl.html",r.prototype._dragImagePath="@websiteWidgets/blog/icons/post_comments/drag.png",r.prototype._template={engine:"nunjucks",content:'<div data-widget-id="{{ currentWidget.getWidgetId() }}" class="moto-widget moto-widget-blog-post_comments moto-preset-default {{ currentWidget.getSpacing(\'classes\') }} {{ currentWidget.getVisibleOn(\'classes\') }}" data-widget="blog.post_comments" data-preset="default"><div class="moto-widget-empty"></div></div>'},r.prototype.isDuplicatableInSection=function(){return!1},o.set("blog.post_comments",r),t.isEnabled("theme_content_blog")&&e.addWidget({name:"blog.post_comments",label:"WIDGET.BLOG.POST_COMMENTS.NAME",category:"blog",order:10,enabled:!0,allowed:function(e,t){return"template.blog.post"==e.type&&"content"==t},icons:{small:"icon icon-blog-post_comments",medium:"",large:"icon icon-blog-post_comments"}})}]),angular.module("application.blog.widget.post_content",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","motoFeatures",function(e,t,o){var i=e.get("AbstractWidgetClass");function r(){this.properties={spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"}},i.apply(this,arguments)}((r.prototype=Object.create(i.prototype)).constructor=r).prototype._transformToMacros=!0,r.prototype._apiVersion=2,r.prototype.name="blog.post_content",r.prototype.label="WIDGET.BLOG.POST_CONTENT.NAME",r.prototype._templateViewURL="@websiteWidgets/blog/views/post_content_properties.tpl.html",r.prototype._dragImagePath="@websiteWidgets/blog/icons/post_content/drag.png",r.prototype._template={engine:"nunjucks",content:'<div data-widget-id="{{ currentWidget.getWidgetId() }}" class="moto-widget moto-widget-blog-post_content moto-preset-default {{ currentWidget.getSpacing(\'classes\') }}" data-widget="blog.post_content" data-preset="default"><div class="moto-widget-empty"></div></div>'},r.prototype.isRemovable=function(){return!1},e.set("blog.post_content",r),o.isEnabled("theme_content_blog")&&t.addWidget({name:r.prototype.name,label:r.prototype.label,category:"blog",order:10,enabled:!1,allowed:function(e,t){return"template.blog.post"==e.type&&"content"==t},icons:{small:"icon icon-blog-post_content",medium:"",large:"icon icon-blog-post_content"}})}]),angular.module("application.blog.widget.post_list",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","motoFeatures","coreLibraryConfig",function(e,t,o,i){var r=e.get("AbstractWidgetClass");function n(){this.properties={spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},item_count:5,read_more_label:"",style:{title:{font_style:"moto-text_system_7"},meta:{font_style:"moto-text_system_11"},button:{preset:"5",size:"small"},feature_image:{preset:"default"},divider:{preset:"default"}}},r.apply(this,arguments)}(n.prototype=Object.create(r.prototype)).name="blog.post_list",n.prototype.label="WIDGET.BLOG.POST_LIST.NAME",(n.prototype.constructor=n).prototype._templateViewURL="@websiteWidgets/blog/views/post_list_properties.tpl.html",n.prototype._transformToMacros=!0,n.prototype._apiVersion=2,n.prototype._dragImagePath="@websiteWidgets/blog/icons/post_list/drag.png",n.prototype._template={engine:"nunjucks",content:'<div data-widget-id="{{ currentWidget.getWidgetId() }}" class="moto-widget moto-widget-blog-post_list moto-preset-default {{ currentWidget.getSpacing(\'classes\') }}" data-widget="blog.post_list"><div class="moto-widget-empty"></div></div>'},n.prototype.isDuplicatableInSection=function(){return!1},n.prototype.setCommonStyles=function(){var e=i.get("settings.website.content_section_blog.design.post_list");angular.isObject(e)&&(this.properties.style=e)},n.prototype.shouldUpdateContentView=function(){return!1},n.prototype.initialize=function(){this.properties.version||(this.setCommonStyles(),this.properties.version=1),r.prototype.initialize.call(this)},n.prototype.create=function(){this.properties.version=1,r.prototype.create.call(this)},e.set(n.prototype.name,n),o.isEnabled("theme_content_blog")&&t.addWidget({name:n.prototype.name,label:n.prototype.label,category:"blog",order:5,enabled:!0,allowed:function(e,t){return("blog.index"===e.type||"template.blog.tag"===e.type||"template.blog.category"===e.type)&&"content"===t},icons:{small:"icon icon-blog-post_list",medium:"",large:"icon icon-blog-post_list"}})}]),angular.module("application.blog.widget.post_name",["application.core"]).run(["core.library.editor.WidgetsService","motoFeatures","coreLibraryWidget",function(e,t,o){var i=o.get("AbstractWidgetClass");function r(){this.properties={visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""},text_style:"moto-text_system_7"},i.apply(this,arguments)}((r.prototype=Object.create(i.prototype)).constructor=r).prototype._transformToMacros=!0,r.prototype.name="blog.post_name",r.prototype.label="WIDGET.BLOG.POST_NAME.NAME",r.prototype._templateViewURL="@websiteWidgets/blog/views/post_name_properties.tpl.html",r.prototype._apiVersion=2,r.prototype._dragImagePath="@websiteWidgets/blog/icons/post_name/drag.png",r.prototype._template={engine:"nunjucks",path:"@websiteWidgets/blog/templates/post_name.twig.html"},r.prototype.isDuplicatableInSection=function(){return!1},o.set(r.prototype.name,r),t.isEnabled("theme_content_blog")&&e.addWidget({name:r.prototype.name,label:r.prototype.label,category:"blog",order:10,enabled:!0,allowed:function(e,t){return"template.blog.post"===e.type&&"content"===t},icons:{small:"icon icon-blog-post_name",medium:"",large:"icon icon-blog-post_name"}})}]),angular.module("application.blog.widget.post_published_on",["application.core"]).run(["core.library.editor.WidgetsService","motoFeatures","coreLibraryWidget","coreLibraryConfig",function(e,t,o,i){var r=o.get("AbstractWidgetClass");function n(){this.properties={font_style:"moto-text_normal",visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""}},r.apply(this,arguments)}((n.prototype=Object.create(r.prototype)).constructor=n).prototype.name="blog.post_published_on",n.prototype.label="WIDGET.BLOG.PUBLISHED_ON.NAME",n.prototype._templateViewURL="@websiteWidgets/blog/views/post_published_on_properties.tpl.html",n.prototype._transformToMacros=!0,n.prototype._apiVersion=2,n.prototype._dragImagePath="@websiteWidgets/blog/icons/published_on/drag.png",n.prototype._template={engine:"nunjucks",path:"@websiteWidgets/blog/templates/post_published_on.twig.html"},n.prototype.isCopyable=function(){return!0},n.prototype.getDateFormat=function(){return i.get("settings.website.content_section_blog.date_format","m.d.Y")},o.set("blog.post_published_on",n),t.isEnabled("theme_content_blog")&&e.addWidget({name:"blog.post_published_on",label:"WIDGET.BLOG.PUBLISHED_ON.NAME",category:"blog",order:10,enabled:!0,allowed:function(e,t){return"template.blog.post"===e.type&&"content"===t},icons:{small:"icon icon-blog-post_published_on",medium:"",large:"icon icon-blog-post_published_on"}})}]),angular.module("application.blog.widget.post_tags",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","core.library.editor.PresetsService","motoFeatures",function(e,t,o,i){var r=e.get("AbstractWidgetClass");function n(){this.properties={title:"Tags:",titleTextStyle:"moto-text_normal",preset:"default",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"}},r.apply(this,arguments)}(n.prototype=Object.create(r.prototype)).name="blog.post_tags",n.prototype.label="WIDGET.BLOG.POST_TAGS.NAME",(n.prototype.constructor=n).prototype._templateViewURL="@websiteWidgets/blog/views/post_tags_properties.tpl.html",n.prototype._transformToMacros=!0,n.prototype._apiVersion=2,n.prototype._dragImagePath="@websiteWidgets/blog/icons/post_tags/drag.png",n.prototype._template={engine:"nunjucks",path:"@websiteWidgets/blog/templates/post_tags.twig.html"},n.prototype.exportForFuture=function(){return null},n.prototype.isCopyable=function(){return!0},n.prototype.getTags=function(){return[{name:"Tag 1"},{name:"Tag 2"},{name:"Tag 3"},{name:"Tag 4"},{name:"Tag 5"},{name:"Tag 6"},{name:"Tag 7"}]},e.set(n.prototype.name,n),t.addWidget({name:n.prototype.name,label:n.prototype.label,category:"blog",order:15,enabled:i.isEnabled("theme_content_blog"),allowed:function(e,t){return"template.blog.post"===e.type&&"content"===t},icons:{small:"icon icon-blog-post_tags",medium:"icon-blog-post_tags-medium",large:"icon icon-blog-post_tags"}}),o.addWidget({name:n.prototype.name,label:n.prototype.label,category:"blog",order:75,enabled:i.isEnabled("theme_content_blog"),stateParam:"post_tags",checkPresetControls:!1,presetPropertiesView:"@websiteWidgets/blog/views/post_tags_preset_properties.tpl.html",template:{path:"@websiteWidgets/blog/templates/post_tags.twig.css",engine:"nunjucks"},icons:{small:"icon icon-blog-post_tags",medium:"icon-blog-post_tags-medium",large:"icon icon-blog-post_tags"}})}]),angular.module("application.blog.widget.recent_posts",["application.core"]).run(["core.library.editor.WidgetsService","motoFeatures","coreLibraryWidget","application.pages.services.PagesModel","coreLibraryContentSection","coreLibraryUtils","$translate","coreLibraryConfig",function(e,t,o,i,r,n,a,s){var l=o.get("AbstractWidgetClass");function c(){return{label:a.instant("WIDGET.BLOG.RECENT_POSTS.DEFAULT_TITLE_LABEL")}}function p(){this.properties={visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},item_count:5,style:{heading:{font_style:"moto-text_system_7"},title:{font_style:"moto-text_system_8"},feature_image:{preset:"default"}}},this.properties=$.extend(!0,c(),this.properties),l.apply(this,arguments)}function d(e){e.defaultTranslates=c()}d.$inject=["$scope"],((p.prototype=Object.create(l.prototype)).constructor=p).prototype.constructor=d,p.prototype.name="blog.recent_posts",p.prototype.label="WIDGET.BLOG.RECENT_POSTS.NAME",p.prototype._templateViewURL="@websiteWidgets/blog/views/recent_posts_properties.tpl.html",p.prototype._transformToMacros=!0,p.prototype._apiVersion=2,p.prototype._dragImagePath="@websiteWidgets/blog/icons/recent_posts/drag.png",p.prototype._template={engine:"nunjucks",path:"@websiteWidgets/blog/templates/recent_posts.twig.html"},p.prototype.setCommonStyles=function(){var e=s.get("settings.website.content_section_blog.design.recent_posts");angular.isObject(e)&&(this.properties.style=e)},p.prototype.initialize=function(){this.properties.version||(this.setCommonStyles(),this.properties.version=1),l.prototype.initialize.call(this)},p.prototype.create=function(){this.properties.version=1,l.prototype.create.call(this)},p.prototype.getRenderVariables=function(){var e,t;return this.posts=(e=this.properties.item_count,(t={records:[],meta:{total:0}}).records=i.objects(function(e){return"blog.post"===e.type&&"publish"===e.status}).orderBy("published","desc").limit(1,e),t.records=Array.prototype.slice.call(t.records),t.meta.total=t.records.length||0,t),{currentWidget:this}},p.prototype.getDesignOption=function(e,t){return n.getObjectValueByPath(this.properties.style,e)||t},p.prototype.isCopyable=function(){return!0},o.set(p.prototype.name,p),t.isEnabled("theme_content_blog")&&e.addWidget({name:p.prototype.name,label:p.prototype.label,category:"blog",order:10,allowed:function(e,t){return!(!e||"popup"===e.type)&&("blog.post"!==e.type||"content"!==t)},icons:{small:"icon icon-blog-recent_posts",medium:"",large:"icon icon-blog-recent_posts"}})}]),angular.module("application.blog.widget.tag_description",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","motoFeatures",function(e,t,o){var i=e.get("AbstractWidgetClass");function r(){this.properties={source:"short_description",firstPageOnly:!1,visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"}},i.apply(this,arguments)}(r.prototype=Object.create(i.prototype)).name="blog.tag_description",r.prototype.label="WIDGET.BLOG.TAG_DESCRIPTION.NAME",(r.prototype.constructor=r).prototype._templateViewURL="@websiteWidgets/blog/views/tag_description_properties.tpl.html",r.prototype._transformToMacros=!0,r.prototype._apiVersion=2,r.prototype._dragImagePath="@websiteWidgets/blog/icons/tag_description/drag.png",r.prototype._template={engine:"nunjucks",path:"@websiteWidgets/blog/templates/tag_description.twig.html"},r.prototype.exportForFuture=function(){return null},r.prototype.isCopyable=function(){return!0},r.prototype.shouldUpdateContentView=function(){return!1},e.set(r.prototype.name,r),t.addWidget({name:r.prototype.name,label:r.prototype.label,category:"blog",order:20,enabled:o.isEnabled("theme_content_blog"),allowed:function(e,t){return"template.blog.tag"===e.type&&"content"===t},icons:{small:"icon icon-blog-tag_description",medium:"",large:"icon icon-blog-tag_description"}})}]),angular.module("application.blog.widget.tag_name",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","motoFeatures",function(e,t,o){var i=e.get("AbstractWidgetClass");function r(){this.properties={htmlTag:"h1",text_style:"moto-text_system_7",visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""}},i.apply(this,arguments)}(r.prototype=Object.create(i.prototype)).name="blog.tag_name",r.prototype.label="WIDGET.BLOG.TAG_NAME.NAME",(r.prototype.constructor=r).prototype._templateViewURL="@websiteWidgets/blog/views/tag_name_properties.tpl.html",r.prototype._transformToMacros=!0,r.prototype._apiVersion=2,r.prototype._dragImagePath="@websiteWidgets/blog/icons/tag_name/drag.png",r.prototype._template={engine:"nunjucks",path:"@websiteWidgets/blog/templates/tag_name.twig.html"},r.prototype.exportForFuture=function(){return null},r.prototype.isCopyable=function(){return!0},e.set(r.prototype.name,r),t.addWidget({name:r.prototype.name,label:r.prototype.label,category:"blog",order:15,enabled:o.isEnabled("theme_content_blog"),allowed:function(e,t){return"template.blog.tag"===e.type&&"content"===t},icons:{small:"icon icon-blog-tag_name",medium:"",large:"icon icon-blog-tag_name"}})}]),angular.module("application.widget.broken",["application.widget.abstract"]).run(["coreLibraryWidget",function(e){var t=e.get("AbstractWidgetClass");function o(){this.properties={},t.apply(this,arguments)}((o.prototype=Object.create(t.prototype)).constructor=o).prototype._transformToMacros=!0,o.prototype._dragImagePath="@websiteWidgets/broken/icons/drag.png",o.prototype._apiVersion=2,o.prototype.name="broken",o.prototype.label="WIDGET.BROKEN.NAME",o.prototype._template={engine:"nunjucks",path:"@websiteWidgets/broken/templates/default.twig.html"},o.prototype.__exportWidget=function(){return this.properties.content},e.set("broken",o)}]),angular.module("application.widget.button",["application.widget.abstract"]).run(["$rootScope","coreLibraryWidget","core.library.editor.WidgetsService","core.library.editor.PresetsService","motoFeatures",function(e,t,o,i,r){var n=t.get("AbstractWidgetClass");function a(){this.properties={link:{action:"none",properties:{id:"",target:"_self",email:"",subject:"",body:""}},label:"Button",align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""},size:"medium",preset:"default",animation:"",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"}},n.apply(this,arguments)}e.$on("NEW EVENT: MotoEditor.config:after",function(e,t){var i=t.getGlobal("$"),r=t.getEditor();i("body").on("blur keyup paste input",".moto-widget-button .moto-widget-button-label[contenteditable]",function(e){var t,o=i(e.target);o.hasClass("moto-widget-button-label")?(t=r.getClosestWidgetByDom(o))&&t.syncContentData(e):console.warn('button : event.target not have class "moto-widget-button-label"')})}),((a.prototype=Object.create(n.prototype)).constructor=a).prototype._transformToMacros=!0,a.prototype._apiVersion=2,a.prototype.name="button",a.prototype.label="WIDGET.BUTTON.NAME",a.prototype._dragImagePath="@websiteWidgets/button/icons/drag.png",a.prototype._template={engine:"nunjucks",path:"@websiteWidgets/button/templates/default.twig.html"},a.prototype.isCopyable=function(){return!0},a.prototype.getLinkDomElement=function(){var e;return e=0<(e=this._dom.getElementsByClassName("moto-widget-button-link")).length?e[0]:null},a.prototype.onClickEvent=function(e){var t,o;t=this.getLinkDomElement(),"true"===(o=this.$(t).find(".moto-widget-button-label")).attr("contenteditable")&&o.focus(),t&&(o.attr("contenteditable")?(this._$dom.is("[draggable=true]")&&this._$dom.attr("data-draggable-disabled","").removeAttr("draggable"),this._$dom.parents("[draggable=true]").attr("data-draggable-disabled","").removeAttr("draggable")):o.attr("contenteditable","true"))},a.prototype.onUnselectedEvent=function(){var e;(e=this.getLinkDomElement())&&(this.$(e).find(".moto-widget-button-label").removeAttr("contenteditable"),this._$dom.is("[data-draggable-disabled]")&&this._$dom.attr("draggable","true").removeAttr("data-draggable-disabled"),this._$dom.parents("[data-draggable-disabled]").attr("draggable","true").removeAttr("data-draggable-disabled"))},a.prototype.syncContentData=function(e){var t,o=this.$(".moto-widget-button-label",this._$dom);o.length&&(t=o.text(),this.properties.label!==t&&(this._syncDataInProcess=!0,this.setProperties({label:t}).then(function(){this._syncDataInProcess=!1}.bind(this))))},a.prototype.shouldUpdateContentView=function(){return!this._syncDataInProcess},t.set("button",a),o.addWidget({name:a.prototype.name,label:a.prototype.label,category:"basic",order:15,enabled:!0,allowed:function(){return!0},icons:{small:"icon icon-button",medium:"",large:"icon icon-button"}}),i.addWidget({name:"button",label:"WIDGET.BUTTON.NAME",category:"basic",order:10,enabled:r.isEnabled("theme_presets_button"),icons:{small:"icon icon-button",medium:"icon icon-button-medium",large:"icon icon-button"}})}]),angular.module("application.widget.carousel").run(["core.library.editor.WidgetsService","motoFeatures","coreLibraryWidget","coreLibraryModal","coreLibraryMessenger","core.library.editor.PresetsService",function(e,t,o,r,n,i){var a=o.get("AbstractWidgetClass"),s=[],l=[];function c(e,t){return t=t||{},e.items&&1==e.items.length&&(t.pager=!1),$.extend({mode:"horizontal",auto:e.slideshowEnabled,pause:1e3*e.slideshowDelay,controls:e.showNextPrev,pager:e.showPaginationDots,slideWidth:e.slideWidth,minSlides:e.minSlides,maxSlides:e.maxSlides,moveSlides:e.moveSlides,slideMargin:e.margins,stopAutoOnClick:!0,shrinkItems:!0},t)}function p(e,t){var o=c(t);return o.onSliderLoad=function(){e.closest(".moto-widget-carousel").removeClass("moto-widget-carousel-loader")},e.bxSlider(o)}function d(e,t){var o,i;e&&e.getCurrentSlide&&(i=c(t,(o=e.getCurrentSlide())<e.getSlideCount()?{startSlide:o}:{}),e.reloadSlider(i))}function u(i){r("@websiteWidgets/carousel/src/backend/views/top.tpl.html",function(t,o){t.items=angular.copy(i.properties.items),t.ok=function(e){i.setProperties({items:e}),o.close(t),n.success("WIDGET.COMMON.MESSAGES.CHANGES_APPLIED")},t.cancel=function(){o.close(t)}},null,"widget-admin")}function g(e){e.moveSlidesTypes=[{type:1,translationKey:"WIDGET.CAROUSEL.ONE_BY_ONE_MOVE_SLIDES_LABEL"},{type:0,translationKey:"WIDGET.CAROUSEL.GROUP_MOVE_SLIDES_LABEL"}],e.openSelectItemsPopup=u}function m(){this.properties={preset:"default",animation:"",visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},items:[],slideshowEnabled:!0,slideshowDelay:5,slideshowAnimationType:"fade",showNextPrev:!0,showPaginationDots:!0,slideWidth:300,minSlides:4,maxSlides:4,moveSlides:1,margins:20},a.apply(this,arguments)}g.$inject=["$scope"],((m.prototype=Object.create(a.prototype)).constructor=m).prototype.controller=g,m.prototype.name="carousel",m.prototype.label="WIDGET.CAROUSEL.NAME",m.prototype._transformToMacros=!0,m.prototype._apiVersion=2,m.prototype._dragImagePath="@websiteWidgets/carousel/icons/drag.png",m.prototype._template={engine:"nunjucks",path:"@websiteWidgets/carousel/templates/default.twig.html"},m.prototype.isCopyable=function(){return!0},m.prototype.create=function(){0<this.properties.items.length&&(this.carouselInstance=p(this.$(this._dom).find(".moto-widget-carousel-list"),this.properties),this.disableDragOnElement()),a.prototype.create.call(this)},m.prototype.onDoubleClickEvent=function(e){u(this)},m.prototype.initialize=function(){var e;(e=this.$(this._dom).attr("data-instance-id"))&&s[e]?(this.carouselInstance=s[e],$.extend(!0,this.properties,l[e]),this.disableDragOnElement()):!this.carouselInstance&&0<this.properties.items.length&&(this.carouselInstance=p(this.$(this._dom).find(".moto-widget-carousel-list"),this.properties),this.disableDragOnElement()),a.prototype.initialize.call(this)},m.prototype.shouldUpdateContentView=function(e){return e.items&&this.properties.items!==e.items||e.preset&&this.properties.preset!==e.preset},m.prototype.manualUpdateContentView=function(){d(this.carouselInstance,this.properties)},m.prototype.onWidthChanged=function(){d(this.carouselInstance,this.properties)},m.prototype.postRenderPreview=function(){a.prototype.postRenderPreview.apply(this,arguments),0<this.properties.items.length&&(this.carouselInstance&&this.carouselInstance.destroySlider(),this.carouselInstance=p(this.$(this._dom).find(".moto-widget-carousel-list"),this.properties),this.disableDragOnElement())},m.prototype.disableDragOnElement=function(){$(".moto-widget-carousel-list img",this._dom).attr("draggable","false")},m.prototype.exportForFuture=function(){var e,t,o=a.prototype.exportForFuture.call(this);if(angular.isArray(o.properties.items))for(e=0,t=o.properties.items.length;e<t;e++)delete o.properties.items[e].id;return o},o.doWhenLivePreviewReady(function(o){s=[],l=[],o.$(".moto-widget-carousel").each(function(){var e,t;try{0<(e=o.widgetCacheOptions[o.$(this).data("widget-id")].properties).items.length&&(t=p(o.$(this).find(".moto-widget-carousel-list"),e),s.push(t),l.push(e),$(this).attr("data-instance-id",s.length-1))}catch(e){}})}),o.doWhenWidthChanged(function(){s.forEach(function(e,t){d(e,l[t])})}),o.set(m.prototype.name,m),e.addWidget({name:m.prototype.name,label:m.prototype.label,category:"galleries",order:30,enabled:t.isEnabled("theme_widget_slider"),allowed:function(){return t.isEnabled("theme_widget_slider")},icons:{small:"icon icon-carousel",medium:"",large:"icon icon-carousel"}}),i.addWidget({name:"carousel",base:"slider",enabled:t.isEnabled("theme_widget_slider")})}]),angular.module("application.widget.carousel").controller("application.widget.carousel.controllers.EditItemController",["$scope","motoUI.LinkToService","coreLibraryUtils","application.media_library.services.MediaLibraryService",function(o,e,t,i){o.changeImage=function(){i.open({id:o.currentItem.id,value:o.currentItem.content,filters:["image"],thumbnails:!0,size:o.currentItem.thumbnail,onApply:function(e,t){e&&(o.currentItem.id!=e.id&&(o.currentItem.id=e.id,o.currentItem.alt=e.alt),o.currentItem.name=e.name,o.currentItem.thumbnail=t,o.currentItem.content=t?e.getThumbnailPath(t):e.path)}})},o.ok=function(){o.editImage&&!o.editImage.$valid||(o.currentItem.content&&(o.currentItem.caption=e.transformLinks(o.currentItem.caption)),o.$parent.ok())}}]),angular.module("application.widget.carousel").controller("application.widget.carousel.controllers.TopController",["$scope","coreLibraryModal","coreLibraryUtils","simpleHistory","application.media_library.services.MediaLibraryService",function(i,e,r,t,o){var n=t.createNew();i.initialItems=angular.copy(i.items),i.addImage=function(){o.open({multiSelect:!0,filters:["image"],thumbnails:!0,onApply:function(e,o){e&&e.forIn(function(e,t){i.items.push({id:t.id,type:t.type,caption:"",content:o?t.getThumbnailPath(o):t.path,thumbnail:o,name:t.name,ordinalNumber:i.items.length,alt:t.alt,link:{action:"none"}})})}})},i.editImage=function(o){n.clear(),n.save(o),e("@websiteWidgets/carousel/src/backend/views/edit_item.tpl.html",function(e,t){e.currentItem=o,e.ok=function(){t.close(e)},e.cancel=function(){t.close(e),n.revert(o)}},null,"widget-admin-edit modal-with-ckeditor")},i.deleteImage=function(e){var t=i.items.indexOf(e);0<=t&&i.items.splice(t,1)},i.$on("numberOfItemsChanged",function(){i.initSortableGrid()}),i.initSortableGrid=function(){var o=angular.element(".items-list");try{o.sortable("destroy")}catch(e){}o.sortable({placeholder:"ui-sortable-highlight",stop:function(){var e,t=o.sortable("toArray",{attribute:"item-index"});for(e=0;e<i.items.length;e++)i.items[e].ordinalNumber=t.indexOf(e.toString());r.sortArrayByProperty(i.items,"ordinalNumber"),i.$apply()}})},i.isChanged=function(){return!angular.equals(i.initialItems,i.items)},i.ok=function(){i.$parent.ok(r.sortArrayByProperty(i.items,"ordinalNumber"),i.isChanged())},i.cancel=function(e){e&&e.preventDefault(),i.isChanged()?r.openConfirmationBox({yesHandler:function(){i.$parent.cancel()}}):i.$parent.cancel()},i.$on("motoPopupCanceled",i.cancel)}]),angular.module("application.widget.completion_bars",["application.widget.abstract"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","coreLibraryWidgetTraits",function(e,t,o){var i=e.get("AbstractWidgetClass");function r(r,e,o){r.openItemPopup=function(o){var i={label:"",progress:0,customProgressLabel:"",customProgressLabelEnabled:!1,stripeBackground:"#e9ecef",stripeForeground:"#54616d"};e("@websiteWidgets/completion_bars/src/backend/views/popup.tpl.html",function(e,t){e.editingMode=!!o,e.item=e.editingMode?angular.copy(o):angular.copy(i),e.ok=function(){e.editCompletionBarItem.$valid&&(e.editingMode?angular.extend(o,e.item):r.currentWidget.properties.items.push(e.item),t.close(e))},e.cancel=function(){t.close(e)}},null,"modal-with-ckeditor")},r.deleteItem=function(t){o.openConfirmationBox({yesHandler:function(){var e=r.currentWidget.properties.items.indexOf(t);0<=e&&r.currentWidget.properties.items.splice(e,1)},question:"WIDGET.COMMON.REMOVE_WIDGETS_ITEM_CONFIRMATION"})}}function n(){this.properties={items:[],spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},visible_on:"mobile-v",labelTextStyle:"moto-text_system_10",progressTextStyle:"moto-text_system_10",stripeHeight:6,stripeRadius:"0px",enableForegroundRadius:!1,enableProgressAnimation:!1,preset:"default",animation:""},i.apply(this,arguments)}r.$inject=["$scope","coreLibraryModal","coreLibraryUtils"],((n.prototype=Object.create(i.prototype)).constructor=n).prototype.controller=r,o.useTrait("WidgetColorizerModel",n),n.prototype.name="completion_bars",n.prototype.label="WIDGET.COMPLETION_BARS.NAME",n.prototype._apiVersion=2,n.prototype._transformToMacros=!0,n.prototype._dragImagePath="@websiteWidgets/completion_bars/icons/drag.png",n.prototype._template={engine:"nunjucks",path:"@websiteWidgets/completion_bars/templates/default.twig.html"},n.prototype.isCopyable=function(){return!0},n.prototype.getBackgroundColorClass=function(e){return this.getColorizerModel().getClassNameByColorName(e,"moto-bg-color")},n.prototype.getCssInlineValue=function(e,t,o){var i="";return o=o||"",angular.isUndefined(t)||!e||"@"!==t[0]&&(0!==parseInt(t,10)&&(t+=o),i=e+":"+t+";"),i},e.set(n.prototype.name,n),t.addWidget({name:n.prototype.name,label:n.prototype.label,category:"more",order:48,icons:{small:"icon icon-completion_bars",medium:"icon-completion_bars-medium",large:"icon icon-completion_bars"}})}]),angular.module("application.widget.contact_form",["application.widget.abstract","application.widget.base_forms"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","core.library.editor.PresetsService","motoFeatures","$translate",function(e,t,o,i,r){var n=e.get("AbstractWidgetClass");function a(){return{fields:{name:{placeholder:r.instant("WIDGET.CONTACT_FORM.FIELD_NAME_PLACEHOLDER_VALUE")},email:{placeholder:r.instant("WIDGET.CONTACT_FORM.FIELD_EMAIL_PLACEHOLDER_VALUE")},phone:{placeholder:r.instant("WIDGET.CONTACT_FORM.FIELD_PHONE_PLACEHOLDER_VALUE")},address:{placeholder:r.instant("WIDGET.CONTACT_FORM.FIELD_ADDRESS_PLACEHOLDER_VALUE")},subject:{placeholder:r.instant("WIDGET.CONTACT_FORM.FIELD_SUBJECT_PLACEHOLDER_VALUE")},attachment:{placeholder:r.instant("WIDGET.CONTACT_FORM.FIELD_ATTACHMENT_PLACEHOLDER_VALUE")},message:{placeholder:r.instant("WIDGET.CONTACT_FORM.FIELD_MESSAGE_PLACEHOLDER_VALUE")},checkbox:{label:r.instant("WIDGET.CONTACT_FORM.FIELD_AGREEMENT_LABEL_VALUE")}},buttons:{submit:{label:r.instant("WIDGET.CONTACT_FORM.FORM_SUBMIT_BUTTON_VALUE")}},messages:{success:r.instant("WIDGET.CONTACT_FORM.FORM_SUBMIT_SUCCESS_MESSAGE_VALUE"),error:r.instant("WIDGET.CONTACT_FORM.FORM_SUBMIT_ERROR_MESSAGE_VALUE"),required:r.instant("WIDGET.COMMON.FORM_VALIDATION_REQUIRED_VALUE"),invalidEmail:r.instant("WIDGET.COMMON.FORM_VALIDATION_EMAIL_VALUE")}}}function s(){this.properties={preset:"default",animation:"",align:{desktop:"",tablet:"","mobile-v":"","mobile-h":""},visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},fields:{name:{enabled:!0,required:!1,type:"text"},email:{enabled:!0,required:!0,type:"email"},phone:{enabled:!1,required:!1,type:"text"},address:{enabled:!1,required:!1,type:"text"},subject:{enabled:!1,required:!1,type:"text"},attachment:{enabled:!1,required:!1,type:"file"},message:{enabled:!0,required:!1,type:"text",tag:"textarea"},checkbox:{enabled:!1,required:!1,type:"checkbox",labelType:"text",text_style:"moto-text_normal"}},messages:{},buttons:{submit:{preset:"default",size:"medium",align:"left"},attachment:{preset:"default",size:"medium",align:"left"}},settings:{recipient:""},postAction:{action:"none",properties:{id:"",target:"_self"}},resetAfterSubmission:!1},this.properties=$.extend(!0,a(),this.properties),n.apply(this,arguments)}function l(e){e.defaultTranslates=a()}l.$inject=["$scope","coreLibraryModal","coreLibraryMessenger"],((s.prototype=Object.create(n.prototype)).constructor=s).prototype.controller=l,s.prototype._transformToMacros=!0,s.prototype.name="contact_form",s.prototype.label="WIDGET.CONTACT_FORM.NAME",s.prototype._apiVersion=2,s.prototype._dragImagePath="@websiteWidgets/contact_form/icons/drag.png",s.prototype._template={engine:"nunjucks",path:"@websiteWidgets/contact_form/templates/default.twig.html"},s.prototype.isCopyable=function(){return!0},s.prototype.getProtectedHash=function(){return""},s.prototype.isEmpty=function(){var e,t=this.properties.fields;for(e in t)if(t[e].enabled)return!1;return!0},s.prototype.initialize=function(){this.properties.buttons=this.properties.buttons||{},this.properties.buttons.submit=this.properties.buttons.submit||{preset:"default",size:"medium",align:"left",label:this.properties.messages.submitButton||""};try{this.properties.messages.submitButton&&(angular.isString(this.properties.messages.submitButton)&&!this.properties.buttons.submit.label&&(this.properties.buttons.submit.label=this.properties.messages.submitButton),delete this.properties.messages.submitButton)}catch(e){}return n.prototype.initialize.call(this)},e.set("contact_form",s),t.addWidget({name:s.prototype.name,label:s.prototype.label,category:"basic",order:35,enabled:!0,allowed:function(){return!0},icons:{small:"icon icon-contact_form",medium:"",large:"icon icon-contact-form"}}),o.addWidget({name:"contact_form",label:"WIDGET.CONTACT_FORM.BUILDER_NAME",category:"basic",order:30,enabled:i.isEnabled("theme_presets_contact_form"),icons:{small:"icon icon-contact_form",medium:"icon icon-contact-form-medium",large:"icon icon-contact-form"}})}]).controller("application.widget.contact_form.DesignPresetController",["$scope",function(e){e.preset.properties.input_placeholder&&e.preset.properties.input_placeholder.desktop||(e.preset.properties.input_placeholder={desktop:{base:{color:""}}}),e.preset.properties.form_checkbox&&e.preset.properties.form_checkbox_error||(e.preset.properties.form_checkbox={desktop:{base:{"border-color":"#81868c",width:"16px",height:"16px","font-size":"16px",color:"#55616d"}}},e.preset.properties.form_checkbox_error={desktop:{base:{"border-color":"#ff0000"}}})}]),angular.module("application.widget.base_forms",[]).controller("application.widget.base_forms.controllers.EditCheckboxDescription",["$scope","motoUI.LinkToService","motoStripTagsFilter",function(t,e,o){t.toggleTextEditor=function(){var e;"text"===t.checkbox.labelType?(e=angular.element(t.checkbox.label)).length&&(e.find(".fa").remove(),t.checkbox.label=e.text()):t.checkbox.label='<p class="'+t.labelTextStyle+'">'+t.checkbox.label+"</p>"},t.ok=function(){t.editLabelForm.validate()&&("html"===t.checkbox.labelType&&5e3<t.checkbox.label.length?(t.$broadcast("MotoEvent:MotoCkeditor.ShowValidationBalloon",{messageKey:"COMMON.VALIDATION_ERROR.HTML_LENGTH_TOO_LONG",messageParams:{maximum_character_count:5e3}}),0):(t.$broadcast("MotoEvent:MotoCkeditor.ClearValidationBalloon"),1))&&("html"===t.checkbox.labelType&&(t.checkbox.label=e.transformLinks(t.checkbox.label)),o(t.checkbox.label).trim().length||(t.checkbox.label=t.defaultLabel,t.checkbox.labelType="text"),t.$parent.ok(t.checkbox))}}]).controller("application.widget.base_forms.controllers.FormElementsController",["$scope","coreLibraryModal",function(i,e){i.invertRequiredValue=function(e){i.currentWidget.properties.fields[e].required=!i.currentWidget.properties.fields[e].required},i.editCheckboxDescription=function(){e("@websiteWidgets/contact_form/src/backend/views/edit_checkbox_label.tpl.html",function(t,o){t.checkbox=angular.copy(i.currentWidget.properties.fields.checkbox),t.defaultLabel=i.defaultTranslates.fields.checkbox.label,t.labelTextStyle=i.currentWidget.properties.fields.checkbox.text_style,t.ok=function(e){i.currentWidget.properties.fields.checkbox=e,o.close(t),i.systemMessenger.success("WIDGET.COMMON.MESSAGES.CHANGES_APPLIED")}},null,"modal-with-ckeditor")}}]),angular.module("application.widget.container",["application.widget.abstract_container","core.library.CssGenerator","core.library.RenderWidget.NunjucksExtensions"]).run(["$rootScope","core.library.editor.WidgetsService","coreLibraryWidget","coreLibraryCssGenerator","core.library.styles.StylesService","coreLibraryUtils","coreLibraryMessenger","$translate","core.library.styles.ClassesStylesModel","application.media_library.services.MediaLibraryService","coreLibraryPathResolver","$q",function(e,t,o,i,l,a,r,n,s,c,p,d){var u,g=o.get("AbstractContainerWidgetClass"),m=/^(margin|padding|border)-/;function f(e){var t={desktop:{base:{"margin-top":"0px","margin-bottom":"0px","margin-left":"0px","margin-right":"0px","padding-top":"0px","padding-bottom":"0px","padding-left":"0px","padding-right":"0px","background-color":"","background-size":"auto","background-position":"left top","background-repeat":"no-repeat","border-style":"none","border-color":"","border-left-width":"0px","border-right-width":"0px","border-top-width":"0px","border-bottom-width":"0px","border-top-left-radius":"0px","border-top-right-radius":"0px","border-bottom-left-radius":"0px","border-bottom-right-radius":"0px","transition-duration":"0.4s","transition-property":"background-color, border-color"},hover:{"background-color":"","border-color":""}}};return void 0===u&&(u=s.ClassStyleProperties()),e instanceof u?(angular.merge(e,angular.merge(t,e)),e):(angular.isObject(e)&&(t=angular.merge(t,e)),new u(t))}function h(e){e._$dom.removeClass("moto-parallax").removeAttr("data-stellar-background-ratio"),e.isBackgroundVideoSet()||e.properties.bgParallaxed&&e._$dom.addClass("moto-parallax").attr("data-stellar-background-ratio","0.5")}function y(e){e._$dom.removeClass("moto-background-fixed"),e.isBackgroundVideoSet()||e.properties.bgFixed&&e._$dom.addClass("moto-background-fixed")}function b(o){o.clearImage=function(){delete o.currentWidget.properties.styles.desktop.base["background-image"],delete o.currentWidget.properties.styles.desktop.base["background-size"],delete o.currentWidget.properties.styles.desktop.base["background-position"],delete o.currentWidget.properties.styles.desktop.base["background-repeat"],o.unsetFixedAndParallaxedProperties()},o.changeImage=function(){c.open({value:o.currentWidget.properties.styles.desktop.base["background-image"],thumbnails:!0,filters:["image"],onApply:function(e,t){e&&(o.currentWidget.properties.styles.desktop.base["background-image"]=t?e.getThumbnailPath(t):e.path,o.currentWidget.properties.styles.desktop.base["background-size"]||(o.currentWidget.properties.styles.desktop.base["background-size"]="auto"),o.currentWidget.properties.styles.desktop.base["background-position"]||(o.currentWidget.properties.styles.desktop.base["background-position"]="left top"),o.currentWidget.properties.styles.desktop.base["background-repeat"]||(o.currentWidget.properties.styles.desktop.base["background-repeat"]="no-repeat"))}})},o.addPixels=function(e,t){e.properties.styles.desktop.base[t].match(/\dpx/)||(e.properties.styles.desktop.base[t]+="px")},o.unsetFixedAndParallaxedProperties=function(){o.currentWidget.properties.bgFixed=!1,o.currentWidget.properties.bgParallaxed=!1,y(o.currentWidget),h(o.currentWidget)}}function _(r){var e=angular.copy(r.properties.styles);r._cssName&&(r.livePreviewCssName=r.livePreviewCssName||"live_preview_"+r._cssName,i.renderStylesRecord({stylesRecord:{tag:"",class_name:r.livePreviewCssName,properties:e},callback:function(e){var t,o,i;t=r._windowContext.document,o="id_"+r.livePreviewCssName,(i=t.getElementById(o))||((i=t.createElement("style")).setAttribute("id",o),t.body.appendChild(i)),r._$dom.addClass(r.livePreviewCssName).removeClass(r._cssName),i.innerHTML=e,r._Editor.getScope().$broadcast("Widget.WidthChangedByWidget",r)}}))}function v(e,t,o){var i,r,n,a="";if(v._tik++,(t=t||{}).prefix=t.prefix||"moto-container",t.delimiter=t.delimiter||"_",t.sectionName=t.sectionName||"",!t.sectionName){if(0===(i=o(e).closest(".moto-section")).length)return"empty";t.sectionName=i.attr("id").split("section-")[1]}return a+=t.prefix+t.delimiter,t.sectionName&&(a+=t.sectionName+t.delimiter),a+=(r=parseInt((new Date).getTime()/1e3,10),((n=8)<(r=parseInt(r,10).toString(16)).length?r.slice(r.length-n):n>r.length?new Array(n-r.length+1).join("0")+r:r)+v._tik)}function E(){this.properties={anchor:"",stickyEnabled:!1,stickyHidden:!1,bgFixed:!1,bgParallaxed:!1,bgPosition:"left top",bgVideo:{loop:!0,preload:"metadata",track:{webm:null,mp4:null}},styles:{}},g.apply(this,arguments)}e.$on("NEW EVENT: MotoEditor.config:after",function(e,t){var a=t.getEditor(),o=t.getEventManager();function s(e){var t=Model("Styles");e&&e.id&&t.save(e)}function i(e){var t,o,i,r,n=a.getCurrentSection();if(!n)return!1;if(!(t=function e(t,o){var i,r,n;if(o=o||[],t.isContainer()&&t.children&&t.children.length)for(i=0,r=t.children.length;i<r;i++)"container"===(n=t.children[i]).name&&o.push(n),n.isContainer()&&(o=e(n,o));return o}(n)).length)return!1;for(o=0,i=t.length;o<i;o++)r={id:"",class_name:t[o]._cssName,name:t[o]._cssName,type:"widget",is_system:null,created:null,modified:null,properties:t[o].properties.styles},e.add(l.save,r).then(s);return!0}o.on("section.saved",i),a.getScope().$on("NEW EVENT: Editor start self destroying",function(){o.off("section.saved",i)})}),b.$inject=["$scope"],v._tik=0,((E.prototype=Object.create(g.prototype)).constructor=E).prototype.controller=b,E.prototype.name="container",E.prototype.label="WIDGET.CONTAINER.NAME",E.prototype._apiVersion=2,E.prototype._dragImagePath="@websiteWidgets/container/icons/drag.png",E.prototype._template={engine:"nunjucks",path:"@websiteWidgets/container/templates/default.twig.html"},E.prototype.isCopyable=function(){return!0},E.prototype.getCustomAttributes=function(){var e,t={};return this.properties.stickyEnabled&&(e={},this.properties.stickyHidden&&(e.hidden=!0),t["data-moto-sticky"]=angular.toJson(e)),this.properties.bgParallaxed&&(t["data-stellar-background-ratio"]="0.5"),t["data-css-name"]=this._cssName,t},E.prototype.connectNode=function(e){return!!g.prototype.connectNode.call(this,e)&&(_(this),!0)},E.prototype.livePreviewCssName=null,E.prototype._cssName=null,E.prototype.manualUpdateContentView=function(){this._updateBackgroundView(),this.updateEmptyClass(),this.updateSticky(),this.updateAnchorDomElement()},E.prototype.updateSticky=function(){this._$dom.removeAttr("moto-sticky"),this.properties.stickyEnabled&&this.properties.stickyHidden?this._$dom.attr("data-moto-sticky",'{ "hidden": true }'):this.properties.stickyEnabled?this._$dom.attr("data-moto-sticky","{ }"):this._$dom.removeAttr("data-moto-sticky")},E.prototype.transform=function(){this.updateAnchorDomElement(),this.properties.stickyEnabled&&this.properties.stickyHidden&&this._$dom.addClass("moto-sticky__hidden"),this.livePreviewCssName&&this._$dom.removeClass(this.livePreviewCssName).addClass(this._cssName),this._exportBackground(this),function(e){var t,o,i,r=e.desktop.base;for(t in r)r.hasOwnProperty(t)&&(""===(i=r[o=t])||"transparent"===i||null===i||("0px"===i||"none"===i)&&m.test(o)||"background-size"===o&&"auto"===i||"background-position"===o&&"left top"===i||"background-repeat"===o&&"no-repeat"===i)&&delete r[t];r["border-style"]&&"none"!==r["border-style"]||(delete r["border-color"],delete r["border-left-width"],delete r["border-right-width"],delete r["border-top-width"],delete r["border-bottom-width"]),r["background-image"]||(delete r["background-size"],delete r["background-position"],delete r["background-repeat"])}(this.properties.styles),this._transformBackgroundVideo(),g.prototype.transform.call(this)},E.prototype.loadPropertiesFromDom=function(){var e,t,o;this.properties.bgParallaxed=!!this._$dom.attr("data-stellar-background-ratio"),this.properties.bgFixed=!!this._$dom.hasClass("moto-background-fixed"),(t=this.getAnchorDomElement()).length&&(this.properties.anchor=t.attr("name"),this.clearUnnecessaryAnchors()),this._$dom.data("cssName")&&(this._cssName=this._$dom.data("cssName"),(e=Model("Styles").getByField("class_name",this._cssName))&&(this.properties.styles=e.properties)),this.properties.stickyEnabled=!!this._$dom.attr("moto-sticky")||!!this._$dom.attr("data-moto-sticky");try{o=angular.fromJson(this._$dom.attr("moto-sticky"))||angular.fromJson(this._$dom.attr("data-moto-sticky")),angular.isObject(o)&&angular.isDefined(o.hidden)&&(this.properties.stickyHidden=o.hidden)}catch(e){this.properties.stickyHidden=!1}this.properties.bgPosition=this._$dom.attr("data-bg-position"),this._loadBackgroundVideoFromDom()},E.prototype.isBackgroundVideoSet=function(e){return angular.isObject(e)||(e=this),a.getObjectValueByPath(e,"properties.bgVideo.track.webm.path")||a.getObjectValueByPath(e,"properties.bgVideo.track.mp4.path")},E.prototype._loadBackgroundVideoFromDom=function(){var e;if((e=this.$(">.moto-background-video-container",this._$dom)).length){this.properties.bgVideo=e.attr("data-moto-background-video");try{angular.isString(this.properties.bgVideo)&&(this.properties.bgVideo=angular.fromJson(this.properties.bgVideo))}catch(e){}}},E.prototype._updateBackgroundVideoInDom=function(e,t){var o,i,r,n;this.isBackgroundVideoSet()?(this.properties.bgFixed=!1,this.properties.bgParallaxed=!1,angular.isUndefined(e)&&(e=this.properties.bgVideo),(e=e||{}).position=this.properties.bgPosition,(o=this.$(">.moto-background-video-container",this._$dom)).length||(o=this.$('<div class="moto-background-video-container moto-absolute-position__container"></div>'),this._$dom.prepend(o)),(i=this.$(">video",o)).length||(i=this.$('<video muted="muted"></video>'),o.append(i)),i.attr("class",this._getBackgroundVideoCssClass(e)),i.attr("preload",a.getObjectValueByPath(e,"preload","metadata")),a.getObjectValueByPath(e,"loop")?i.attr("loop","loop"):i.attr("loop",null),n=a.getObjectValueByPath(e,"track.webm.path"),r=this.$('source[type="video/webm"]',i),n?(r.length||(r=this.$('<source type="video/webm">'),i.prepend(r)),r.attr("src",p.getUploadAbsoluteUrl(n)),t&&r.replaceWith(this._windowContext.document.createComment('--@<source type="video/webm" src="{{ Linker.file(\''+n+"') }}\">@--"))):r.remove(),n=a.getObjectValueByPath(e,"track.mp4.path"),r=this.$('source[type="video/mp4"]',i),n?(r.length||(r=this.$('<source type="video/mp4">'),i.append(r)),r.attr("src",p.getUploadAbsoluteUrl(n)),t&&r.replaceWith(this._windowContext.document.createComment('--@<source type="video/mp4" src="{{ Linker.file(\''+n+"') }}\">@--"))):r.remove(),(r=this.$("source",i)).length?i[0].load():t||i.remove(),o.attr("data-moto-background-video",angular.toJson(e)),o.motoVideoBackground()):this.$(">.moto-background-video-container",this._$dom).remove()},E.prototype._exportBackground=function(e){angular.isObject(e)&&angular.isObject(e.properties)&&(e.properties.styles.desktop.base["background-color"]||delete e.properties.styles.desktop.base["background-color"],e.properties.styles.desktop.base["background-image"]||(delete e.properties.styles.desktop.base["background-image"],delete e.properties.styles.desktop.base["background-repeat"],delete e.properties.styles.desktop.base["background-size"],delete e.properties.bgFixed,delete e.properties.bgParallaxed),e.properties.styles.desktop.base["background-image"]||this.isBackgroundVideoSet(e)||(delete e.properties.styles.desktop.base["background-position"],delete e.properties.bgPosition))},E.prototype._transformBackgroundVideo=function(){var e=angular.copy(this.properties.bgVideo);this.isBackgroundVideoSet()&&angular.isObject(e)&&e.track&&(e.track.webm&&e.track.webm.path?(delete e.track.webm.id,delete e.track.webm.filesize,delete e.track.webm.length):e.track.webm=null,e.track.mp4&&e.track.mp4.path?(delete e.track.mp4.id,delete e.track.mp4.filesize,delete e.track.mp4.length):e.track.mp4=null),this._updateBackgroundVideoInDom(e,!0)},E.prototype._updateBackgroundView=function(){this._$dom.attr("data-bg-position",this.properties.bgPosition),this.properties.styles.desktop.base["background-position"]=this.properties.bgPosition,this._updateBackgroundVideoInDom(this.properties.bgVideo),_(this),h(this),y(this)},E.prototype._getBackgroundVideoCssClass=function(){if(this.isBackgroundVideoSet())return"moto-background-video moto-absolute-position"+(angular.isString(this.properties.bgPosition)?" moto-absolute-position_"+this.properties.bgPosition.replace(" ","-"):"")},E.prototype.initialize=function(){this._$dom.removeClass("moto-sticky__hidden"),this._propertiesLoaded?(this.properties.bgPosition=this.properties.styles.desktop.base["background-position"],this.properties.cssName&&(this._cssName=this.properties.cssName)):this.loadPropertiesFromDom(),this._cssName||(this._cssName=v(this._dom,{},this.$),this._$dom.attr("data-css-name",this._cssName)),this.properties.styles=f(this.properties.styles),this.properties.bgPosition=this.properties.bgPosition||this.properties.styles.desktop.base["background-position"],_(this),this.updateEmptyClass(),this._updateBackgroundView()},E.prototype.create=function(){this.properties.styles=f(this.properties.styles),this._cssName=v(this._dom,{},this.$),this._$dom.attr("data-css-name",this._cssName),this.updateEmptyClass(),_(this),this.properties.bgPosition=this.properties.styles.desktop.base["background-position"]||this.properties.bgPosition,this._$dom.attr("data-bg-position",this.properties.bgPosition),this._updateBackgroundView()},E.prototype.__toObject=function(){var t=this,e=g.prototype.__toObject.call(this),o=d.defer();return d.when(e).then(function(e){e.properties.cssName=t._cssName,o.resolve(e)},o.reject),o.promise},E.prototype.__exportWidget=function(e){var t=g.prototype.__exportWidget.call(this,e);return t.properties.cssName=this._cssName,t},E.prototype.exportForCopy=function(){var e=g.prototype.exportForCopy.call(this);return delete e.properties.cssName,this._exportBackground(e),e},E.prototype.exportForFuture=function(){var e=g.prototype.exportForFuture.call(this);return delete e.properties.cssName,delete e.properties.anchor,e.properties.stickyEnabled=!1,e.properties.stickyHidden=!1,this._exportBackground(e),e},o.set("container",E),t.addWidget({name:E.prototype.name,label:E.prototype.label,category:"structure",order:10,enabled:!0,allowed:function(){return!0},icons:{small:"icon icon-container",medium:"",large:"icon icon-container"}})}]),angular.module("application.widget.container").config(["coreLibraryWidgetProvider","coreLibraryRenderWidgetUtilProvider","MotoDevicesConstants",function(d,u,g){function m(e){return!0===e||1===e||"1"===e}d.Environment.getGlobal("Nunjucks").addExtension("widget_container",new function(){this.tags=["widgetContainer"],this.parse=function(e,t){var o,i,r=e.nextToken();return o=e.parseSignature(null,!0),e.advanceAfterBlockEnd(r.value),i=e.parseUntilBlocks("endWidgetContainer"),e.advanceAfterBlockEnd(),new t.CallExtensionAsync(this,"runAsync",o,[i])},this.runAsync=function(e,c,t,p){return t(function(e,t){var o,i,r,n=u.generateWidgetId(),a={widgetId:n},s="",l="";if(angular.isString(c)&&("{"!==(c=c.trim())[0]&&(c=atob(c)),"{"===c[0]&&(c=angular.fromJson(c)||{})),c=c||{},a={widgetId:n=u.generateWidgetId()},angular.isObject(c.properties)){if(angular.isDefined(c.properties.desktop)&&angular.isUndefined(c.properties.styles)&&angular.isUndefined(c.version)){for(c.properties.styles={},r=(o=g.LIST).length,i=0;i<r;i++)angular.isDefined(c.properties[o[i]])&&(c.properties.styles[o[i]]=c.properties[o[i]],delete c.properties[o[i]]);angular.isDefined(c.properties.fixed)&&(c.properties.bgFixed=!!parseInt(c.properties.fixed),delete c.properties.fixed),angular.isDefined(c.properties.parallax)&&(c.properties.bgParallaxed=!!parseInt(c.properties.parallax),delete c.properties.parallax),angular.isDefined(c.sticky_enabled)&&(c.properties.stickyEnabled=c.sticky_enabled,delete c.sticky_enabled),angular.isDefined(c.sticky_hidden)&&(c.properties.stickyHidden=c.sticky_hidden,delete c.sticky_hidden)}a.properties=c.properties,d.CacheOptions.set(n,{name:"container",widgetId:n,properties:c.properties})}else c.properties={};c.properties.stickyEnabled&&(s={},c.properties.stickyHidden&&(s.hidden=!0),s='data-moto-sticky="'+angular.toJson(s)+'"'),m(c.properties.bgFixed)&&(l+="moto-background-fixed"),t='<div data-widget-id="'+n+'" class="moto-widget moto-widget-container '+l+'" '+s+'data-widget="container" '+(m(c.properties.bgParallaxed)?' data-stellar-background-ratio="0.5" ':"")+'data-container="container">'+t+"</div>",p(null,t)})}})}]),angular.module("application.widget.cookie_notification",[]).run(["core.library.editor.PresetsService",function(e){e.addWidget({name:"cookie_notification",label:"WIDGET.COOKIE_NOTIFICATION.NAME",category:"basic",order:14,enabled:!0,checkPresetControls:!1,stateParam:"cookie_notification",icons:{small:"icon icon-cookie_notification",medium:"icon icon-cookie_notification-medium",large:"icon icon-cookie_notification"},template:{path:"@websiteWidgets/cookie_notification/templates/default.twig.css",engine:"nunjucks"}})}]),angular.module("application.widget.countdown",["application.widget.abstract","core.library.languages"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","core.library.editor.PresetsService","motoFeatures","coreLibraryLanguages",function(e,t,o,i,r){var n=e.get("AbstractWidgetClass");function a(){return(new Date).setHours(0,0,0,0)+1296e5}function s(e){var t,o,i;(e=e.__getPublicInstance())&&("event"===e.properties.type?((t=new Date).setTime(e.properties.time),o=angular.copy(t),i=angular.copy(t)):(o=null,(i=new Date).setHours(e.properties.time/36e5%24,e.properties.time/6e4%60,e.properties.time/1e3%60,0)),e.viewData.date=o,e.viewData.time=i)}function l(e){s(e.currentWidget),e.dateOrTimeChanged=function(){e.currentWidget.viewData.time?"event"===e.currentWidget.properties.type?(e.currentWidget.viewData.date||(e.currentWidget.viewData.date=new Date,e.currentWidget.viewData.date.setTime(a())),e.currentWidget.properties.time=new Date(e.currentWidget.viewData.date.getFullYear(),e.currentWidget.viewData.date.getMonth(),e.currentWidget.viewData.date.getDate(),e.currentWidget.viewData.time.getHours(),e.currentWidget.viewData.time.getMinutes(),e.currentWidget.viewData.time.getSeconds(),0).getTime()):e.currentWidget.properties.time=1e3*e.currentWidget.viewData.time.getSeconds()+6e4*e.currentWidget.viewData.time.getMinutes()+36e5*e.currentWidget.viewData.time.getHours():e.currentWidget.properties.time=0},e.timezones=[{key:-12,value:"(GMT -12:00) Eniwetok, Kwajalein"},{key:-11,value:"(GMT -11:00) Midway Island, Samoa"},{key:-10,value:"(GMT -10:00) Hawaii"},{key:-9,value:"(GMT -9:00) Alaska"},{key:-8,value:"(GMT -8:00) Pacific Time (US & Canada), Baja California"},{key:-7,value:"(GMT -7:00) Mountain Time (US & Canada), Arizona, Chihuahua, La Paz, Mazatlan"},{key:-6,value:"(GMT -6:00) Central Time (US & Canada), Central America, Mexico City, Monterrey, Saskatchewan"},{key:-5,value:"(GMT -5:00) Eastern Time (US & Canada), Bogota, Lima, Quito, Indiana (East)"},{key:-4.5,value:"(GMT -4:30) Caracas"},{key:-4,value:"(GMT -4:00) Atlantic Time (Canada), Georgetown, La Paz, Manaus, San Juan, Asuncion, Cuiaba, Santiago"},{key:-3.5,value:"(GMT -3:30) Newfoundland"},{key:-3,value:"(GMT -3:00) Brasilia, Buenos Aires, Cayenne, Fortaleza, Greenland, Montevideo"},{key:-2,value:"(GMT -2:00) Mid-Atlantic"},{key:-1,value:"(GMT -1:00) Azores, Cape Verde Islands"},{key:0,value:"(GMT) Western Europe Time, London, Lisbon, Dublin, Edinburgh, Casablanca, Reykjavik"},{key:1,value:"(GMT +1:00) Amsterdam, Berlin, Rome, Budapest, Brussels, Madrid, Paris, West Central Africa"},{key:2,value:"(GMT +2:00) Athens, Bucharest, Istanbul, Helsinki, Kyiv, Minsk, Tallinn, Riga, Jerusalem, Damascus, Harare, Pretoria"},{key:3,value:"(GMT +3:00) Baghdad, Kuwait, Moscow, St. Petersburg, Volgograd"},{key:3.5,value:"(GMT +3:30) Tehran"},{key:4,value:"(GMT +4:00) Abu Dhabi, Muscat, Baku, Tbilisi, Yerevan"},{key:4.5,value:"(GMT +4:30) Kabul"},{key:5,value:"(GMT +5:00) Ekaterinburg, Islamabad, Karachi, Tashkent"},{key:5.5,value:"(GMT +5:30) Chennai, Kolkata, Mumbai, New Delhi"},{key:5.75,value:"(GMT +5:45) Kathmandu"},{key:6,value:"(GMT +6:00) Astana, Dhaka, Novosibirsk"},{key:6.5,value:"(GMT +6:30) Yangon (Rangoon)"},{key:7,value:"(GMT +7:00) Bangkok, Hanoi, Jakarta, Krasnoyarsk"},{key:8,value:"(GMT +8:00) Beijing, Perth, Singapore, Hong Kong, Irkutsk, Singapore, Perth"},{key:9,value:"(GMT +9:00) Tokyo, Seoul, Osaka, Sapporo, Yakutsk"},{key:9.5,value:"(GMT +9:30) Adelaide, Darwin"},{key:10,value:"(GMT +10:00) Sydney, Canberra, Vladivostok, Hobart, Guam"},{key:11,value:"(GMT +11:00) Magadan, Solomon Islands, New Caledonia"},{key:12,value:"(GMT +12:00) Auckland, Wellington, Fiji"},{key:13,value:"(GMT +13:00) Nuku'alofa"}],e.languages=[{value:"Arabic",key:"ar"},{value:"Catalan",key:"ca"},{value:"Chinese, simplified",key:"zh_CN"},{value:"Chinese, traditional",key:"zh_TW"},{value:"Czech",key:"cs"},{value:"Danish",key:"da"},{value:"Dutch",key:"nl"},{value:"English",key:"en"},{value:"Finnish",key:"fi"},{value:"French",key:"fr"},{value:"German",key:"de"},{value:"Greek",key:"gr"},{value:"Hungarian",key:"hu"},{value:"Indonesian",key:"id"},{value:"Italian",key:"it"},{value:"Japanese",key:"ja"},{value:"Korean",key:"ko"},{value:"Lithuanian",key:"lt"},{value:"Malay",key:"ms"},{value:"Norwegian",key:"no"},{value:"Polish",key:"pl"},{value:"Portuguese",key:"pt"},{value:"Russian",key:"ru"},{value:"Spanish",key:"es"},{value:"Swedish",key:"sv"},{value:"Turkish",key:"tr"},{value:"Ukrainian",key:"uk"},{value:"Vietnamese",key:"vi"}]}function c(){this.properties={preset:"default",align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""},animation:"",visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},timezone:moment().utcOffset()/60,type:"event",time:a(),items:[{id:"years",enabled:!1},{id:"months",enabled:!1},{id:"days",enabled:!0},{id:"hours",enabled:!0},{id:"minutes",enabled:!0},{id:"seconds",enabled:!0}],delimiter:":",language:r.getProfileCode(),onExpiry:"stop",timeMeridianMode:!0},this.viewData={},n.apply(this,arguments)}l.$inject=["$scope"],((c.prototype=Object.create(n.prototype)).constructor=c).prototype._transformToMacros=!0,c.prototype.name="countdown",c.prototype.label="WIDGET.COUNTDOWN.NAME",c.prototype.controller=l,c.prototype._apiVersion=2,c.prototype._dragImagePath="@websiteWidgets/countdown/icons/drag.png",c.prototype._template={engine:"nunjucks",path:"@websiteWidgets/countdown/templates/default.twig.html"},c.prototype.isCopyable=function(){return!0},c.prototype.getEnabledItems=function(){return this.properties.items.filter(function(e){return e.enabled})},c.prototype.postRenderPreview=function(){n.prototype.postRenderPreview.apply(this,arguments),this._compileAngularTemplate(this._$dom)},c.prototype._compileAngularTemplate=function(o){var i;c.prototype._virtualNgApp.injector().invoke(["$rootScope","$compile",function(e,t){i=e.$new(),o.data("_$scope",i),t(o)(i),i.$digest()}])},c.prototype.willReceiveNewProperties=function(e){(e.type&&this.properties.type!==e.type||e.time&&this.properties.time!==e.time)&&s(this)},c.prototype._replaceNode=function(e){var t;this._$dom&&(t=this._$dom.data("_$scope"))&&t.$destroy(),n.prototype._replaceNode.call(this,e)},c.prototype.initialize=function(){this._$dom.data("_$scope")||this._compileAngularTemplate(this._$dom),n.prototype.initialize.call(this)},c.prototype.create=function(){this._compileAngularTemplate(this._$dom),n.prototype.create.call(this)},c.prototype.transform=function(){"redirect"!==this.properties.onExpiry&&delete this.properties.redirectUrl,"event"!==this.properties.type&&delete this.properties.timezone,n.prototype.transform.call(this)},e.doWhenLivePreviewReady(function(e){var t=e.angular.element("<div></div>");e.angular.bootstrap(t,["website.widget.countdown"]),c.prototype._virtualNgApp=t,e.angular.element(".moto-widget-countdown").each(function(){c.prototype._compileAngularTemplate(e.angular.element(this))})}),e.set(c.prototype.name,c),t.addWidget({name:c.prototype.name,label:c.prototype.label,category:"more",order:43,icons:{small:"icon icon-countdown",medium:"icon-countdown-medium",large:"icon icon-countdown"}}),o.addWidget({name:c.prototype.name,label:c.prototype.label,stateParam:"countdown_timer",category:"more",order:15,checkPresetControls:!1,icons:{small:"icon icon-countdown",medium:"icon-countdown-medium",large:"icon icon-countdown"}})}]),angular.module("application.widget.disqus",["application.core"]).config(["coreLibraryValidationProvider",function(i){i.setErrorMessage("DISQUS_SHORTNAME","WIDGET.DISQUS.SET_SHORTNAME_ERROR_MESSAGE"),i.setValidator("disqus_shortname",function(e){var t={isValid:!1,key:i.getErrorMessage("DISQUS_SHORTNAME","WIDGET.DISQUS.SET_SHORTNAME_ERROR_MESSAGE"),args:{}},o={isValid:!0,key:"",args:{}};return null===e?o:angular.isString(e)&&(e=e.trim(),/^([a-z0-9][a-z0-9\-]{1,62}[a-z0-9])$/i.test(e)||0===e.length)?o:t})}]).run(["core.library.editor.WidgetsService","motoFeatures","coreLibraryWidget","coreLibraryIntegration","coreLibraryUtils",function(e,t,o,i,c){var p,d,r=o.get("AbstractWidgetClass"),u=o.getCurrentPage,g="",n=null,a=!1,m=!1;function s(e){d=d||e}function f(){return d}function l(){d=null}function h(i,e){var t,o,r,n,a,s,l;try{if(!(i=i||{}).force&&!d)return void(m&&console.log("NOT _existsWidgetInstance"));if(t=f(),o=i.id||"connector_disqus",a=(n=(r=e||t._windowContext).document).getElementById(o),s=n.getElementsByTagName("head")[0],!(l=g||i.shortname)||!/^[a-zA-Z0-9\-]+$/.test(l)||a)return;if(n===p)return;p=n,r.disqus_config=function(){var e,t,o;try{e=u(),t=f(),o="@dynamic",this.language="en","@dynamic"===(o=t?(this.language=t.properties.params.language,t.properties.params.url):(i.language&&(this.language=i.language),i.url))?o=c.generateFullPageUrl(e):"@permanent"===o&&(o=e.getAbsoluteUrl()),this.page.url=o}catch(e){m&&console.info("error on disqus_config",e)}},(a=n.createElement("script")).id=o,a.src="//"+l+".disqus.com/embed.js",a.type="text/javascript",s.appendChild(a)}catch(e){m&&console.info("_injectSDK.ERROR",e)}}function y(){var e;try{(e=f()._windowContext).DISQUS?e.DISQUS.reset({reload:!0}):h()}catch(e){}}function b(i,e,r,n){i.shortname=g,i.addShortName=function(){0<i.shortname.length?m&&console.log("Shorname can be changed on this place"):e("@websiteWidgets/disqus/views/set_options.tpl.html",function(t,o){t.shortname=i.shortname,t.showTooltip=!1,t.ok=function(){t.editWidgetOptions&&!t.editWidgetOptions.validate()||r.setOptions({shortname:t.shortname}).then(function(e){e&&e.shortname&&(i.shortname=g=e.shortname,n.first("disqus").set("shortname",g),i.currentWidget.renderPreview(),i.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS"),h()),o.close(t)},function(){i.systemMessenger.error("WIDGET.DISQUS.SET_SHORTNAME_ERROR_MESSAGE")})},t.cancel=function(){o.close(t)}})},i.shortname||a||(a=!0,r.getOptions().then(function(e){e&&e.shortname&&(i.shortname=g=e.shortname),a=!1}).catch(function(){a=!1}))}function _(){this.properties={visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},params:{shortname:"",language:"en",use_identifier:!1,identifier:"",url:"@dynamic"}},r.apply(this,arguments)}n=i.first("disqus"),g=n.get("shortname",""),b.$inject=["$scope","coreLibraryModal","application.widget.DisqusService","coreLibraryIntegration"],((_.prototype=Object.create(r.prototype)).constructor=_).prototype.controller=b,_.prototype.name="disqus",_.prototype.label="WIDGET.DISQUS.NAME",_.prototype._transformToMacros=!0,_.prototype._apiVersion=2,_.prototype._dragImagePath="@websiteWidgets/disqus/icons/drag.png",_.prototype._template={engine:"nunjucks",path:"@websiteWidgets/disqus/templates/default.twig.html"},_.prototype.getParam=function(e){return"shortname"===e?g:this.properties.params[e]},_.prototype.isDuplicatableInSection=function(){return!1},_.prototype.postRenderPreview=function(){r.prototype.postRenderPreview.apply(this,arguments),y()},_.prototype.create=function(e){s(this),y(),r.prototype.create.call(this,e)},_.prototype.initialize=function(e){s(this),y(),r.prototype.initialize.call(this,e)},_.prototype.beforeDestroy=function(){l(),delete this.properties.params.window},_.prototype.transform=function(){l(),p=null,r.prototype.transform.call(this)},o.doWhenLivePreviewReady(function(e){var t,o;try{if(p=null,t=e.$(".moto-widget-disqus").first(),m&&console.log("disqus! $dom",t),!t.length)return void(m&&console.log("not found widget"));(o=e.widgetCacheOptions[t.data("widget-id")].properties.params).force=!0,o.shortname=g=n.get("shortname",""),o.shortname&&h(o,e)}catch(e){m&&console.info("disqus.doWhenLivePreviewReady",e)}}),o.set(_.prototype.name,_),e.addWidget({name:_.prototype.name,label:_.prototype.label,category:"more",order:40,enabled:!0,allowed:"page",icons:{small:"icon icon-disqus",medium:"",large:"icon icon-disqus"}})}]).service("application.widget.DisqusService",["jsonrpc",function(e){var t=e.newService("Widget.Disqus");this.getOptions=t.createMethod("getOptions"),this.setOptions=t.createMethod("setOptions")}]),angular.module("application.widget.divider_horizontal",["application.widget.abstract"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","core.library.editor.PresetsService","motoFeatures",function(e,t,o,i){var r=e.get("AbstractWidgetClass");function n(){this.properties={align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""},preset:"default",width:100,fixedWidth:1200,isFixed:!1,animation:"",visible_on:"mobile-v",spacing:{top:"medium",right:"auto",bottom:"medium",left:"auto"}},r.apply(this,arguments)}((n.prototype=Object.create(r.prototype)).constructor=n).prototype.name="divider_horizontal",n.prototype.label="WIDGET.DIVIDER_HORIZONTAL.NAME",n.prototype._apiVersion=2,n.prototype._transformToMacros=!0,n.prototype._dragImagePath="@websiteWidgets/divider_horizontal/icons/drag.png",n.prototype._template={engine:"nunjucks",path:"@websiteWidgets/divider_horizontal/templates/default.twig.html"},n.prototype.isCopyable=function(){return!0},n.prototype.initialize=function(){this._propertiesLoaded||(this.properties.width=this._$dom.data("width"),this.loadFromDOM()),r.prototype.initialize.call(this)},n.prototype.loadFromDOM=function(){this._$dom.attr("data-preset")&&(this.properties.preset=this._$dom.attr("data-preset")),this._$dom.attr("data-animation")&&(this.properties.animation=this._$dom.attr("data-animation")),this._$dom.attr("data-align")&&(this.properties.align=this._$dom.data("align"),"string"==typeof this.properties.align&&(this.properties.align={desktop:this.properties.align,tablet:"","mobile-h":"","mobile-v":""}))},e.set("divider_horizontal",n),t.addWidget({name:n.prototype.name,label:n.prototype.label,category:"basic",order:20,enabled:!0,allowed:function(){return!0},icons:{small:"icon icon-divider_horizontal",medium:"",large:"icon icon-h-divider"}}),o.addWidget({name:"divider_horizontal",label:"WIDGET.DIVIDER_HORIZONTAL.NAME",category:"basic",order:20,enabled:i.isEnabled("theme_presets_divider_horizontal"),icons:{small:"icon icon-divider_horizontal",medium:"icon icon-divider-medium",large:"icon icon-h-divider"}})}]),angular.module("application.widget.embed",["application.widget.abstract"]).run(["$rootScope","coreLibraryWidget","core.library.editor.WidgetsService","motoFeatures","coreLibraryUtils",function(e,t,o,i,r){var n=t.get("AbstractWidgetClass");function a(t,o){t.editCodeInEditor=function(e){o.openModal(e).then(function(e){t.currentWidget._code=e,t.currentWidget.setCode(e)})}}function s(){this.properties={animation:"",align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""},spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},preset:"default",code:""},this._code="",this._codeStamp=null,n.apply(this,arguments)}a.$inject=["$scope","CodeEditor"],((s.prototype=Object.create(n.prototype)).constructor=s).prototype.controller=a,s.prototype.name="embed",s.prototype.label="WIDGET.EMBED.NAME",s.prototype._apiVersion=2,s.prototype._transformToMacros=!0,s.prototype._dragImagePath="@websiteWidgets/embed/icons/drag.png",s.prototype._template={engine:"nunjucks",path:"@websiteWidgets/embed/templates/default.twig.html"},s.prototype._sanitizeOptions={removeComments:!0,trimHtmlCode:!0,removeMotoWidget:!0},s.prototype.getCode=function(){return this.properties.code},s.prototype.initialize=function(){this.properties.code=r.base64Decode(this.properties.code),this.properties.code&&(this._code=this.properties.code,this.rememberCode(this.properties.code)),n.prototype.initialize.call(this)},s.prototype.create=function(){this.properties.code&&(this._code=this.properties.code,this.rememberCode(this.properties.code)),n.prototype.create.call(this)},s.prototype.contentViewWasUpdated=function(e){this.properties.code!==e.code&&(this.__getPublicInstance()._code=this.properties.code,this.rememberCode(this.properties.code))},s.prototype.transform=function(){this.properties.code=r.base64Encode(this.properties.code),n.prototype.transform.call(this)},s.prototype.exportForFuture=function(){return null},s.prototype.sanitizeCode=function(e){var t;if(this._sanitizeOptions.trimHtmlCode&&(e=e.trim()),(t=$("<div>")).html(e),this._sanitizeOptions.removeComments)try{t.contents().filter(function(){return 8===this.nodeType}).remove()}catch(e){}return this._sanitizeOptions.removeMotoWidget&&t.find(".moto-widget").remove(),e=t.html(),this._sanitizeOptions.trimHtmlCode&&(e=e.trim()),e},s.prototype.isCodeChanged=function(e){return this._codeStamp!==e},s.prototype.rememberCode=function(e){this._codeStamp=e},s.prototype.setCode=function(e){var t=this.sanitizeCode(e);this.isCodeChanged(t)&&(this.rememberCode(t),this.setProperties({code:t}))},s.prototype.isCopyable=function(){return!0},s.prototype.isExecutableCode=function(){return!!angular.isUndefined(e.websiteSettings.widget_embed_execution)||e.websiteSettings.widget_embed_execution},t.set(s.prototype.name,s),o.addWidget({name:s.prototype.name,label:s.prototype.label,category:"more",order:80,enabled:i.isEnabled("theme_widget_embed"),icons:{small:"icon icon-embed",medium:"",large:"icon icon-embed"}})}]),function(){function a(e){return!!angular.isString(e)&&(e=e.trim(),/^(http[s]?:\/\/)?((www\.)?facebook\.com\/)(.+)$/i.test(e))}angular.module("application.widget.facebook_page_plugin",["application.widget.abstract","core.library.scriptsInjector","core.library.languages"]).config(["coreLibraryValidationProvider",function(i){i.setValidator("facebook_url",function(e){var t={isValid:!1,key:i.getErrorMessage("URL_INVALID","incorrectURL"),args:{}},o={isValid:!0,key:"",args:{}};return null===e?o:a(e)||0===e.length?o:t})}]).run(["coreLibraryWidget","core.library.editor.WidgetsService","ScriptsInjector","coreLibraryLanguages",function(e,t,o,i){var r=e.get("AbstractWidgetClass");function n(){this.properties={spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},align:{desktop:"center",tablet:"","mobile-v":"","mobile-h":""},title:"",params:{href:"",width:500,height:500,hide_cover:!1,show_facepile:!0,show_posts:!0,hide_cta:!1,small_header:!0,adapt_container_width:!0}},r.apply(this,arguments)}((n.prototype=Object.create(r.prototype)).constructor=n).prototype.name="facebook_page_plugin",n.prototype.label="WIDGET.FACEBOOK_PAGE_PLUGIN.NAME",n.prototype._templateViewURL="@websiteWidgets/facebook/views/page_plugin.tpl.html",n.prototype._apiVersion=2,n.prototype._dragImagePath="@websiteWidgets/facebook/icons/drag.png",n.prototype._transformToMacros=!0,n.prototype._template={engine:"nunjucks",path:"@websiteWidgets/facebook/templates/page_plugin.twig.html"},n.prototype.shouldUpdateContentView=function(e){return e.params&&!angular.equals(this.properties.params,e.params)},n.prototype.postRenderPreview=function(){var t=this;r.prototype.postRenderPreview.apply(this,arguments);try{a(this.properties.params.href)&&this._windowContext.FB.XFBML.parse(this._dom)}catch(e){"init not called with valid version"===e.message&&setTimeout(function(){t.renderPreview()},1e3)}},n.prototype.loadPropertiesFromAttribute=function(){var e;try{e=this.$(this._dom).attr("moto-properties"),e=angular.fromJson(e),angular.isObject(e)&&(this.properties=$.extend(!0,this.properties,e))}catch(e){}},n.prototype.getHref=function(){return a(this.properties.params.href)?this.properties.params.href:""},n.prototype.create=function(){this.initializeSDK(),r.prototype.create.call(this)},n.prototype.initialize=function(){this._propertiesLoaded||this.loadPropertiesFromAttribute(),this.initializeSDK(),r.prototype.initialize.call(this)},n.prototype.isCopyable=function(){return!0},n.prototype.initializeSDK=function(){this._Environment.getLivePreviewService().ScriptsInjector.inject("facebook").then(function(){this.postRenderPreview()}.bind(this))},o.addScript("facebook",function(){var e=i.getWebsiteLocale();return $("<script><\/script>").attr("id","facebook-jssdk").attr("src","//connect.facebook.net/"+e+"/sdk.js#xfbml=1&version=v2.8")}),e.set("facebook_page_plugin",n),t.addWidget({name:n.prototype.name,label:n.prototype.label,category:"social",order:30,enabled:!0,icons:{small:"icon icon-facebook-page",medium:"",large:"icon icon-facebook-page"}})}])}(),angular.module("application.widget.form_elements.attachment",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","motoFeatures",function(e,t,o){var i=e.get("AbstractFormFieldWidgetClass");function r(e,t){e.serverEnvironment=t.get("environment")}function n(){this.properties={name:"",placeholder:"",type:"file",description:{text:"",style:"moto-text_system_11",align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""}},validation:{required:!1,fileExtension:{allowed:!1,value:""},fileSize:{allowMin:!1,minValue:"10kb",allowMax:!1,maxValue:"500kb"}},buttons:{attachment:{label:"Attach File",preset:"default",size:"medium"}},spaceBetweenControls:"small",spacing:{top:"auto",right:"auto",bottom:"small",left:"auto"}},i.apply(this,arguments)}r.$inject=["$scope","coreLibraryConfig"],((n.prototype=Object.create(i.prototype)).constructor=n).prototype.name="form_elements.attachment",n.prototype.label="WIDGET.FORM_ELEMENTS.ATTACHMENT.NAME",n.prototype.controller=r,n.prototype._templateViewURL="@websiteWidgets/form_elements/views/attachment_properties.tpl.html",n.prototype._dragImagePath="@websiteWidgets/form_elements/icons/attachment/drag.png",n.prototype._template={engine:"nunjucks",path:"@websiteWidgets/form_elements/templates/attachment.twig.html"},n.prototype.create=function(){var e=this.getMainForm();e&&!this.properties.name&&(this.properties.name=e.generateAutomaticFieldName("ATTACHMENT_")),i.prototype.create.call(this)},t.addWidget({name:n.prototype.name,label:n.prototype.label,category:"form_elements",order:65,enabled:o.isEnabled("engine_form_element_widgets"),allowed:function(){return!0},icons:{small:"icon icon-form_elements-attachment",medium:"icon icon-form_elements-attachment",large:"icon icon-form_elements-attachment"}}),e.set(n.prototype.name,n)}]),angular.module("application.widget.form_elements.button_submit",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","motoFeatures","$translate",function(e,t,o,i){var r=e.get("AbstractFormElementWidgetClass");function n(e){}function a(){this.properties={preset:"default",label:i.instant("COMMON.TEXT.SUBMIT"),waitingText:"",size:"medium",align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""},spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"}},r.apply(this,arguments)}n.$inject=["$scope"],((a.prototype=Object.create(r.prototype)).constructor=a).prototype.name="form_elements.button_submit",a.prototype.label="WIDGET.FORM_ELEMENTS.BUTTON_SUBMIT.NAME",a.prototype.controller=n,a.prototype._templateViewURL="@websiteWidgets/form_elements/views/button_submit_properties.tpl.html",a.prototype._dragImagePath="@websiteWidgets/form_elements/icons/button_submit/drag.png",a.prototype._template={engine:"nunjucks",path:"@websiteWidgets/form_elements/templates/button_submit.twig.html"},t.addWidget({name:a.prototype.name,label:a.prototype.label,category:"form_elements",order:70,enabled:o.isEnabled("engine_form_element_widgets"),allowed:function(){return!0},icons:{small:"icon icon-form_elements-button_submit",medium:"icon icon-form_elements-button_submit",large:"icon icon-form_elements-button_submit"}}),e.set(a.prototype.name,a)}]),angular.module("application.widget.form_elements.checkbox",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","motoFeatures","$translate",function(e,t,o,i){var r=e.get("AbstractFormFieldWidgetClass");function n(o,e){o.editCheckboxDescription=function(){e("@websiteWidgets/form_elements/src/backend/views/edit_checkbox_label.tpl.html",function(t,e){t.properties=angular.copy(o.currentWidget.properties),t.toggleTextEditor=function(){var e;"text"===t.properties.labelType?(e=angular.element(t.properties.label)).length&&(e.find(".fa").remove(),t.properties.label=e.text()):t.properties.label="<p>"+t.properties.label+"</p>"},t.ok=function(){t.editLabelForm.validate()&&("html"===t.properties.labelType&&5e3<t.properties.label.length?(t.$broadcast("MotoEvent:MotoCkeditor.ShowValidationBalloon",{messageKey:"COMMON.VALIDATION_ERROR.HTML_LENGTH_TOO_LONG",messageParams:{maximum_character_count:5e3}}),0):(t.$broadcast("MotoEvent:MotoCkeditor.ClearValidationBalloon"),1))&&(o.currentWidget.setProperties({label:t.properties.label,labelType:t.properties.labelType}),o.systemMessenger.success("WIDGET.COMMON.MESSAGES.CHANGES_APPLIED"),e.close(t))}},null,"modal-with-ckeditor")}}function a(){this.properties={name:"",label:i.instant("COMMON.TEXT.CHECKBOX"),labelType:"text",checked:!1,values:{checked:"Yes",unchecked:"No"},validation:{required:!1},align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""},spacing:{top:"auto",right:"auto",bottom:"small",left:"auto"}},r.apply(this,arguments)}n.$inject=["$scope","coreLibraryModal"],((a.prototype=Object.create(r.prototype)).constructor=a).prototype.name="form_elements.checkbox",a.prototype.label="WIDGET.FORM_ELEMENTS.CHECKBOX.NAME",a.prototype.controller=n,a.prototype._templateViewURL="@websiteWidgets/form_elements/views/checkbox_properties.tpl.html",a.prototype._dragImagePath="@websiteWidgets/form_elements/icons/checkbox/drag.png",a.prototype._template={engine:"nunjucks",path:"@websiteWidgets/form_elements/templates/checkbox.twig.html"},a.prototype.create=function(){var e=this.getMainForm();e&&!this.properties.name&&(this.properties.name=e.generateAutomaticFieldName("CHECKBOX_")),r.prototype.create.call(this)},t.addWidget({name:a.prototype.name,label:a.prototype.label,category:"form_elements",order:50,enabled:o.isEnabled("engine_form_element_widgets"),allowed:function(){return!0},icons:{small:"icon icon-form_elements-checkbox",medium:"icon icon-form_elements-checkbox",large:"icon icon-form_elements-checkbox"}}),e.set(a.prototype.name,a)}]),angular.module("application.form_elements.widgets").controller("application.form_elements.widgets.controllers.FieldOptionsController",["$scope","coreLibraryModal",function(r,e){r.openOptionPopup=function(i){e("@websiteWidgets/form_elements/src/backend/views/edit_field_option.tpl.html",function(t,e){var o;t.editingMode=!!i,t.editingMode&&(o=i.value),t.isOptionValueAvailable=!0,t.checkOptionValue=function(){return t.option.value=t.option.value.trim(),t.isOptionValueAvailable=o===t.option.value||!r.currentWidget.properties.options.some(function(e){return e.value===t.option.value})},t.option=t.editingMode?angular.copy(i):angular.copy({value:"",label:"",selected:!1}),t.ok=function(){!t.checkOptionValue()||t.editFieldOptionsForm&&!t.editFieldOptionsForm.validate()||(t.option.label=t.option.label.trim(),t.editingMode?angular.extend(i,t.option):r.currentWidget.properties.options.push(t.option),e.close(t))},t.cancel=function(){e.close(t)}})},r.deleteOption=function(e){var t=r.currentWidget.properties.options.indexOf(e);0<=t&&r.currentWidget.properties.options.splice(t,1)},r.setOptionSelected=function(t){t.selected?t.selected=!1:r.currentWidget.properties.options.forEach(function(e){e.selected=e===t})}}]),angular.module("application.form_elements.widgets").controller("application.form_elements.widgets.controllers.FormFieldController",["$scope","coreLibraryModal",function(e,t){e.editFieldName=function(o){t("@websiteWidgets/form_elements/src/backend/views/edit_field_name.tpl.html",function(e,t){e.name=o.getFieldName(),e.originalName=o.getFieldName(),e.isFieldNameAvailable=!0,e.checkFieldName=function(){e.isFieldNameAvailable=e.originalName===e.name||o.getMainForm().isFieldNameAvailable(e.name)},e.ok=function(){e.checkFieldName(),e.name&&e.isFieldNameAvailable&&(!e.editFieldNameForm||e.editFieldNameForm.validate())&&(o.setProperties({name:e.name}),t.close(e))},e.cancel=function(){t.close(e)}})}}]),angular.module("application.widget.form_elements.input",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","motoFeatures",function(e,t,o){var i=e.get("AbstractFormFieldWidgetClass");function r(e){e.inputTypes=[{label:"COMMON.TEXT.TEXT",value:"text"},{label:"COMMON.TEXT.NUMBER",value:"number"},{label:"COMMON.TEXT.EMAIL",value:"email"},{label:"COMMON.TEXT.PHONE",value:"tel"},{label:"COMMON.TEXT.URL",value:"url"}]}function n(){this.properties={name:"",placeholder:"",type:"text",icon:null,description:{text:"",style:"moto-text_system_11",align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""}},validation:{required:!1,stringLength:{allowMin:!1,minValue:1,allowMax:!1,maxValue:100},numberValue:{allowMin:!1,minValue:1,allowMax:!1,maxValue:100}},spacing:{top:"auto",right:"auto",bottom:"small",left:"auto"}},i.apply(this,arguments)}r.$inject=["$scope"],((n.prototype=Object.create(i.prototype)).constructor=n).prototype.name="form_elements.input",n.prototype.label="WIDGET.FORM_ELEMENTS.INPUT.NAME",n.prototype.controller=r,n.prototype._templateViewURL="@websiteWidgets/form_elements/views/input_properties.tpl.html",n.prototype._dragImagePath="@websiteWidgets/form_elements/icons/input/drag.png",n.prototype._template={engine:"nunjucks",path:"@websiteWidgets/form_elements/templates/input.twig.html"},n.prototype.create=function(){var e=this.getMainForm();e&&!this.properties.name&&(this.properties.name=e.generateAutomaticFieldName("INPUT_")),i.prototype.create.call(this)},n.prototype.getFieldValidators=function(){var e=i.prototype.getFieldValidators.call(this);return"email"===this.properties.type&&e.push("email"),e},t.addWidget({name:n.prototype.name,label:n.prototype.label,category:"form_elements",order:20,enabled:o.isEnabled("engine_form_element_widgets"),allowed:function(){return!0},icons:{small:"icon icon-form_elements-input",medium:"icon icon-form_elements-input",large:"icon icon-form_elements-input"}}),e.set(n.prototype.name,n)}]),angular.module("application.widget.form_elements.label",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","motoFeatures","$translate",function(e,t,o,i){var r=e.get("AbstractFormElementWidgetClass");function n(e){}function a(){this.properties={text:i.instant("WIDGET.FORM_ELEMENTS.LABEL.NAME"),textStyle:"moto-text_system_10",align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""},spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"}},r.apply(this,arguments)}n.$inject=["$scope"],((a.prototype=Object.create(r.prototype)).constructor=a).prototype.name="form_elements.label",a.prototype.label="WIDGET.FORM_ELEMENTS.LABEL.NAME",a.prototype.controller=n,a.prototype._templateViewURL="@websiteWidgets/form_elements/views/label_properties.tpl.html",a.prototype._dragImagePath="@websiteWidgets/form_elements/icons/label/drag.png",a.prototype._template={engine:"nunjucks",path:"@websiteWidgets/form_elements/templates/label.twig.html"},t.addWidget({name:a.prototype.name,label:a.prototype.label,category:"form_elements",order:10,enabled:o.isEnabled("engine_form_element_widgets"),allowed:function(){return!0},icons:{small:"icon icon-form_elements-label",medium:"icon icon-form_elements-label",large:"icon icon-form_elements-label"}}),e.set(a.prototype.name,a)}]),angular.module("application.widget.form_elements.radio_buttons",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","motoFeatures","$translate",function(e,t,o,i){var r=e.get("AbstractFormFieldWidgetClass");function n(e){}function a(){this.properties={options:null,optionsDirection:"vertical",validation:{required:!1},align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""},spacing:{top:"auto",right:"auto",bottom:"small",left:"auto"}},r.apply(this,arguments),angular.isArray(this.properties.options)||(this.properties.options=[{value:i.instant("WIDGET.FORM_ELEMENTS.RADIO_BUTTONS.OPTION_1_LABEL"),label:i.instant("WIDGET.FORM_ELEMENTS.RADIO_BUTTONS.OPTION_1_LABEL"),selected:!1},{value:i.instant("WIDGET.FORM_ELEMENTS.RADIO_BUTTONS.OPTION_2_LABEL"),label:i.instant("WIDGET.FORM_ELEMENTS.RADIO_BUTTONS.OPTION_2_LABEL"),selected:!1}])}n.$inject=["$scope"],((a.prototype=Object.create(r.prototype)).constructor=a).prototype.name="form_elements.radio_buttons",a.prototype.label="WIDGET.FORM_ELEMENTS.RADIO_BUTTONS.NAME",a.prototype.controller=n,a.prototype._templateViewURL="@websiteWidgets/form_elements/views/radio_buttons_properties.tpl.html",a.prototype._dragImagePath="@websiteWidgets/form_elements/icons/radio_buttons/drag.png",a.prototype._template={engine:"nunjucks",path:"@websiteWidgets/form_elements/templates/radio_buttons.twig.html"},a.prototype.create=function(){var e=this.getMainForm();e&&!this.properties.name&&(this.properties.name=e.generateAutomaticFieldName("RADIO_BUTTONS_")),r.prototype.create.call(this)},a.prototype.getFieldValidators=function(){var e,t=r.prototype.getFieldValidators.call(this),o=[];for(e=0;e<this.properties.options.length;e++)o.push(this.properties.options[e].value);return t.push({name:"InArray",options:{haystack:o}}),t},t.addWidget({name:a.prototype.name,label:a.prototype.label,category:"form_elements",order:60,enabled:o.isEnabled("engine_form_element_widgets"),allowed:function(){return!0},icons:{small:"icon icon-form_elements-radio_buttons",medium:"icon icon-form_elements-radio_buttons",large:"icon icon-form_elements-radio_buttons"}}),e.set(a.prototype.name,a)}]),angular.module("application.widget.form_elements.recaptcha",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","motoFeatures","ScriptsInjector","coreLibraryIntegration","application.settings.services.SettingsService",function(e,t,o,i,r,n){var a=e.get("AbstractFormFieldWidgetClass");function s(i,e){i.recaptcha={v2:r.first("recaptcha").get("v2",{key:"",secret_key:""})},i.addIntegrationSiteKey=function(){e("@websiteWidgets/form_elements/src/backend/views/add_recaptcha_keys.tpl.html",function(t,o){t.recaptcha=angular.copy(i.recaptcha),t.apply=function(){n.setIntegrationValue({type:"recaptcha",items:[t.recaptcha]}).then(function(e){r.first("recaptcha").set("v2",e.v2),o.close(t),i.recaptcha=t.recaptcha,i.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS")},function(){i.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")})}})}}function l(){this.properties={name:"",theme:"light",size:"normal",validation:{required:!0},align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""},spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"}},a.apply(this,arguments)}s.$inject=["$scope","coreLibraryModal"],((l.prototype=Object.create(a.prototype)).constructor=l).prototype.name="form_elements.recaptcha",l.prototype.label="WIDGET.FORM_ELEMENTS.RECAPTCHA.NAME",l.prototype.controller=s,l.prototype._templateViewURL="@websiteWidgets/form_elements/views/recaptcha_properties.tpl.html",l.prototype._dragImagePath="@websiteWidgets/form_elements/icons/recaptcha/drag.png",l.prototype._template={engine:"nunjucks",path:"@websiteWidgets/form_elements/templates/recaptcha.twig.html"},l.prototype.create=function(){var e=this.getMainForm();e&&!this.properties.name&&(this.properties.name=e.generateAutomaticFieldName("RECAPTCHA_")),a.prototype.create.call(this)},l.prototype.getFieldFilters=function(){return null},l.prototype.getFieldValidators=function(){var e=a.prototype.getFieldValidators.apply(this,arguments);return e.push("recaptcha"),e},o.isEnabled("engine_form_element_widgets")&&o.enable("engine_widget_form_elements_recaptcha"),t.addWidget({name:l.prototype.name,label:l.prototype.label,category:"form_elements",order:90,enabled:o.isEnabled("engine_form_element_widgets"),allowed:function(){return!0},icons:{small:"icon icon-form_elements-recaptcha",medium:"icon icon-form_elements-recaptcha",large:"icon icon-form_elements-recaptcha"}}),e.set(l.prototype.name,l)}]),angular.module("application.widget.form_elements.select",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","motoFeatures","$translate",function(e,t,o,i){var r=e.get("AbstractFormFieldWidgetClass");function n(e){}function a(){this.properties={name:"",options:null,validation:{required:!1},spacing:{top:"auto",right:"auto",bottom:"small",left:"auto"}},r.apply(this,arguments),angular.isArray(this.properties.options)||(this.properties.options=[{value:"",label:i.instant("COMMON.TEXT.NOT_SELECTED"),selected:!0}])}n.$inject=["$scope"],((a.prototype=Object.create(r.prototype)).constructor=a).prototype.name="form_elements.select",a.prototype.label="WIDGET.FORM_ELEMENTS.SELECT.NAME",a.prototype.controller=n,a.prototype._templateViewURL="@websiteWidgets/form_elements/views/select_properties.tpl.html",a.prototype._dragImagePath="@websiteWidgets/form_elements/icons/select/drag.png",a.prototype._template={engine:"nunjucks",path:"@websiteWidgets/form_elements/templates/select.twig.html"},a.prototype.create=function(){var e=this.getMainForm();e&&!this.properties.name&&(this.properties.name=e.generateAutomaticFieldName("SELECT_")),r.prototype.create.call(this)},a.prototype.getPreviewOptionLabel=function(){var t,o;return this.properties.options.forEach(function(e){e.selected&&(o=e.label),e.value||(t=e.label)}),o||t||""},a.prototype.getFieldValidators=function(){var e,t=r.prototype.getFieldValidators.call(this),o=[];for(e=0;e<this.properties.options.length;e++)o.push(this.properties.options[e].value);return t.push({name:"InArray",options:{haystack:o}}),t},t.addWidget({name:a.prototype.name,label:a.prototype.label,category:"form_elements",order:40,enabled:o.isEnabled("engine_form_element_widgets"),allowed:function(){return!0},icons:{small:"icon icon-form_elements-select",medium:"icon icon-form_elements-select",large:"icon icon-form_elements-select"}}),e.set(a.prototype.name,a)}]),angular.module("application.widget.form_elements.status_message",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","motoFeatures","$translate",function(e,t,o,i){var r=e.get("AbstractFormElementWidgetClass");function n(e){}function a(){this.properties={messages:{statusSendingText:i.instant("WIDGET.FORM_ELEMENTS.STATUS_MESSAGE.SENDING_MESSAGE_TEXT"),statusSendingStyle:"moto-text_system_10",sendingSuccessText:i.instant("WIDGET.FORM_ELEMENTS.STATUS_MESSAGE.SUCCESS_MESSAGE_TEXT"),sendingSuccessStyle:"moto-text_system_10",sendingErrorText:i.instant("WIDGET.FORM_ELEMENTS.STATUS_MESSAGE.ERROR_MESSAGE_TEXT"),sendingErrorStyle:"moto-text_system_10"},align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""},spacing:{top:"auto",right:"auto",bottom:"small",left:"auto"}},r.apply(this,arguments)}n.$inject=["$scope"],((a.prototype=Object.create(r.prototype)).constructor=a).prototype.name="form_elements.status_message",a.prototype.label="WIDGET.FORM_ELEMENTS.STATUS_MESSAGE.NAME",a.prototype.controller=n,a.prototype._templateViewURL="@websiteWidgets/form_elements/views/status_message_properties.tpl.html",a.prototype._dragImagePath="@websiteWidgets/form_elements/icons/status_message/drag.png",a.prototype._template={engine:"nunjucks",path:"@websiteWidgets/form_elements/templates/status_message.twig.html"},a.prototype.__showMessageName=null,a.prototype.showStatusMessage=function(e){this.__showMessageName!==e&&(this.__showMessageName=e,this.updateContentView())},t.addWidget({name:a.prototype.name,label:a.prototype.label,category:"form_elements",order:80,enabled:o.isEnabled("engine_form_element_widgets"),allowed:function(){return!0},icons:{small:"icon icon-form_elements-status_message",medium:"icon icon-form_elements-status_message",large:"icon icon-form_elements-status_message"}}),e.set(a.prototype.name,a)}]),angular.module("application.widget.form_elements.textarea",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","motoFeatures",function(e,t,o){var i=e.get("AbstractFormFieldWidgetClass");function r(e){}function n(){this.properties={name:"",placeholder:"",styles:{desktop:{base:{height:"140px"}},tablet:{base:{height:""}},"mobile-v":{base:{height:""}},"mobile-h":{base:{height:""}}},description:{text:"",style:"moto-text_system_11",align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""}},validation:{required:!1,stringLength:{allowMin:!1,minValue:1,allowMax:!1,maxValue:100}},spacing:{top:"auto",right:"auto",bottom:"small",left:"auto"}},i.apply(this,arguments)}r.$inject=["$scope"],((n.prototype=Object.create(i.prototype)).constructor=n).prototype.name="form_elements.textarea",n.prototype.label="WIDGET.FORM_ELEMENTS.TEXTAREA.NAME",n.prototype.controller=r,n.prototype._templateViewURL="@websiteWidgets/form_elements/views/textarea_properties.tpl.html",n.prototype._dragImagePath="@websiteWidgets/form_elements/icons/textarea/drag.png",n.prototype._template={engine:"nunjucks",path:"@websiteWidgets/form_elements/templates/textarea.twig.html"},n.prototype.create=function(){var e=this.getMainForm();e&&!this.properties.name&&(this.properties.name=e.generateAutomaticFieldName("TEXTAREA_")),i.prototype.create.call(this)},t.addWidget({name:n.prototype.name,label:n.prototype.label,category:"form_elements",order:30,enabled:o.isEnabled("engine_form_element_widgets"),allowed:function(){return!0},icons:{small:"icon icon-form_elements-textarea",medium:"icon icon-form_elements-textarea",large:"icon icon-form_elements-textarea"}}),e.set(n.prototype.name,n)}]),angular.module("application.widget.google_map_pro").controller("application.widget.google_map_pro.controllers.MarkerController",["$scope","coreLibraryModal","coreLibraryUtils","application.media_library.services.MediaLibraryService","motoUI.LinkToService","MotoGeocoding",function(i,e,o,t,r,n){var a={icon:"",title:"",caption:"",position:{}};function s(e,t,o){i.$apply(function(){i.editingMarker||i.editMarker(t,o)})}function l(e,t){i.$apply(function(){i.editingMarker.position={lat:t.lat(),lng:t.lng()}})}i.address="",i.search=function(){""!==i.address&&n.searchFirstLocationByAddress(i.address).then(function(e){i.popupGoogleMapInstance.setCenter(n.getPointByLocation(e))},function(e){i.systemMessenger.error(e)})},i.editingMarker=null,i.editMarker=function(e,t){e?(i.editingMarker=angular.copy(e),i.popupGoogleMapInstance.setCenter(i.editingMarker.position),angular.isString(i.editingMarker.caption)||(i.editingMarker.caption=""),i.editingMarkerIndex=t):(i.editingMarker=angular.copy(a),i.editingMarker.uid=o.generateUID("gmm_"),i.editingMarker.position=i.popupGoogleMapInstance.getCenter(),i.editingMarkerIndex=-1,i.popupGoogleMapInstance.addMarker(i.editingMarker)),i.popupGoogleMapInstance.showOnlyMarker(i.editingMarker)},i.deleteMarker=function(t){o.openConfirmationBox({yesHandler:function(){var e;i.popupGoogleMapInstance.deleteMarker(t),-1<(e=i.markersList.indexOf(t))&&i.markersList.splice(e,1)}})},$(document).on("motoGoogleMap:markerClick",s),$(document).on("motoGoogleMap:markerDragend",l),i.$on("$destroy",function(){$(document).off("motoGoogleMap:markerClick",s),$(document).off("motoGoogleMap:markerDragend",l)}),i.applyEditing=function(){var e;(!angular.isString(i.editingMarker.caption)||(e=$("<div>"+i.editingMarker.caption.trim()+"</div>"),r.transformLinks(e),4e3<e.text().length?(i.$broadcast("MotoEvent:MotoCkeditor.ShowValidationBalloon",{messageKey:"COMMON.VALIDATION_ERROR.STRING_LENGTH_TOO_LONG",messageParams:{maximum_character_count:4e3}}),0):(i.$broadcast("MotoEvent:MotoCkeditor.ClearValidationBalloon"),i.editingMarker.caption=e.html(),1)))&&i.editingMarker.title.length<=200&&(-1<i.editingMarkerIndex?i.markersList[i.editingMarkerIndex]=i.editingMarker:i.markersList.push(i.editingMarker),i.popupGoogleMapInstance.clearAllMarkers(),i.popupGoogleMapInstance.addMarker(i.markersList),i.editingMarker=null)},i.cancelEditing=function(){i.editingMarker=null,i.popupGoogleMapInstance.clearAllMarkers(),i.popupGoogleMapInstance.addMarker(i.markersList)},i.clearIcon=function(){i.editingMarker.icon="",i.refreshCurrentMarker()},i.changeIcon=function(){t.open({value:angular.isString(i.editingMarker.icon)&&i.editingMarker.icon.match(/^http/i)?null:i.editingMarker.icon,filters:["image"],thumbnails:!0,onApply:function(e){i.editingMarker.icon=e.path,i.refreshCurrentMarker()}})},i.refreshCurrentMarker=function(){i.editingMarker&&i.popupGoogleMapInstance.updateMarker(i.editingMarker)}}]),angular.module("application.widget.google_map_pro").run(["coreLibraryWidget","core.library.editor.WidgetsService","coreLibraryIntegration","application.settings.services.SettingsService","MotoGeocoding","coreLibraryPathResolver",function(e,t,r,n,o,i){var a=e.get("AbstractWidgetClass");function s(e,t){r.first("google_map").get("api_key","")&&e.find(".moto-widget-google-map-pro-wrapper").motoGoogleMap(t.params).then(function(e){e.addMarker(t.markers)})}function l(i,e){i.apiKey=r.first("google_map").get("api_key",""),i.addGoogleMapApiKey=function(){e("@websiteWidgets/google_map_pro/src/backend/views/add_api_key.tpl.html",function(t,o){t.apply=function(){n.setIntegrationValue({type:"google_map",items:[{api_key:t.apiKey}]}).then(function(e){r.first("google_map").set("api_key",e.api_key),i.apiKey=r.first("google_map").get("api_key",""),$.fn.motoGoogleMap.setApiKey(e.api_key),i.currentWidget._windowContext.$.fn.motoGoogleMap.setApiKey(e.api_key),i.currentWidget.renderPreview(),o.close(t),i.systemMessenger.success("COMMON.MESSAGES.UPDATE_SUCCESS")},function(){i.systemMessenger.error("COMMON.MESSAGES.UPDATE_ERROR")})}})},i.editMapPosition=function(){e("@websiteWidgets/google_map_pro/src/backend/views/map_position.tpl.html",function(t,e){t.popupGoogleMapInstance=null,t.mapParams=angular.copy(i.currentWidget.properties.params),t.markersList=angular.copy(i.currentWidget.properties.markers),t.mapParams.fullscreenControl=!1,t.mapParams.streetViewControl=!1,t.mapParams.zoomControl=!0,t.mapParams.mapTypeControl=!0,t.address="",e.rendered.then(function(){$("#popupMapPositionGoogleMapPreview").motoGoogleMap(t.mapParams).then(function(e){t.popupGoogleMapInstance=e,t.popupGoogleMapInstance._markers.withInfowWindow=!1,t.popupGoogleMapInstance.addMarker(t.markersList)})}),t.ok=function(){i.currentWidget.properties.params.zoom=t.popupGoogleMapInstance.getZoom(),i.currentWidget.properties.params.center=t.popupGoogleMapInstance.getCenter(),e.close(t)},t.search=function(){""!==t.address&&o.searchFirstLocationByAddress(t.address).then(function(e){t.popupGoogleMapInstance.setCenter(o.getPointByLocation(e))},function(e){i.systemMessenger.error(e)})}},null,"widget-admin")},i.openMarkersPopup=function(){e("@websiteWidgets/google_map_pro/src/backend/views/markers.tpl.html",function(t,e){t.mapParams=angular.copy(i.currentWidget.properties.params),t.markersList=angular.copy(i.currentWidget.properties.markers),t.mapParams.streetViewControl=!1,t.mapParams.fullscreenControl=!1,e.rendered.then(function(){$("#popupMapMarkersPreview").motoGoogleMap(t.mapParams).then(function(e){t.popupGoogleMapInstance=e,t.popupGoogleMapInstance._markers.withInfowWindow=!1,t.popupGoogleMapInstance.addMarker(t.markersList)})}),t.ok=function(){i.currentWidget.properties.markers=t.markersList,e.close(t)}},null,"widget-admin modal-map-markers")}}function c(){this.properties={spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},visible_on:"mobile-v",height:300,params:{center:{lat:40.7127753,lng:-74.0059728},zoom:10,theme:"standard",mapTypeControl:!0,zoomControl:!0,streetViewControl:!0,rotateControl:!1,scaleControl:!1,fullscreenControl:!0},markers:[]},a.apply(this,arguments)}$.fn.motoGoogleMap.setApiKey(r.first("google_map").get("api_key","")),$.fn.motoGoogleMap.setUrlResolveHandler(i.getUploadAbsoluteUrl),l.$inject=["$scope","coreLibraryModal","coreLibraryUtils"],((c.prototype=Object.create(a.prototype)).constructor=c).prototype.controller=l,c.prototype.name="google_map_pro",c.prototype.label="WIDGET.GOOGLE_MAP_PRO.NAME",c.prototype._apiVersion=2,c.prototype._transformToMacros=!0,c.prototype._dragImagePath="@websiteWidgets/google_map_pro/icons/drag.png",c.prototype._template={engine:"nunjucks",path:"@websiteWidgets/google_map_pro/templates/default.twig.html"},c.prototype.isCopyable=function(){return!0},c.prototype.isSetApiKey=function(){return r.first("google_map").get("api_key","")},c.prototype.create=function(){s(this._$dom,this.properties),a.prototype.create.call(this)},c.prototype.exportFrontendMarkersData=function(){return angular.toJson(this.properties.markers)},c.prototype.postRenderPreview=function(){s(this._$dom,this.properties)},e.doWhenLivePreviewReady(function(e){e.$.fn.motoGoogleMap.setUrlResolveHandler(i.getUploadAbsoluteUrl),e.$(".moto-widget-google-map-pro").each(function(){try{e.$(this).data("widget-id")&&e.widgetCacheOptions[e.$(this).data("widget-id")].properties&&s(e.$(this),e.widgetCacheOptions[e.$(this).data("widget-id")].properties)}catch(e){}})}),e.set(c.prototype.name,c),t.addWidget({name:c.prototype.name,label:c.prototype.label,enabled:!0,category:"more",order:11,options:{children:[]},icons:{small:"icon icon-google_map_pro",medium:"icon icon-google_map_pro",large:"icon icon-google_map_pro"}})}]),angular.module("application.widget.google_map_pro").service("MotoGeocoding",["$http","$q","coreLibraryIntegration",function(i,r,n){this.searchAllLocationsByAddress=function(e){var t=n.first("google_map").get("api_key",""),o=r.defer();return t.length?angular.isString(e)&&e.length?i.get("https://maps.googleapis.com/maps/api/geocode/json?",{params:{key:t,address:e}}).then(function(e){var t=e.data;return"ZERO_RESULTS"===t.status?o.reject("COMMON.ERROR_MESSAGE.NOT_FOUND"):"OK"!==t.status?o.reject(t.error_message||"Unknown Error"):o.resolve(t.results)}).catch(function(e){return o.reject(e.statusText||"Unknown Error")}):o.reject("Bad argument"):o.reject("Empty API key"),o.promise},this.searchFirstLocationByAddress=function(e){return this.searchAllLocationsByAddress(e).then(function(e){return e[0]})},this.getPointByLocation=function(e){return e.geometry.location}}]),function(s){var l="NOT_LOADED",c="",p="googleMapLoadedCallback_"+Date.now(),d=[];function u(e){for(var t;d.length;)t=d.shift(),e?t.deferred.reject(e):t.deferred.resolve(t.instance())}function t(e){return e}function g(e){return angular.isObject(e)&&e.icon&&(e.icon=t(e.icon,"marker.icon")),e}"undefined"!=typeof google&&void 0!==google.maps&&(l="LOADED"),window[p]=function(){u(),delete window[p],l="LOADED"},s.fn.motoGoogleMap=function(e){var t,o,i=s.Deferred(),r=this[0],n={standard:[],silver:[{elementType:"geometry",stylers:[{color:"#f5f5f5"}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{elementType:"labels.text.stroke",stylers:[{color:"#f5f5f5"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#bdbdbd"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#eeeeee"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#e5e5e5"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#ffffff"}]},{featureType:"road.arterial",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#dadada"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{color:"#e5e5e5"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#eeeeee"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#c9c9c9"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]}],retro:[{elementType:"geometry",stylers:[{color:"#ebe3cd"}]},{elementType:"labels.text.fill",stylers:[{color:"#523735"}]},{elementType:"labels.text.stroke",stylers:[{color:"#f5f1e6"}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#c9b2a6"}]},{featureType:"administrative.land_parcel",elementType:"geometry.stroke",stylers:[{color:"#dcd2be"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#ae9e90"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#93817c"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#a5b076"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#447530"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#f5f1e6"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#fdfcf8"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#f8c967"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#e9bc62"}]},{featureType:"road.highway.controlled_access",elementType:"geometry",stylers:[{color:"#e98d58"}]},{featureType:"road.highway.controlled_access",elementType:"geometry.stroke",stylers:[{color:"#db8555"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#806b63"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"transit.line",elementType:"labels.text.fill",stylers:[{color:"#8f7d77"}]},{featureType:"transit.line",elementType:"labels.text.stroke",stylers:[{color:"#ebe3cd"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#b9d3c2"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#92998d"}]}],dark:[{elementType:"geometry",stylers:[{color:"#212121"}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{elementType:"labels.text.stroke",stylers:[{color:"#212121"}]},{featureType:"administrative",elementType:"geometry",stylers:[{color:"#757575"}]},{featureType:"administrative.country",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"administrative.land_parcel",stylers:[{visibility:"off"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#bdbdbd"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#181818"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"poi.park",elementType:"labels.text.stroke",stylers:[{color:"#1b1b1b"}]},{featureType:"road",elementType:"geometry.fill",stylers:[{color:"#2c2c2c"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#8a8a8a"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#373737"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#3c3c3c"}]},{featureType:"road.highway.controlled_access",elementType:"geometry",stylers:[{color:"#4e4e4e"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"transit",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#000000"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#3d3d3d"}]}],night:[{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#263c3f"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#6b9a76"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#38414e"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#212a37"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#9ca5b3"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#746855"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#1f2835"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#f3d19c"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#2f3948"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#515c6d"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#17263c"}]}],aubergine:[{elementType:"geometry",stylers:[{color:"#1d2c4d"}]},{elementType:"labels.text.fill",stylers:[{color:"#8ec3b9"}]},{elementType:"labels.text.stroke",stylers:[{color:"#1a3646"}]},{featureType:"administrative.country",elementType:"geometry.stroke",stylers:[{color:"#4b6878"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#64779e"}]},{featureType:"administrative.province",elementType:"geometry.stroke",stylers:[{color:"#4b6878"}]},{featureType:"landscape.man_made",elementType:"geometry.stroke",stylers:[{color:"#334e87"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#023e58"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#283d6a"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#6f9ba5"}]},{featureType:"poi",elementType:"labels.text.stroke",stylers:[{color:"#1d2c4d"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#023e58"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#3C7680"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#304a7d"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#98a5be"}]},{featureType:"road",elementType:"labels.text.stroke",stylers:[{color:"#1d2c4d"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#2c6675"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#255763"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#b0d5ce"}]},{featureType:"road.highway",elementType:"labels.text.stroke",stylers:[{color:"#023e58"}]},{featureType:"transit",elementType:"labels.text.fill",stylers:[{color:"#98a5be"}]},{featureType:"transit",elementType:"labels.text.stroke",stylers:[{color:"#1d2c4d"}]},{featureType:"transit.line",elementType:"geometry.fill",stylers:[{color:"#283d6a"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#3a4762"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#0e1626"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#4e6d70"}]}]};function a(e){this.items=[],this.map=e,this.withInfowWindow=!0}return a.prototype.add=function(e){var t,o;return Array.isArray(e)?angular.forEach(e,this.add.bind(this)):(o=s.extend(!0,{},e),e instanceof google.maps.Marker||(e=new google.maps.Marker(e)),g(e),e.setMap(this.map),this.items.push(e),this.withInfowWindow?this.setInfoWindow(e):(google.maps.event.addListener(e,"click",function(){t=this.items.indexOf(e),s(document).trigger("motoGoogleMap:markerClick",[o,t])}.bind(this)),google.maps.event.addListener(e,"dragend",function(){s(document).trigger("motoGoogleMap:markerDragend",e.getPosition())}.bind(this)))),this},a.prototype.update=function(t){var o,e=this.getByUid(t.uid);if(!angular.isObject(t))return!1;for(o in g(t=angular.copy(t)),t)if(t.hasOwnProperty(o)&&"_"!==o[0]&&"$"!==o[0]&&"function"!=typeof t[o])try{"position"===o?e.setPosition(t[o]):e.set(o,t[o])}catch(e){console.warn("UpdateMarker : error on set property value ",o,t[o])}return!0},a.prototype.delete=function(e){var t;(e=this.getByUid(e.uid))&&(e.setMap(null),-1<(t=this.items.indexOf(e))&&this.items.splice(t,1))},a.prototype.clearAll=function(){this.items.forEach(function(e){e.setMap(null)}),this.items=[]},a.prototype.getItems=function(){return this.items},a.prototype.showOnly=function(e){var t,o;for(t=0,o=this.items.length;t<o;t++)this.items[t].get("uid")!==e.uid?this.items[t].setVisible(!1):this.items[t].setDraggable(!0)},a.prototype.setInfoWindow=function(e){var t;e.caption&&e.caption.length&&((t=new google.maps.InfoWindow).setContent('<div class="moto-widget-text">'+e.caption+"</div>"),e.addListener("click",function(){t.open(this.map,e)}.bind(this)))},a.prototype.getByUid=function(e){var t,o;for(t=0,o=this.items.length;t<o;t++)if(this.items[t].get("uid")===e)return this.items[t];return null},d.push({deferred:i,instance:function(){return e.styles=n[e.theme],{getMap:function(){return t},setZoom:function(e){t.setZoom(e)},getZoom:function(){return t.getZoom()},setCenter:function(e){return t.setCenter(e)},getCenter:function(){return{lat:t.getCenter().lat(),lng:t.getCenter().lng()}},_markers:new a(t=new google.maps.Map(r,e)),addMarker:function(e){this._markers.add(e)},deleteMarker:function(e){this._markers.delete(e)},showOnlyMarker:function(e){this._markers.showOnly(e)},updateMarker:function(e){this._markers.update(e)},clearAllMarkers:function(){this._markers.clearAll()}}}}),"LOADED"===l?u():"LOADING"!==l&&(l="LOADING",(o=document.createElement("script")).type="text/javascript",o.src="https://maps.googleapis.com/maps/api/js?key="+c+"&callback="+p,o.defer=!0,o.onerror=function(){u("Google Map SDK not loaded!")},document.body.appendChild(o)),i.promise()},s.fn.motoGoogleMap.setUrlResolveHandler=function(e){return!!angular.isFunction(e)&&(t=e,!0)},s.fn.motoGoogleMap.isSdkInjected=function(){return"NOT_LOADED"!==l&&"LOADING"!==l},s.fn.motoGoogleMap.isSdkReady=function(){return"LOADED"===l},s.fn.motoGoogleMap.setApiKey=function(e){if("string"!=typeof e)throw new Error("[motoGoogleMap.setApiKey] Bad argument: ApiKey must be a string, got "+typeof e);return!s.fn.motoGoogleMap.isSdkInjected()&&(c=e,!0)}}(jQuery),angular.module("application.widget.grid_gallery").controller("application.widget.grid_gallery.controllers.EditItemController",["$scope","application.media_library.services.MediaLibraryService",function(o,e){o.currentItem=angular.copy(o.editingItem),o.currentItem.captionType=o.currentItem.captionType||"text",o.toggleTextEditor=function(){var e;"text"==o.currentItem.captionType&&(e=angular.element(o.currentItem.caption)).length&&(e.find(".fa").remove(),o.currentItem.caption=e.text())},o.changeContentImage=function(){e.open({id:o.currentItem.content.id||null,value:o.currentItem.content.path,filters:["image"],thumbnails:!0,size:o.currentItem.content.size||"",onApply:function(e,t){e&&(o.currentItem.content.path=t?e.getThumbnailPath(t):e.path,o.currentItem.content.size=t,o.currentItem.content.id=e.id,o.currentItem.content.name=e.name)}})},o.changeThumbnailImage=function(){e.open({id:o.currentItem.thumbnail.id||null,value:o.currentItem.thumbnail.path,filters:["image"],thumbnails:!0,size:o.currentItem.thumbnail.size||"",onApply:function(e,t){e&&(o.currentItem.thumbnail.id!=e.id&&(o.currentItem.thumbnail.id=e.id,o.currentItem.thumbnail.alt=e.alt),o.currentItem.thumbnail.path=t?e.getThumbnailPath(t):e.path,o.currentItem.thumbnail.size=t,o.currentItem.thumbnail.name=e.name)}})},o.ok=function(){o.editImage&&!o.editImage.$valid||(angular.equals(o.editingItem,o.currentItem)||(o.editingItem.caption=o.currentItem.caption.trim(),o.editingItem.captionType=o.currentItem.captionType,o.editingItem.content=o.currentItem.content,o.editingItem.id=o.currentItem.id,o.editingItem.size=o.currentItem.size,o.editingItem.thumbnail=o.currentItem.thumbnail),o.$parent.ok())}}]),angular.module("application.widget.grid_gallery").controller("application.widget.grid_gallery.controllers.TopController",["$scope","coreLibraryModal","coreLibraryUtils","application.media_library.services.MediaLibraryService",function(i,e,r,t){i.initialItems=angular.copy(i.items),i.addImage=function(){t.open({multiSelect:!0,filters:["image"],thumbnails:!0,onApply:function(e,o){e&&e.forIn(function(e,t){i.items.push({caption:"",ordinalNumber:i.items.length,content:{path:o?t.getThumbnailPath(o):t.path,id:t.id,name:t.name,size:o},thumbnail:{path:o?t.getThumbnailPath(o):t.path,id:t.id,name:t.name,size:o,alt:t.alt}})})}})},i.editImage=function(o){i.selectedImage=o,e("@websiteWidgets/grid_gallery/src/backend/views/edit_item.tpl.html",function(e,t){e.editingItem=o,e.ok=function(){t.close(e)},e.cancel=function(){t.close(e)}},null,"widget-admin-edit modal-with-ckeditor")},i.deleteImage=function(e){var t=i.items.indexOf(e);0<=t&&i.items.splice(t,1)},i.$on("numberOfItemsChanged",function(){i.initSortableGrid()}),i.initSortableGrid=function(){var o=angular.element(".items-list");try{o.sortable("destroy")}catch(e){}o.sortable({placeholder:"ui-sortable-highlight",stop:function(){var e,t=o.sortable("toArray",{attribute:"item-index"});for(e=0;e<i.items.length;e++)i.items[e].ordinalNumber=t.indexOf(e.toString());r.sortArrayByProperty(i.items,"ordinalNumber"),i.$apply()}})},i.isChanged=function(){return!angular.equals(i.initialItems,i.items)},i.ok=function(){i.$parent.ok(i.items)},i.cancel=function(e){e&&e.preventDefault(),i.isChanged()?r.openConfirmationBox({yesHandler:function(){i.$parent.cancel()}}):i.$parent.cancel()},i.$on("motoPopupCanceled",i.cancel)}]),angular.module("application.widget.grid_gallery").run(["core.library.editor.WidgetsService","motoFeatures","coreLibraryWidget","coreLibraryModal","coreLibraryMessenger","core.library.editor.PresetsService",function(e,t,o,r,n,i){var a=o.get("AbstractWidgetClass");function s(i){r("@websiteWidgets/grid_gallery/src/backend/views/top.tpl.html",function(t,o){t.items=angular.copy(i.properties.items),t.ok=function(e){i.setProperties({items:e}),o.close(t),n.success("WIDGET.COMMON.MESSAGES.CHANGES_APPLIED")},t.cancel=function(){o.close(t)}},null,"widget-admin")}function l(e,t){var o;e.justifiedGallery({rowHeight:(o=t).rowHeight,maxRowHeight:o.fixedHeight?o.rowHeight:0,margins:o.margins,lastRow:o.lastRow,captions:o.showCaptions,cssAnimation:!0})}function c(e){e.openSelectItemsPopup=s}function p(){this.properties={preset:"default",visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},settings:{rowHeight:120,fixedHeight:!1,margins:10,lastRow:"nojustify",showCaptions:!0,enableLightbox:!0,showCounter:!0},animation:"",items:[]},a.apply(this,arguments)}c.$inject=["$scope"],((p.prototype=Object.create(a.prototype)).constructor=p).prototype._transformToMacros=!0,p.prototype.name="grid_gallery",p.prototype.label="WIDGET.GRID_GALLERY.NAME",p.prototype.controller=c,p.prototype._apiVersion=2,p.prototype._dragImagePath="@websiteWidgets/grid_gallery/icons/drag.png",p.prototype._template={engine:"nunjucks",path:"@websiteWidgets/grid_gallery/templates/default.twig.html"},p.prototype.onDoubleClickEvent=function(){s(this)},p.prototype.postRenderPreview=function(){l(this.$(".moto-widget-grid-gallery-items",this._dom),this.properties.settings)},p.prototype.isCopyable=function(){return!0},p.prototype.initialize=function(){l(this.$(".moto-widget-grid-gallery-items",this._dom),this.properties.settings),a.prototype.initialize.call(this)},p.prototype.create=function(){l(this.$(".moto-widget-grid-gallery-items",this._dom),this.properties.settings),a.prototype.create.call(this)},p.prototype.exportForFuture=function(){var e,t,o=a.prototype.exportForFuture.call(this);if(angular.isArray(o.properties.items))for(e=0,t=o.properties.items.length;e<t;e++)angular.isObject(o.properties.items[e].content)&&delete o.properties.items[e].content.id,angular.isObject(o.properties.items[e].thumbnail)&&delete o.properties.items[e].thumbnail.id;return o},o.doWhenLivePreviewReady(function(t){t.$(".moto-widget-grid-gallery").each(function(){var e;try{t.$(this).data("widget-id")&&(e=t.widgetCacheOptions[t.$(this).data("widget-id")].properties)&&l(t.$(this).find(".moto-widget-grid-gallery-items"),e.settings)}catch(e){}})}),o.set(p.prototype.name,p),e.addWidget({name:p.prototype.name,label:p.prototype.label,category:"galleries",order:20,enabled:t.isEnabled("theme_widget_grid_gallery"),icons:{small:"icon icon-grid_gallery",medium:"",large:"icon icon-grid"}}),i.addWidget({name:p.prototype.name,label:p.prototype.label,category:"galleries",order:40,enabled:t.isEnabled("theme_presets_grid_gallery"),template:{path:"@websiteWidgets/grid_gallery/templates/default.twig.css",engine:"nunjucks"},icons:{small:"icon icon-grid_gallery",medium:"icon icon-grid-medium",large:"icon icon-grid"}})}]),angular.module("application.widget.iframe",["application.widget.abstract"]).run(["core.library.editor.WidgetsService","application.extra.services.ExtraService","coreLibraryWidget","$q","coreLibraryValidation",function(e,n,t,a,s){var o=t.get("AbstractWidgetClass");function i(r,e){r.openChangeUrlPopup=function(){e("@websiteWidgets/iframe/views/change_url.tpl.html",function(o,i){o.url=r.currentWidget.properties.url,o.apply=function(){var e,t;s.getValidator("url")(o.url).isValid&&(e=o.url,t=a.defer(),n.getUrlFrameOptions({url:e.replace(/^\/\//,"http://")}).then(function(e){!e||0<=e.indexOf(window.location.host)?t.resolve():t.reject()},function(e){(e.code=400)?t.resolve():t.reject()}),t.promise).then(function(){r.currentWidget.properties.url=o.url,i.close(o)},function(){o.systemMessenger.error("WIDGET.IFRAME.URL_HINT_ERROR")})},o.cancel=function(){i.close(o)}})}}function r(){this.properties={preset:"default",height:120,animation:"",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},url:""},o.apply(this,arguments)}i.$inject=["$scope","coreLibraryModal"],((r.prototype=Object.create(o.prototype)).constructor=r).prototype.name="iframe",r.prototype.label="WIDGET.IFRAME.NAME",r.prototype.controller=i,r.prototype._transformToMacros=!0,r.prototype._dragImagePath="@websiteWidgets/iframe/icons/drag.png",r.prototype._apiVersion=2,r.prototype._template={engine:"nunjucks",path:"@websiteWidgets/iframe/templates/default.twig.html"},r.prototype.isCopyable=function(){return!0},r.prototype.loadPropertiesFromDom=function(){var e=this._$dom.find(".moto-widget-iframe-frame");this.properties.url=e.attr("src"),this.properties.height=e.height(),this.properties.animation=this._$dom.data("animation")||"",this._$dom.find(".moto-widget-empty,.frame-empty").hasClass("frame-empty")&&this.renderPreview()},r.prototype.initialize=function(){this._propertiesLoaded||this.loadPropertiesFromDom(),o.prototype.initialize.call(this)},r.prototype.shouldUpdateContentView=function(e){return e.url!==this.properties.url},r.prototype.manualUpdateContentView=function(){this._$dom.find(".moto-widget-iframe-frame").height(this.properties.height)},t.set(r.prototype.name,r),e.addWidget({name:r.prototype.name,label:r.prototype.label,category:"more",order:70,allowed:function(){return!0},icons:{small:"icon icon-iframe",medium:"",large:"icon icon-iframe"}})}]),angular.module("application.widget.image",["application.widget.abstract","application.media_library"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","application.media_library.services.MediaLibraryService","core.library.editor.PresetsService",function(e,t,i,o){var r=e.get("AbstractWidgetClass"),n=!1;function a(e){e.clearImage=function(e){e.clearImage()},e.changeImage=function(e){e.changeImage()}}function s(){this.properties={id:null,src:"",alt:"",title:"",align:{desktop:"",tablet:"","mobile-v":"","mobile-h":""},preset:"default",thumbnail:"",animation:"",link:{action:"none",properties:{id:"",target:"_self",email:"",subject:"",body:""}},visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"}},r.apply(this,arguments)}a.$inject=["$scope"],((s.prototype=Object.create(r.prototype)).constructor=s).prototype.name="image",s.prototype.label="WIDGET.IMAGE.NAME",s.prototype.controller=a,s.prototype._apiVersion=2,s.prototype._transformToMacros=!0,s.prototype._dragImagePath="@websiteWidgets/image/icons/drag.png",s.prototype._template={engine:"nunjucks",path:"@websiteWidgets/image/templates/default.twig.html"},s.prototype.isCopyable=function(){return!0},s.prototype.onDoubleClickEvent=function(e){this.changeImage()},s.prototype.setImage=function(e,t){var o={};t&&e.thumbnails.hasOwnProperty(t)?(o.src=e.getThumbnailPath(t),o.thumbnail=t):(o.src=e.path,o.thumbnail=""),this.properties.id!=e.id&&(o.id=e.id,o.alt=e.alt,o.title=e.title),this.setProperties(o)},s.prototype.clearImage=function(){this.setProperties({id:"0",src:"",thumbnail:""})},s.prototype.changeImage=function(){var o=this;n||(i.open({value:this.properties.src,id:this.properties.id,filters:["image"],thumbnails:!0,size:this.properties.thumbnail,onApply:function(e,t){o.setImage(e,t)}}),n=!0,setTimeout(function(){n=!1},250))},s.prototype.loadPropertiesFromDom=function(){var e,t=this._$dom.find(".moto-widget-image-picture"),o=this._$dom.find(".moto-widget-image-link");return t.data("id")&&(this.properties.id=parseInt(t.data("id")),this.properties.src=t.data("src")||"",this.properties.alt=t.attr("alt")||"",this.properties.title=t.attr("title")||""),o.data("action")&&(this.properties.link={action:o.data("action"),properties:{id:o.data("page"),url:o.attr("href"),target:o.attr("target")}},(e=o.attr("href"))&&(e=e.replace("mailto:",""),this.properties.link.properties.email=e)),this.properties.title=t.attr("title"),this.properties.alt=t.attr("alt"),this},s.prototype.initialize=function(){this._propertiesLoaded||(this.loadPropertiesFromDom(),this.properties.preset=this._$dom.data("preset"),this.properties.align=this._$dom.data("align")),r.prototype.initialize.call(this)},s.prototype.create=function(){this._Editor.isSilentMode(this)||this.changeImage(),r.prototype.create.call(this)},s.prototype.exportForFuture=function(){var e=r.prototype.exportForFuture.call(this);return delete e.properties.id,e},e.set(s.prototype.name,s),t.addWidget({name:s.prototype.name,label:s.prototype.label,category:"basic",order:10,enabled:!0,allowed:function(){return!0},icons:{small:"icon icon-image",medium:"",large:"icon icon-image"}}),o.addWidget({name:s.prototype.name,label:s.prototype.label,category:"basic",order:50,icons:{small:"icon icon-image",medium:"icon icon-image-medium",large:"icon icon-image"}})}]),angular.module("application.widget.instagram.post",["application.widget.abstract","core.library.scriptsInjector"]).config(["coreLibraryValidationProvider",function(r){r.setValidator("instagram_post_url",function(e){var t,o={isValid:!1,key:r.getErrorMessage("URL_INVALID","incorrectURL"),args:{}},i={isValid:!0,key:"",args:{}};return null===e?i:(t=e,angular.isString(t)&&(t=t.trim(),/^(http[s]?:\/\/)?((www\.)?instagram\.com\/p\/)(.+)$/i.test(t))||0===e.length?i:o)})}]).run(["core.library.editor.WidgetsService","coreLibraryWidget","coreLibraryValidation","ScriptsInjector","coreLibraryUtils","coreLibraryModal","$http","motoFeatures",function(e,t,r,o,i,n,a,s){var l=t.get("AbstractWidgetClass");function c(i){i.openChangeUrlPopup=function(){n("@websiteWidgets/instagram/views/change_post_url.tpl.html",function(e,t){var o=i.currentWidget.properties;e.url=o.params.href,e.apply=function(){if(r.getValidator("instagram_post_url")(e.url).isValid)return""===e.url?(i.currentWidget.setProperties({encodedHtml:"",params:{href:"",hideCaption:o.params.hideCaption}}),void t.close(e)):void i.currentWidget.getDataFromAPI({href:e.url,hideCaption:o.params.hideCaption}).then(function(){t.close(e)}).catch(function(){i.systemMessenger.error("WIDGET.INSTAGRAM_POST.POST_NOT_FOUND_ERROR")})}})}}function p(){this.properties={spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},align:{desktop:"center",tablet:"","mobile-v":"","mobile-h":""},visible_on:"mobile-v",encodedHtml:"",params:{href:"",hideCaption:!1}},l.apply(this,arguments)}c.$inject=["$scope"],((p.prototype=Object.create(l.prototype)).constructor=p).prototype.name="instagram.post",p.prototype.label="WIDGET.INSTAGRAM_POST.NAME",p.prototype._apiVersion=2,p.prototype.controller=c,p.prototype._templateViewURL="@websiteWidgets/instagram/views/post.tpl.html",p.prototype._transformToMacros=!0,p.prototype._dragImagePath="@websiteWidgets/instagram/icons/post/drag.png",p.prototype._template={engine:"nunjucks",path:"@websiteWidgets/instagram/templates/post.twig.html"},p.prototype.create=function(){this.initializeSDK(),l.prototype.create.apply(this,arguments)},p.prototype.initialize=function(){this.initializeSDK(),l.prototype.initialize.apply(this,arguments)},p.prototype.shouldUpdateContentView=function(e){return angular.isDefined(e.encodedHtml)&&!angular.equals(this.properties.encodedHtml,e.encodedHtml)},p.prototype.getDecodedHtml=function(){return i.base64Decode(this.properties.encodedHtml)},p.prototype.isCopyable=function(){return!0},p.prototype.getDataFromAPI=function(t){return angular.isUndefined(t)&&(t=this.properties.params),a({method:"GET",url:"https://api.instagram.com/oembed/?omitscript=true&hidecaption="+t.hideCaption+"&url="+t.href}).then(function(e){this.setProperties({encodedHtml:i.base64Encode(e.data.html),params:{href:t.href,hideCaption:t.hideCaption}})}.bind(this))},p.prototype.postRenderPreview=function(){l.prototype.postRenderPreview.apply(this,arguments);try{this._windowContext.instgrm.Embeds.process()}catch(e){}},p.prototype.initializeSDK=function(){this._Environment.getLivePreviewService().ScriptsInjector.inject("instagram_post").then(function(){this.postRenderPreview()}.bind(this))},o.addScript("instagram_post",function(){return $("<script><\/script>").attr("src","//www.instagram.com/embed.js").attr("async","").attr("defer","")}),t.set(p.prototype.name,p),e.addWidget({name:p.prototype.name,label:p.prototype.label,category:"social",order:50,enabled:s.isEnabled("theme_widget_instagram_post"),icons:{small:"icon icon-instagram_post",medium:"icon icon-instagram_post",large:"icon icon-instagram_post"}})}]),angular.module("application.integrations.widget.acuity_scheduling",["application.core"]).config(["coreLibraryValidationProvider",function(r){r.setValidator("acuity_scheduling_page_url",function(e){var t,o={isValid:!1,key:r.getErrorMessage("URL_INVALID","incorrectURL"),args:{}},i={isValid:!0,key:"",args:{}};return null===e?i:(t=e,angular.isString(t)&&/^(http[s]?:\/\/)?(app\.acuityscheduling\.com\/schedule\.php\?)(.+)$/i.test(t.trim())||0===e.length?i:o)})}]).run(["coreLibraryWidget","core.library.editor.WidgetsService","coreLibraryModal","coreLibraryValidation","motoFeatures",function(e,t,o,r,i){var n=e.get("AbstractWidgetClass");function a(i){i.openChangeUrlPopup=function(){o("@websiteWidgets/integrations/src/backend/views/acuity_scheduling/change_url.tpl.html",function(e,t){var o=i.currentWidget.properties;e.url=o.url,e.apply=function(){r.getValidator("acuity_scheduling_page_url")(e.url).isValid&&(i.currentWidget.setProperties({url:e.url}),t.close(e))}},null,"modal-with-ckeditor")}}function s(){this.properties={spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""},visible_on:"mobile-v",url:"",type:"iframe",templateType:"weekly",buttonProperties:{label:"Schedule Appointment",target:"popup",size:"medium",preset:"default"}},n.apply(this,arguments)}a.$inject=["$scope"],((s.prototype=Object.create(n.prototype)).constructor=s).prototype._transformToMacros=!0,s.prototype.name="integrations.acuity_scheduling",s.prototype.label="WIDGET.INTEGRATIONS.ACUITY_SCHEDULING.NAME",s.prototype.controller=a,s.prototype._apiVersion=2,s.prototype._templateViewURL="@websiteWidgets/integrations/views/acuity_scheduling_properties.tpl.html",s.prototype._dragImagePath="@websiteWidgets/integrations/icons/acuity_scheduling/drag.png",s.prototype._template={engine:"nunjucks",path:"@websiteWidgets/integrations/templates/acuity_scheduling.twig.html"},s.prototype.exportForFuture=function(){return null},s.prototype.isCopyable=function(){return!0},t.addWidget({name:s.prototype.name,label:s.prototype.label,category:"integrations",order:5,enabled:i.isEnabled("theme_widget_integrations_acuity_scheduling"),allowed:function(){return!0},icons:{small:"icon icon-integrations-acuity_scheduling",medium:"icon icon-integrations-acuity_scheduling",large:"icon icon-integrations-acuity_scheduling"}}),e.set(s.prototype.name,s)}]),angular.module("application.integrations.widget.airbnb",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","coreLibraryModal","motoFeatures","ScriptsInjector",function(e,t,o,i,r){var n=e.get("AbstractWidgetClass");function a(t){t.openChangeIdPopup=function(){o("@websiteWidgets/integrations/src/backend/views/airbnb/apartment_id.tpl.html",function(o,e){o.apartmentId=t.currentWidget.properties.apartmentId,o.urlIdRegExp=/^((http[s]?:\/\/)?(\w+\.)?airbnb\.(\w+)\/rooms\/(plus\/)?)?([0-9]{0,100})((\/)?(\?.+)?)?$/,o.tryParseUrl=function(e){var t=o.apartmentId.match(o.urlIdRegExp);return t?t[6]:e},o.apply=function(){o.apartmentId=o.tryParseUrl(o.apartmentId),o.editItemForm.validate()&&(t.currentWidget.setProperties({apartmentId:o.apartmentId}),e.close(o))}})}}function s(){this.properties={apartmentId:null,hidePrice:!1,hideReviews:!1,spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},align:{desktop:"center",tablet:"","mobile-v":"","mobile-h":""},visible_on:"mobile-v"},n.apply(this,arguments)}a.$inject=["$scope"],((s.prototype=Object.create(n.prototype)).constructor=s).prototype._transformToMacros=!0,s.prototype.name="integrations.airbnb",s.prototype.label="WIDGET.INTEGRATIONS.AIRBNB.NAME",s.prototype.controller=a,s.prototype._apiVersion=2,s.prototype._templateViewURL="@websiteWidgets/integrations/views/airbnb_properties.tpl.html",s.prototype._dragImagePath="@websiteWidgets/integrations/icons/airbnb/drag.png",s.prototype._template={engine:"nunjucks",path:"@websiteWidgets/integrations/templates/airbnb.twig.html"},s.prototype.exportForFuture=function(){return null},s.prototype.isCopyable=function(){return!0},s.prototype.create=function(){this.initializeSDK(),n.prototype.create.apply(this,arguments)},s.prototype.initialize=function(){this.initializeSDK(),n.prototype.initialize.apply(this,arguments)},s.prototype.shouldUpdateContentView=function(e){return angular.isDefined(e.apartmentId)&&this.properties.apartmentId!==e.apartmentId||angular.isDefined(e.hidePrice)&&this.properties.hidePrice!==e.hidePrice||angular.isDefined(e.hideReviews)&&this.properties.hideReviews!==e.hideReviews},s.prototype.postRenderPreview=function(){n.prototype.postRenderPreview.apply(this,arguments);try{this._windowContext.AirbnbAPI.bootstrap()}catch(e){}},s.prototype.initializeSDK=function(){this._Environment.getLivePreviewService().ScriptsInjector.inject("airbnb_embed").then(function(){this.postRenderPreview()}.bind(this))},r.addScript("airbnb_embed",function(){return $("<script><\/script>").attr("id","airbnb-jssdk").attr("src","//airbnb.com/embeddable/airbnb_jssdk")}),t.addWidget({name:s.prototype.name,label:s.prototype.label,category:"integrations",order:15,enabled:i.isEnabled("theme_widget_integrations_airbnb"),allowed:function(){return!0},icons:{small:"icon icon-integrations-airbnb",medium:"icon icon-integrations-airbnb",large:"icon icon-integrations-airbnb"}}),e.set(s.prototype.name,s)}]),angular.module("application.integrations.widget.opentable",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","coreLibraryModal","motoFeatures",function(e,t,o,i){var r=e.get("AbstractWidgetClass");function n(r){r.openItemPopup=function(i){o("@websiteWidgets/integrations/src/backend/views/opentable/restaurant_id.tpl.html",function(e,t){var o=angular.copy(r.currentWidget.properties.restaurants);e.editingMode=angular.isDefined(i),e.id=e.editingMode?o[i]:"",e.ok=function(){if(e.editItem.validate()){if(-1!==o.indexOf(e.id)&&o.indexOf(e.id)!==i)return r.systemMessenger.error("COMMON.VALIDATION_ERROR.VALUE_ALREADY_EXISTS");e.editingMode?o[i]=e.id:o.push(e.id),r.currentWidget.setProperties({restaurants:o}),t.close(e)}}})},r.deleteItem=function(e){r.currentWidget.properties.restaurants.splice(e,1)}}function a(){this.properties={spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""},visible_on:"mobile-v",restaurants:[],type:"standard",lang:"en-US"},r.apply(this,arguments)}n.$inject=["$scope"],((a.prototype=Object.create(r.prototype)).constructor=a).prototype._transformToMacros=!0,a.prototype.name="integrations.opentable",a.prototype.label="WIDGET.INTEGRATIONS.OPENTABLE.NAME",a.prototype.controller=n,a.prototype._apiVersion=2,a.prototype._templateViewURL="@websiteWidgets/integrations/views/opentable_properties.tpl.html",a.prototype._dragImagePath="@websiteWidgets/integrations/icons/opentable/drag.png",a.prototype._template={engine:"nunjucks",path:"@websiteWidgets/integrations/templates/opentable.twig.html"},a.prototype.exportForFuture=function(){return null},a.prototype.isCopyable=function(){return!0},t.addWidget({name:a.prototype.name,label:a.prototype.label,category:"integrations",order:10,enabled:i.isEnabled("theme_widget_integrations_opentable"),allowed:function(){return!0},icons:{small:"icon icon-integrations-opentable",medium:"icon icon-integrations-opentable",large:"icon icon-integrations-opentable"}}),e.set(a.prototype.name,a)}]),angular.module("application.widget.mail_chimp",["application.core"]).config(["core.library.editor.PresetsServiceProvider",function(e){e.addWidget({name:"mail_chimp",base:"contact_form"})}]).run(["coreLibraryWidget","core.library.editor.WidgetsService","$translate",function(e,t,o){var i=e.get("AbstractWidgetClass"),l="",c=!1,p=[{id:"",name:"None"}];function d(){return{fields:{email:{placeholder:o.instant("WIDGET.MAIL_CHIMP.FIELD_EMAIL_PLACEHOLDER_VALUE")},name:{placeholder:o.instant("WIDGET.MAIL_CHIMP.FIELD_NAME_PLACEHOLDER_VALUE")},surname:{placeholder:o.instant("WIDGET.MAIL_CHIMP.FIELD_SURNAME_PLACEHOLDER_VALUE")},checkbox:{label:o.instant("WIDGET.MAIL_CHIMP.FIELD_AGREEMENT_LABEL_VALUE")}},buttons:{submit:{label:o.instant("WIDGET.MAIL_CHIMP.FORM_SUBSCRIBE_BUTTON_VALUE")}},messages:{success:o.instant("WIDGET.MAIL_CHIMP.FORM_SUBSCRIBE_SUCCESS_MESSAGE_VALUE"),error:o.instant("WIDGET.MAIL_CHIMP.FORM_SUBSCRIBE_ERROR_MESSAGE_VALUE"),alreadySubscribed:o.instant("WIDGET.MAIL_CHIMP.FORM_USER_ALREADY_SUBSCRIBED_MESSAGE_VALUE"),required:o.instant("WIDGET.COMMON.FORM_VALIDATION_REQUIRED_VALUE"),invalidEmail:o.instant("WIDGET.COMMON.FORM_VALIDATION_EMAIL_VALUE")}}}function r(n,e,t,i){var r=null,o=!1;function a(){var e,t=n.lists.length;if(n.currentWidget.properties.listId&&!o){for(e=1;e<t;e++)n.currentWidget.properties.listId==n.lists[e].id&&(o=!0);o||(n.currentWidget.properties.listId=n.lists[0].id)}}function s(e){p.splice(1,n.lists.length),e&&e.forEach(function(e){p.push({id:e.id,name:e.name})}),n.lists=p,n.isLoad||a()}n.apiKey=l,n.lists=p,n.isLoad=c,n.defaultTranslates=d(),n.connectAccount=function(){t("@websiteWidgets/mail_chimp/admin/views/edit_item.tpl.html",function(t,o){t.apiKey=n.apiKey,t.ok=function(){t.editMailChimpKey&&!t.editMailChimpKey.validate()||(t.apiKey=t.apiKey.trim(),t.apiKey!==l?((r=e.createBatch()).add(i.setOptions,{apikey:t.apiKey}).success(function(e){e&&e.apikey&&(n.apiKey=l=e.apikey,n.currentWidget.properties.listId=n.lists[0].id)}),r.add(i.getList).success(s),r.doRequest().success(function(e){(function(e,t){var o,i=!1,r=e.length;for(o=0;o<r;o++)if(e[o].error){i=!0;break}return i&&(t=t||{},n.systemMessenger.error("WIDGET.MAIL_CHIMP.API_KEY_INVALID_ERROR_MESSAGE",t)),i})(e,{apiKey:t.apiKey})||o.close(t)})):o.close(t))},t.cancel=function(){o.close(t)}})},l||c||((r=e.createBatch()).add(i.getOptions).success(function(e){e&&e.apikey&&(n.apiKey=l=e.apikey)}),r.add(i.getList).success(s),r.doRequest().success(function(){n.isLoad=c=!0}).error(function(){n.isLoad=c=!0})),n.isLoad&&a()}function n(){this.properties={preset:"default",listId:"",animation:"",align:{desktop:"",tablet:"","mobile-v":"","mobile-h":""},visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},fields:{email:{enabled:!0,required:!0,type:"email"},name:{enabled:!0,required:!1,type:"text"},surname:{enabled:!0,required:!1,type:"text"},checkbox:{enabled:!1,required:!0,type:"checkbox",labelType:"text",text_style:"moto-text_normal"}},messages:{},buttons:{submit:{preset:"default",size:"medium",align:"left"}},postAction:{action:"none",properties:{id:"",target:"_self"}},subscriptionConfirmation:!1,resetAfterSubmission:!1},this.properties=$.extend(!0,d(),this.properties),i.apply(this,arguments)}r.$inject=["$scope","jsonrpc","coreLibraryModal","application.widget.MailChimpService"],((n.prototype=Object.create(i.prototype)).constructor=n).prototype._transformToMacros=!0,n.prototype.name="mail_chimp",n.prototype.label="WIDGET.MAIL_CHIMP.NAME",n.prototype.controller=r,n.prototype._apiVersion=2,n.prototype._dragImagePath="@websiteWidgets/mail_chimp/icons/drag.png",n.prototype._template={engine:"nunjucks",path:"@websiteWidgets/mail_chimp/templates/default.twig.html"},n.prototype.isCopyable=function(){return!0},t.addWidget({name:n.prototype.name,label:n.prototype.label,category:"more",order:30,enabled:!0,allowed:function(){return!0},icons:{small:"icon icon-mail_chimp",medium:"",large:"icon icon-mail_chimp"}}),e.set(n.prototype.name,n)}]),angular.module("application.widget.mail_chimp").service("application.widget.MailChimpService",["jsonrpc",function(e){var t=e.newService("Widget.MailChimp");this.getOptions=t.createMethod("getOptions"),this.setOptions=t.createMethod("setOptions"),this.getList=t.createMethod("getList")}]),angular.module("application.widget.map",["application.core"]).config(["core.library.editor.PresetsServiceProvider","motoFeaturesProvider",function(e,t){e.addWidget({name:"map",label:"WIDGET.MAP.NAME",category:"more",order:10,enabled:t.isEnabled("theme_presets_map"),icons:{small:"icon icon-map",medium:"",large:"icon icon-map"}})}]).run(["coreLibraryWidget","core.library.editor.WidgetsService",function(e,t){var o=e.get("AbstractWidgetClass");function i(){this.properties={preset:"default",height:"200",animation:"",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},api:{url:"//maps.google.com/maps?",geoLoc:"New York, USA",zoom:"10"}},o.apply(this,arguments)}((i.prototype=Object.create(o.prototype)).constructor=i).prototype.name="map",i.prototype.label="WIDGET.MAP.NAME",i.prototype._apiVersion=2,i.prototype._transformToMacros=!0,i.prototype._dragImagePath="@websiteWidgets/map/icons/drag.png",i.prototype._template={engine:"nunjucks",path:"@websiteWidgets/map/templates/default.twig.html"},i.prototype.isCopyable=function(){return!0},i.prototype.initialize=function(){var e=this._$dom.find(".moto-widget-map-frame");e.removeAttr("frameborder"),this._propertiesLoaded||(this._$dom.attr("data-animation")&&(this.properties.animation=this._$dom.attr("data-animation")),e.data("address")&&(this.properties.api.geoLoc=e.data("address"),this.properties.api.zoom=e.data("zoom"),this.properties.height=e.height())),o.prototype.initialize.call(this)},i.prototype.getApiSrc=function(){return this.properties.api.url+"q="+this.properties.api.geoLoc+"&z="+this.properties.api.zoom+"&t=m&output=embed"},i.prototype.shouldUpdateContentView=function(e){return e.api&&!angular.equals(this.properties.api,e.api)},i.prototype.manualUpdateContentView=function(e){this.properties.height!==e.height&&this._$dom.find(".moto-widget-map-frame").attr("height",this.properties.height)},e.set("map",i),t.addWidget({name:i.prototype.name,label:i.prototype.label,category:"more",order:10,enabled:!0,allowed:function(){return!0},icons:{small:"icon icon-map",medium:"",large:"icon icon-map"}})}]),angular.module("application.widget.menu",["application.widget.abstract"]).run(["$translate","$injector","core.library.editor.WidgetsService","coreLibraryWidget","coreLibraryModal","core.library.editor.PresetsService","motoFeatures",function(r,n,e,t,o,i,a){var s=t.get("AbstractWidgetClass");function l(e){e.currentWidget.updateMenuDataAndRenderPreview()}function c(e){this.properties={id:1,preset:"default",align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""},spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"}},e.extraOptions&&e.extraOptions.currentItems&&(this.items=e.extraOptions.currentItems),s.apply(this,arguments)}l.$inject=["$scope"],((c.prototype=Object.create(s.prototype)).constructor=c).prototype.name="menu",c.prototype.label="WIDGET.MENU.NAME",c.prototype.controller=l,c.prototype._transformToMacros=!0,c.prototype._apiVersion=2,c.prototype._dragImagePath="@websiteWidgets/menu/icons/drag.png",c.prototype._template={engine:"nunjucks",path:"@websiteWidgets/menu/templates/default.twig.html"},c.prototype.items=null,c.prototype.systemMenus=[],c.prototype._loadingMenuItems=!1,c.prototype.isCopyable=function(){return!0},c.prototype.getSystemMenuList=function(){return this.systemMenus},c.prototype.printLoadItemsFlag=function(){return" data-load-items"},c.prototype.updateMenuDataAndRenderPreview=function(){var e,t,o=!1,i=this;if(!this._loadingMenuItems)if(this._loadingMenuItems=!0,t=n.get("application.menus.services.MenusModel"),c.prototype.systemMenus=t.objects(),!t.loading&&this.systemMenus.length){for(this._loadingMenuItems=!1,e=0;e<this.systemMenus.length;e++)this.systemMenus[e].id==this.properties.id&&(o=!0,this.systemMenus[e].tree(function(e){i.items=e,i.renderPreview()},"publish"));o||(this.items=[],this.properties.id=0,this.renderPreview()),this.systemMenus.unshift({id:0,name:r.instant("WIDGET.MENU.NOT_SELECTED_MENU_LABEL")})}else t.success(function(){i._loadingMenuItems=!1,i.updateMenuDataAndRenderPreview()})},c.prototype.showMenuPopup=function(){var t=this;o("views/application/menus/popup/popup.tpl.html",function(e){e.activeCurrentWidget=t.properties.id},null,"menu-popup").result.finally(function(){t.updateMenuDataAndRenderPreview()})},c.prototype.initialize=function(){this._$dom.is("[data-load-items]")&&this.updateMenuDataAndRenderPreview(),s.prototype.initialize.call(this)},c.prototype.create=function(){this._$dom.is("[data-load-items]")&&this.updateMenuDataAndRenderPreview(),s.prototype.create.call(this)},c.prototype.onDoubleClickEvent=function(e){this.showMenuPopup()},c.prototype.shouldUpdateContentView=function(e){return!!angular.isDefined(e.id)&&e.id===this.properties.id},c.prototype.manualUpdateContentView=function(){this.updateMenuDataAndRenderPreview()},t.set(c.prototype.name,c),e.addWidget({name:c.prototype.name,label:c.prototype.label,category:"basic",order:30,enabled:!0,icons:{small:"icon icon-menu",medium:"",large:"icon icon-menu"}}),i.addWidget({name:"menu",label:"WIDGET.MENU.NAME",category:"basic",order:60,enabled:a.isEnabled("theme_presets_menu"),icons:{small:"icon icon-menu",medium:"icon icon-menu-medium",large:"icon icon-menu"}})}]),angular.module("application.widget.pagination",["application.widget.abstract"]).run(["core.library.editor.PresetsService","motoFeatures",function(e,t){e.addWidget({name:"pagination",label:"WIDGET.PAGINATION.NAME",category:"basic",order:70,enabled:t.isEnabled("theme_content_blog"),checkPresetControls:!1,icons:{small:"icon icon-pagination",medium:"icon-pagination-medium",large:"icon icon-pagination"}})}]),angular.module("application.widget.pagination").controller("application.widget.pagination.DesignPresetController",["$scope","$rootScope",function(i,e){var t=e.$on("Design.WidgetPreset.Changed",function(e,t){var o;t.oldValue.properties.pagination.desktop.base["font-size"]!=t.newValue.properties.pagination.desktop.base["font-size"]&&(o=Math.round(2.22*t.newValue.properties.pagination.desktop.base["font-size"].slice(0,-2))+"px",i.preset.properties.item_link.desktop.base.width=o,i.preset.properties.item_link.desktop.base.height=o)});i.$on("$destroy",function(){t()})}]),angular.module("application.widget.paypal_button",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","application.media_library.services.MediaLibraryService","motoFeatures",function(e,t,i,o){var r=e.get("AbstractWidgetClass"),n=!1;function a(e){e.localeList=[{key:"en_US",value:"United States"},{key:"en_AU",value:"Australia"},{key:"en_GB",value:"United Kingdom"},{key:"fr_CA",value:"French (Canadian)"},{key:"es_ES",value:"Spanish"},{key:"it_IT",value:"Italian"},{key:"fr_FR",value:"French"},{key:"de_DE",value:"German"},{key:"pt_BR",value:"Portuguese (Brazilian)"},{key:"zh_CN",value:"Chinese (Simplified)"},{key:"da_DK",value:"Danish"},{key:"zh_HK",value:"Chinese (Hongkong)"},{key:"id_ID",value:"Indonesian"},{key:"he_IL",value:"Hebrew"},{key:"ja_JP",value:"Japanese"},{key:"nl_NL",value:"Dutch"},{key:"no_NO",value:"Norway"},{key:"pl_PL",value:"Polish"},{key:"pt_PT",value:"Portuguese"},{key:"ru_RU",value:"Russian"},{key:"sv_SE",value:"Swedish"},{key:"th_TH",value:"Thai"},{key:"zh_TW",value:"Chinese (Taiwan)"}],e.currencyList=["AUD","BRL","CAD","CZK","DKK","EUR","HKD","HUF","ILS","JPY","MYR","MXN","NOK","NZD","PHP","PLN","GBP","RUB","SGD","SEK","CHF","TWD","THB","USD"],e.clearImage=function(e){e.setProperties({customImageData:{id:"0",src:"",thumbnail:""}})},e.changeImage=e.currentWidget.changeImage}function s(){this.properties={preset:"default",animation:"",align:{desktop:"",tablet:"","mobile-v":"","mobile-h":""},visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},buttonConfig:{linkTarget:"_blank",businessID:"",itemName:"",itemID:"",currency:"USD",locale:"en_US",displayType:"paypal",style:"default",payPalButtonType:"buynow",buynow:{amount:"",shippingRate:"",taxAmount:"",text:"buynow"},donate:{contributionAmountType:"own",contributionAmount:""}},customImageData:{id:null,src:"",alt:"",title:"",thumbnail:""},themeButtonData:{label:"Buy Now",preset:"default",size:"medium"}},r.apply(this,arguments)}a.$inject=["$scope"],((s.prototype=Object.create(r.prototype)).constructor=s).prototype._transformToMacros=!0,s.prototype.name="paypal_button",s.prototype.label="WIDGET.PAYPAL_BUTTON.NAME",s.prototype.controller=a,s.prototype._apiVersion=2,s.prototype._dragImagePath="@websiteWidgets/paypal_button/icons/drag.png",s.prototype._template={engine:"nunjucks",path:"@websiteWidgets/paypal_button/templates/default.twig.html"},s.prototype.isCopyable=function(){return!0},s.prototype.getImageUrl=function(){var e="https://www.paypalobjects.com/";return e+=this.properties.buttonConfig.locale,e+="/i/btn/btn_","buynow"===this.properties.buttonConfig.payPalButtonType?e+=this.properties.buttonConfig.buynow.text:e+=this.properties.buttonConfig.payPalButtonType,"default"===this.properties.buttonConfig.style?e+="CC_LG":"small"===this.properties.buttonConfig.style?e+="_SM":e+="_LG",e+=".gif"},s.prototype.setImage=function(e,t){var o={};t&&e.thumbnails.hasOwnProperty(t)?(o.src=e.getThumbnailPath(t),o.thumbnail=t):(o.src=e.path,o.thumbnail=""),this.properties.customImageData.id!==e.id&&(o.id=e.id,o.alt=e.alt,o.title=e.title),this.setProperties({customImageData:o})},s.prototype.changeImage=function(){var o=this;n||(i.open({value:this.properties.customImageData.src,id:this.properties.customImageData.id,filters:["image"],thumbnails:!0,size:this.properties.customImageData.thumbnail,onApply:function(e,t){o.setImage(e,t)}}),n=!0,setTimeout(function(){n=!1},250))},t.addWidget({name:s.prototype.name,label:s.prototype.label,category:"more",order:60,enabled:o.isEnabled("theme_widget_paypal_button"),allowed:function(){return!0},icons:{small:"icon icon-paypal_button",medium:"icon icon-paypal_button",large:"icon icon-paypal_button"}}),e.set(s.prototype.name,s)}]),function(){function a(e){return!!angular.isString(e)&&(e=e.trim(),/^(http[s]?:)?\/\/((www\.)?([a-z]{2,3}\.)?pinterest\.com\/)((?!\bpin\b).+)\/(.+)$/i.test(e))}angular.module("application.widget.pinterest",["application.widget.abstract","core.library.scriptsInjector"]).config(["coreLibraryValidationProvider",function(i){i.setValidator("pin_board_url",function(e){var t={isValid:!1,key:i.getErrorMessage("URL_INVALID","incorrectURL"),args:{}},o={isValid:!0,key:"",args:{}};return null===e?o:a(e)||0===e.length?o:t})}]).run(["$rootScope","coreLibraryWidget","core.library.editor.WidgetsService","ScriptsInjector",function(o,e,t,i){var r=e.get("AbstractWidgetClass");function n(){this.properties={url:"",lang:"",img_width:92,board_height:600,visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""}},r.apply(this,arguments)}o.$on("NEW EVENT: MotoEditor.config:after",function(e,t){t.getGlobal("window").showPinterestBoardError=function(){o.systemMessenger.error("WIDGET.PINTEREST.BOARD_LOAD_ERROR_MESSAGE")}}),((n.prototype=Object.create(r.prototype)).constructor=n).prototype.name="pinterest",n.prototype.label="WIDGET.PINTEREST.NAME",n.prototype._apiVersion=2,n.prototype._transformToMacros=!0,n.prototype._dragImagePath="@websiteWidgets/pinterest/icons/drag.png",n.prototype._template={engine:"nunjucks",path:"@websiteWidgets/pinterest/templates/default.twig.html"},n.prototype.isCopyable=function(){return!0},n.prototype.shouldUpdateContentView=function(e){var t;for(t in e)if(e[t]!==this.properties[t]){if("spacing"===t||"align"===t)continue;return!0}return!1},n.prototype.postRenderPreview=function(){var e;r.prototype.postRenderPreview.apply(this,arguments);try{if(!this._windowContext.rebuildPinterestBoard||!a(this.properties.url))return;if(!(e=this.$('div > a[data-pin-do="embedBoard"]',this._$dom)).length||e.data("inProgress"))return;e.data("inProgress",!0),this._windowContext.rebuildPinterestBoard(this._dom)}catch(e){}},n.prototype.getBoardUrl=function(){return a(this.properties.url)?this.properties.url:""},n.prototype.loadPropertiesFromAttribute=function(){var e;try{e=angular.fromJson(this._$dom.attr("moto-properties")),angular.isObject(e)&&(this.properties=$.extend(!0,this.properties,e))}catch(e){}},n.prototype.initialize=function(){this._propertiesLoaded||this.loadPropertiesFromAttribute(),this.initializeSDK(),r.prototype.initialize.call(this)},n.prototype.create=function(){this.initializeSDK(),r.prototype.create.call(this)},n.prototype.initializeSDK=function(){this._Environment.getLivePreviewService().ScriptsInjector.inject("pinterest").then(function(){this.postRenderPreview()}.bind(this))},i.addScript("pinterest",function(){return $("<script><\/script>").attr("id","pinterest-jssdk").attr("src","//assets.pinterest.com/js/pinit.js").attr("async","").attr("defer","").attr("data-pin-build","rebuildPinterestBoard").attr("data-pin-error","showPinterestBoardError")}),e.set("pinterest",n),t.addWidget({name:n.prototype.name,label:n.prototype.label,category:"social",order:40,enabled:!0,icons:{small:"icon icon-pinterest",medium:"",large:"icon icon-pinterest"}})}])}(),angular.module("application.widget.row.resizer").service("MotoWidgetRowResizer",[function(){var p,d,u,g,a,i,s,r,m;function o(){g&&g.hide()}function n(e){var t,o=d._$dom.find(">.container-fluid>.row"),i=o.children(".moto-cell")[p+1],r=e.clientX-o.offset().left,n=s-r;for(e.preventDefault(),e.stopPropagation();Math.abs(n)>=a-.1*a;)t=n<0?"right":"left",d.resizeColumn(p,"left"===t?-1:1),"right"===t?n+=a:n-=a;s=$(i).offset().left-o.offset().left}function l(e){var t=r-d.children[p].properties.size;e.preventDefault(),e.stopPropagation(),i.off("mouseup",l),m._$body.off("mouseup",l),d._$dom.off("mousemove",n),d._$dom.children(".moto-widget-row__resizer-cover").remove(),g.css("display","block"),o(),u=!0,t&&m.HistoryManager.addAction("rowColumnsResized",{id:d.getId(),columnIndex:p,deltaSize:t}),m.HistoryManager.endActionsTransaction("RowColumnsResized"),m.HistoryManager.unlockAction("setProperties"),s=r=null}function t(e){var t,o;e.preventDefault(),e.stopPropagation(),i.on("mouseup",l),m._$body.on("mouseup",l),d._$dom.on("mousemove",n),d._$dom.append('<div class="moto-widget-row__resizer-cover"></div>'),d.select(),d.$(".cke_focus,*:focus").blur(),u=!1,o=(t=d._$dom.find(">.container-fluid>.row")).children(".moto-cell")[p+1],s=d.$(o).offset().left-t.offset().left,a=d._$dom.find(">.container-fluid").outerWidth()/12,g.css("display","none"),m.HistoryManager.lockAction("setProperties"),m.HistoryManager.startActionsTransaction("RowColumnsResized"),r=d.children[p].properties.size}this.showResizer=function(e,t){var o,i,r,n,a,s,l,c;if(t&&m&&!m.isDeviceAMobile()){if(i=t.$(e.target),!u||!g||!i.hasClass("moto-cell")||t._$dom.hasClass("row-even-columns"))return;if(r=m.getWidgetByDom(i[0]),n=t.children.indexOf(r),(c=e.originalEvent.offsetX||e.originalEvent.layerX)<=(o=m.getElementCharacteristics(r._$dom)).width/2?a="left":c>o.width/2&&(a="right"),"left"===a&&n<1||"right"===a&&n>t.children.length-2)return;"left"===a?(l=o.left-g.width()/2,p=n-1):"right"===a&&(s=parseInt(i.css("padding-right").replace("px","")),l=o.left+o.width-g.width()/2+2*s,p=n),d=t,g.css("top",Math.round(o.top)+"px").css("left",l+"px").height(t._$dom.height()).show()}},this.hideResizer=o,this.initializeResizer=function(e){g||(m=e,(g=$('<div class="moto-widget-row__resizer"></div>')).on("mousedown",t),m._$body.append(g),u=!0,i=$("body"))},this.destroyResizer=function(){g&&(o(),g.off("mousedown",t),i=a=s=d=g=u=null)}}]),angular.module("application.widget.row_column",["application.widget.abstract_container"]).run(["$rootScope","coreLibraryWidget","coreLibraryWidgetTraits","application.media_library.services.MediaLibraryService","core.library.editor.WidgetsService",function(e,t,o,i,r){var n=t.get("AbstractContainerWidgetClass");function a(o){o.clearImage=function(){delete o.currentWidget.properties.styles["background-image"],delete o.currentWidget.properties.styles["background-size"],delete o.currentWidget.properties.styles["background-position"],delete o.currentWidget.properties.styles["background-repeat"]},o.changeImage=function(){i.open({value:o.currentWidget.properties.styles["background-image"],thumbnails:!0,filters:["image"],onApply:function(e,t){e&&(o.currentWidget.properties.styles["background-image"]=t?e.getThumbnailPath(t):e.path,o.currentWidget.properties.styles["background-size"]||(o.currentWidget.properties.styles["background-size"]="auto"),o.currentWidget.properties.styles["background-position"]||(o.currentWidget.properties.styles["background-position"]="left top"),o.currentWidget.properties.styles["background-repeat"]||(o.currentWidget.properties.styles["background-repeat"]="no-repeat"))}})}}function s(){this.properties=this.getDefaultProperties(),n.apply(this,arguments)}e.$on("NEW EVENT: MotoEditor.config:after",function(e,t){var l,c;l=t.getEditor(),c=l.getHelpers(),l.getHelpers().addInsertPositions({name:["cell-left","cell-right"],getRenderOptions:function(e,t){var o,i,r,n,a,s;if("row.column"===e.name)return a=e._parent,i=parseInt(a._$dom.children(".container-fluid").css("margin-left").slice(0,-2)),o=l.getElementCharacteristics(a._$dom),r=l.getElementCharacteristics(e._$dom),"cell-left"===t&&(s=e._$dom.prev().length?r.left-c.MEDIUM_INSERT_HELPER_SIZE/2:o.left+i),"cell-right"===t&&(s=(n=e._$dom.next()).length?n.offset().left-c.MEDIUM_INSERT_HELPER_SIZE/2:o.left+o.width-i-c.MEDIUM_INSERT_HELPER_SIZE),{width:c.MEDIUM_INSERT_HELPER_SIZE,height:r.height,top:r.top,left:s}}}),l.addInterceptor(l.INTERCEPTOR__DRAG_OVER_TARGET_WIDGET,function(e,t,o){var i,r;return"row.column"===t.name&&"row.column"!==o.droppedWidgetOptions.widgetName&&(r=t._$dom.outerHeight(),i=l.Utils.getContainerEdgeHeight(t),(o.eventPositions.targetWidgetOffsetY<=i||o.eventPositions.targetWidgetOffsetY>=r-i)&&(t=t._parent)),t}),l.addInterceptor(l.INTERCEPTOR__DRAG_OVER_POSITION,function(e,t,o){return!("row.column"===o.droppedWidgetOptions.widgetName&&["cell-left","cell-right"].indexOf(t)<0)&&t}),l.addInterceptor(l.INTERCEPTOR__INSERT_OR_MOVE_WIDGET_OPTIONS,function(e,t){var o;return"row.column"===t.droppedWidgetOptions.widgetName&&(t.needToSelect=!1,"row.column"!==t.targetWidget.name||"cell-left"!==t.position&&"cell-right"!==t.position||(o=t.targetWidget.getLocationInEditor().indexInContainer,t.targetConfig.indexInContainer="cell-left"===t.position?o:o+1,t.targetWidget=t.targetWidget._parent,t.parentWidget=t.targetWidget,delete t.position)),t}),l.HelperSelected.registerTemplate("row.column",{render:function(){return'<div class="moto-editor-helper moto-editor-helper_selected moto-editor-widget-row__column-helper moto-visible-on_tablet" draggable="true"><div class="moto-editor-outline"></div><div class="moto-editor-label"><span class="moto-editor_draggable moto-editor-drag-icon" draggable="true"></span><span class="moto-editor_remove-closest-widget moto-editor-label-button_widget-remove"></span></div></div>'}}),l.HelperHover.registerTemplate("row.column",{render:function(e){var t=e.widget._parent.children.length<6,o=t?90:66,i=e.widget._$dom.width()>=o;return'<div class="moto-editor-helper moto-editor-helper_hover moto-editor-widget-row__column-helper moto-visible-on_tablet" draggable="true"><div class="moto-editor-label">'+(i?'<span class="moto-editor_draggable moto-editor-drag-icon" draggable="true"></span>':"")+'<span class="moto-editor-icon_edit" onclick="MotoEditor.selectWidget(\''+e.widget.getId()+"', true)\"></span>"+(t&&i?'<span class="moto-editor_duplicate-closest-widget moto-editor-label-button_widget-duplicate"></span>':"")+(i?'<span class="moto-editor_remove-closest-widget moto-editor-label-button_widget-remove"></span>':"")+"</div></div>"}})}),a.$inject=["$scope"],(s.prototype=Object.create(n.prototype)).constructor=s,o.useTrait("WidgetBackground",s),s.prototype.__backgroundTraitVideoAllowed=!0,s.prototype.allow=["row"],s.prototype._apiVersion=2,s.prototype.name="row.column",s.prototype.label="WIDGET.ROW_COLUMN.NAME",s.prototype.controller=a,s.prototype._templateViewURL="@websiteWidgets/row/views/column_properties.tpl.html",s.prototype._dragImagePath="@websiteWidgets/row/icons/drag-column.png",s.prototype._template={engine:"nunjucks",path:"@websiteWidgets/row/templates/column.twig.html"},s.prototype.getDefaultProperties=function(){return{size:12,styles:{"background-color":""},bgPosition:"left top",bgVideo:{loop:!0,preload:"metadata",track:{webm:null,mp4:null}},spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"}}},s.prototype._allowedDragMethods=["cell-left","cell-right",{rule:"default",result:"append"}],s.prototype.getHelperInsertPosition=function(e){var t,o,i,r,n=this._Editor.isDeviceATablet()||this._Editor.isDeviceADesktop(),a=this._parent;if(!((a.children.length<6||e.droppedWidgetOptions.widget&&a===e.droppedWidgetOptions.widget._parent)&&n))return"append";if(e.droppedWidgetOptions.widgetName===this.name)return r=this._$dom.outerWidth(),e.eventPositions.targetWidgetOffsetX<=r/2?"cell-left":"cell-right";if(this._$targetDomElement.hasClass("moto-cell")){if(t=this._Editor.getElementCharacteristics(this._$targetDomElement),i=10<(o=parseInt(this._$targetDomElement.css("padding-left").slice(0,-2)))?o:10,e.eventPositions.clientX<t.left+i)return"cell-left";if(e.eventPositions.clientX>t.left+2*o+t.width-i)return"cell-right"}return"append"},s.prototype.propertiesWereChanged=function(){var e=angular.copy(this.properties);return delete e.__backgroundTraitColorEnabled,delete e.__backgroundTraitImageEnabled,delete e.__backgroundTraitVideoEnabled,delete e.styles["background-position"],delete e.bgVideo.position,!angular.equals(e,this.getDefaultProperties())},s.prototype.getTargetDataForPaste=function(){var e=this.getPositionInContent();return e.positionIndex=this.children.length,{targetWidget:this,widgetPosition:e}},s.prototype.isDraggable=function(e){var t;return!(!e||!e.target)&&(t=this._Editor.Utils.getClosestWidgetElementForDrag(e.target),this._dom===t)},s.prototype.isCopyable=function(){return!this.isSelected()},s.prototype.isVisibleInNesting=function(){return!1},s.prototype.getWidgetForHelper=function(e){return this.isSelected()?this:this._parent.getWidgetForHelper(e)},s.prototype.initialize=function(){this._propertiesLoaded||this.loadPropertiesFromDom(),this._updateBackgroundView(),n.prototype.initialize.apply(this,arguments)},s.prototype.loadPropertiesFromDom=function(){this.properties.size=parseInt(this._dom.className.match(/col-..-(\d{1,2})/)[1]),this._loadBackgroundColorFromDom(),this._loadBackgroundImageFromDom(),this._loadBackgroundVideoFromDom()},s.prototype.setSize=function(e){this.setProperties({size:e})},s.prototype.setGridType=function(e){this._dom.className=this._dom.className.replace(/col-(xs|sm)/g,"col-"+e)},s.prototype.getSize=function(){return this.properties.size},s.prototype.updateEmptyClass=function(){this._parent.updateEmptyClass()},s.prototype.getCssClasses=function(){var e,t="";return t+="col-"+this._parent.getGridType()+"-"+this.getSize(),this.properties.styles["background-color"]&&(e=this.getColorizerModel().getClassNameByColorName(this.properties.styles["background-color"],"moto-bg-color"))&&(t+=" "+e),t+=" "+this.getSpacing("classes")},s.prototype.manualUpdateContentView=function(){this._dom.className=this._dom.className.replace(/col-(..)-\d{1,2}/,"col-$1-"+this.properties.size),this._updateBackgroundView()},s.prototype._updateBackgroundView=function(){this._updateBackgroundColorInDom(),this._updateBackgroundImageInDom(),this._updateBackgroundVideoInDom(this.properties.bgVideo)},s.prototype.create=function(){this.__backgroundTraitMigrateStrucure(),n.prototype.create.call(this),this._updateBackgroundView()},s.prototype.transform=function(){this._transformBackgroundImage(),this._transformBackgroundVideo(),n.prototype.transform.call(this)},s.prototype.getCustomAttributes=function(){var e={};return this.properties.styles["background-image"]&&(e["data-bg-image"]=this.properties.styles["background-image"]),e},s.prototype.getStylesValue=function(){return angular.copy(this.properties.styles)},s.prototype.onRemoveChildEvent=function(e,t){n.prototype.onRemoveChildEvent.apply(this,arguments),this._parent.triggerEvent("removeChild",t)},s.prototype.onMovedEvent=function(){this.setGridType(this._parent.properties.grid)},s.prototype.exportForFuture=function(){var e=n.prototype.exportForFuture.call(this);return delete e.properties.spacing.left,delete e.properties.spacing.right,e},t.set(s.prototype.name,s),r.addWidget({name:s.prototype.name,category:"structure",enabled:!1,allowed:function(){return!0}})}]),angular.module("application.widget.row",["application.widget.abstract_container","core.library.messenger","application.design","application.widget.row_column","application.widget.row.resizer"]).run(["core.library.editor.WidgetsService","coreLibraryWidget","$translate","coreLibraryUtils","coreLibraryMessenger","application.media_library.services.MediaLibraryService","$q","coreLibraryWidgetTraits",function(e,a,s,l,c,t,r,o){var i,p=a.get("AbstractContainerWidgetClass");function n(o){o.unsetFixedAndParallaxedProperties=function(){o.currentWidget.properties.bgFixed=!1,o.currentWidget.properties.bgParallaxed=!1},o.clearImage=function(){delete o.currentWidget.properties.styles["background-image"],delete o.currentWidget.properties.styles["background-size"],delete o.currentWidget.properties.styles["background-position"],delete o.currentWidget.properties.styles["background-repeat"],o.unsetFixedAndParallaxedProperties()},o.changeImage=function(){t.open({value:o.currentWidget.properties.styles["background-image"],thumbnails:!0,filters:["image"],onApply:function(e,t){e&&(o.currentWidget.properties.styles["background-image"]=t?e.getThumbnailPath(t):e.path,o.currentWidget.properties.styles["background-size"]||(o.currentWidget.properties.styles["background-size"]="auto"),o.currentWidget.properties.styles["background-position"]||(o.currentWidget.properties.styles["background-position"]="left top"),o.currentWidget.properties.styles["background-repeat"]||(o.currentWidget.properties.styles["background-repeat"]="no-repeat"))}})}}function d(){this.properties=this.getDefaultProperties(),p.apply(this,arguments)}n.$inject=["$scope"],(d.prototype=Object.create(p.prototype)).constructor=d,o.useTrait("WidgetBackground",d),d.prototype.__backgroundTraitVideoAllowed=!0,d.prototype.name="row",d.prototype.label="WIDGET.ROW.NAME",d.prototype.controller=n,d.prototype._apiVersion=2,d.prototype._dragImagePath="@websiteWidgets/row/icons/drag.png",d.prototype._template={engine:"nunjucks",path:"@websiteWidgets/row/templates/default.twig.html"},d.prototype.getDefaultProperties=function(){return{styles:{"background-color":""},bgFixed:!1,bgParallaxed:!1,bgPosition:"left top",bgVideo:{loop:!0,preload:"metadata",track:{webm:null,mp4:null}},fixed:!1,gutter:!0,evenColumns:!1,justify:!1,grid:"sm",anchor:"",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"}}},d.prototype.isCopyable=function(){return!0},d.prototype.getTargetDataForPaste=function(e){var t,o=this.getPositionInContent();return a.isContainers(e.name)?(t=this._parent,o.positionIndex++):(t=this.children[0],o.positionIndex=t.children.length),{targetWidget:t,widgetPosition:o}},d.prototype.isParentASection=function(){return this._parent?"section"===this._parent.name:null},d.prototype.isFixable=function(){return!(this._$dom&&this._$dom.parents(".moto-widget-row,.row-fixed,.moto-disabling_row-fixed").length)},d.prototype.isEmpty=function(){var e;for(e=0;e<this.children.length;e++)if(!this.children[e].isEmpty())return!1;return!0},d.prototype.initialize=function(){var e;(e=this.getDomElementsWhereWidgetsCanBePlaced()).is("[data-container]")||e.attr("data-container","container"),this._propertiesLoaded||this.loadPropertiesFromDom(),this.updateEmptyClass(),this._updateBackgroundView(),p.prototype.initialize.call(this)},d.prototype.create=function(){(!this.isGutterSetAbove()||this.isGutterForcedByAnyParent()&&!this._Editor.isSilentMode(this))&&(this.properties.gutter=!1),this.__backgroundTraitMigrateStrucure(),p.prototype.create.call(this),this.manualUpdateContentView()},d.prototype.getCustomAttributes=function(){var e={};return this.properties.bgParallaxed&&(e["data-stellar-background-ratio"]="0.5"),this.properties.styles["background-image"]&&(e["data-bg-image"]=this.properties.styles["background-image"]),e},d.prototype.getStylesValue=function(){return angular.copy(this.properties.styles)},d.prototype.transform=function(){this._transformBackgroundImage(),this._transformBackgroundVideo(),p.prototype.transform.call(this)},d.prototype.loadPropertiesFromDom=function(){var e;this.properties.fixed=this._$dom.hasClass("row-fixed"),this.properties.grid=this._$dom.attr("data-grid-type")||"sm",this.properties.gutter=this.isGutterSetAbove()&&!this._$dom.hasClass("row-gutter-0"),this.properties.evenColumns=this._$dom.hasClass("row-even-columns"),this._$dom.hasClass("moto-justify-content_center")?this.properties.justify="center":this._$dom.hasClass("moto-justify-content_bottom")&&(this.properties.justify="bottom"),(e=this.getAnchorDomElement()).length&&(this.properties.anchor=e.attr("name"),this.clearUnnecessaryAnchors()),this._loadBackgroundColorFromDom(),this._loadBackgroundImageFromDom(),this._loadBackgroundParallaxedFromDom(),this._loadBackgroundFixedFromDom(),this._loadBackgroundVideoFromDom()},d.prototype.beforeInitialize=d.prototype._upgradeColumns=function(){this._$dom.find(".moto-cell").addClass("moto-widget moto-widget-row__column").attr("data-widget","row.column").attr("data-container","container")},d.prototype.beforeCreate=d.prototype._upgradeColumns,d.prototype._allowedDragMethods=[{rule:"top:edge",result:"before"},{rule:"bottom:edge",result:"after"}],d.prototype.getHelperInsertPosition=function(e){var t=this._$dom.outerHeight();return e.eventPositions.targetWidgetOffsetY<=t/2?"before":"after"},d.prototype.getTargetElement=function(e){return 0<=["before","after"].indexOf(e.position)&&(!e.targetConfig||angular.isUndefined(e.targetConfig.containerIndex))?this._$dom:p.prototype.getTargetElement.call(this,e)},d.prototype.getDomElementsWhereWidgetsCanBePlaced=function(){return this._$dom.find(">.container-fluid>.row")},d.prototype.getColumnSizes=function(){var e,t=[];for(e=0;e<this.children.length;e++)t.push(this.children[e].getSize());return t},d.prototype.setColumnSizes=function(t){var e,o=this,i=r.defer();for(function e(){t.length<o.children.length&&(o._Editor.destroyWidget(o.children[o.children.length-1]),e())}(),e=0;e<this.children.length;e++)this.children[e].setSize(t[e]);return function e(){t.length>o.children.length?o._Editor.ContentManager.insertOrMoveWidgetByOptions({droppedWidgetOptions:{isNew:!0,widgetName:"row.column",options:{properties:{size:t[o.children.length]}}},needToSelect:!1,targetConfig:{targetWidgetId:o.getWidgetId(),containerIndex:0,indexInContainer:o.children.length},callback:e}):i.resolve()}(),i.promise},d.prototype.userWantsToChangeColumnSizes=function(e){var t,o,i,r,n=this;function a(){n._changingColumnSizes=!0,n.setColumnSizes(e).then(function(){delete n._changingColumnSizes,n.postUpdateRowStructure(),n._Editor.HistoryManager.endActionsTransaction("ChangeColumnSizes")})}if(this._Editor.HistoryManager.startActionsTransaction("ChangeColumnSizes"),e.length<this.children.length){for(i in t=this.children.slice(e.length-this.children.length)){if(r=this._Editor.getUnremovableWidgetInside(t[i]))return void c.error("WIDGET.ROW.UNREMOVABLE_WIDGET_INSIDE_ROW_CELL_ERROR_MESSAGE",{widget_name:s.instant(r.label)});o||t[i].isEmpty()||(o=!0)}if(o)return void l.openConfirmationBox({yesHandler:a,question:"WIDGET.COMMON.REMOVE_WIDGET_CONFIRMATION"})}a()},d.prototype.getChildrenCount=function(){return this._changingColumnSizes||this._Editor.HistoryManager.isUndoOrRedoInProcess()?i:i=this.children.length},d.prototype.getGridType=function(){return this.properties.grid},d.prototype.setGridType=function(e){this.setProperties({grid:e})},d.prototype.isGutterSetAbove=function(){return!(this._$dom&&this._$dom.parents(".row-gutter-0").length)},d.prototype.isGutterForcedByAnyParent=function(){return!(!this._$dom||!this._$dom.parents(".set-row-gutter-0").length)},d.prototype.setGutterValueFromOutside=function(e){this.properties.gutter=e,this._$dom.removeClass("row-gutter-0")},d.prototype._updateBackgroundView=function(){this._updateBackgroundColorInDom(),this._updateBackgroundImageInDom(),this._updateBackgroundParallaxedInDom(),this._updateBackgroundFixedInDom(),this._updateBackgroundVideoInDom(this.properties.bgVideo)},d.prototype.manualUpdateContentView=function(e){e=e||{},this._updateBackgroundView(),this.isGutterSetAbove()&&!this.properties.gutter?this._$dom.addClass("row-gutter-0"):this._$dom.removeClass("row-gutter-0"),this.isFixable()&&this.properties.fixed?this._$dom.addClass("row-fixed"):this._$dom.removeClass("row-fixed"),this.properties.evenColumns?this._$dom.addClass("row-even-columns"):this._$dom.removeClass("row-even-columns"),this._$dom.removeClass("moto-justify-content_center moto-justify-content_bottom"),"center"!==this.properties.justify&&"bottom"!==this.properties.justify||this._$dom.addClass("moto-justify-content_"+this.properties.justify),angular.isDefined(e.gutter)&&this.properties.gutter!==e.gutter&&this._Editor.Widgets.getNestedWidgetsByDom(this._dom,{where:{name:"row"}}).forEach(function(e){e.setGutterValueFromOutside(this.properties.gutter)}.bind(this)),angular.isDefined(e.grid)&&this.properties.grid!==e.grid&&(this._$dom.attr("data-grid-type",this.properties.grid),this.children.forEach(function(e){e.setGridType(this.properties.grid)}.bind(this))),this.updateAnchorDomElement(),this.updateColumnHelpers(),(angular.isDefined(e.fixed)&&this.properties.fixed!==e.fixed||angular.isDefined(e.grid)&&this.properties.grid!==e.grid||angular.isDefined(e.gutter)&&this.properties.gutter!==e.gutter||angular.isDefined(e.evenColumns)&&this.properties.evenColumns!==e.evenColumns)&&this._Editor.getScope().$broadcast("Widget.WidthChangedByWidget",this)},d.prototype.getColumnsWidgets=function(){var e,t,o,i,r=[],n=this._$dom.find(">.container-fluid>.row>.moto-cell");for(o=0,i=n.length;o<i;o++)t={dom:n[o]},(e=a.createWidgetByName("row.column",t,this)).initialize(),e.initChildrenByDom(),r.push(e);return r},d.prototype.exportChildrenToObject=function(){return this.exportWidgetsToObject(this.getColumnsWidgets())},d.prototype.exportForFuture=function(){var e=p.prototype.exportForFuture.call(this);return delete e.properties.anchor,delete e.properties.spacing.left,delete e.properties.spacing.right,e},d.prototype.exportForCopy=function(){return p.prototype.exportForCopy.call(this)},d.prototype.onUnselectedEvent=function(){this.hideColumnHelpers(),i=null},d.prototype.onSelectedEvent=function(){this.updateColumnHelpers()},d.prototype.updateColumnHelpers=function(){this.isSelected()&&this.children.forEach(function(e){e._Editor.HelperHover.updateByWidget(e)})},d.prototype.hideColumnHelpers=function(){this.children.forEach(function(e){e._Editor.HelperHover.hideByWidget(e)})},d.prototype.onMovedEvent=function(){this.setProperties({gutter:this.isGutterSetAbove()&&this.properties.gutter})},d.prototype.postUpdateRowStructure=function(){this._changingColumnSizes||(this._Editor.HistoryManager.isUndoOrRedoInProcess()||this.normalizeColumnSizes(),this.updateEmptyClass(),this.updateColumnHelpers(),this._Editor.getScope().$broadcast("Widget.WidthChangedByWidget",this))},d.prototype.propertiesWereChanged=function(){var e=angular.copy(this.properties);return delete e.__backgroundTraitColorEnabled,delete e.__backgroundTraitImageEnabled,delete e.__backgroundTraitVideoEnabled,delete e.styles["background-position"],delete e.bgVideo.position,!angular.equals(e,this.getDefaultProperties())},d.prototype.canBeAutoRemoved=function(){return!this._changingColumnSizes&&(!this._Editor.HistoryManager.isUndoOrRedoInProcess()&&(!this.children.length||1===this.children.length&&this.isEmpty()&&this.isParentASection()&&!this.propertiesWereChanged()&&!this.children[0].propertiesWereChanged()))},d.prototype.onAppendChildEvent=function(){p.prototype.onAppendChildEvent.apply(this,arguments),this.postUpdateRowStructure()},d.prototype.onRemoveChildEvent=function(e,t){var o,i,r,n=this;function a(){o(),i(),n._Editor.destroyWidget(n)}p.prototype.onRemoveChildEvent.apply(this,arguments),this.canBeAutoRemoved()?(r=this._Editor.getScope(),o=r.$on("NEW EVENT: Widget was removed",a),i=r.$on("NEW EVENT: Move widget after",a)):t.isContainer()&&this.postUpdateRowStructure()},d.prototype.getCssClasses=function(){var e,t="";return t+=this.isFixable()&&this.properties.fixed?" row-fixed":"",t+=!this.properties.gutter&&this.isGutterSetAbove()?" row-gutter-0":"",t+=this.properties.evenColumns?" row-even-columns":"",t+=this.properties.justify?" moto-justify-content_"+this.properties.justify:"",this.properties.styles["background-color"]&&(e=this.getColorizerModel().getClassNameByColorName(this.properties.styles["background-color"],"moto-bg-color"))&&(t+=" "+e),t+=" "+this.getSpacing("classes")},d.prototype.resizeColumn=function(e,t){var o,i,r,n;return!!(angular.isNumber(e)&&angular.isNumber(t)&&t)&&(o=e+1,!(!this.children[e]||!this.children[o])&&(i=this.children[e].getSize(),n=this.children[o].getSize()-t,!((r=i+t)<1||n<1)&&(this.children[e].setSize(r),this.children[o].setSize(n),this.postUpdateRowStructure(),!0)))},d.prototype.normalizeColumnSizes=function(){var e,t,o,i=this.getColumnSizes(),r=i.reduce(function(e,t){return e+t},0);if(12!==r){for(;12<r;)t=Math.max.apply(Math,i),e=i.indexOf(t),i[e]=t-1,r--;for(;r<12;)o=Math.min.apply(Math,i),e=i.indexOf(o),i[e]=o+1,r++;this.setColumnSizes(i)}},a.set(d.prototype.name,d),e.addWidget({name:d.prototype.name,label:d.prototype.label,category:"structure",order:5,enabled:!0,allowed:function(){return!0},options:{children:[{name:"row.column"}]},icons:{small:"icon icon-row",medium:"",large:"icon icon-row"}})}]),angular.module("application.widget.section",["application.core"]).run(["$rootScope","coreLibraryWidget","$translate","$timeout",function(e,o,c,i){var r,p,n=o.get("AbstractContainerWidgetClass");function t(e){var o=null;e.sectionSizeChanged=function(e,t){o&&t.cancel(o),o=t(function(){e.updateLivePreview()},250)}}function a(){n.apply(this,arguments)}window.__debugHelperSection=!1,e.$on("NEW EVENT: MotoEditor.config:after",function(e,t){window.__debugHelperSection&&console.info("Widget Section : _connectToEditor ",e&&'by $event : "'+e.name+'"');var o,i=t.getGlobal("$"),r=t.getEditor();function n(e){var t=r.getElementCharacteristics(e._$dom);return r._$body.height()==t.height?"moto-editor-label_inside":0<=t.top-20?"moto-editor-label_top":t.top-20<0?"moto-editor-label_bottom":void 0}function a(e){r.getCurrentSection()||(o=r.getWidgetByDom(e.currentTarget),r.HelperHover.showByWidget(o))}function s(){r.HelperHover.hideByWidget(o),o=null}function l(e){window.__debugHelperSection&&console.info("Widget Section : _disconnect ",e&&'by $event : "'+e.name+'"'),i(".moto-section").off("mouseenter",a).off("mousemove",a).off("mouseleave",s),s()}t.getEventManager(),p=null,r.HelperHover.registerTemplate("section",{render:function(e){return'<div class="moto-editor-helper moto-editor-helper_hover moto-editor-widget-section-helper moto-editor_no-draggable" draggable="true"><div class="moto-editor-outline"></div><div class="moto-editor-label '+n(e.widget)+'"><span class="helper-label">'+c.instant(e.widget.label)+"</span>"+(e.widget.hasProperties()?'<span class="moto-editor-icon_edit"></span>':"")+"</div></div>"}}),r.HelperSelected.registerTemplate("section",{render:function(e){return'<div class="moto-editor-helper moto-editor-helper_selected moto-editor-widget-section-helper moto-editor_no-draggable" draggable="true"><div class="moto-editor-outline"></div><div class="moto-editor-label '+n(e.widget)+'"><span class="helper-label">'+c.instant(e.widget.label)+"</span>"+(e.widget.hasProperties()?'<span class="moto-editor-icon_edit"></span>':"")+"</div></div>"}}),r.HelperDragHover.registerTemplate("section",{render:function(e){return e.widget.isSelected()?'<div class="moto-editor-helper moto-editor-helper_drag-hover"><div class="moto-editor-outline"></div></div>':r.HelperDragHover.getTemplate("base").render(e)}}),i(".moto-section").on("mouseenter",a).one("mousemove",a).on("mouseleave",s),r.getScope().$on("NEW EVENT: Editor start activating section",l),r.getScope().$on("NEW EVENT: Editor start self destroying",l)}),t.$inject=["$scope"],((a.prototype=Object.create(n.prototype)).constructor=a).prototype.name="section",a.prototype.label="",a.prototype.controller=t,a.prototype._apiVersion=2,a.prototype._permanentId=!0,a.prototype._template={engine:"nunjucks",path:"@websiteWidgets/section/templates/default.twig.html"},a.prototype.getSectionName=function(){return this._$dom.attr("id").substring(8)},a.prototype.hasProperties=function(){return"footer"===this.getSectionName()},a.prototype.initialize=function(e){var t,o;this.label||(this.label="WIDGET.SECTION."+this.getSectionName().toUpperCase()+"_TITLE"),this.updateEmptyClass(),(t=this._Editor.getEnvironment().getGlobal("permanent_highlighted_sections"))&&0<=t.indexOf(this.getSectionName())&&this._Editor.HelperHighlight.showByWidget(this),(o=this._Editor.getEnvironment().getGlobal("only_drag_placeholder_sections"))&&0<=o.indexOf(this.getSectionName())||this.showEmptyClickSectionPlaceholder(),this.showEmptySectionPlaceholder(),n.prototype.initialize.call(this,e)},a.prototype.isRemovable=function(){return!1},a.prototype.getTargetDataForPaste=function(){var e=this.getPositionInContent();return e.positionIndex=this.children.length,{targetWidget:this,widgetPosition:e}},a.prototype.isDraggable=function(){return!1},a.prototype.isAutoShowHelpers=function(e){return this.isContentActivated()},a.prototype.isAutoHideHelpers=function(e){return this.isContentActivated()},a.prototype.onChildHoveredEvent=function(e,t){this.isContentActivated()?p&&(o.Environment.getGlobal("MotoEditor").HelperHover.hideByWidget(p),p=null):(p!==this&&o.Environment.getGlobal("MotoEditor").HelperHover.hideByWidget(p).showByWidget(this),p=this)},a.prototype._allowedDragMethods=[{rule:"default",result:"append"},{rule:"top:half",result:"prepend"}],a.prototype.getHelperInsertPosition=function(e){var t=this._$dom.outerHeight();return e.eventPositions.targetWidgetOffsetY<=t/2?"prepend":"append"},a.prototype.showEmptySectionPlaceholder=function(){return!!this.isEmpty()&&(this._$dom.addClass("moto-section_placeholder"),this._$dom.prepend(this.$('<div class="moto-editor-widget-section-placeholder"><div class="placeholder-drag"><div class="placeholder-border"></div><div class="placeholder-center"><div class="placeholder-icon-drag"></div><span class="placeholder-text">'+c.instant("WIDGET.SECTION.EMPTY_TEXT")+"</span></div></div></div>")),!0)},a.prototype.hideEmptySectionPlaceholder=function(e){return!(this.isEmpty()&&!e)&&(this._$dom.removeClass("moto-section_placeholder").removeClass("moto-section_placeholder_click"),this._$dom.find(".moto-editor-widget-section-placeholder").remove(),!0)},a.prototype.showEmptyClickSectionPlaceholder=function(){if(this.isEmpty())return this._$dom.addClass("moto-section_placeholder").addClass("moto-section_placeholder_click"),this._$dom.prepend(this.$('<div class="moto-editor-widget-section-placeholder"><div class="placeholder-click"><div class="placeholder-center"><div class="placeholder-icon-click"></div><span class="placeholder-text">'+c.instant("WIDGET.SECTION.EMPTY_CLICK_TEXT")+"</span></div></div></div>")),!0},a.prototype.pleaseLockContent=function(e){var t,o,i;return this.isContentLocked()||this.isContentNotActivated()||(this._$dom.addClass("moto-section_locked"),this._$dom.prepend(this.$((o=this,i="WIDGET.SECTION.CONTENT_LOCKED_BY_WIDGET_TEXT","BLOCK"==(t=(t=e)||{}).lockedBy&&(i="WIDGET.SECTION.CONTENT_LOCKED_BY_BLOCK_TEXT"),t.text&&(i=t.message),'<div class="moto-editor-helper moto-editor-helper_locked moto-editor-widget-section-helper"><div class="moto-editor-label moto-editor-label_inside"><span class="helper-label">'+c.instant(o.label)+'</span></div><span class="moto-editor-helper_locked-text">'+c.instant(i)+"</span></div>")))),!0},a.prototype.pleaseUnLockContent=function(e){return this.isContentLocked()&&(this._$dom.removeClass("moto-section_locked"),this._$dom.find(">.moto-editor-helper.moto-editor-helper_locked").remove()),!0},a.prototype.isContentLocked=function(){return this._$dom.hasClass("moto-section_locked")},a.prototype.isContentNotActivated=function(){return this._$dom.hasClass("moto-section_inactive")},a.prototype.isContentActivated=function(){return this._$dom.hasClass("moto-section_active")},a.prototype.onAppendChildEvent=function(){n.prototype.onAppendChildEvent.apply(this,arguments),this.hideEmptySectionPlaceholder()},a.prototype.onRemoveChildEvent=function(){n.prototype.onRemoveChildEvent.apply(this,arguments),this.showEmptySectionPlaceholder()},a.prototype.getContainerIndexByElement=function(){return 0},a.prototype.getContainerPositionIndexByChild=function(){return 0},a.prototype.updateContentViewByString=function(e,t,o){return angular.isString(e)&&(this._$dom.html(e),e=this._dom),n.prototype.updateContentViewByString.call(this,e,t,o)},a.prototype.onContentUpdatedEvent=function(e,t){var o=this;t.scanLiveChildren(),r&&i.cancel(r),r=i(function(){o.devQuickConvertWidget(!1)},100)},o.set("section",a)}]),angular.module("application.widget.slider").controller("application.widget.slider.controllers.EditItemController",["$scope","application.media_library.services.MediaLibraryService","motoUI.LinkToService",function(o,e,t){o.currentItem={id:o.editingItem.id||null,name:o.editingItem.name,caption:o.editingItem.caption,content:o.editingItem.content,alt:o.editingItem.alt,thumbnail:o.editingItem.thumbnail||"",captionType:o.editingItem.captionType||"text"},o.toggleTextEditor=function(){var e;"text"==o.currentItem.captionType&&(e=angular.element(o.currentItem.caption)).length&&(e.find(".fa").remove(),o.currentItem.caption=e.text())},o.changeImage=function(){e.open({id:o.currentItem.id,value:o.currentItem.content?o.currentItem.content:o.editingItem.content,filters:["image"],thumbnails:!0,size:o.currentItem.thumbnail,onApply:function(e,t){e&&(o.currentItem.id!=e.id&&(o.currentItem.id=e.id,o.currentItem.alt=e.alt),o.currentItem.name=e.name,o.currentItem.thumbnail=t,o.currentItem.content=t?e.getThumbnailPath(t):e.path)}})},o.ok=function(){o.editImage&&!o.editImage.$valid||(o.currentItem.content&&("html"===o.currentItem.captionType&&(o.currentItem.caption=t.transformLinks(o.currentItem.caption)),o.editingItem.id=o.currentItem.id,o.editingItem.content=o.currentItem.content,o.editingItem.name=o.currentItem.name,o.editingItem.thumbnail=o.currentItem.thumbnail,o.editingItem.alt=o.currentItem.alt,o.editingItem.captionType=o.currentItem.captionType),o.editingItem.caption=o.currentItem.caption.trim(),o.$parent.ok())}}]),angular.module("application.widget.slider").controller("application.widget.slider.controllers.TopController",["$scope","coreLibraryModal","coreLibraryUtils","application.media_library.services.MediaLibraryService",function(i,e,r,t){i.initialItems=angular.copy(i.items),i.addImage=function(){t.open({multiSelect:!0,filters:["image"],thumbnails:!0,onApply:function(e,o){e&&e.forIn(function(e,t){i.items.push({id:t.id,type:t.type,caption:"",content:o?t.getThumbnailPath(o):t.path,thumbnail:o,name:t.name,ordinalNumber:i.items.length,alt:t.alt})})}})},i.editImage=function(o){e("@websiteWidgets/slider/src/backend/views/edit_item.tpl.html",function(e,t){e.editingItem=o,e.ok=function(){t.close(e)},e.cancel=function(){t.close(e)}},null,"widget-admin-edit modal-with-ckeditor")},i.deleteImage=function(e){var t=i.items.indexOf(e);0<=t&&i.items.splice(t,1)},i.$on("numberOfItemsChanged",function(){i.initSortableGrid()}),i.initSortableGrid=function(){var o=angular.element(".items-list");try{o.sortable("destroy")}catch(e){}o.sortable({placeholder:"ui-sortable-highlight",stop:function(){var e,t=o.sortable("toArray",{attribute:"item-index"});for(e=0;e<i.items.length;e++)i.items[e].ordinalNumber=t.indexOf(e.toString());r.sortArrayByProperty(i.items,"ordinalNumber"),i.$apply()}})},i.isChanged=function(){return!angular.equals(i.initialItems,i.items)},i.ok=function(){i.$parent.ok(r.sortArrayByProperty(i.items,"ordinalNumber"),i.isChanged())},i.cancel=function(e){e&&e.preventDefault(),i.isChanged()?r.openConfirmationBox({yesHandler:function(){i.$parent.cancel()}}):i.$parent.cancel()},i.$on("motoPopupCanceled",i.cancel)}]),angular.module("application.widget.slider").run(["core.library.editor.WidgetsService","core.library.editor.PresetsService","motoFeatures","coreLibraryWidget","coreLibraryMessenger","coreLibraryModal",function(e,t,o,i,r,n){var a=i.get("AbstractWidgetClass"),s=[],l=[];function c(e,t){return t=t||{},e.items&&1==e.items.length&&(t.pager=!1),$.extend({mode:e.slideshowAnimationType,auto:e.slideshowEnabled,pause:1e3*e.slideshowDelay,controls:e.showNextPrev,pager:e.showPaginationDots,captions:e.showSlideCaptions,stopAutoOnClick:!0},t)}function p(e,t){var o=c(t);return o.onSliderLoad=function(){e.closest(".moto-widget-slider").removeClass("moto-widget-slider-loader")},e.bxSlider(o)}function d(e,t){var o,i,r;e&&e.getCurrentSlide&&(i=c(t,(o=e.getCurrentSlide())<e.getSlideCount()?{startSlide:o}:{}),(r=e.find(".bx-caption")).removeClass("bx-caption"),r.css("display","none"),e.reloadSlider(i),r.addClass("bx-caption"),r.css("display",""))}function u(i){n("@websiteWidgets/slider/src/backend/views/top.tpl.html",function(t,o){t.items=angular.copy(i.properties.items),t.ok=function(e){i.setProperties({items:e}),o.close(t),r.success("WIDGET.COMMON.MESSAGES.CHANGES_APPLIED")},t.cancel=function(){o.close(t)}},null,"widget-admin")}function g(e){e.animationTypes=[{type:"fade",translationKey:"WIDGET.SLIDER.FADE_ANIMATION_TYPE_LABEL"},{type:"horizontal",translationKey:"WIDGET.SLIDER.SLIDE_ANIMATION_TYPE_LABEL"}],e.openSelectItemsPopup=u}function m(){this.properties={preset:"default",animation:"",visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},items:[],slideshowEnabled:!0,slideshowDelay:5,slideshowAnimationType:"fade",showNextPrev:!0,showPaginationDots:!0,showSlideCaptions:!0,showSlideCaptionsOn:"mobile-v"},a.apply(this,arguments)}g.$inject=["$scope"],((m.prototype=Object.create(a.prototype)).constructor=m).prototype._transformToMacros=!0,m.prototype.controller=g,m.prototype.name="slider",m.prototype.label="WIDGET.SLIDER.NAME",m.prototype._apiVersion=2,m.prototype._dragImagePath="@websiteWidgets/slider/icons/drag.png",m.prototype._template={engine:"nunjucks",path:"@websiteWidgets/slider/templates/default.twig.html"},m.prototype.isCopyable=function(){return!0},m.prototype.create=function(){0<this.properties.items.length&&(this.carouselInstance=p(this._$dom.find(".moto-widget-slider-list"),this.properties),this.disableDragOnElement()),a.prototype.create.call(this)},m.prototype.getCaptionsVisibleOnClass=function(){var e=this.properties.showSlideCaptionsOn;return e&&"mobile-v"!==e?"moto-visible-on_"+e:""},m.prototype.onDoubleClickEvent=function(e){u(this)},m.prototype.initialize=function(){var e;(e=this._$dom.attr("data-instance-id"))&&s[e]?(this.carouselInstance=s[e],$.extend(!0,this.properties,l[e]),this.disableDragOnElement()):!this.carouselInstance&&0<this.properties.items.length&&(this.carouselInstance=p(this._$dom.find(".moto-widget-slider-list"),this.properties),this.disableDragOnElement()),this.properties.showSlideCaptionsOn=this.properties.showSlideCaptionsOn||"mobile-v",a.prototype.initialize.call(this)},m.prototype.shouldUpdateContentView=function(e){return e.items&&this.properties.items!==e.items||e.preset&&this.properties.preset!==e.preset},m.prototype.manualUpdateContentView=function(){d(this.carouselInstance,this.properties)},m.prototype.onWidthChanged=function(){d(this.carouselInstance,this.properties)},m.prototype.postRenderPreview=function(){a.prototype.postRenderPreview.apply(this,arguments),0<this.properties.items.length&&(this.carouselInstance&&this.carouselInstance.destroySlider(),this.carouselInstance=p(this._$dom.find(".moto-widget-slider-list"),this.properties),this.disableDragOnElement())},m.prototype.disableDragOnElement=function(){$(".moto-widget-slider-list img",this._dom).attr("draggable","false")},m.prototype.exportForFuture=function(){var e,t,o=a.prototype.exportForFuture.call(this);if(angular.isArray(o.properties.items))for(e=0,t=o.properties.items.length;e<t;e++)delete o.properties.items[e].id;return o},i.doWhenLivePreviewReady(function(o){s=[],l=[],o.$(".moto-widget-slider:not(.moto-widget-carousel)").each(function(){var e,t;try{0<(e=o.widgetCacheOptions[o.$(this).data("widget-id")].properties).items.length&&(t=p(o.$(this).find(".moto-widget-slider-list"),e),s.push(t),l.push(e),$(this).attr("data-instance-id",s.length-1))}catch(e){}})}),i.doWhenWidthChanged(function(){s.forEach(function(e,t){d(e,l[t])})}),i.set(m.prototype.name,m),e.addWidget({name:m.prototype.name,label:m.prototype.label,category:"galleries",order:10,enabled:o.isEnabled("theme_widget_slider"),allowed:function(){return o.isEnabled("theme_widget_slider")},icons:{small:"icon icon-slider",medium:"",large:"icon icon-slider"}}),t.addWidget({name:"slider",label:"WIDGET.SLIDER.BUILDER_NAME",category:"galleries",order:80,enabled:o.isEnabled("theme_presets_slider"),icons:{small:"icon icon-slider",medium:"icon icon-slider-medium",large:"icon icon-slider"}})}]),angular.module("application.widget.slideshare",["application.core"]).config(["coreLibraryValidationProvider",function(o){o.setValidator("slideshare_url",function(e){var t={isValid:!1,key:o.getErrorMessage("URL_INVALID","incorrectURL"),args:{}};return e&&angular.isString(e)&&(e=e.trim(),/^(http[s]?:\/\/)?((www\.)?slideshare\.net\/)(.+)$/i.test(e)||0===e.length)?{isValid:!0,key:"",args:{}}:t})}]).run(["coreLibraryWidget","core.library.editor.WidgetsService","$http",function(e,t,o){var i=e.get("AbstractWidgetClass");function r(e,t){e.cachedUrl=e.currentWidget.properties.params.url,e.checkPresentationUrl=function(){t(function(){e.currentWidget.properties.params.url&&e.cachedUrl!==e.currentWidget.properties.params.url&&e.widgetSlidesharePropertiesForm.$valid?(e.cachedUrl=e.currentWidget.properties.params.url,e.currentWidget.getDataFromAPI()):e.widgetSlidesharePropertiesForm.$valid||(e.cachedUrl=null,e.currentWidget.properties.params.src="")})}}function n(){this.properties={visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},params:{url:"",src:"",presentationRatio:75}},i.apply(this,arguments)}r.$inject=["$scope","$timeout"],((n.prototype=Object.create(i.prototype)).constructor=n).prototype.name="slideshare",n.prototype.label="WIDGET.SLIDESHARE.NAME",n.prototype.controller=r,n.prototype._transformToMacros=!0,n.prototype._apiVersion=2,n.prototype._dragImagePath="@websiteWidgets/slideshare/icons/drag.png",n.prototype._template={engine:"nunjucks",path:"@websiteWidgets/slideshare/templates/default.twig.html"},n.prototype.isCopyable=function(){return!0},n.prototype.initialize=function(){this._propertiesLoaded||this.loadPropertiesFromAttribute(),i.prototype.initialize.call(this)},n.prototype.getDataFromAPI=function(){o({url:"//www.slideshare.net/api/oembed/2?url="+this.properties.params.url+"&format=jsonp&callback=JSON_CALLBACK",method:"JSONP",ignoreLoadingBar:!0}).then(function(e){var t,o=e.data,i=angular.copy(this.properties.params);t=$(o.html).first(),i.presentationRatio=o.height/o.width*100,i.src=t.attr("src"),this.setProperties({params:i})}.bind(this),function(){var e=angular.copy(this.properties.params);e.src="",this.setProperties({params:e})}.bind(this))},n.prototype.loadPropertiesFromAttribute=function(){var e;try{e=this.$(this._dom).attr("moto-properties"),e=angular.fromJson(e),angular.isObject(e)&&(this.properties=$.extend(!0,this.properties,e))}catch(e){}},e.set(n.prototype.name,n),t.addWidget({name:n.prototype.name,label:n.prototype.label,category:"more",order:50,allowed:function(){return!0},icons:{small:"icon icon-slideshare",medium:"",large:"icon icon-slideshare"}})}]),angular.module("application.widget.social_buttons",["application.widget.abstract"]).run(["coreLibraryWidget","core.library.editor.WidgetsService",function(e,t){var o=e.get("AbstractWidgetClass");function i(){this.properties={preset:"default",visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""},buttons:[{name:"facebook_share",provider:"facebook",enabled:!0},{name:"facebook_like",provider:"facebook",enabled:!0},{name:"twitter_tweet",provider:"twitter",enabled:!0},{name:"linkedIn_share",provider:"linkedin",enabled:!0},{name:"google_share",provider:"google_plus",enabled:!0},{name:"google_like",provider:"google_plus",enabled:!0}]},o.apply(this,arguments)}((i.prototype=Object.create(o.prototype)).constructor=i).prototype._transformToMacros=!0,i.prototype.name="social_buttons",i.prototype.label="WIDGET.SOCIAL_BUTTONS.NAME",i.prototype._apiVersion=2,i.prototype._dragImagePath="@websiteWidgets/social_buttons/icons/drag.png",i.prototype._template={engine:"nunjucks",path:"@websiteWidgets/social_buttons/templates/default.twig.html"},i.prototype.initialize=function(){"string"==typeof this.properties.align&&(this.properties.align={desktop:this.properties.align,tablet:"","mobile-h":"","mobile-v":""}),o.prototype.initialize.call(this)},i.prototype.getSocialButtonTemplate=function(){return""},i.prototype.setCurrentPage=function(){},i.prototype.isCopyable=function(){return!0},e.set("social_buttons",i),t.addWidget({name:i.prototype.name,label:i.prototype.label,category:"social",order:10,enabled:!0,icons:{small:"icon icon-social_buttons",medium:"",large:"icon icon-social-buttons"}})}]),angular.module("application.widget.social_links_extended",["application.widget.abstract"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","core.library.editor.PresetsService","motoFeatures",function(e,t,o,i){var r=e.get("AbstractWidgetClass");function n(r,e,o){r.openItemPopup=function(o){var i={icon:null,link:{action:"url",properties:{nofollow:!1,target:"_blank",url:""}},advancedStylesEnabled:!1,advancedStyles:{desktop:{base:{color:"","background-color":"","border-color":""},hover:{color:"","background-color":"","border-color":""}}}};e("@websiteWidgets/social_links_extended/src/backend/views/item.tpl.html",function(e,t){e.editingMode=!!o,e.item=e.editingMode?angular.copy(o):angular.copy(i),e.ok=function(){e.editingMode?angular.extend(o,e.item):r.currentWidget.properties.items.push(e.item),t.close(e)},e.cancel=function(){t.close(e)}})},r.deleteItem=function(t){o.openConfirmationBox({yesHandler:function(){var e=r.currentWidget.properties.items.indexOf(t);0<=e&&r.currentWidget.properties.items.splice(e,1)},question:"WIDGET.COMMON.REMOVE_WIDGETS_ITEM_CONFIRMATION"})}}function a(){this.properties={items:[],preset:"default",align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""},visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},animation:""},r.apply(this,arguments)}n.$inject=["$scope","coreLibraryModal","coreLibraryUtils"],((a.prototype=Object.create(r.prototype)).constructor=a).prototype._transformToMacros=!0,a.prototype.name="social_links_extended",a.prototype.label="WIDGET.SOCIAL_LINKS.NAME",a.prototype.controller=n,a.prototype._apiVersion=2,a.prototype._dragImagePath="@websiteWidgets/social_links_extended/icons/drag.png",a.prototype._template={engine:"nunjucks",path:"@websiteWidgets/social_links_extended/templates/default.twig.html"},a.prototype.isCopyable=function(){return!0},e.set("social_links_extended",a),t.addWidget({name:a.prototype.name,label:a.prototype.label,category:"social",order:5,enabled:i.isEnabled("theme_widget_social_links_extended"),allowed:function(){return i.isEnabled("theme_widget_social_links_extended")},icons:{small:"icon icon-social_links_extended",medium:"icon icon-social_links_extended-medium",large:"icon icon-social_links_extended"}}),o.addWidget({name:"social_links_extended",label:"WIDGET.SOCIAL_LINKS.NAME",category:"more",order:90,enabled:i.isEnabled("theme_widget_social_links_extended"),checkPresetControls:!1,stateParam:"social_links_extended",template:{path:"@websiteWidgets/social_links_extended/templates/default.twig.css",engine:"nunjucks"},icons:{small:"icon icon-social_links_extended",medium:"icon icon-social_links_extended-medium",large:"icon icon-social_links_extended"}})}]),angular.module("application.widget.social_links_extended").controller("application.widget.social_links_extended.controllers.ItemController",["$scope",function(i){i.styleModel={},i.$on("MotoUI.StateSwitcher.Changed",function(e,t){i.setStyleModel(t)}),i.setStyleModel=function(e){var t,o=e.entities.split(",");for(t=0;t<o.length;t++)i.item[o[t]]||(i.item[o[t]]={desktop:{base:{},hover:{}},mobile:{base:{},hover:{}}}),i.item[o[t]].desktop?i.styleModel[o[t]]=i.item[o[t]].desktop[e.value]:i.item[o[t]].mobile&&(i.styleModel[o[t]]=i.item[o[t]].mobile[e.value]);i.$broadcast("widget.properties.setCache",i.currentCashKey),i.currentCashKey=e.entities+e.value,i.currentStyleOptions=e},i.initEntities=function(e,t){!function e(t){var o;if(angular.isArray(t)||!angular.isObject(t))return!1;for(o in t)t.hasOwnProperty(o)&&(angular.isArray(t[o])?t[o].length||(t[o]={}):angular.isObject(t[o])&&e(t[o]));return!0}(i.item),i.setStyleModel({entities:e,value:t||"base",init:!1})},i.resetEntities=function(e,t){t&&i.setStyleModel({entities:e,value:t})},i.getParent=function(e,t){return"base"===i.currentStyleOptions.value?null:t?i.item[e].desktop.base[t]:i.item[e].desktop.base},i.saveItem=function(){i.editWidgetItem.$valid&&i.$parent.ok()}}]),angular.module("application.widget.social_links",["application.widget.abstract"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","core.library.editor.PresetsService","motoFeatures",function(e,t,o,i){var r=e.get("AbstractWidgetClass");function n(e){e.getLabelByProvider=function(e){return"WIDGET.SOCIAL_LINKS."+("googleplus"===e?"google":e).toUpperCase()+"_URL_LABEL"},e.checkUrl=function(t){var o;e.currentWidget.properties.links.forEach(function(e){e.provider===t&&(o=e)}),o&&o.url&&-1===o.url.indexOf("http://")&&-1===o.url.indexOf("https://")&&"#"!==o.url&&(o.url="http://"+o.url)},e.$on("widgetPropertiesChanged",function(){e.currentWidget.renderPreview()})}function a(){this.properties={preset:"default",align:{desktop:"left",tablet:"","mobile-v":"","mobile-h":""},visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},animation:"",links:[{provider:"facebook",url:"#",name:"",icon:""},{provider:"googleplus",url:"#",name:"",icon:""},{provider:"twitter",url:"#",name:"",icon:""},{provider:"pinterest",url:"#",name:"",icon:""},{provider:"linkedin",url:"#",name:"",icon:""},{provider:"instagram",url:"#",name:"",icon:""}]},r.apply(this,arguments)}n.$inject=["$scope"],((a.prototype=Object.create(r.prototype)).constructor=a).prototype._transformToMacros=!0,a.prototype.name="social_links",a.prototype.label="WIDGET.SOCIAL_LINKS.NAME",a.prototype.controller=n,a.prototype._apiVersion=2,a.prototype._dragImagePath="@websiteWidgets/social_links/icons/drag.png",a.prototype._template={engine:"nunjucks",path:"@websiteWidgets/social_links/templates/default.twig.html"},a.prototype.isCopyable=function(){return!0},a.prototype.initialize=function(){var e,t;for("object"==typeof this.properties.links&&(this.properties.links=(t=this.properties.links,$.map(t,function(e){return[e]}))),e=0;e<this.properties.links.length;e++)delete this.properties.links[e].order;r.prototype.initialize.call(this)},e.set("social_links",a),t.addWidget({name:a.prototype.name,label:a.prototype.label,category:"social",order:10,enabled:!1,icons:{small:"icon icon-social_links",medium:"",large:"icon icon-social-links"}}),o.addWidget({name:"social_links",label:"WIDGET.SOCIAL_LINKS.NAME",category:"more",order:90,hidden:!0,enabled:i.isEnabled("theme_presets_social_links"),icons:{small:"icon icon-social_links",medium:"icon icon-social-medium",large:"icon icon-social-links"}})}]),angular.module("application.widget.sound_cloud",["application.core"]).config(["coreLibraryValidationProvider",function(o){o.setErrorMessage("SOUNDCLOUD_WIDGET_ID","WIDGET.SOUNDCLOUD.INCORRECT_TRACK_ID_ERROR_MESSAGE"),o.setValidator("soundcloud_track_id",function(e){var t={isValid:!1,key:o.getErrorMessage("SOUNDCLOUD_WIDGET_ID","WIDGET.SOUNDCLOUD.INCORRECT_TRACK_ID_ERROR_MESSAGE"),args:{}};return e&&angular.isString(e)&&(e=e.trim(),/(api.soundcloud.com\/tracks\/\d+)|(^\d+$)/i.test(e)||0===e.length)?{isValid:!0,key:"",args:{}}:t})}]).run(["core.library.editor.WidgetsService","coreLibraryWidget",function(e,t){var o=t.get("AbstractWidgetClass");function i(i,e){function r(e,t){var o;return o=new RegExp(e+"=(\\w+)").exec(t),"color"===e?o&&2<=o.length?o[1]:void 0:o&&2<=o.length?"true"===o[1]:void 0}i.colorPickerOptions={showInput:!0,showAlpha:!1,showInitial:!0,preferredFormat:"hex",clickoutFiresChange:!1},i.modeSelectOptions=[{label:"WIDGET.SOUNDCLOUD.PREVIEW_MODE_VISUAL_LABEL",value:!0},{label:"WIDGET.SOUNDCLOUD.PREVIEW_MODE_CLASSIC_LABEL",value:!1}],i.setTrackId=function(){e(function(){i.widgetSoundCloudPropertiesForm.$valid?(Number(i.currentWidget.properties.params.track_id)||i.updateWidgetProperties(),i.currentWidget.properties.enabled=!0):i.currentWidget.properties.enabled=!1})},i.updateWidgetProperties=function(){var e,t,o;try{e=/src="(.*)"/i.exec(i.currentWidget.properties.params.track_id)[1],t=Number(/height="(\d+)"/i.exec(i.currentWidget.properties.params.track_id)[1]),o={visual:r("visual",e)||!1,height:t||450,show_user:r("show_user",e),show_artwork:r("show_artwork",e),show_comments:r("show_comments",e),auto_play:r("auto_play",e),color:r("color",e)||"ff5500"},angular.isObject(o)&&(i.currentWidget.properties.params=$.extend(!0,i.currentWidget.properties.params,o)),i.currentWidget.properties.params.track_id=/tracks\/(\d+)&/i.exec(i.currentWidget.properties.params.track_id)[1]||null}catch(e){}}}function r(){this.properties={spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},preset:"default",enabled:!1,params:{track_id:null,visual:!0,height:450,show_user:!0,show_artwork:!0,show_comments:!0,auto_play:!1,color:"ff5500"}},o.apply(this,arguments)}i.$inject=["$scope","$timeout"],((r.prototype=Object.create(o.prototype)).constructor=r).prototype.controller=i,r.prototype.name="sound_cloud",r.prototype.label="WIDGET.SOUNDCLOUD.NAME",r.prototype._dragImagePath="@websiteWidgets/sound_cloud/icons/drag.png",r.prototype._transformToMacros=!0,r.prototype._apiVersion=2,r.prototype._template={engine:"nunjucks",path:"@websiteWidgets/sound_cloud/templates/default.twig.html"},r.prototype.isCopyable=function(){return!0},r.prototype.shouldUpdateContentView=function(e){return!angular.equals(this.properties.params,e.params)||this.properties.enabled!==e.enabled},t.set(r.prototype.name,r),e.addWidget({name:r.prototype.name,label:r.prototype.label,category:"media",order:60,allowed:function(){return!0},icons:{small:"icon icon-sound_cloud",medium:"",large:"icon icon-sound_cloud"}})}]),angular.module("application.widget.spacer",["application.widget.abstract"]).run(["coreLibraryWidget","core.library.editor.WidgetsService",function(e,t){var o=e.get("AbstractWidgetClass");function i(){this.properties={preset:"default",height:"30px",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},visible_on:"mobile-v"},o.apply(this,arguments)}((i.prototype=Object.create(o.prototype)).constructor=i).prototype.name="spacer",i.prototype.label="WIDGET.SPACER.NAME",i.prototype._apiVersion=2,i.prototype._transformToMacros=!0,i.prototype._dragImagePath="@websiteWidgets/spacer/icons/drag.png",i.prototype._template={engine:"nunjucks",path:"@websiteWidgets/spacer/templates/default.twig.html"},i.prototype.initialize=function(){this._propertiesLoaded||(this.properties.height=this._$dom.find(".moto-widget-spacer-block").height()+"px",this.properties.visible_on=this._$dom.data("visible-on")||"mobile-v"),o.prototype.initialize.call(this)},i.prototype.isCopyable=function(){return!0},e.set("spacer",i),t.addWidget({name:i.prototype.name,label:i.prototype.label,category:"basic",order:25,enabled:!0,allowed:function(){return!0},icons:{small:"icon icon-spacer",medium:"",large:"icon icon-spacer"}})}]),function(){var m="tabs",f="tabs.item";angular.module("application.widget.tabs_handlers",["ng"]).config(["motoWidgetsWhiteListProvider",function(e){e.add(m,[f,"text","image","button","divider_horizontal","spacer","row","row.column","contact_form","completion_bars","paypal_button","countdown","map"])}]).run(["$rootScope","motoWidgetsWhiteList",function(e,i){var c,n=!1;function p(e){var t,o=!1;if(!e)return o;for(t=e;t;){if(t.name===m){o=!0;break}t=t._parent}return o}function d(e){return i.isAllowed(m,e)}function o(e,t,o){return p(o.targetWidget)?(n&&console.info("Start cleaning buffer by white list ",i.get(m)),function e(t){var o,i;if(!angular.isArray(t.children)||!t.children.length)return t;for(o=0;o<t.children.length;o++)d((i=t.children[o]).name)?angular.isArray(i.children)&&i.children.length&&(i=e(i)):(n&&console.warn("DROP widget from buffer",i.name),t.children.splice(o,1));return t}(t)):(n&&console.info("Ignore cleaning buffer because target widget not ",m),t)}function r(e,t,o){var i=o.targetWidget;return t&&(p(i)?o.buffer&&o.buffer.name?(t=d(o.buffer.name),n&&console.warn('Buffered widget "'+o.buffer.name+'" checked by "'+m+'" => ',t)):n&&console.warn("Cant checking for allow paste buffer because buffer is invalid",o.buffer):n&&console.info("Ignore checking for allow paste buffer target widget not ",m)),t}function a(e,t,o){var i=o.targetWidget,r=o.dropObject;return t&&p(i)?i.name===m&&r.widgetName!==f?(n&&console.info('Reject drop "'+r.widgetName+'" because primary child widget must be item "'+f+'" but target is "'+i.name+'"'),!1):(r.isNew?(t=d(r.widgetName),n&&console.warn('Drag NEW widget "'+r.widgetName+'" checked by "'+m+'" => ',t)):(t=function e(t){var o,i,r=d(t.name);if(!r)return n&&console.info('Denied use widget "'+t.name+'"'),r;if(!t.children||!t.children.length)return r;for(o=0,i=t.children.length;o<i;o++)if(!(r=e(t.children[o])))return r;return r}(r.widget),n&&console.warn('Drag existed widget "'+r.widget.name+'" checked by "'+m+'" => ',t)),t):t}function s(e,t,o){var i,r;return p(t)?t.name===m&&(i=o.position,r=t.getPositionInContent(),i.positionIndex=r.positionIndex+1,i.containerIndex=r.containerIndex,t=t._parent,n&&console.info("Target widget was fixed to",t)):n&&console.info('Ignore checking on paste widget target widget "'+t+'" not ',m),t}function l(e,t,o){var i,r,n,a,s,l;if(t.name===m&&d(o.droppedWidgetOptions.widgetName))return(i=$(o.event.target).closest(".moto-widget-tabs__header")).length&&(t=c.getWidgetById(i.data("tab"))).openOnPreview(),t;if(!p(t))return t;if(r=c.Utils.getContainerEdgeHeight(t),a=t._$dom.outerWidth(),n=t._$dom.outerHeight(),s=/(desktop|tablet)/.test(o.device),l=o.eventPositions.clientX-t._$dom.offset().left,t.isFirstInParent()&&o.eventPositions.targetWidgetOffsetY<=r||t.isLastInParent()&&o.eventPositions.targetWidgetOffsetY>=n-r||l<=20&&60<a&&s||a-20<=l&&60<a&&s||!d(o.droppedWidgetOptions.widgetName))for(;t&&t.name!==m;)t=t._parent;return t}function u(e,t,o){try{if("section"===o.parentWidget.name&&o.droppedWidgetOptions.widgetName===m)return!0}catch(e){n&&(console.warn("Error on onCheckIsNeedToWrapRow"),console.error(e))}return t}function g(e,t,o){var i;switch(t){case"removeWidget":case"createWidget":i=c.getWidgetById(o.parent);break;case"moveWidget":i=c.getWidgetById(o.targetWidgetId);break;case"setProperties":case"rowColumnsResized":case"widgetEditorActivated":case"widgetEditorDeactivated":i=c.getWidgetById(o.id);break;default:console.error("tabs_handlers.js : unexpected undo/redo action")}for(;i;){if(i.name===f)return void i.openOnPreview();i=i._parent}}e.$on("NEW EVENT: MotoEditor.config:after",function(e,t){(c=t.getEditor()).addInterceptor(c.INTERCEPTOR__PASTE_BUFFER_CLEANING,o),c.addInterceptor(c.INTERCEPTOR__BUFFER_IS_ALLOW_TO_PASTE,r),c.addInterceptor(c.INTERCEPTOR__IS_ALLOW_DROP_OBJECT,a),c.addInterceptor(c.INTERCEPTOR__PASTE_FROM_BUFFER,s),c.addInterceptor(c.INTERCEPTOR__DRAG_OVER_TARGET_WIDGET,l),c.addInterceptor(c.INTERCEPTOR__IS_NEED_TO_WRAP_WITH_ROW,u),c.addInterceptor(c.INTERCEPTOR__UNDO_REDO_ACTION_BEFORE,g)})}])}(),angular.module("application.widget.tabs_item",["application.widget.abstract_container"]).run(["coreLibraryWidget","core.library.editor.PresetsService",function(e,t){var o=e.get("AbstractContainerWidgetClass");function i(){this.properties={header:{content:"",icon:null}},o.apply(this,arguments)}((i.prototype=Object.create(o.prototype)).constructor=i).prototype.name="tabs.item",i.prototype.label="WIDGET.TABS_ITEM.NAME",i.prototype._apiVersion=2,i.prototype._transformToMacros=!0,i.prototype._template={engine:"nunjucks",path:"@websiteWidgets/tabs/templates/item.twig.html"},i.prototype.getRenderVariables=function(){return{currentWidget:this}},i.prototype.isCopyable=function(){return!0},i.prototype.isDraggable=function(){return!1},i.prototype.isVisibleInNesting=function(){return!1},i.prototype.getHelperInsertPosition=function(){return"append"},i.prototype.getDomElementsWhereWidgetsCanBePlaced=function(){return this._$dom.find(">.moto-widget-tabs__content-wrapper>.moto-widget-tabs__content")},i.prototype.getTargetElement=function(e){return e&&0<=["prepend","append"].indexOf(e.position)?this.getDomElementsWhereWidgetsCanBePlaced():o.prototype.getTargetElement.call(this,e)},i.prototype.getWidgetForHelper=function(e){return"draghover"===e?this:this._parent.getWidgetForHelper(e)},i.prototype.create=function(){this.updateEmptyClass(),o.prototype.create.apply(this,arguments)},i.prototype.initialize=function(){this.updateEmptyClass(),o.prototype.initialize.apply(this,arguments)},i.prototype.isOpenedOnPreview=function(){return this._$dom.find(">.moto-widget-tabs__header").hasClass("moto-widget-tabs__header_opened")},i.prototype.openOnPreview=function(){this.isOpenedOnPreview()||this._$dom.find(">.moto-widget-tabs__header").click()},i.prototype.isOpenedByDefault=function(){return this.isFirstInParent()},i.prototype.manualUpdateContentView=function(){this._$dom.find(">.moto-widget-tabs__header>.moto-widget-tabs__header-title").remove(),this.properties.header.content.length&&this._$dom.find(">.moto-widget-tabs__header").append('<div class="moto-widget-tabs__header-item moto-widget-tabs__header-title">'+this.properties.header.content+"</div>"),this._$dom.find(">.moto-widget-tabs__header>.moto-widget-tabs__header-icon").remove(),this.properties.header.icon&&this.properties.header.icon.id&&this._$dom.find(">.moto-widget-tabs__header").prepend('<span class="moto-widget-tabs__header-item moto-widget-tabs__header-icon"><span class="fa fa-fw fa-'+this.properties.header.icon.id+'" aria-hidden="true"></span></span>')},i.prototype.onAppendChildEvent=function(){this.openOnPreview(),o.prototype.onAppendChildEvent.apply(this,arguments)},e.set(i.prototype.name,i),t.addWidget({name:"tabs.item",base:"tabs",enabled:!0})}]),angular.module("application.widget.tabs",["application.widget.abstract_container","application.widget.tabs_item","application.widget.tabs_handlers"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","core.library.editor.PresetsService","motoFeatures","coreLibraryModal",function(e,t,o,i,n){var r=e.get("AbstractContainerWidgetClass");function a(e){var t=e.find(">.moto-widget-tabs__wrapper>.moto-widget-tabs__headers-wrapper"),o=e.find(">.moto-widget-tabs__wrapper>.moto-widget-tabs__items-wrapper>.moto-widget-tabs__item>.moto-widget-tabs__header").clone();t.children().remove(),o.removeClass("moto-widget-tabs__header_mobile").addClass("moto-widget-tabs__header_desktop"),t.append(o)}function s(e){e.motoTabs()}function l(r){r.openItemPopup=function(o){var i={header:{content:"",icon:null}};n("@websiteWidgets/tabs/src/backend/views/item.tpl.html",function(e,t){e.editingMode=!!o,e.item=e.editingMode?angular.copy(o.properties):angular.copy(i),e.ok=function(){e.editTabsItem.$valid&&(e.editingMode?o.setProperties({header:e.item.header}).then(function(){a(r.currentWidget._$dom)}):r.currentWidget._Editor.ContentManager.insertOrMoveWidgetByOptions({droppedWidgetOptions:{isNew:!0,widgetName:"tabs.item",options:{properties:{header:e.item.header}}},position:"append",targetWidget:r.currentWidget}),t.close(e))},e.cancel=function(){t.close(e)}})},r.deleteItem=r.currentWidget._Editor.userWantsToRemoveWidget,r.duplicateItem=r.currentWidget._Editor.userWantsToDuplicateWidget}function c(){this.properties={type:"horizontal",horizontal:{justifiedHeaders:!1,headersAlignment:"left"},vertical:{position:"left",headerTextAlignment:"left",widthType:"responsive",fixedWidth:"150px",responsiveWidth:"20%"},preset:"default",iconsAlignment:"left",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},visible_on:"mobile-v",animation:""},r.apply(this,arguments)}l.$inject=["$scope"],((c.prototype=Object.create(r.prototype)).constructor=c).prototype.controller=l,c.prototype.name="tabs",c.prototype.label="WIDGET.TABS.NAME",c.prototype._apiVersion=2,c.prototype._transformToMacros=!0,c.prototype._dragImagePath="@websiteWidgets/tabs/icons/drag.png",c.prototype._template={engine:"nunjucks",path:"@websiteWidgets/tabs/templates/default.twig.html"},c.prototype.isCopyable=function(){return!0},c.prototype.getHelperInsertPosition=function(e){var t=/(desktop|tablet)/.test(e.device),o=this._$dom.outerWidth();return e.eventPositions.targetWidgetOffsetX<=20&&60<o&&t?"left":e.eventPositions.targetWidgetOffsetX>=o-20&&60<o&&t?"right":e.eventPositions.targetWidgetOffsetY<=this._$dom.outerHeight()/2?"before":"after"},c.prototype.getDomElementsWhereWidgetsCanBePlaced=function(){return this._$dom.find(">.moto-widget-tabs__wrapper>.moto-widget-tabs__items-wrapper")},c.prototype.getTargetElement=function(e){return e&&0<=["prepend","append"].indexOf(e.position)?this.getDomElementsWhereWidgetsCanBePlaced():r.prototype.getTargetElement.call(this,e)},c.prototype.initialize=function(){this.updateEmptyClass(),r.prototype.initialize.apply(this,arguments)},c.prototype.create=function(){var e;e=this,angular.isDefined(e.properties.justifiedHeaders)&&(e.properties.horizontal.justifiedHeaders=e.properties.justifiedHeaders,e.properties.horizontal.headersAlignment=e.properties.headersAlignment,delete e.properties.justifiedHeaders,delete e.properties.headersAlignment,e.manualUpdateContentView()),s(this._$dom),this.updateEmptyClass(),r.prototype.create.apply(this,arguments)},c.prototype.onAppendChildEvent=function(){r.prototype.onAppendChildEvent.apply(this,arguments),a(this._$dom),s(this._$dom),this.checkAndSelectFirstItem()},c.prototype.onRemoveChildEvent=function(){r.prototype.onRemoveChildEvent.apply(this,arguments),a(this._$dom),s(this._$dom),this.checkAndSelectFirstItem()},c.prototype.postRenderPreview=function(){r.prototype.postRenderPreview.apply(this,arguments),s(this._$dom)},c.prototype.manualUpdateContentView=function(){var e=this._$dom.find(">.moto-widget-tabs__wrapper>.moto-widget-tabs__headers-wrapper");this._$dom.removeClass("moto-visible-on_desktop moto-visible-on_tablet moto-visible-on_mobile-h moto-widget-tabs_type-horizontal moto-widget-tabs_type-vertical moto-widget-tabs_type-vertical_left moto-widget-tabs_type-vertical_right").addClass(this.getCssClasses()).attr("class",this._$dom.attr("class").replace(/(^|\s)moto-preset-\S+/g," moto-preset-"+this.properties.preset)),e.css("width",this.getWrapperWidth()).attr("class",e.attr("class").replace(/(^|\s)moto-widget-tabs__headers-wrapper_\S+/g," ")).addClass(this.getWrapperClasses())},c.prototype.checkAndSelectFirstItem=function(){var e;if(!this.children.length)return!1;for(e=0;e<this.children.length;e++)if(this.children[e].isOpenedOnPreview())return!1;return this.children[0].openOnPreview(),!0},c.prototype.getCssClasses=function(){var e=this.getAlignClass();return e+=" "+this.getSpacing("classes"),e+=" "+this.getVisibleOn("classes"),e+=" "+this.getAnimationClasses(),e+=" moto-preset-"+this.properties.preset,e+=" moto-widget-tabs_type-"+this.properties.type,"vertical"===this.properties.type&&(e+=" moto-widget-tabs_type-vertical_"+this.properties.vertical.position),e},c.prototype.getWrapperClasses=function(){var e="moto-widget-tabs__headers-wrapper_icon-"+this.properties.iconsAlignment;return"horizontal"===this.properties.type?this.properties.horizontal.justifiedHeaders?e+=" moto-widget-tabs__headers-wrapper_headers-justified":e+=" moto-widget-tabs__headers-wrapper_headers-"+this.properties.horizontal.headersAlignment:e+=" moto-widget-tabs__headers-wrapper_text-"+this.properties.vertical.headerTextAlignment,e},c.prototype.getWrapperWidth=function(){return"vertical"===this.properties.type?this.properties.vertical[this.properties.vertical.widthType+"Width"]:"auto"},e.doWhenLivePreviewReady(function(e){e.$(".moto-widget-tabs").each(function(){s(e.$(this))})}),e.set(c.prototype.name,c),t.addWidget({name:c.prototype.name,label:c.prototype.label,category:"more",order:46,enabled:i.isEnabled("theme_widget_tabs"),options:{children:[]},icons:{small:"icon icon-tabs",medium:"icon-tabs-medium",large:"icon icon-tabs"}}),o.addWidget({name:c.prototype.name,label:c.prototype.label,category:"more",order:100,enabled:i.isEnabled("theme_widget_tabs"),checkPresetControls:!1,stateParam:"tabs",template:{path:"@websiteWidgets/tabs/templates/default.twig.css",engine:"nunjucks"},icons:{small:"icon icon-tabs",medium:"icon icon-tabs-medium",large:"icon icon-tabs"}})}]),angular.module("application.widget.text",["application.core"]).run(["core.library.editor.WidgetsService","coreLibraryWidget","motoUI.LinkToService","MotoCkeditor","coreLibraryUtils","$rootScope",function(e,t,s,l,c,o){var p=t.get("AbstractWidgetClass");function d(e){var t,o,i;for(o=e._$body.find(".cke_editable").closest(".moto-widget"),i=0;i<o.length;i++)(t=e.getWidgetByDom(o[i])).hideCKEditorToolbar&&t!==t._Editor.getCurrentWidget()&&t.hideCKEditorToolbar()}function u(e){var t=e.getLivePreviewService().ScriptsInjector.inject("ckeditor");return t.then(function(){l.processGlobalCKEDITOR(e.getGlobal("window").CKEDITOR)}),t}function i(){this.properties={content:'<p class="moto-text_normal">Text...</p>',preset:"default",animation:"",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"}},this._CKEditorInstance=null,this.canDrag=!0,this.firstClick=!1,p.apply(this,arguments)}o.$on("NEW EVENT: MotoEditor.run:after",function(e,t){var o=t.getEditor(),i=o.getScope(),r=$("body");function n(){var e;r.hasClass("modal-open")||(d(o),(e=o.getCurrentWidget())&&e.hideCKEditorToolbar&&e.hideCKEditorToolbar())}function a(){r.off("click",n)}i.$on("NEW EVENT: Widget was selected",function(){d(o)}),i.$on("MotoEditor.Text.CKEditorToolbarWasShown",function(){r.on("click",n)}),i.$on("MotoEditor.Text.CKEditorToolbarWasHidden",a),i.$on("$destroy",a),u(t)}),((i.prototype=Object.create(p.prototype)).constructor=i).prototype.name="text",i.prototype.label="WIDGET.TEXT.NAME",i.prototype._apiVersion=2,i.prototype._dragImagePath="@websiteWidgets/text/icons/drag.png",i.prototype._template={engine:"nunjucks",path:"@websiteWidgets/text/templates/default.twig.html"},i.prototype.isCopyable=function(){return!0},i.prototype.shouldUpdateContentView=function(){return this._Editor.HistoryManager.isUndoOrRedoInProcess()},i.prototype.clearAttributes=function(e){var t;e&&((t=this.$(e)).removeClass("cke_editable").removeClass("cke_editable_inline").removeClass("cke_contents_ltr").removeClass("cke_show_borders").removeClass("cke_focus").removeAttr("contenteditable").removeAttr("data-gramm").removeAttr("aria-label").removeAttr("aria-describedby").removeAttr("tabindex").removeAttr("id").removeAttr("role").removeAttr("title").removeAttr("spellcheck").removeAttr("style"),t.find("[data-cke-hidden-sel]").remove(),t.find("[data-cke-saved-href]").removeAttr("data-cke-saved-href"),t.find("[data-cke-saved-src]").removeAttr("data-cke-saved-src"),t.find(".fa[contenteditable]").removeAttr("contenteditable"))},i.prototype.canBeRemoved=function(){return!this.isOpenToolbar()&&p.prototype.canBeRemoved.call(this)},i.prototype.beforeDestroy=function(){this.hideCKEditorToolbar(!0)},i.prototype.showCKEditorToolbar=function(){var o=this,i=l.getBaseConfig();i.extraPlugins=i.extraPlugins+",motoimage",this._CKEditorInstance||this.isOpenToolbar()||u(this._Environment).then(function(){var e,t;o._CKEditorInstance||o.isOpenToolbar()||o.isSelected()&&((e=o.getContentElement())&&(e.setAttribute("data-gramm",!1),e.setAttribute("contenteditable",!0),$(e.parentElement).removeClass("moto-widget-text_blank"),(t=o._Environment.getGlobal("window").CKEDITOR.inline(e,i)).on("change",o.syncContentData.bind(o)),t.on("focus",function(){setTimeout(function(){e.setAttribute("title","")},100)}),t.on("blur",function(e){t.config.preventBlur?e.stop():setTimeout(function(){o.hideCKEditorToolbar()},100)}),o._CKEditorInstance=t),o._$dom.is("[draggable=true]")&&o._$dom.attr("data-draggable-disabled","").removeAttr("draggable"),o._$dom.parents("[draggable=true]").attr("data-draggable-disabled","").removeAttr("draggable"),o.canDrag=!1,$(".moto-ui-sidebar").css("overflow","hidden"),o._Editor.getScope().$broadcast("MotoEditor.Text.CKEditorToolbarWasShown"))})},i.prototype.hideCKEditorToolbar=function(e){var t;this._CKEditorInstance&&(l.destroyInstance(this._CKEditorInstance),this._CKEditorInstance=null,(t=this.getContentElement())&&this.clearAttributes(t),this.firstClick=!1,this._$dom.is("[data-draggable-disabled]")&&this._$dom.attr("draggable","true").removeAttr("data-draggable-disabled"),this._$dom.parents("[data-draggable-disabled]").attr("draggable","true").removeAttr("data-draggable-disabled"),this.canDrag=!0,$(".moto-ui-sidebar").css("overflow",""),e?this._Editor.getScope().$broadcast("MotoEditor.Text.CKEditorToolbarWasHidden"):this.renderPreview(function(){this._Editor.getScope().$broadcast("MotoEditor.Text.CKEditorToolbarWasHidden")}.bind(this)))},i.prototype.initialize=function(){var e,n;this._propertiesLoaded||((n=this).$("a",n._dom).each(function(e,t){var o,i,r;(i=(o=n.$(t)).attr("data-action"))?"pages"===i?o.attr("data-action","page"):"email"===i&&o.attr("data-action","mail"):(r=o.attr("href"))&&/^mailto:/.test(r)&&o.attr("data-action","mail")}),this._$dom.find("[data-cke-saved-href]").removeAttr("data-cke-saved-href"),this._$dom.find(".fa[contenteditable]").removeAttr("contenteditable"),(e=this.getContentElement())&&(e=angular.element(e),this.properties.content=e.html(),this.properties.content=s.transformLinks(this.properties.content)),this._$dom.data("animation")&&(this.properties.animation=this._$dom.data("animation"))),c.removeComments(this._$dom),p.prototype.initialize.call(this)},i.prototype.create=function(){var e=this;d(this._Editor),this._Editor.isSilentMode(this)||setTimeout(function(){e.showCKEditorToolbar()},0),p.prototype.create.call(this)},i.prototype.transform=function(){var e,o,i,r,n,a;c.removeComments(this._$dom),s.transformLinks(this._$dom),this.clearAttributes(this.getContentElement()),e=this._$dom,o=this._windowContext.document,e.find(".cke_widget_motoimagewidget").each(function(e,t){i=$(t),(r=i.find(".moto-content-image-plugin-wrapper")).removeClass("cke_widget_element").removeAttr("data-cke-widget-data").removeAttr("data-cke-widget-upcasted").removeAttr("data-cke-widget-keep-attr").removeAttr("data-widget"),i.find(".moto-content-resizer").remove(),i.replaceWith(r)}),e.find(".moto-content-image-plugin-wrapper").each(function(e,t){r=$(t),i=r.find(".moto-content-image-container"),n=r.find(".moto-content-image"),i.length&&n.length&&(a=r.html(),a=l.transformImagesSource(a,".moto-content-image"),i.replaceWith(o.createComment("--@"+a+"@--")))}),p.prototype.transform.call(this)},i.prototype.manualUpdateContentView=function(){this.properties.animation?this.setAnimationClass():this.unsetAnimationClass()},i.prototype.syncContentData=function(){var e;this._CKEditorInstance&&(e=this._CKEditorInstance.getData(),e=s.transformLinks(e),e=l.clearRedundantData(e),e=l.transformImagesSource(e,".moto-content-image"),this.setProperties({content:e}))},i.prototype.getContentElement=function(){var e;return e=0<(e=this._dom.getElementsByClassName("moto-widget-text-editable")).length?e[0]:null},i.prototype.isOpenToolbar=function(){return!!this._$dom.find(".cke_editable").length},i.prototype.isDraggable=function(e){return angular.isDefined(e)&&!this.canDrag&&(this.$(e.target).hasClass("cke_widget_drag_handler")||(e.preventDefault(),e.stopPropagation())),this.canDrag},i.prototype.onClickEvent=function(){this.firstClick?(d(this._Editor),this.showCKEditorToolbar()):this.firstClick=!0},i.prototype.onUnselectedEvent=function(){this.firstClick=!1},t.set(i.prototype.name,i),e.addWidget({name:i.prototype.name,label:i.prototype.label,category:"basic",order:5,enabled:!0,allowed:function(){return!0},icons:{small:"icon icon-text",medium:"",large:"icon icon-text"}})}]),angular.module("application.widget.tile_gallery").controller("application.widget.tile_gallery.controllers.EditItemController",["$scope","application.media_library.services.MediaLibraryService","motoUI.LinkToService",function(o,e,t){o.currentItem=angular.copy(o.editingItem),o.toggleTextEditor=function(){var e;"text"===o.currentItem.caption.type&&(e=angular.element(o.currentItem.caption.content)).length&&(e.find(".fa").remove(),o.currentItem.caption.content=e.text())},o.changeImage=function(){e.open({id:o.currentItem.content.id,value:o.currentItem.content.path,filters:["image"],thumbnails:!0,size:o.currentItem.content.size,onApply:function(e,t){e&&(o.currentItem.content.id!==e.id&&(o.currentItem.content.id=e.id,o.currentItem.content.alt=e.alt),o.currentItem.content.name=e.name,o.currentItem.content.size=t,o.currentItem.content.path=e.getThumbnailPath(t))}})},o.ok=function(){o.editImage&&!o.editImage.$valid||(o.currentItem.content.path&&("html"===o.currentItem.caption.type&&(o.currentItem.caption.content=t.transformLinks(o.currentItem.caption.content)),o.editingItem.caption.type=o.currentItem.caption.type,o.editingItem.link=angular.copy(o.currentItem.link),o.editingItem.content=angular.copy(o.currentItem.content)),o.editingItem.caption.content=o.currentItem.caption.content.trim(),o.$parent.ok())}}]),angular.module("application.widget.tile_gallery").controller("application.widget.tile_gallery.controllers.TopController",["$scope","coreLibraryModal","coreLibraryUtils","application.media_library.services.MediaLibraryService",function(o,e,t,i){o.initialItems=angular.copy(o.items),o.addImage=function(){i.open({multiSelect:!0,filters:["image"],thumbnails:!0,onApply:function(e,t){e&&e.forEach(function(e){o.items.push({caption:{content:"",type:"text"},content:{id:e.id,type:e.type,path:e.getThumbnailPath(t),size:t,name:e.name,alt:e.alt},link:{action:"lightbox",properties:{mediaId:e.id,size:"",src:e.path}}})})}})},o.editImage=function(o){e("@websiteWidgets/tile_gallery/src/backend/views/edit_item.tpl.html",function(e,t){e.editingItem=o,e.ok=function(){t.close(e)},e.cancel=function(){t.close(e)}},null,"widget-admin-edit modal-with-ckeditor")},o.deleteImage=function(e){var t=o.items.indexOf(e);0<=t&&o.items.splice(t,1)},o.isChanged=function(){return!angular.equals(o.initialItems,o.items)},o.ok=function(){o.$parent.ok(o.items,o.isChanged())},o.cancel=function(e){e&&e.preventDefault(),o.isChanged()?t.openConfirmationBox({yesHandler:function(){o.$parent.cancel()}}):o.$parent.cancel()},o.$on("motoPopupCanceled",o.cancel)}]),angular.module("application.widget.tile_gallery").run(["core.library.editor.WidgetsService","core.library.editor.PresetsService","motoFeatures","coreLibraryWidget","coreLibraryMessenger","coreLibraryModal",function(e,t,o,i,n,a){var r=i.get("AbstractWidgetClass"),s={itemsWrapper:{desktop:{base:{"column-gap":"30px","column-count":"4"}},tablet:{base:{"column-gap":"","column-count":""}},"mobile-v":{base:{"column-gap":"","column-count":""}},"mobile-h":{base:{"column-gap":"","column-count":""}}},itemWrapper:{desktop:{base:{"padding-bottom":"30px"}},tablet:{base:{"padding-bottom":""}},"mobile-v":{base:{"padding-bottom":""}},"mobile-h":{base:{"padding-bottom":""}}}};function l(e){e.find(".moto-widget-tile-gallery__items-wrapper").tileGallery()}function c(r){a("@websiteWidgets/tile_gallery/src/backend/views/top.tpl.html",function(o,i){o.items=angular.copy(r.properties.items),o.ok=function(e,t){t&&r.setProperties({items:e}),i.close(o),n.success("WIDGET.COMMON.MESSAGES.CHANGES_APPLIED")},o.cancel=function(){i.close(o)}},null,"widget-admin")}function p(o){o.openSelectItemsPopup=c,o.columnGapChanged=function(){var e,t=o.currentWidget.properties.styles;for(e in t.itemsWrapper)t.itemsWrapper[e].base&&(angular.isObject(t.itemWrapper[e].base)||(t.itemWrapper[e].base={}),t.itemWrapper[e].base["padding-bottom"]=t.itemsWrapper[e].base["column-gap"])}}function d(){this.properties={items:[],justifyHeight:!0,styles:angular.copy(s),preset:"default",animation:"",visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"}},r.apply(this,arguments)}p.$inject=["$scope"],((d.prototype=Object.create(r.prototype)).constructor=d).prototype._transformToMacros=!0,d.prototype.controller=p,d.prototype.name="tile_gallery",d.prototype.label="WIDGET.TILE_GALLERY.NAME",d.prototype._apiVersion=2,d.prototype._dragImagePath="@websiteWidgets/tile_gallery/icons/drag.png",d.prototype._template={engine:"nunjucks",path:"@websiteWidgets/tile_gallery/templates/default.twig.html"},d.prototype.isCopyable=function(){return!0},d.prototype.onDoubleClickEvent=function(){c(this)},d.prototype.create=function(){l(this._$dom),r.prototype.create.call(this)},d.prototype.postRenderPreview=function(){l(this._$dom)},d.prototype.onWidthChanged=function(){this.renderPreview()},i.doWhenLivePreviewReady(function(e){e.$(".moto-widget-tile-gallery").each(function(){try{e.$(this).data("widget-id")&&e.widgetCacheOptions[e.$(this).data("widget-id")].properties&&l(e.$(this))}catch(e){}})}),i.set(d.prototype.name,d),e.addWidget({name:d.prototype.name,label:d.prototype.label,category:"galleries",order:40,enabled:o.isEnabled("theme_widget_tile_gallery"),icons:{small:"icon icon-tile_gallery",medium:"icon icon-tile_gallery",large:"icon icon-tile_gallery"}}),t.addWidget({name:d.prototype.name,label:d.prototype.label,category:"galleries",order:110,enabled:o.isEnabled("theme_widget_tile_gallery"),checkPresetControls:!1,stateParam:"tile_gallery",template:{path:"@websiteWidgets/tile_gallery/templates/default.twig.css",engine:"nunjucks"},icons:{small:"icon icon-tile_gallery",medium:"icon icon-tile_gallery-medium",large:"icon icon-tile_gallery"}})}]),angular.module("application.widget.twitter.time_line",["application.widget.abstract","core.library.scriptsInjector"]).config(["coreLibraryValidationProvider",function(r){r.setErrorMessage("TWITTER_WIDGET_ID","WIDGET.TWITTER_TIME_LINE.INCORRECT_ID_ERROR_MESSAGE"),r.setValidator("twitter_widget_id",function(e){var t,o,i;return t={isValid:!1,key:r.getErrorMessage("TWITTER_WIDGET_ID","WIDGET.TWITTER_TIME_LINE.INCORRECT_ID_ERROR_MESSAGE"),args:{}},o={isValid:!0,key:"",args:{}},i=/^([0-9]{18})$/i,e?angular.isString(e)&&(e=e.trim(),i.test(e)||!e.length)?o:t:o})}]).run(["core.library.editor.WidgetsService","coreLibraryWidget","coreLibraryValidation","ScriptsInjector",function(e,t,o,i){var r=t.get("AbstractWidgetClass");function n(e){"widget"===e.params.sourceType?delete e.params.screenName:delete e.params.widget_id}function a(){this.properties={visible_on:"mobile-v",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},title:"",params:{tweet_limit:5,lang:"en",theme:"light",chrome_noheader:!1,chrome_nofooter:!1}},r.apply(this,arguments)}((a.prototype=Object.create(r.prototype)).constructor=a).prototype.name="twitter.time_line",a.prototype.label="WIDGET.TWITTER_TIME_LINE.NAME",a.prototype._apiVersion=2,a.prototype._templateViewURL="@websiteWidgets/twitter/views/properties.tpl.html",a.prototype._transformToMacros=!0,a.prototype._dragImagePath="@websiteWidgets/twitter/icons/drag.png",a.prototype._template={engine:"nunjucks",path:"@websiteWidgets/twitter/templates/time_line.twig.html"},a.prototype.create=function(){this._initSourceType(),this.postRenderPreview(),r.prototype.create.call(this)},a.prototype.initialize=function(){this._initSourceType(),this._$dom.is("[data-frontend-rendering]")&&this.renderPreview(),r.prototype.initialize.call(this)},a.prototype.transform=function(){n(this.properties),r.prototype.transform.call(this)},a.prototype.exportForFuture=function(){var e=r.prototype.exportForFuture.call(this);return n(e.properties),e},a.prototype._initSourceType=function(){this.properties.params.sourceType||(angular.isDefined(this.properties.params.widget_id)?this.properties.params.sourceType="widget":this.properties.params.sourceType="profile")},a.prototype._initTwitterTimeline=function(){var e,t,o=this.$(".moto-widget_wrapper",this._dom),i={sourceType:this.getTwitterParam("sourceType")};this.isValidTwitterSource()&&!this.__createTimelineInProccess&&(this.__createTimelineInProccess=!0,"widget"===i.sourceType?i.widgetId=this.getTwitterParam("widget_id"):i.screenName=this.getTwitterParam("screenName"),o.empty(),e=this._windowContext.twttr,t={tweetLimit:this.getTwitterParam("tweet_limit"),chrome:this.getTwitterChrome(),lang:this.getTwitterParam("lang"),theme:this.getTwitterParam("theme")},e.widgets.createTimeline(i,o.get(0),t).then(function(e){e||o.after('<div class="moto-widget-empty"></div>').remove(),delete this.__createTimelineInProccess}.bind(this)))},a.prototype.postRenderPreview=function(){var e=this,t=this._Environment.getLivePreviewService();r.prototype.postRenderPreview.apply(this,arguments),this.__createTimelineInProccess=!1,this.isValidTwitterSource()&&t.ScriptsInjector.inject("twitter").then(function(){e._initTwitterTimeline()})},a.prototype.onWidthChanged=function(){this.renderPreview()},a.prototype.getTwitterChrome=function(){var e="";return this.getTwitterParam("chrome_noheader")&&(e+=" noheader"),this.getTwitterParam("chrome_nofooter")&&(e+=" nofooter"),"transparent"===this.getTwitterParam("theme")&&(e+=" transparent"),e},a.prototype.isValidTwitterSource=function(){return"widget"===this.getTwitterParam("sourceType")?!(!this.getTwitterParam("widget_id")||!o.getValidator("twitter_widget_id")(this.getTwitterParam("widget_id")).isValid):!!this.getTwitterParam("screenName")},a.prototype.getTwitterParam=function(e,t){return this.properties.params[e]||t},a.prototype.isCopyable=function(){return!0},i.addScript("twitter",function(t){return t.twttr=t.twttr||{},t.twttr._e=[],t.twttr.ready=function(e){t.twttr._e.push(e)},$("<script><\/script>").attr("id","twitter-wjs").attr("async","true").attr("src","https://platform.twitter.com/widgets.js")}),t.set(a.prototype.name,a),e.addWidget({name:a.prototype.name,label:a.prototype.label,category:"social",order:20,enabled:!0,icons:{small:"icon icon-twitter-timeline",medium:"",large:"icon icon-twitter-timeline"}})}]),angular.module("application.widget.video_player",["application.core"]).run(["coreLibraryWidget","core.library.editor.WidgetsService","application.media_library.services.MediaLibraryService","core.library.editor.PresetsService","motoFeatures",function(e,t,o,i,r){var n=e.get("AbstractWidgetClass");function a(e){var t,o;this.properties={preset:"default",version:2,tracks:[{webm:{id:null,name:null,path:null,filesize:null,length:null},mp4:{id:null,name:null,path:null,filesize:null,length:null}}],settings:{autoplay:!1,muted:!1},spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"}},e.properties&&(t=e.properties,angular.isObject(t)&&(t.version||(t.version=1),1===t.version&&(t.version=2,o=angular.copy(t.tracks[0]),t.tracks[0]={webm:{id:null,name:null,path:null,filesize:null,length:null},mp4:o}))),n.apply(this,arguments)}function s(e,t){var o,i={name:"",length:0};o=t.tracks[0],angular.isUndefined(t.version)?i=o:o.webm.path?i=o.webm:o.mp4.path&&(i=o.mp4),e.on("loadeddata",function(){e.closest(".moto-media-player").removeClass("moto-media-player_not-loaded").addClass("moto-media-player_loaded")}),e.mediaelementplayer({motoTrackName:i.name||"",timeAndDurationSeparator:"<span>/</span>",startVolume:1,playText:"",pauseText:"",stopText:"",fullscreenText:"",videoVolume:"horizontal",alwaysShowControls:!0,features:["playpause","progress","current","duration","mototrackname","volume","fullscreen","motoskin"],plugins:[],duration:i.length,keyActions:[]})}((a.prototype=Object.create(n.prototype)).constructor=a).prototype._transformToMacros=!0,a.prototype.name="video_player",a.prototype.label="WIDGET.VIDEO_PLAYER.NAME",a.prototype._apiVersion=2,a.prototype._dragImagePath="@websiteWidgets/video_player/icons/drag.png",a.prototype._template={engine:"nunjucks",path:"@websiteWidgets/video_player/templates/default.twig.html"},a.prototype.postRenderPreview=function(){n.prototype.postRenderPreview.apply(this,arguments),s(this._$dom.find("video"),this.properties)},a.prototype.shouldUpdateContentView=function(){return!1},a.prototype.isCopyable=function(){return!0},a.prototype.manualUpdateContentView=function(e){angular.equals(this.properties.tracks,e.tracks)?angular.equals(this.properties.spacing,e.spacing)||this.onWidthChanged():this.renderPreview()},a.prototype.getPlayerInstance=function(){var e=this._$dom.find("video");return e[0]&&e[0].player||null},a.prototype.onWidthChanged=function(){var e=this.getPlayerInstance();e&&(e.setPlayerSize(),e.setControlsSize())},a.prototype.initialize=function(){s(this._$dom.find("video"),this.properties),n.prototype.initialize.call(this)},a.prototype.create=function(){s(this._$dom.find("video"),this.properties),this._Editor.isSilentMode(this)||this.changeVideoFile(),n.prototype.create.call(this)},a.prototype.changeVideoFile=function(){var t=this;o.open({filters:["video"],extensions:["mp4","webm"],onApply:function(e){t.__getPublicInstance().properties.tracks[0][e.extension]={id:e.id,path:e.path,name:e.name,filesize:e.filesize||null,length:e.properties.playtime_seconds||0}}})},a.prototype.onDoubleClickEvent=function(){this.changeVideoFile()},a.prototype.exportForFuture=function(){var e,t,o=n.prototype.exportForFuture.call(this);if(angular.isArray(o.properties.tracks))for(e=0,t=o.properties.tracks.length;e<t;e++)delete o.properties.tracks[e].mp4.id,delete o.properties.tracks[e].webm.id;return o},e.set("video_player",a),e.doWhenLivePreviewReady(function(e){e.$(".moto-widget-video_player").each(function(){try{s(e.$(this).find("video"),e.widgetCacheOptions[e.$(this).data("widget-id")].properties)}catch(e){}})}),e.doWhenWidthChanged(function(t){t.$(".moto-widget-video_player").each(function(){var e;t.$(this).find("video")[0]&&t.$(this).find("video")[0].video&&((e=t.$(this).find("video")[0].video).setPlayerSize(),e.setControlsSize())})}),t.addWidget({name:a.prototype.name,label:a.prototype.label,category:"media",order:40,enabled:!0,allowed:function(){return!0},icons:{small:"icon icon-video_player",medium:"",large:"icon icon-video_player"}}),i.addWidget({name:a.prototype.name,base:"audio_player"})}]),angular.module("application.widget.video",["application.core"]).config(["core.library.editor.PresetsServiceProvider","motoFeaturesProvider","coreLibraryValidationProvider",function(e,t,o){e.addWidget({name:"video",label:"WIDGET.VIDEO.NAME",category:"media",order:20,enabled:t.isEnabled("theme_presets_video"),icons:{small:"icon icon-video",medium:"",large:"icon icon-video"}}),o.setValidator("video_url",function(e){var t={isValid:!1,key:o.getErrorMessage("URL_INVALID","incorrectURL"),args:{}};return e&&0!==e.length&&!/^(https:\/\/|http:\/\/)(((www\.)?vimeo\.com\/)|((www\.)?youtube\.com\/)|((www\.)?youtu\.be\/))(.*)?$/gi.test(e)||(t.isValid=!0,t.key=""),t})}]).run(["coreLibraryWidget","core.library.editor.WidgetsService",function(e,t){var o=e.get("AbstractWidgetClass");function i(n,a,e){n.openChangeUrlPopup=function(){e("@websiteWidgets/video/views/change_url.tpl.html",function(i,e){var r;i.url=n.currentWidget.properties.uri.user_url,i.apply=function(){if(i.editWidgetURL.$valid){if(i.url=i.url.trim(),r=i.url.match(/vimeo\.com|youtube\.com|youtu\.be/),!i.url.length)return n.currentWidget.properties.uri.src="",n.currentWidget.properties.uri.user_url="",void i.cancel();var e,t,o;n.currentWidget.properties.uri.user_url=i.url,"vimeo.com"===r[0]?(o=i.url,o=o.replace(/(http:|https:)?\/\//,""),a.jsonp("https://vimeo.com/api/oembed.json",{params:{url:"http://"+o,callback:"JSON_CALLBACK"},ignoreLoadingBar:!0})).then(function(e){n.currentWidget.properties.uri.src="//player.vimeo.com/video/"+e.data.video_id,i.cancel()},function(){n.currentWidget.properties.uri.src="//player.vimeo.com/video/000",i.cancel()}):(n.currentWidget.properties.uri.src=(e=i.url,"//www.youtube.com/embed/"+((t=e.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/))&&t[7]?t[7]:"000")),i.cancel())}},i.cancel=function(){e.close(i)}})}}function r(){this.properties={align:{desktop:"",tablet:"","mobile-v":"","mobile-h":""},preset:"default",animation:"",spacing:{top:"auto",right:"auto",bottom:"auto",left:"auto"},uri:{src:"",user_url:""}},o.apply(this,arguments)}i.$inject=["$scope","$http","coreLibraryModal"],((r.prototype=Object.create(o.prototype)).constructor=r).prototype.controller=i,r.prototype.name="video",r.prototype.label="WIDGET.VIDEO.NAME",r.prototype._apiVersion=2,r.prototype._transformToMacros=!0,r.prototype._dragImagePath="@websiteWidgets/video/icons/drag.png",r.prototype._template={engine:"nunjucks",path:"@websiteWidgets/video/templates/default.twig.html"},r.prototype.initialize=function(){this._propertiesLoaded||(this.properties.uri.src=this.$(this._dom).find(".video-frame").attr("src")||"",this.properties.uri.user_url=this.properties.uri.src.replace("?wmode=transparent",""),this.properties.animation=this.$(this._dom).data("animation")||this.properties.animation),delete this.properties.uri.isUrlChanged,o.prototype.initialize.call(this)},r.prototype.shouldUpdateContentView=function(e){return angular.isObject(e.uri)&&angular.isDefined(e.uri.src)&&e.uri.src!==this.properties.uri.src},r.prototype.isCopyable=function(){return!0},e.set("video",r),t.addWidget({name:r.prototype.name,label:r.prototype.label,category:"media",order:20,enabled:!0,allowed:function(){return!0},icons:{small:"icon icon-video",medium:"",large:"icon icon-video"}})}]);